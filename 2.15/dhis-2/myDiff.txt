=== modified file 'dhis-2/dhis-services/dhis-service-administration/src/main/java/org/hisp/dhis/resourcetable/DefaultResourceTableService.java'
--- dhis-2/dhis-services/dhis-service-administration/src/main/java/org/hisp/dhis/resourcetable/DefaultResourceTableService.java	2014-08-27 17:15:39 +0000
+++ dhis-2/dhis-services/dhis-service-administration/src/main/java/org/hisp/dhis/resourcetable/DefaultResourceTableService.java	2014-09-02 07:18:42 +0000
@@ -340,7 +340,7 @@
 
         resourceTableStore.createCategoryStructure( categories );
 
-        resourceTableStore.populateCategoryStructure( categories );
+        //resourceTableStore.populateCategoryStructure( categories );
 
         log.info( "Category table generated" );
     }

=== modified file 'dhis-2/dhis-services/dhis-service-administration/src/main/java/org/hisp/dhis/resourcetable/jdbc/JdbcResourceTableStore.java'
--- dhis-2/dhis-services/dhis-service-administration/src/main/java/org/hisp/dhis/resourcetable/jdbc/JdbcResourceTableStore.java	2014-08-27 17:15:39 +0000
+++ dhis-2/dhis-services/dhis-service-administration/src/main/java/org/hisp/dhis/resourcetable/jdbc/JdbcResourceTableStore.java	2014-09-02 07:24:26 +0000
@@ -406,7 +406,7 @@
         
         final String sql = "CREATE TABLE " + TABLE_NAME_DATA_ELEMENT_STRUCTURE + " ( " + 
             "dataelementid INTEGER NOT NULL PRIMARY KEY, " +
-            "dataelementuid CHARACTER(11), " +
+            "dataelementuid CHARACTER(255), " +
             "dataelementname VARCHAR(250), " +
             "datasetid INTEGER, " +
             "datasetuid CHARACTER(11), " +
@@ -507,7 +507,7 @@
         }
         
         final String create = "CREATE TABLE " + TABLE_NAME_DATA_ELEMENT_CATEGORY_OPTION_COMBO + 
-            " (dataelementuid VARCHAR(11) NOT NULL, categoryoptioncombouid VARCHAR(11) NOT NULL)";
+            " (dataelementuid VARCHAR(255) NOT NULL, categoryoptioncombouid VARCHAR(11) NOT NULL)";
         
         jdbcTemplate.execute( create );
         

=== modified file 'dhis-2/dhis-services/dhis-service-analytics/src/main/java/org/hisp/dhis/analytics/data/DefaultAnalyticsService.java'
--- dhis-2/dhis-services/dhis-service-analytics/src/main/java/org/hisp/dhis/analytics/data/DefaultAnalyticsService.java	2014-09-15 08:03:33 +0000
+++ dhis-2/dhis-services/dhis-service-analytics/src/main/java/org/hisp/dhis/analytics/data/DefaultAnalyticsService.java	2014-09-20 04:51:42 +0000
@@ -1160,7 +1160,7 @@
      */
     private int getProcessNo()
     {
-        Integer cores = (Integer) systemSettingManager.getSystemSetting( SystemSettingManager.KEY_DATABASE_SERVER_CPUS );
+        Integer cores =0 ;//(Integer) systemSettingManager.getSystemSetting( SystemSettingManager.KEY_DATABASE_SERVER_CPUS );
         
         return ( cores == null || cores == 0 ) ? SystemUtils.getCpuCores() : cores;
     }

=== modified file 'dhis-2/dhis-services/dhis-service-analytics/src/main/java/org/hisp/dhis/analytics/table/DefaultAnalyticsTableService.java'
--- dhis-2/dhis-services/dhis-service-analytics/src/main/java/org/hisp/dhis/analytics/table/DefaultAnalyticsTableService.java	2014-08-25 15:09:10 +0000
+++ dhis-2/dhis-services/dhis-service-analytics/src/main/java/org/hisp/dhis/analytics/table/DefaultAnalyticsTableService.java	2014-09-02 07:38:41 +0000
@@ -306,7 +306,7 @@
      */
     private int getProcessNo()
     {
-        Integer cores = (Integer) systemSettingManager.getSystemSetting( SystemSettingManager.KEY_DATABASE_SERVER_CPUS );
+        Integer cores = 0;//(Integer) systemSettingManager.getSystemSetting( SystemSettingManager.KEY_DATABASE_SERVER_CPUS );
         
         cores = ( cores == null || cores == 0 ) ? SystemUtils.getCpuCores() : cores;
                         

=== modified file 'dhis-2/dhis-services/dhis-service-analytics/src/main/java/org/hisp/dhis/analytics/table/JdbcAnalyticsTableManager.java'
--- dhis-2/dhis-services/dhis-service-analytics/src/main/java/org/hisp/dhis/analytics/table/JdbcAnalyticsTableManager.java	2014-06-04 16:20:00 +0000
+++ dhis-2/dhis-services/dhis-service-analytics/src/main/java/org/hisp/dhis/analytics/table/JdbcAnalyticsTableManager.java	2014-09-02 07:36:45 +0000
@@ -282,7 +282,7 @@
             columns.add( col );
         }
         
-        String[] de = { quote( "de" ), "character(11) not null", "de.uid" };
+        String[] de = { quote( "de" ), "character(255) not null", "de.uid" };
         String[] co = { quote( "co" ), "character(11) not null", "co.uid" };
         String[] level = { quote( "level" ), "integer", "ous.level" };
         

=== modified file 'dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/expression/DefaultExpressionService.java'
--- dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/expression/DefaultExpressionService.java	2014-03-18 08:10:10 +0000
+++ dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/expression/DefaultExpressionService.java	2014-10-17 06:49:35 +0000
@@ -625,6 +625,7 @@
                 {
                     for ( Indicator indicator : indicators )
                     {
+                        //System.out.println("INdicator : "  + indicator.getId() + "--" + indicator.getName() );
                         indicator.setExplodedNumerator( explodeExpression( indicator.getExplodedNumeratorFallback(), dataElementMap ) );
                         indicator.setExplodedDenominator( explodeExpression( indicator.getExplodedDenominatorFallback(), dataElementMap ) );
                     }

=== modified file 'dhis-2/dhis-services/dhis-service-i18n/src/main/resources/i18n_global.properties'
--- dhis-2/dhis-services/dhis-service-i18n/src/main/resources/i18n_global.properties	2014-05-07 11:40:53 +0000
+++ dhis-2/dhis-services/dhis-service-i18n/src/main/resources/i18n_global.properties	2014-07-15 10:48:00 +0000
@@ -63,6 +63,7 @@
 dhis-web-dashboard=Data Analyser
 dhis-web-integration=NHRM Integration
 dhis-web-reports=NRHM Reports
+dhis-web-reports-national=NRHM Reports
 dhis-web-dataentry-national=Linelisting Data Entry
 dhis-web-validationrule-local-in=Validation Analysis
 dhis-web-survey=Survey - Target
@@ -70,6 +71,8 @@
 dhis-web-sms=SMS
 dhis-web-maintenance-in=Configuration
 dhis-web-linelisting-mp=Manpower
+dhis-web-birtreports = BIRT Reports
+dhis-web-excelimport = Data Integration
 
 #-- Intro modules -------------------------------------------------------------#
 

=== modified file 'dhis-2/dhis-web/dhis-web-dataentry/src/main/resources/META-INF/dhis/beans.xml'
--- dhis-2/dhis-web/dhis-web-dataentry/src/main/resources/META-INF/dhis/beans.xml	2014-03-04 00:59:32 +0000
+++ dhis-2/dhis-web/dhis-web-dataentry/src/main/resources/META-INF/dhis/beans.xml	2015-01-12 06:14:11 +0000
@@ -69,4 +69,16 @@
     <property name="dataValueService" ref="org.hisp.dhis.datavalue.DataValueService" />
   </bean>
 
+  <!-- Get Closing balance -->  	
+  <bean id="org.hisp.dhis.de.action.GetClosingBalancAction" class="org.hisp.dhis.de.action.GetClosingBalancAction" scope="prototype">
+    <property name="currentUserService" ref="org.hisp.dhis.user.CurrentUserService" />
+    <property name="dataElementService" ref="org.hisp.dhis.dataelement.DataElementService" />
+    <property name="dataValueService" ref="org.hisp.dhis.datavalue.DataValueService" />
+    <property name="categoryService" ref="org.hisp.dhis.dataelement.DataElementCategoryService" />
+    <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
+    <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
+    <property name="dataElementCategoryService" ref="org.hisp.dhis.dataelement.DataElementCategoryService" />
+    <property name="dataSetService" ref="org.hisp.dhis.dataset.DataSetService" />
+  </bean>
+
 </beans>

=== modified file 'dhis-2/dhis-web/dhis-web-dataentry/src/main/resources/struts.xml'
--- dhis-2/dhis-web/dhis-web-dataentry/src/main/resources/struts.xml	2014-02-11 15:34:53 +0000
+++ dhis-2/dhis-web/dhis-web-dataentry/src/main/resources/struts.xml	2015-01-12 06:12:47 +0000
@@ -69,5 +69,26 @@
       <result name="input" type="velocity">/dhis-web-dataentry/validationResult.vm</result>
     </action>
 
+	<!--  For IPPF -->
+
+    <action name="registerCompleteDataSet" class="org.hisp.dhis.commons.action.NoAction">
+      <param name="requiredAuthorities">F_COMPLETE_REGISTER</param>
+    </action>
+
+
+    <action name="undoCompleteDataSet" class="org.hisp.dhis.commons.action.NoAction">
+      <param name="requiredAuthorities">F_UNDO_REGISTER</param>
+    </action>
+
+
+	<!-- Get Closing balance --> 
+    <action name="getClosingBal" class="org.hisp.dhis.de.action.GetClosingBalancAction">
+      <result name="success" type="velocity-json">/dhis-web-dataentry/status.vm</result>
+      <param name="onExceptionReturn">plainTextError</param>
+      <param name="requiredAuthorities">F_DATAVALUE_ADD,F_DATAVALUE_UPDATE,F_DATAVALUE_DELETE</param>
+    </action>
+
+
+
   </package>
 </struts>

=== modified file 'dhis-2/dhis-web/dhis-web-portal/india-pom.xml'
--- dhis-2/dhis-web/dhis-web-portal/india-pom.xml	2014-06-02 09:44:51 +0000
+++ dhis-2/dhis-web/dhis-web-portal/india-pom.xml	2014-07-15 10:46:21 +0000
@@ -24,10 +24,14 @@
       <artifactId>servlet-api</artifactId>
     </dependency>
 
-    <!-- DHIS -->
+   <!-- DHIS -->
 
     <dependency>
       <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-api</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
       <artifactId>dhis-web-commons</artifactId>
     </dependency>
     <dependency>
@@ -35,6 +39,10 @@
       <artifactId>dhis-web-commons-resources</artifactId>
       <type>war</type>
     </dependency>
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-service-core</artifactId>
+    </dependency>
 
     <!-- Web-API modules -->
 
@@ -176,10 +184,35 @@
       <version>${project.version}</version>
       <type>war</type>
     </dependency>
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-event-capture</artifactId>
+      <version>${project.version}</version>
+      <type>war</type>
+    </dependency>
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-event-reports</artifactId>
+      <version>${project.version}</version>
+      <type>war</type>
+    </dependency>
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-tracker-capture</artifactId>
+      <version>${project.version}</version>
+      <type>war</type>
+    </dependency>
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-maintenance-appmanager</artifactId>
+      <version>${project.version}</version>
+      <type>war</type>
+    </dependency>
     
 	
-	<!-- India modules -->    
-<!--	<dependency>
+	<!-- India modules -->   
+	 
+	<!--	<dependency>
       <groupId>org.hisp.dhis</groupId>
       <artifactId>dhis-web-maintenance-ccem</artifactId>
       <version>${project.version}</version>
@@ -192,12 +225,66 @@
       <type>war</type>
     </dependency>
 -->
-       <dependency>
-            <groupId>org.hisp.dhis</groupId>
-            <artifactId>dhis-web-birtreports</artifactId>
-            <version>${project.version}</version>
-            <type>war</type>
-        </dependency>   
+   
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-dashboard</artifactId>
+      <version>${project.version}</version>
+      <type>war</type>
+    </dependency>
+	
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-reports-national</artifactId>
+      <version>${project.version}</version>
+      <type>war</type>
+    </dependency>
+	
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-excelimport</artifactId>
+      <version>${project.version}</version>
+      <type>war</type>
+    </dependency>	
+	
+	
+	<!-- 
+	<dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-dataentry-national</artifactId>
+      <version>${project.version}</version>
+      <type>war</type>
+    </dependency> 
+	
+
+
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-maintenance-in</artifactId>
+      <version>${project.version}</version>
+      <type>war</type>
+    </dependency>
+	
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-survey</artifactId>
+      <version>${project.version}</version>
+      <type>war</type>
+    </dependency>
+	
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-alert</artifactId>
+      <version>${project.version}</version>
+      <type>war</type>
+    </dependency>	
+    -->
+    <dependency>
+         <groupId>org.hisp.dhis</groupId>
+         <artifactId>dhis-web-birtreports</artifactId>
+         <version>${project.version}</version>
+         <type>war</type>
+     </dependency>   
 	
   </dependencies>
   

=== modified file 'dhis-2/dhis-web/dhis-web-reporting/src/main/resources/META-INF/dhis/beans.xml'
--- dhis-2/dhis-web/dhis-web-reporting/src/main/resources/META-INF/dhis/beans.xml	2014-08-27 18:05:00 +0000
+++ dhis-2/dhis-web/dhis-web-reporting/src/main/resources/META-INF/dhis/beans.xml	2015-02-17 08:11:27 +0000
@@ -180,4 +180,12 @@
     <property name="serviceProvider" ref="exportServiceProvider" />
   </bean>
 
+	<!--  for download dataSet Report as dataEntry Screen to excel -->
+	<bean id="org.hisp.dhis.reporting.exp.excel.ExportToExcelAction"
+		class="org.hisp.dhis.reporting.exp.excel.ExportToExcelAction" scope="prototype">
+	</bean>
+
+
+
+
 </beans>

=== modified file 'dhis-2/dhis-web/dhis-web-reporting/src/main/resources/org/hisp/dhis/reporting/i18n_module.properties'
--- dhis-2/dhis-web/dhis-web-reporting/src/main/resources/org/hisp/dhis/reporting/i18n_module.properties	2014-05-26 10:56:26 +0000
+++ dhis-2/dhis-web/dhis-web-reporting/src/main/resources/org/hisp/dhis/reporting/i18n_module.properties	2015-02-17 09:33:33 +0000
@@ -267,4 +267,5 @@
 confirm_unaccept=Are you sure you want to unaccept this data set approval?
 approval_entity=Approval entity
 approval_status=Approval status
-please_make_selection=Please make a selection below
\ No newline at end of file
+please_make_selection=Please make a selection below
+get_report_as_workbook = Download as Excel

=== modified file 'dhis-2/dhis-web/dhis-web-reporting/src/main/resources/struts.xml'
--- dhis-2/dhis-web/dhis-web-reporting/src/main/resources/struts.xml	2014-04-11 11:43:13 +0000
+++ dhis-2/dhis-web/dhis-web-reporting/src/main/resources/struts.xml	2015-02-17 08:48:44 +0000
@@ -316,6 +316,21 @@
       </result>
       <param name="requiredAuthorities">F_MYDATAMART_VIEW</param>
     </action>
+	
+	<!--  For IPPF Resource Add UPDATE and DELETE-->
+    <action name="addResource" class="org.hisp.dhis.commons.action.NoAction">
+      <param name="requiredAuthorities">F_RESOURCE_ADD</param>
+    </action>
+
+	<!--  for download dataSet Report as dataEntry Screen to excel -->
+    <action name="exportToExcel" class="org.hisp.dhis.reporting.exp.excel.ExportToExcelAction">
+      <result name="success" type="stream">
+      	<param name="contentType">application/vnd.ms-excel</param>
+      	<param name="inputName">inputStream</param>
+      	<param name="contentDisposition">filename="${fileName}"</param>
+      	<param name="bufferSize">10240</param>
+      </result>
+    </action>
 
   </package>
 </struts>

=== modified file 'dhis-2/dhis-web/dhis-web-reporting/src/main/webapp/dhis-web-reporting/dataSetReportForm.vm'
--- dhis-2/dhis-web/dhis-web-reporting/src/main/webapp/dhis-web-reporting/dataSetReportForm.vm	2014-04-03 18:20:05 +0000
+++ dhis-2/dhis-web/dhis-web-reporting/src/main/webapp/dhis-web-reporting/dataSetReportForm.vm	2015-02-17 09:02:26 +0000
@@ -79,8 +79,10 @@
 
 <div id="control">
 <input type="button" value='$i18n.getString( "data" )' style="width:140px" onclick="dhis2.dsr.showCriteria()">
+<!--
 <input type="button" class="downloadButton" value="$i18n.getString( 'get_report_as_xls' )" onclick="dhis2.dsr.exportDataSetReport( 'xls' )" style="width:140px; display:none;">
 <input type="button" class="downloadButton" value="$i18n.getString( 'get_report_as_pdf' )" onclick="dhis2.dsr.exportDataSetReport( 'pdf' )" style="width:140px; display:none;">
+-->
 <input type="button" class="downloadButton" value="$i18n.getString( 'print' )" onclick="window.print()" style="width:140px; display:none;">
 </div>
 

=== modified file 'dhis-2/dhis-web/dhis-web-reporting/src/main/webapp/dhis-web-reporting/renderCustomDataSetReportForm.vm'
--- dhis-2/dhis-web/dhis-web-reporting/src/main/webapp/dhis-web-reporting/renderCustomDataSetReportForm.vm	2012-09-03 19:48:33 +0000
+++ dhis-2/dhis-web/dhis-web-reporting/src/main/webapp/dhis-web-reporting/renderCustomDataSetReportForm.vm	2015-02-17 09:07:20 +0000
@@ -1,7 +1,37 @@
 
-#parse( "dhis-web-reporting/renderDataSetReportHeader.vm" )
-
-#set( $css = "cde cde-$!{selectedDataSet.dataEntryForm.style}" )
-<div class="${css}">
-	$customDataEntryFormCode
-</div>
+<script type="text/javascript">
+
+	function exportCustumDataSetReportToWorkBook()
+	{			    
+	    document.getElementById('htmlCode').value = document.getElementById('formResult').innerHTML;			    			
+	    return true;
+	}
+</script>
+
+<form id="form" name="form" action="exportToExcel.action" method="post" onsubmit="exportCustumDataSetReportToWorkBook()" target="_newtab">
+	<input type="hidden" name="htmlCode" id="htmlCode" />
+	<input type="hidden" name="reportName" id="reportName" value="$encoder.htmlEncode( $selectedOrgunit.name )-$format.formatPeriod( $selectedPeriod )"/>
+	<div id="export">
+		<table> 
+			<tr>
+				<td colspan="2" style="height:5px"></td>
+			</tr>
+			<tr>
+				<td>
+					<input type="submit" value="$i18n.getString( 'get_report_as_workbook' )" style="width:140px;>
+				</td>	
+			</tr>
+		</table>
+	</div>           
+
+	#parse( "dhis-web-reporting/renderDataSetReportHeader.vm" )
+
+	<div id="formResult">
+		#set( $css = "cde cde-$!{selectedDataSet.dataEntryForm.style}" )
+		<div class="${css}">
+			<h3>$encoder.htmlEncode( $selectedOrgunit.name ) - $format.formatPeriod( $selectedPeriod )</h3>
+				$customDataEntryFormCode
+		</div>
+
+	</div>
+</form>

=== modified file 'dhis-2/dhis-web/dhis-web-reporting/src/main/webapp/dhis-web-reporting/viewDocumentForm.vm'
--- dhis-2/dhis-web/dhis-web-reporting/src/main/webapp/dhis-web-reporting/viewDocumentForm.vm	2013-12-06 13:03:52 +0000
+++ dhis-2/dhis-web/dhis-web-reporting/src/main/webapp/dhis-web-reporting/viewDocumentForm.vm	2015-02-17 07:21:16 +0000
@@ -21,9 +21,13 @@
 <div id="contextMenu" class="contextMenu">
   <ul id="contextMenuItems" class="contextMenuItems">
     <li><a data-target-fn="runDocument"><i class="fa fa-play"></i>&nbsp;&nbsp;$i18n.getString( "view_resource" )</a></li>
-    <li data-enabled="canManage"><a data-target-fn="showSharingDialogWithContext"><i class="fa fa-share"></i>&nbsp;&nbsp;$i18n.getString( "sharing_settings" )</a></li>
-    <li data-enabled="canUpdate"><a data-target-fn="displayAddDocumentForm"><i class="fa fa-edit"></i>&nbsp;&nbsp;$i18n.getString( "edit" )</a></li>
-    <li data-enabled="canDelete"><a data-target-fn="removeDocument"><i class="fa fa-trash-o"></i>&nbsp;&nbsp;$i18n.getString( "remove" )</a></li>
+	
+	#if( $auth.hasAccess( "dhis-web-reporting", "addResource") )
+		<li data-enabled="canManage"><a data-target-fn="showSharingDialogWithContext"><i class="fa fa-share"></i>&nbsp;&nbsp;$i18n.getString( "sharing_settings" )</a></li>
+		<li data-enabled="canUpdate"><a data-target-fn="displayAddDocumentForm"><i class="fa fa-edit"></i>&nbsp;&nbsp;$i18n.getString( "edit" )</a></li>
+		<li data-enabled="canDelete"><a data-target-fn="removeDocument"><i class="fa fa-trash-o"></i>&nbsp;&nbsp;$i18n.getString( "remove" )</a></li>
+	#end
+
   </ul>
 </div>
 
@@ -33,11 +37,13 @@
       <table width="100%">
 				<tr>
 					<td>#filterDiv( "displayViewDocumentForm" )</td>
-            <td style="text-align:right">
-              <input type="button" value="$i18n.getString( "add_new" )" onclick="window.location.href='displayAddDocumentForm.action'">
-            </td>
-        </tr>
-			</table>
+					<td style="text-align:right">
+						#if( $auth.hasAccess( "dhis-web-reporting", "addResource") )
+							<input type="button" value="$i18n.getString( "add_new" )" onclick="window.location.href='displayAddDocumentForm.action'">
+						#end		
+            		</td>
+        		</tr>
+		</table>
 
       <table class="listTable" id="listTable">
       <col>

=== modified file 'local/in/dhis-in-api/src/main/java/org/hisp/dhis/coldchain/reports/CCEMReportManager.java'
--- local/in/dhis-in-api/src/main/java/org/hisp/dhis/coldchain/reports/CCEMReportManager.java	2014-01-09 12:43:23 +0000
+++ local/in/dhis-in-api/src/main/java/org/hisp/dhis/coldchain/reports/CCEMReportManager.java	2013-11-18 05:39:24 +0000
@@ -43,8 +43,6 @@
     
     String getMinMaxAvgValues(String orgunitid, String periodid , Integer dataElementid, Integer optionCombo);
     
-    String getMinMaxAvgValuesForLiveBirths( String orgunitid, String periodid, Integer dataElementid, Integer optionCombo, Double liveBirthsPerThousand );
-    
     Integer getGrandTotalValue(String orgunitid, String periodid , Integer dataElementid);
     
     Map<String,Integer> getCatalogDatavalueId( String orgUnitIdsByComma, Integer inventoryTypeId, Integer catalogTypeAttributeId );

=== modified file 'local/in/dhis-in-api/src/main/java/org/hisp/dhis/config/Configuration_IN.java'
--- local/in/dhis-in-api/src/main/java/org/hisp/dhis/config/Configuration_IN.java	2012-05-30 10:46:26 +0000
+++ local/in/dhis-in-api/src/main/java/org/hisp/dhis/config/Configuration_IN.java	2013-09-19 06:34:31 +0000
@@ -39,7 +39,7 @@
     public static final String DEFAULT_REPORTFOLDER = "ra_national";
     
     public static final String DEFAULT_TEMPFOLDER = "temp";
-    
+
     private int id;
     
     private String key;

=== modified file 'local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportModel.java'
--- local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportModel.java	2010-12-29 07:57:25 +0000
+++ local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportModel.java	2013-09-19 06:34:31 +0000
@@ -55,7 +55,8 @@
     
     public final static String RM_PROGRESSIVE_PERIOD = "PROGRESSIVE-PERIOD";
     
-        
+    public final static String RM_PROGRESSIVE_BATCH = "PROGRESSIVE-BATCH";
+    
     public static List<String> getReportModels()
     {
         List<String> reportModels = new ArrayList<String>();
@@ -81,6 +82,8 @@
         reportModels.add( RM_PROGRESSIVE_ORGUNIT );
         
         reportModels.add( RM_PROGRESSIVE_PERIOD );
+        
+        reportModels.add( RM_PROGRESSIVE_BATCH );
 
         return reportModels;            
     }

=== modified file 'local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportOrgSpecificDataService.java'
--- local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportOrgSpecificDataService.java	2013-09-25 09:45:36 +0000
+++ local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportOrgSpecificDataService.java	2013-09-19 06:34:31 +0000
@@ -1,16 +1,17 @@
 package org.hisp.dhis.reports;
 
+import org.hisp.dhis.organisationunit.OrganisationUnit;
+import org.hisp.dhis.period.PeriodType;
+
+import java.io.File;
 import java.util.Date;
 import java.util.Map;
 
-import org.hisp.dhis.organisationunit.OrganisationUnit;
-import org.hisp.dhis.period.PeriodType;
-
 /**
  * <gaurav>,Date: 7/10/12, Time: 5:24 PM
  */
-public interface ReportOrgSpecificDataService 
-{
+public interface ReportOrgSpecificDataService {
+
     public Map<String, String> getOrgSpecificData(OrganisationUnit District, Date sDate, Date eDate, Date aggSDate, PeriodType periodType, String XmlFileName);
 
 }

=== modified file 'local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportService.java'
--- local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportService.java	2012-07-26 09:20:56 +0000
+++ local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportService.java	2014-07-03 12:12:00 +0000
@@ -34,10 +34,14 @@
 import java.util.Map;
 
 import org.hisp.dhis.dataelement.DataElement;
+import org.hisp.dhis.dataelement.DataElementCategoryOptionCombo;
+import org.hisp.dhis.dataset.DataSet;
+import org.hisp.dhis.datavalue.DataValue;
 import org.hisp.dhis.indicator.Indicator;
 import org.hisp.dhis.organisationunit.OrganisationUnit;
 import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodType;
+import org.hisp.dhis.program.Program;
 
 public interface ReportService
 {
@@ -68,7 +72,18 @@
     Collection<Report_in> getReportsByPeriodAndReportType( PeriodType periodType, String reportType );
 
     Collection<Report_in> getReportsByPeriodSourceAndReportType( PeriodType periodType, OrganisationUnit source, String reportType );
+	
+    // get Patients List ByOrgUnit
+    
+    //Collection<Patient> getPatientByOrgUnit( OrganisationUnit organisationUnit );
+    
+    // get Programs List ByOrgUnit
+    Collection<Program> getProgramsByOrgUnit( OrganisationUnit organisationUnit );
 
+    // get Patients List By OrgUnit and Program
+    
+    //Collection<Patient> getPatientByOrgUnitAndProgram( OrganisationUnit organisationUnit, Program program );
+	
     // -------------------------------------------------------------------------
     // Report_in Design
     // -------------------------------------------------------------------------
@@ -105,6 +120,15 @@
     
     List<Report_inDesign> getReportDesign( String fileName );
     
+    
+    List<Report_inDesign> getReportDesignForGlobalSetting( String fileName );
+    
+    List<Report_inDesign> getReportDesignForTracker( String fileName );
+    
+    List<Report_inDesign> getReportDesignForHeader( String fileName );
+    
+    
+
     List<Report_inDesign> getDistrictFeedbackReportDesign( String fileName );
     
     String getResultDataValue( String formula, Date startDate, Date endDate, OrganisationUnit organisationUnit , String reportModelTB );
@@ -155,6 +179,12 @@
 
     Map<String, String> getAggDataFromDataValueTableByDeAndPeriodwise( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma );
     
+    Map<String, String> getAggDataFromDataValueTableByDeAndOrgUnitwise( String orgUnitIdsByComma, String dataElmentIdsByComma, String startDate, String endDate );
+    
+    Map<String, String> getAggDataFromDataValueTableByDeAndOrgUnitwise( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma );
+    
+    Map<String, String> getCapturedDataFromDataValueTableByDeAndOrgUnitwise( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma );
+    
     Map<String, String> getDataFromDataValueTable( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma );
     
     Map<String, String> getDataFromDataValueTableByPeriodAgg( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma );
@@ -181,4 +211,32 @@
     String getDataelementIdsByStype( List<Report_inDesign> reportDesignList, String sType );
     
     Map<String, String> getAggNonNumberDataFromDataValueTable( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma );
+    
+    //
+    String getResultDataValueForOrgUnitGroupMember( String formula, String childOrgUnitsByComma ,Date startDate, Date endDate ,String reportModelTB );
+    
+    Integer getDataCountFromDataValueTable( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma );
+    
+    Map<String, String> getBatchDataFromDataValueTable( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma );
+    
+    List<Report_inDesign> getHeaderInfo( String fileName );
+    
+    String getTextDataFromDataValueTable( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma );
+	
+    Map<String, String> getResultDataFromDataValueTable( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma );
+    
+    // Get Data value for Latest Period
+    
+    DataValue getLatestDataValue( DataElement dataElement, DataElementCategoryOptionCombo optionCombo, OrganisationUnit organisationUnit );
+    
+    // Methods for Lock Exception
+    void deleteLockException( String orgUnitIdsByComma, String periodIdsByComma, String dataSetIdsByComma );
+    void createBatchLockExceptions( String insertQuery );
+    Boolean getLockException( Integer organisationUnitId, Integer periodId, Integer dataSetId );
+    void deleteLockException( DataSet dataSet, Period period, OrganisationUnit organisationUnit );
+    
+    
+    // methods for getting Data from data value for GOI Monthly Report
+    Map<String, String> getDataFromDataValueTableForGoiMonthly( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma );
+    
 }

=== modified file 'local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportStore.java'
--- local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportStore.java	2012-04-16 11:29:53 +0000
+++ local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportStore.java	2014-07-03 12:12:18 +0000
@@ -29,37 +29,55 @@
 
 import java.util.Collection;
 
+import org.hisp.dhis.dataelement.DataElement;
+import org.hisp.dhis.dataelement.DataElementCategoryOptionCombo;
+import org.hisp.dhis.dataset.DataSet;
+import org.hisp.dhis.datavalue.DataValue;
 import org.hisp.dhis.organisationunit.OrganisationUnit;
+import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodType;
 
-public interface ReportStore
+public interface ReportStore 
 {
-    String ID = ReportStore.class.getName();
-
+        String ID = ReportStore.class.getName();
+        
     // -------------------------------------------------------------------------
     // Report_in
     // -------------------------------------------------------------------------
 
-    int addReport( Report_in report );
-
-    void updateReport( Report_in report );
-
-    void deleteReport( Report_in report );
-
-    Report_in getReport( int id );
-
-    Report_in getReportByName( String name );
-
-    Collection<Report_in> getReportBySource( OrganisationUnit source );
-
-    Collection<Report_in> getAllReports();
-
-    Collection<Report_in> getReportsByReportType( String reportType );
-
-    Collection<Report_in> getReportsByPeriodType( PeriodType periodType );
-
-    Collection<Report_in> getReportsByPeriodAndReportType( PeriodType periodType, String reportType );
-
-    Collection<Report_in> getReportsByPeriodSourceAndReportType( PeriodType periodType, OrganisationUnit source,
-        String reportType );
+        int addReport( Report_in report );
+        
+        void updateReport( Report_in report );
+        
+        void deleteReport( Report_in report );
+        
+        Report_in getReport( int id );
+        
+        Report_in getReportByName( String name );
+        
+        Collection<Report_in> getReportBySource( OrganisationUnit source );
+        
+        Collection<Report_in> getAllReports();
+        
+        Collection<Report_in> getReportsByReportType( String reportType );
+        
+        Collection<Report_in> getReportsByPeriodType( PeriodType periodType );
+        
+        Collection<Report_in> getReportsByPeriodAndReportType( PeriodType periodType, String reportType );
+
+        Collection<Report_in> getReportsByPeriodSourceAndReportType( PeriodType periodType, OrganisationUnit source, String reportType );
+		
+	// getPatientByOrgUnit
+	//Collection<Patient> getPatientByOrgUnit( OrganisationUnit organisationUnit );
+    
+	// get Patients List By OrgUnit and Program
+	//Collection<Patient> getPatientByOrgUnitAndProgram( OrganisationUnit organisationUnit, Program program );
+
+	// Get Data value for Latest Period
+	    
+	DataValue getLatestDataValue( DataElement dataElement, DataElementCategoryOptionCombo optionCombo, OrganisationUnit organisationUnit );
+	
+	// Methods for delete Lock Exception
+	void deleteLockException( DataSet dataSet, Period period, OrganisationUnit organisationUnit );
+
 }

=== modified file 'local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportType.java'
--- local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportType.java	2012-07-24 12:38:31 +0000
+++ local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/ReportType.java	2014-07-08 08:41:16 +0000
@@ -67,6 +67,12 @@
     public final static String RT_RANKING_REPORT = "Ranking Reports";
 
     public final static String RT_FEEDBACK_TEMPLATE = "Feedback Template";
+    
+    public final static String RT_PROGRAMWISE_ORGUNITPROGRESS_REPORT = "Programwise OrgUnitProgress Reports";
+    
+    public final static String RT_PERIOD_ORGUNIT_SERVICE_PROGRESS_REPORT = "Period OrgUnit Progress Reports";
+    
+    public final static String RT_BIRT = "Birt Report";
 
     public static List<String> getReportTypes()
     {
@@ -108,6 +114,12 @@
 
         reportTypes.add(RT_FEEDBACK_TEMPLATE);
         
+        reportTypes.add(RT_PROGRAMWISE_ORGUNITPROGRESS_REPORT);
+        
+        reportTypes.add(RT_PERIOD_ORGUNIT_SERVICE_PROGRESS_REPORT);
+        
+        reportTypes.add(RT_BIRT);
+        
         return reportTypes;
     }
 }

=== modified file 'local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/Report_inDesign.java'
--- local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/Report_inDesign.java	2012-07-24 12:38:31 +0000
+++ local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/Report_inDesign.java	2013-09-19 06:34:31 +0000
@@ -211,5 +211,4 @@
     public static final String E_PERIOD_MONTH = "PERIOD-MONTH";
     public static final String E_PERIOD_YEAR = "PERIOD-YEAR";
     
-    
 }
\ No newline at end of file

=== modified file 'local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/StateDistrictFeedbackReportService.java'
--- local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/StateDistrictFeedbackReportService.java	2013-09-25 09:45:36 +0000
+++ local/in/dhis-in-api/src/main/java/org/hisp/dhis/reports/StateDistrictFeedbackReportService.java	2013-09-19 06:34:31 +0000
@@ -1,18 +1,18 @@
 package org.hisp.dhis.reports;
 
+import org.hisp.dhis.organisationunit.OrganisationUnit;
+
+import java.io.File;
 import java.util.Date;
 import java.util.Map;
 
-import org.hisp.dhis.organisationunit.OrganisationUnit;
-
 /**
  * <gaurav>,Date: 7/4/12, Time: 12:44 PM
  */
-public interface StateDistrictFeedbackReportService
-{
+public interface StateDistrictFeedbackReportService {
+
     String ID = StateDistrictFeedbackReportService.class.getName();
 
-    public Map<String, String> getDistrictFeedbackData( OrganisationUnit District, Date sDate, Date eDate,
-        String XmlFileName );
+    public Map<String, String> getDistrictFeedbackData(OrganisationUnit District, Date sDate, Date eDate, String XmlFileName);
 
 }

=== modified file 'local/in/dhis-in-api/src/main/java/org/hisp/dhis/surveydatavalue/SurveyDataValue.java'
--- local/in/dhis-in-api/src/main/java/org/hisp/dhis/surveydatavalue/SurveyDataValue.java	2013-09-25 09:45:36 +0000
+++ local/in/dhis-in-api/src/main/java/org/hisp/dhis/surveydatavalue/SurveyDataValue.java	2013-09-19 06:34:31 +0000
@@ -41,12 +41,6 @@
 public class SurveyDataValue implements Serializable
 {
     /**
-     * Determines if a de-serialized file is compatible with this class.
-     */
-    private static final long serialVersionUID = -6551567526188061690L;
-    
-    
-    /**
      * Part of the SurveyDataValue's composite ID
      */
     private Survey survey;

=== modified file 'local/in/dhis-in-services/dhis-in-service-coldchain/pom.xml'
--- local/in/dhis-in-services/dhis-in-service-coldchain/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-in-services/dhis-in-service-coldchain/pom.xml	2014-07-03 10:15:59 +0000
@@ -6,7 +6,7 @@
 	<parent>
 		<groupId>org.hisp.dhis</groupId>
 		<artifactId>dhis-in-services</artifactId>
-		<version>2.15-SNAPSHOT</version>
+		<version>2.15</version>
 	</parent>
   
   <artifactId>dhis-in-service-coldchain</artifactId>

=== modified file 'local/in/dhis-in-services/dhis-in-service-configuration/src/main/resources/org/hisp/dhis/config/hibernate/ConfigIn.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-configuration/src/main/resources/org/hisp/dhis/config/hibernate/ConfigIn.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-configuration/src/main/resources/org/hisp/dhis/config/hibernate/ConfigIn.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   <class name="org.hisp.dhis.config.Configuration_IN" table="config_in">

=== modified file 'local/in/dhis-in-services/dhis-in-service-dataentrystatus/pom.xml'
--- local/in/dhis-in-services/dhis-in-service-dataentrystatus/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-in-services/dhis-in-service-dataentrystatus/pom.xml	2014-07-03 10:16:45 +0000
@@ -5,7 +5,7 @@
 	<parent>
 		<groupId>org.hisp.dhis</groupId>
 		<artifactId>dhis-in-services</artifactId>
-		<version>2.15-SNAPSHOT</version>
+		<version>2.15</version>
 	</parent>
   
   <artifactId>dhis-in-service-dataentrystatus</artifactId>

=== modified file 'local/in/dhis-in-services/dhis-in-service-dataentrystatus/src/main/resources/org/hisp/dhis/dataentrystatus/hibernate/DataEntryStatus.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-dataentrystatus/src/main/resources/org/hisp/dhis/dataentrystatus/hibernate/DataEntryStatus.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-dataentrystatus/src/main/resources/org/hisp/dhis/dataentrystatus/hibernate/DataEntryStatus.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   <class name="org.hisp.dhis.dataentrystatus.DataEntryStatus" table="dataentrystatus">

=== modified file 'local/in/dhis-in-services/dhis-in-service-dbmanager/pom.xml'
--- local/in/dhis-in-services/dhis-in-service-dbmanager/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-in-services/dhis-in-service-dbmanager/pom.xml	2014-07-03 12:29:55 +0000
@@ -6,7 +6,7 @@
 	<parent>
 		<groupId>org.hisp.dhis</groupId>
 		<artifactId>dhis-in-services</artifactId>
-		<version>2.15-SNAPSHOT</version>
+		<version>2.15</version>
 	</parent>
 	
 	<artifactId>dhis-in-service-dbmanager</artifactId>
@@ -56,10 +56,12 @@
 		<artifactId>mysql-connector-java</artifactId>
 		</dependency>
 		-->
+		<!--
 		<dependency>
 			<groupId>jep</groupId>
 			<artifactId>jep</artifactId>
 		</dependency>
+		-->
 		<dependency>
 			<groupId>commons-collections</groupId>
 			<artifactId>commons-collections</artifactId>

=== modified file 'local/in/dhis-in-services/dhis-in-service-ihrissyncmanager/pom.xml'
--- local/in/dhis-in-services/dhis-in-service-ihrissyncmanager/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-in-services/dhis-in-service-ihrissyncmanager/pom.xml	2014-11-27 06:08:18 +0000
@@ -6,7 +6,7 @@
 	<parent>
 		<groupId>org.hisp.dhis</groupId>
 		<artifactId>dhis-in-services</artifactId>
-		<version>2.15-SNAPSHOT</version>
+		<version>2.15</version>
 	</parent>
   
   <artifactId>dhis-in-service-ihrissyncmanager</artifactId>

=== modified file 'local/in/dhis-in-services/dhis-in-service-linelisting/pom.xml'
--- local/in/dhis-in-services/dhis-in-service-linelisting/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-in-services/dhis-in-service-linelisting/pom.xml	2014-07-03 12:30:44 +0000
@@ -6,7 +6,7 @@
 	<parent>
 		<groupId>org.hisp.dhis</groupId>
 		<artifactId>dhis-in-services</artifactId>
-		<version>2.15-SNAPSHOT</version>
+		<version>2.15</version>
 	</parent>
 	
 	<artifactId>dhis-in-service-linelisting</artifactId>
@@ -56,10 +56,12 @@
 		<artifactId>mysql-connector-java</artifactId>
 		</dependency>
 		-->
+		<!--
 		<dependency>
 			<groupId>jep</groupId>
 			<artifactId>jep</artifactId>
 		</dependency>
+		-->
 		<dependency>
 			<groupId>commons-collections</groupId>
 			<artifactId>commons-collections</artifactId>

=== modified file 'local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/Employee.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/Employee.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/Employee.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   <class name="org.hisp.dhis.linelisting.Employee" table="employee">

=== modified file 'local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListDataElementMap.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListDataElementMap.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListDataElementMap.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   

=== modified file 'local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListElement.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListElement.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListElement.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   <class name="org.hisp.dhis.linelisting.LineListElement" table="linelistelement">

=== modified file 'local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListGroup.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListGroup.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListGroup.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   <class name="org.hisp.dhis.linelisting.LineListGroup" table="linelistgroup">

=== modified file 'local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListOption.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListOption.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListOption.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   <class name="org.hisp.dhis.linelisting.LineListOption" table="linelistoption">

=== modified file 'local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListValidationRule.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListValidationRule.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/hibernate/LineListValidationRule.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,8 +1,5 @@
-<?xml version="1.0"?>
-<!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
- 
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 <hibernate-mapping>
   <class name="org.hisp.dhis.linelisting.LineListValidationRule" table="linelistvalidationrule">
     <id column="llvalidationid" name="id">

=== modified file 'local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/linelistdataelementmapping/hibernate/LineListDataElementMapping.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/linelistdataelementmapping/hibernate/LineListDataElementMapping.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/linelistdataelementmapping/hibernate/LineListDataElementMapping.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,8 +1,5 @@
-<?xml version="1.0"?>
-<!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
- 
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 <hibernate-mapping>
   <class name="org.hisp.dhis.linelisting.linelistdataelementmapping.LineListDataElementMapping" table="lldataelementmapping">
     <id column="lldataelementmapid" name="id">

=== modified file 'local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/llaggregation/hibernate/LinelistAggregation.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/llaggregation/hibernate/LinelistAggregation.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-linelisting/src/main/resources/org/hisp/dhis/linelisting/llaggregation/hibernate/LinelistAggregation.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
-<!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+<!DOCTYPE hibernate-mapping PUBLIC 
+    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+    "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
     <class name="org.hisp.dhis.linelisting.llaggregation.LinelistAggregationMapping" table="llaggregation">

=== modified file 'local/in/dhis-in-services/dhis-in-service-reports/pom.xml'
--- local/in/dhis-in-services/dhis-in-service-reports/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-in-services/dhis-in-service-reports/pom.xml	2014-07-03 10:22:11 +0000
@@ -6,7 +6,7 @@
 	<parent>
 		<groupId>org.hisp.dhis</groupId>
 		<artifactId>dhis-in-services</artifactId>
-		<version>2.15-SNAPSHOT</version>
+		<version>2.15</version>
 	</parent>
   
   <artifactId>dhis-in-service-reports</artifactId>

=== modified file 'local/in/dhis-in-services/dhis-in-service-reports/src/main/java/org/hisp/dhis/reports/DefaultReportOrgSpecificDataService.java'
--- local/in/dhis-in-services/dhis-in-service-reports/src/main/java/org/hisp/dhis/reports/DefaultReportOrgSpecificDataService.java	2012-07-26 09:20:56 +0000
+++ local/in/dhis-in-services/dhis-in-service-reports/src/main/java/org/hisp/dhis/reports/DefaultReportOrgSpecificDataService.java	2013-09-19 06:34:31 +0000
@@ -174,6 +174,7 @@
                 expValue = Math.round( expValue );
 
             }
+
             catch ( Exception e )
             {
 
@@ -236,7 +237,8 @@
                 int colno = new Integer( deFeedElement.getAttribute( "colno" ) );
                 String expression = new String( deFeedElement.getAttribute( "expression" ) );
 
-                List<OrganisationUnit> orgUnitList = new ArrayList<OrganisationUnit>( District.getChildren() );
+                List<OrganisationUnit> orgUnitList = new ArrayList<OrganisationUnit>( organisationUnitService
+                    .getOrganisationUnitWithChildren( District.getId() ) );
 
                 if ( organisationUnitGroupService == null )
                 {
@@ -245,7 +247,8 @@
 
                 List<OrganisationUnit> orgUnitGroupList = new ArrayList<OrganisationUnit>( organisationUnitGroupService
                     .getOrganisationUnitGroup( oucode ).getMembers() );
-                orgUnitList.retainAll( orgUnitGroupList );
+
+                orgUnitGroupList.retainAll( orgUnitList );
 
                 Collection<Period> IntermediatePeriods = periodService.getPeriodsBetweenDates( sDate, eDate );
 
@@ -268,7 +271,9 @@
                     {
                         for ( Period period : IntermediatePeriods )
                         {
+
                             PeriodIDsByComma = PeriodIDsByComma.concat( "," + period.getId() );
+
                         }
                     }
 

=== modified file 'local/in/dhis-in-services/dhis-in-service-reports/src/main/java/org/hisp/dhis/reports/DefaultReportService.java'
--- local/in/dhis-in-services/dhis-in-service-reports/src/main/java/org/hisp/dhis/reports/DefaultReportService.java	2012-07-27 12:16:33 +0000
+++ local/in/dhis-in-services/dhis-in-service-reports/src/main/java/org/hisp/dhis/reports/DefaultReportService.java	2014-07-04 10:30:21 +0000
@@ -14,6 +14,7 @@
 import java.util.Iterator;
 import java.util.List;
 import java.util.Map;
+import java.util.Set;
 import java.util.regex.Matcher;
 import java.util.regex.Pattern;
 
@@ -33,6 +34,7 @@
 import org.hisp.dhis.dataset.DataSetService;
 import org.hisp.dhis.datavalue.DataValue;
 import org.hisp.dhis.datavalue.DataValueService;
+import org.hisp.dhis.expression.ExpressionService;
 import org.hisp.dhis.indicator.Indicator;
 import org.hisp.dhis.indicator.IndicatorService;
 import org.hisp.dhis.organisationunit.OrganisationUnit;
@@ -41,6 +43,8 @@
 import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
+import org.hisp.dhis.program.Program;
+import org.hisp.dhis.program.ProgramService;
 import org.hisp.dhis.survey.Survey;
 import org.hisp.dhis.survey.SurveyService;
 import org.hisp.dhis.surveydatavalue.SurveyDataValue;
@@ -102,6 +106,13 @@
         this.indicatorService = indicatorService;
     }
 
+    private ExpressionService expressionService;
+    
+    public void setExpressionService(ExpressionService expressionService) 
+    {
+		this.expressionService = expressionService;
+    }
+
     private PeriodService periodService;
 
     public void setPeriodService( PeriodService periodService )
@@ -172,7 +183,15 @@
     {
         this.databaseInfoProvider = databaseInfoProvider;
     }
-
+    
+    private ProgramService programService;
+    
+    public void setProgramService( ProgramService programService )
+    {
+        this.programService = programService;
+        
+    }
+    
     // -------------------------------------------------------------------------
     // Report_in
     // -------------------------------------------------------------------------
@@ -243,7 +262,28 @@
     {
         return reportStore.getReportsByPeriodSourceAndReportType( periodType, source, reportType );
     }
-
+	
+    // get Patients List ByOrgUnit
+    /*
+    @Transactional
+    public Collection<Patient> getPatientByOrgUnit( OrganisationUnit organisationUnit )
+    {
+        return reportStore.getPatientByOrgUnit( organisationUnit );
+    }
+    */
+    
+    // get Patients List By OrgUnit and Program
+    /*
+    @Transactional
+    public Collection<Patient> getPatientByOrgUnitAndProgram( OrganisationUnit organisationUnit, Program program )
+    {
+        return reportStore.getPatientByOrgUnitAndProgram( organisationUnit, program );
+    }
+    */
+    
+	
+	
+	
     // -------------------------------------------------------------------------
     // for Report Result Action input/otput
     // -------------------------------------------------------------------------
@@ -254,72 +294,33 @@
     // Support Methods Defination
     // -------------------------------------------------------------------------
 
-    public String getRAFolderName()
-    {
-        String raFolderName = "ra_national";
-
-        try
-        {
-            raFolderName = configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue();
-        }
-        catch ( Exception e )
-        {
-            System.out.println( "Exception : " + e.getMessage() );
-            return null;
-        }
-
-        return raFolderName;
-    }
-
-    public List<Integer> getLinelistingRecordNos( OrganisationUnit organisationUnit, Period period, String lltype )
-    {
-        List<Integer> recordNosList = new ArrayList<Integer>();
-
-        String query = "";
-
-        int dataElementid = 1020;
-
-        if ( lltype.equalsIgnoreCase( "lllivebirth-l4DECodes.xml" )
-            || lltype.equalsIgnoreCase( "lllivebirth-l5DECodes.xml" )
-            || lltype.equalsIgnoreCase( "lllivebirth-l6DECodes.xml" ) )
-        {
-            dataElementid = 1020;
-        }
-        else if ( lltype.equalsIgnoreCase( "lldeath-l4DECodes.xml" )
-            || lltype.equalsIgnoreCase( "lldeath-l5DECodes.xml" ) || lltype.equalsIgnoreCase( "lldeath-l6DECodes.xml" )
-            || lltype.equalsIgnoreCase( "monthly_SCWebPortalDECodes.xml" ) )
-        {
-            dataElementid = 1027;
-        }
-        else if ( lltype.equalsIgnoreCase( "llmaternaldeath-l4DECodes.xml" )
-            || lltype.equalsIgnoreCase( "llmaternaldeath-l5DECodes.xml" )
-            || lltype.equalsIgnoreCase( "llmaternaldeath-l6DECodes.xml" ) )
-        {
-            dataElementid = 1032;
-        }
-
-        try
-        {
-            query = "SELECT recordno FROM lldatavalue WHERE dataelementid = " + dataElementid + " AND periodid = "
-                + period.getId() + " AND sourceid = " + organisationUnit.getId();
-
-            SqlRowSet rs1 = jdbcTemplate.queryForRowSet( query );
-
-            while ( rs1.next() )
+	
+	// get Programs List ByOrgUnit
+    public Collection<Program> getProgramsByOrgUnit( OrganisationUnit organisationUnit )
+    {
+        //System.out.println( "In side  get Programs By OrgUnit Method " );
+        List<Program> programList = new ArrayList<Program>();
+        
+        //List<Program> allProgramList = new ArrayList<Program>( programService.getAllPrograms() );
+
+        for ( Program program : programService.getAllPrograms() )
+        {
+            if ( program.getOrganisationUnits().contains( organisationUnit ) )
             {
-                recordNosList.add( rs1.getInt( 1 ) );
+                programList.add( program );
             }
-
-            Collections.sort( recordNosList );
-        }
-        catch ( Exception e )
-        {
-            System.out.println( "SQL Exception : " + e.getMessage() );
-        }
-
-        return recordNosList;
+        }
+        //System.out.println( "Size of Program List is   : " + programList.size() );
+        return programList;
     }
-
+	
+	
+	
+	
+	
+	
+	
+	
     // ----------------------------------------------------------------------------------------------------
     // START
     // Fetch Global Decode Configuration
@@ -346,8 +347,24 @@
         try
         {
             DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
-            DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
-            Document doc = docBuilder.parse( new File( path ) );
+            DocumentBuilder docBuilder = null;
+            try
+            {
+                docBuilder = docBuilderFactory.newDocumentBuilder();
+            }
+            catch ( ParserConfigurationException e )
+            {
+                e.printStackTrace();
+            }
+            Document doc = null;
+            try
+            {
+                doc = docBuilder.parse( new File( path ) );
+            }
+            catch ( IOException e )
+            {
+                e.printStackTrace();
+            }
 
             if ( doc == null )
             {
@@ -367,25 +384,15 @@
 
                 String id = configElement.getAttribute( "commonid" ).trim();
 
-                // System.out.println("\n*INFO : DhisID: "+value+" || "+"CommonID: "+id+"\n");
-
                 globalValuesMap.put( id, value );
 
             }
 
         }
-        catch ( ParserConfigurationException e )
-        {
-            e.printStackTrace();
-        }
         catch ( SAXException e )
         {
             e.printStackTrace();
         }
-        catch ( IOException e )
-        {
-            e.printStackTrace();
-        }
 
         return globalValuesMap;
     }
@@ -403,6 +410,7 @@
 
         Pattern p = Pattern.compile( "\\[(.*?)\\]" );
         Matcher matcher = p.matcher( expression );
+
         String localValue;
 
         while ( matcher.find() )
@@ -413,6 +421,7 @@
         }
 
         result = expression;
+
         return result;
     }
 
@@ -499,6 +508,80 @@
         return reportDesignList;
     }
 
+    public String getRAFolderName()
+    {
+        String raFolderName = "ra_national";
+
+        try
+        {
+            raFolderName = configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue();
+        }
+        catch ( Exception e )
+        {
+            System.out.println( "Exception : " + e.getMessage() );
+            return null;
+        }
+
+        return raFolderName;
+    }
+
+    public List<Integer> getLinelistingRecordNos( OrganisationUnit organisationUnit, Period period, String lltype )
+    {
+        List<Integer> recordNosList = new ArrayList<Integer>();
+
+        String query = "";
+
+        int dataElementid = 1020;
+
+        if ( lltype.equalsIgnoreCase( "lllivebirth-l4DECodes.xml" )
+            || lltype.equalsIgnoreCase( "lllivebirth-l5DECodes.xml" )
+            || lltype.equalsIgnoreCase( "lllivebirth-l6DECodes.xml" ) )
+        {
+            dataElementid = 1020;
+        }
+        else if ( lltype.equalsIgnoreCase( "lldeath-l4DECodes.xml" )
+            || lltype.equalsIgnoreCase( "lldeath-l5DECodes.xml" ) || lltype.equalsIgnoreCase( "lldeath-l6DECodes.xml" )
+            || lltype.equalsIgnoreCase( "monthly_SCWebPortalDECodes.xml" ) )
+        {
+            dataElementid = 1027;
+        }
+        else if ( lltype.equalsIgnoreCase( "llmaternaldeath-l4DECodes.xml" )
+            || lltype.equalsIgnoreCase( "llmaternaldeath-l5DECodes.xml" )
+            || lltype.equalsIgnoreCase( "llmaternaldeath-l6DECodes.xml" ) )
+        {
+            dataElementid = 1032;
+        }
+        else if ( lltype.equalsIgnoreCase( "LL_FP_Status.xml" ) )
+        {
+            dataElementid = 7271;
+        }
+        else if ( lltype.equalsIgnoreCase( "LL_Yukti_Status.xml" ) )
+        {
+            dataElementid = 7280;
+        }
+                
+        try
+        {
+            query = "SELECT recordno FROM lldatavalue WHERE dataelementid = " + dataElementid + " AND periodid = "
+                + period.getId() + " AND sourceid = " + organisationUnit.getId();
+
+            SqlRowSet rs1 = jdbcTemplate.queryForRowSet( query );
+
+            while ( rs1.next() )
+            {
+                recordNosList.add( rs1.getInt( 1 ) );
+            }
+
+            Collections.sort( recordNosList );
+        }
+        catch ( Exception e )
+        {
+            System.out.println( "SQL Exception : " + e.getMessage() );
+        }
+
+        return recordNosList;
+    }
+
     public List<Report_inDesign> getReportDesign( Report_in report )
     {
         List<Report_inDesign> deCodes = new ArrayList<Report_inDesign>();
@@ -509,8 +592,6 @@
         String path = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator
             + report.getXmlTemplateName();
 
-        // String configFile = "";
-
         try
         {
             DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
@@ -524,7 +605,6 @@
 
             NodeList listOfDECodes = doc.getElementsByTagName( "de-code" );
             int totalDEcodes = listOfDECodes.getLength();
-            Map<String, String> globalValuesMap = mapGlobalValues();
 
             for ( int s = 0; s < totalDEcodes; s++ )
             {
@@ -532,14 +612,6 @@
                 NodeList textDECodeList = deCodeElement.getChildNodes();
 
                 String expression = ((Node) textDECodeList.item( 0 )).getNodeValue().trim();
-
-                // ------------------------replace global
-                // values------------------------------------------------
-
-                expression = getGlobalExpression( expression, globalValuesMap );
-
-                // ---------------------------------------------------------------------------------------------
-
                 String stype = deCodeElement.getAttribute( "stype" );
                 String ptype = deCodeElement.getAttribute( "type" );
                 int sheetno = new Integer( deCodeElement.getAttribute( "sheetno" ) );
@@ -553,13 +625,8 @@
 
                 deCodes.add( reportDesign );
 
-            }
-
-            // end of for loop with s var
-        }
-
-        // try block end
-
+            }// end of for loop with s var
+        }// try block end
         catch ( SAXParseException err )
         {
             System.out.println( "** Parsing error" + ", line " + err.getLineNumber() + ", uri " + err.getSystemId() );
@@ -581,6 +648,389 @@
      * Returns Previous Month's Period object For ex:- selected period is
      * Aug-2007 it returns the period object corresponding July-2007
      */
+    
+ 
+    public List<Report_inDesign> getReportDesignForGlobalSetting( Report_in report )
+    {
+        List<Report_inDesign> deCodes = new ArrayList<Report_inDesign>();
+
+        String raFolderName = configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER )
+            .getValue();
+
+        String path = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator
+            + report.getXmlTemplateName();
+
+        // String configFile = "";
+
+        try
+        {
+            DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
+            DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
+            Document doc = docBuilder.parse( new File( path ) );
+            if ( doc == null )
+            {
+                System.out.println( "DECodes related XML file not found" );
+                return null;
+            }
+
+            NodeList listOfDECodes = doc.getElementsByTagName( "de-code" );
+            int totalDEcodes = listOfDECodes.getLength();
+            Map<String, String> globalValuesMap = mapGlobalValues();
+
+            for ( int s = 0; s < totalDEcodes; s++ )
+            {
+                Element deCodeElement = (Element) listOfDECodes.item( s );
+                NodeList textDECodeList = deCodeElement.getChildNodes();
+
+                String expression = ((Node) textDECodeList.item( 0 )).getNodeValue().trim();
+
+                // ------------------------replace global
+                // values------------------------------------------------
+
+                expression = getGlobalExpression( expression, globalValuesMap );
+
+                // ---------------------------------------------------------------------------------------------
+
+                String stype = deCodeElement.getAttribute( "stype" );
+                String ptype = deCodeElement.getAttribute( "type" );
+                int sheetno = new Integer( deCodeElement.getAttribute( "sheetno" ) );
+                int rowno = new Integer( deCodeElement.getAttribute( "rowno" ) );
+                int colno = new Integer( deCodeElement.getAttribute( "colno" ) );
+                int rowMerge = new Integer( deCodeElement.getAttribute( "rowmerge" ) );
+                int colMerge = new Integer( deCodeElement.getAttribute( "colmerge" ) );
+
+                Report_inDesign reportDesign = new Report_inDesign( stype, ptype, sheetno, rowno, colno, rowMerge,
+                    colMerge, expression );
+
+                deCodes.add( reportDesign );
+
+            }
+
+            // end of for loop with s var
+        }
+
+        // try block end
+
+        catch ( SAXParseException err )
+        {
+            System.out.println( "** Parsing error" + ", line " + err.getLineNumber() + ", uri " + err.getSystemId() );
+            System.out.println( " " + err.getMessage() );
+        }
+        catch ( SAXException e )
+        {
+            Exception x = e.getException();
+            ((x == null) ? e : x).printStackTrace();
+        }
+        catch ( Throwable t )
+        {
+            t.printStackTrace();
+        }
+        return deCodes;
+    }// getDECodes end
+
+    
+    // -------------------------------------------------------------------------
+    // Get Aggregated Result for dataelement expression for Global Setting
+    // -------------------------------------------------------------------------
+
+    public List<Report_inDesign> getReportDesignForGlobalSetting( String fileName )
+    {
+        List<Report_inDesign> reportDesignList = new ArrayList<Report_inDesign>();
+
+        String path = System.getProperty( "user.home" ) + File.separator + "dhis" + File.separator
+            + configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue()
+            + File.separator + fileName;
+        try
+        {
+            String newpath = System.getenv( "DHIS2_HOME" );
+            if ( newpath != null )
+            {
+                path = newpath + File.separator
+                    + configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue()
+                    + File.separator + fileName;
+            }
+        }
+        catch ( NullPointerException npe )
+        {
+            System.out.println( "DHIS2_HOME not set" );
+        }
+
+        try
+        {
+            DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
+            DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
+            Document doc = docBuilder.parse( new File( path ) );
+            if ( doc == null )
+            {
+                System.out.println( "There is no DECodes related XML file in the ra folder" );
+                return null;
+            }
+
+            NodeList listOfDECodes = doc.getElementsByTagName( "de-code" );
+            int totalDEcodes = listOfDECodes.getLength();
+            Map<String, String> globalValuesMap = mapGlobalValues();
+
+            for ( int s = 0; s < totalDEcodes; s++ )
+            {
+                Element deCodeElement = (Element) listOfDECodes.item( s );
+                NodeList textDECodeList = deCodeElement.getChildNodes();
+
+                String expression = ((Node) textDECodeList.item( 0 )).getNodeValue().trim();
+
+                // ------------------------replace global
+                // values------------------------------------------------
+
+                // System.out.println(
+                // "\n*INFO :<< CHECKING CONFIG FILE SETUP(2) >>" );
+                // System.out.println( "*INFO :Global Value: " + expression );
+                expression = getGlobalExpression( expression, globalValuesMap );
+                // System.out.println( "*INFO :Local Value: " + expression );
+                // System.out.println( "*INFO :<<CHECK FINISHED>>\n" );
+
+                // ---------------------------------------------------------------------------------------------
+
+                String stype = deCodeElement.getAttribute( "stype" );
+                String ptype = deCodeElement.getAttribute( "type" );
+                int sheetno = new Integer( deCodeElement.getAttribute( "sheetno" ) );
+                int rowno = new Integer( deCodeElement.getAttribute( "rowno" ) );
+                int colno = new Integer( deCodeElement.getAttribute( "colno" ) );
+
+                Report_inDesign report_inDesign = new Report_inDesign( stype, ptype, sheetno, rowno, colno, expression );
+                reportDesignList.add( report_inDesign );
+            }// end of for loop with s var
+        }// try block end
+        catch ( SAXParseException err )
+        {
+            System.out.println( "** Parsing error" + ", line " + err.getLineNumber() + ", uri " + err.getSystemId() );
+            System.out.println( " " + err.getMessage() );
+        }
+        catch ( SAXException e )
+        {
+            Exception x = e.getException();
+            ((x == null) ? e : x).printStackTrace();
+        }
+        catch ( Throwable t )
+        {
+            t.printStackTrace();
+        }
+        return reportDesignList;
+    }    
+    
+    
+    
+    public List<Report_inDesign> getReportDesignForTracker( Report_in report )
+    {
+        List<Report_inDesign> deCodes = new ArrayList<Report_inDesign>();
+
+        String raFolderName = configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER )
+            .getValue();
+
+        String path = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator
+            + report.getXmlTemplateName();
+
+        try
+        {
+            DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
+            DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
+            Document doc = docBuilder.parse( new File( path ) );
+            if ( doc == null )
+            {
+                System.out.println( "DECodes related XML file not found" );
+                return null;
+            }
+
+            NodeList listOfDECodes = doc.getElementsByTagName( "de-code" );
+            int totalDEcodes = listOfDECodes.getLength();
+
+            for ( int s = 0; s < totalDEcodes; s++ )
+            {
+                Element deCodeElement = (Element) listOfDECodes.item( s );
+                NodeList textDECodeList = deCodeElement.getChildNodes();
+
+                String expression = ((Node) textDECodeList.item( 0 )).getNodeValue().trim();
+                String stype = deCodeElement.getAttribute( "stype" );
+                String ptype = deCodeElement.getAttribute( "type" );
+                int sheetno = new Integer( deCodeElement.getAttribute( "sheetno" ) );
+                int rowno = new Integer( deCodeElement.getAttribute( "rowno" ) );
+                int colno = new Integer( deCodeElement.getAttribute( "colno" ) );
+                int rowMerge = new Integer( deCodeElement.getAttribute( "rowmerge" ) );
+                int colMerge = new Integer( deCodeElement.getAttribute( "colmerge" ) );
+
+                Report_inDesign reportDesign = new Report_inDesign( stype, ptype, sheetno, rowno, colno, rowMerge,
+                    colMerge, expression );
+
+                deCodes.add( reportDesign );
+
+            }// end of for loop with s var
+        }// try block end
+        catch ( SAXParseException err )
+        {
+            System.out.println( "** Parsing error" + ", line " + err.getLineNumber() + ", uri " + err.getSystemId() );
+            System.out.println( " " + err.getMessage() );
+        }
+        catch ( SAXException e )
+        {
+            Exception x = e.getException();
+            ((x == null) ? e : x).printStackTrace();
+        }
+        catch ( Throwable t )
+        {
+            t.printStackTrace();
+        }
+        return deCodes;
+    }// getDECodes end
+
+    
+    // -------------------------------------------------------------------------
+    // Get Aggregated Result for dataelement/attribute/tracker expression
+    // -------------------------------------------------------------------------
+
+    public List<Report_inDesign> getReportDesignForTracker( String fileName )
+    {
+        List<Report_inDesign> reportDesignList = new ArrayList<Report_inDesign>();
+
+        String path = System.getProperty( "user.home" ) + File.separator + "dhis" + File.separator
+            + configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue()
+            + File.separator + fileName;
+        try
+        {
+            String newpath = System.getenv( "DHIS2_HOME" );
+            if ( newpath != null )
+            {
+                path = newpath + File.separator
+                    + configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue()
+                    + File.separator + fileName;
+            }
+        }
+        catch ( NullPointerException npe )
+        {
+            System.out.println( "DHIS2_HOME not set" );
+        }
+
+        try
+        {
+            DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
+            DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
+            Document doc = docBuilder.parse( new File( path ) );
+            if ( doc == null )
+            {
+                System.out.println( "There is no DECodes related XML file in the ra folder" );
+                return null;
+            }
+
+            NodeList listOfDECodes = doc.getElementsByTagName( "de-code" );
+            int totalDEcodes = listOfDECodes.getLength();
+
+            for ( int s = 0; s < totalDEcodes; s++ )
+            {
+                Element deCodeElement = (Element) listOfDECodes.item( s );
+                NodeList textDECodeList = deCodeElement.getChildNodes();
+
+                String expression = ((Node) textDECodeList.item( 0 )).getNodeValue().trim();
+                String stype = deCodeElement.getAttribute( "stype" );
+                String ptype = deCodeElement.getAttribute( "type" );
+                int sheetno = new Integer( deCodeElement.getAttribute( "sheetno" ) );
+                int rowno = new Integer( deCodeElement.getAttribute( "rowno" ) );
+                int colno = new Integer( deCodeElement.getAttribute( "colno" ) );
+
+                Report_inDesign report_inDesign = new Report_inDesign( stype, ptype, sheetno, rowno, colno, expression );
+                reportDesignList.add( report_inDesign );
+            }// end of for loop with s var
+        }// try block end
+        catch ( SAXParseException err )
+        {
+            System.out.println( "** Parsing error" + ", line " + err.getLineNumber() + ", uri " + err.getSystemId() );
+            System.out.println( " " + err.getMessage() );
+        }
+        catch ( SAXException e )
+        {
+            Exception x = e.getException();
+            ((x == null) ? e : x).printStackTrace();
+        }
+        catch ( Throwable t )
+        {
+            t.printStackTrace();
+        }
+        return reportDesignList;
+    }
+    
+    
+    
+    
+    
+    
+    public List<Report_inDesign> getReportDesignForHeader( String fileName )
+    {
+        List<Report_inDesign> deCodes = new ArrayList<Report_inDesign>();
+
+        String path = System.getProperty( "user.home" ) + File.separator + "dhis" + File.separator
+        + configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue()
+        + File.separator + fileName;
+        try
+        {
+            String newpath = System.getenv( "DHIS2_HOME" );
+            if ( newpath != null )
+            {
+                path = newpath + File.separator
+                    + configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue()
+                    + File.separator + fileName;
+            }
+        }
+        catch ( NullPointerException npe )
+        {
+            System.out.println( "DHIS2_HOME not set" );
+        }
+        
+        try
+        {
+            DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
+            DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
+            Document doc = docBuilder.parse( new File( path ) );
+            if ( doc == null )
+            {
+                System.out.println( "DECodes related XML file not found" );
+                return null;
+            }
+
+            NodeList listOfDECodes = doc.getElementsByTagName( "header-info" );
+            int totalDEcodes = listOfDECodes.getLength();
+
+            for ( int s = 0; s < totalDEcodes; s++ )
+            {
+                Element deCodeElement = (Element) listOfDECodes.item( s );
+                NodeList textDECodeList = deCodeElement.getChildNodes();
+
+                String expression = ((Node) textDECodeList.item( 0 )).getNodeValue().trim();
+                String stype = deCodeElement.getAttribute( "stype" );
+                String ptype = deCodeElement.getAttribute( "type" );
+                int sheetno = new Integer( deCodeElement.getAttribute( "sheetno" ) );
+                int rowno = new Integer( deCodeElement.getAttribute( "rowno" ) );
+                int colno = new Integer( deCodeElement.getAttribute( "colno" ) );
+
+                Report_inDesign reportDesign = new Report_inDesign( stype, ptype, sheetno, rowno, colno, expression );
+
+                deCodes.add( reportDesign );
+
+            }// end of for loop with s var
+        }// try block end
+        catch ( SAXParseException err )
+        {
+            System.out.println( "** Parsing error" + ", line " + err.getLineNumber() + ", uri " + err.getSystemId() );
+            System.out.println( " " + err.getMessage() );
+        }
+        catch ( SAXException e )
+        {
+            Exception x = e.getException();
+            ((x == null) ? e : x).printStackTrace();
+        }
+        catch ( Throwable t )
+        {
+            t.printStackTrace();
+        }
+        return deCodes;
+    }// getDECodes end
+    
+   
     public Period getPreviousPeriod( Date startDate, Date endDate )
     {
         Period period = new Period();
@@ -631,7 +1081,7 @@
             cal.set( year, Calendar.DECEMBER, 31 );
         }
         Date lastDay = new Date( cal.getTimeInMillis() );
-
+        // System.out.println( lastDay.toString() );
         Period newPeriod = new Period();
         newPeriod = periodService.getPeriod( firstDay, lastDay, periodType );
         return newPeriod;
@@ -700,6 +1150,7 @@
             tempEndDate.setTime( endDate );
         }
 
+        // System.out.print(deType+" -- ");
         calendarList.add( tempStartDate );
         calendarList.add( tempEndDate );
 
@@ -786,14 +1237,11 @@
 
         return null;
 
-    }
-
-    // getDataElementPeriodType end
+    } // getDataElementPeriodType end
 
     // -------------------------------------------------------------------------
     // Get Aggregated Result for dataelement expression
     // -------------------------------------------------------------------------
-
     public String getResultDataValue( String formula, Date startDate, Date endDate, OrganisationUnit organisationUnit,
         String reportModelTB )
     {
@@ -836,7 +1284,9 @@
                 {
                     Double aggregatedValue = aggregationService.getAggregatedDataValue( dataElement, optionCombo,
                         startDate, endDate, organisationUnit );
-
+                    // System.out.println( dataElement.getId() + " : " +
+                    // optionCombo.getId() + " : " + startDate + " : " + endDate
+                    // + " : " + organisationUnit + " : " + aggregatedValue);
                     if ( aggregatedValue == null )
                     {
                         replaceString = NULL_REPLACEMENT;
@@ -852,7 +1302,9 @@
                 {
                     deFlag1 = 1;
                     PeriodType dePeriodType = getDataElementPeriodType( dataElement );
-
+                    // List<Period> periodList = new ArrayList<Period>(
+                    // periodService.getIntersectingPeriodsByPeriodType(
+                    // dePeriodType, startDate, endDate ) );
                     List<Period> periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates(
                         dePeriodType, startDate, endDate ) );
                     Period tempPeriod = new Period();
@@ -867,8 +1319,9 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                    
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod, organisationUnit,  optionCombo );
 
                     if ( dataValue != null && dataValue.getValue() != null )
                     {
@@ -896,8 +1349,11 @@
                 double d = 0.0;
                 try
                 {
+
                     d = MathUtils.calculateExpression( buffer.toString() );
-                    d = Math.round(d);
+
+                    d = Math.round( d );
+
                 }
                 catch ( Exception e )
                 {
@@ -1001,6 +1457,9 @@
                 {
 
                     PeriodType dePeriodType = getDataElementPeriodType( dataElement );
+                    // List<Period> periodList = new ArrayList<Period>(
+                    // periodService.getIntersectingPeriodsByPeriodType(
+                    // dePeriodType, startDate, endDate ) );
                     List<Period> periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates(
                         dePeriodType, startDate, endDate ) );
 
@@ -1015,10 +1474,10 @@
                         double aggregatedValue = 0.0;
                         for ( Period tempPeriod : periodList )
                         {
-                            DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement,
-                                tempPeriod, optionCombo );
+                            //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                            DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod, organisationUnit,  optionCombo );
 
-                            if ( dataValue != null )
+                            if ( dataValue != null && dataValue.getValue() != null )
                             {
                                 aggregatedValue += Double.parseDouble( dataValue.getValue() );
 
@@ -1032,7 +1491,9 @@
                 {
                     deFlag1 = 1;
                     PeriodType dePeriodType = getDataElementPeriodType( dataElement );
-
+                    // List<Period> periodList = new ArrayList<Period>(
+                    // periodService.getIntersectingPeriodsByPeriodType(
+                    // dePeriodType, startDate, endDate ) );
                     List<Period> periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates(
                         dePeriodType, startDate, endDate ) );
                     Period tempPeriod = new Period();
@@ -1047,8 +1508,8 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod, organisationUnit,  optionCombo );
 
                     if ( dataValue != null )
                     {
@@ -1077,8 +1538,11 @@
                 double d = 0.0;
                 try
                 {
+
                     d = MathUtils.calculateExpression( buffer.toString() );
-                    d = Math.round(d);
+
+                    d = Math.round( d );
+
                 }
                 catch ( Exception e )
                 {
@@ -1094,6 +1558,7 @@
                 }
                 else
                 {
+
                     // This is to display financial data as it is like 2.1476838
                     resultValue = "" + d;
 
@@ -1139,7 +1604,7 @@
         }
     }
 
-    // Function getBooleanDataValue Start
+    // functoin getBooleanDataValue stsrt
 
     public String getBooleanDataValue( String formula, Date startDate, Date endDate, OrganisationUnit organisationUnit,
         String reportModelTB )
@@ -1182,7 +1647,9 @@
                     deFlag1 = 1;
                     deFlag2 = 0;
                     PeriodType dePeriodType = getDataElementPeriodType( dataElement );
-
+                    // List<Period> periodList = new ArrayList<Period>(
+                    // periodService.getIntersectingPeriodsByPeriodType(
+                    // dePeriodType, startDate, endDate ) );
                     List<Period> periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates(
                         dePeriodType, startDate, endDate ) );
                     Period tempPeriod = new Period();
@@ -1197,9 +1664,8 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
-
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod, organisationUnit,  optionCombo );
                     if ( dataValue != null )
                     {
                         // Works for both text and boolean data types
@@ -1248,8 +1714,11 @@
                 double d = 0.0;
                 try
                 {
+
                     d = MathUtils.calculateExpression( buffer.toString() );
-                    d = Math.round(d);
+
+                    d = Math.round( d );
+
                 }
                 catch ( Exception e )
                 {
@@ -1283,9 +1752,9 @@
         }
     }
 
-    // Function getBooleanDataValue End
+    // functoin getBooleanDataValue end
 
-    // Function getStartingEndingPeriods Starts
+    // function getStartingEndingPeriods starts
 
     public List<Calendar> getStartingEndingPeriods( String deType, Period selectedPeriod )
     {
@@ -1296,8 +1765,74 @@
 
         Period previousPeriod = new Period();
         previousPeriod = getPreviousPeriod( selectedPeriod );
+        
+        // Financial current year
+        if ( deType.equalsIgnoreCase( "fcy" ) )
+        {
+            tempStartDate.setTime( selectedPeriod.getStartDate() );
+            tempEndDate.setTime( selectedPeriod.getStartDate() );
+            
+            int currentYear = tempStartDate.get( Calendar.YEAR );
+            
+            if ( tempStartDate.get( Calendar.MONTH ) < Calendar.APRIL )
+            {
+                tempStartDate.set( Calendar.YEAR, currentYear-1 );
+                tempStartDate.set( Calendar.MONTH, Calendar.APRIL );
+                tempStartDate.set( Calendar.DATE, 1 );
+                
+                tempEndDate.set( Calendar.YEAR, currentYear );
+                tempEndDate.set( Calendar.MONTH, Calendar.MARCH );
+                tempEndDate.set( Calendar.DATE, 31 );
+            }
+            else
+            {
+                tempStartDate.set( Calendar.YEAR, currentYear );
+                tempStartDate.set( Calendar.MONTH, Calendar.APRIL );
+                tempStartDate.set( Calendar.DATE, 1 );
+                
+                tempEndDate.set( Calendar.YEAR, currentYear+1 );
+                tempEndDate.set( Calendar.MONTH, Calendar.MARCH );
+                tempEndDate.set( Calendar.DATE, 31 );                
+            }
+            
+        }
+        // Financial previous year
+        else if ( deType.equalsIgnoreCase( "fpy" ) )
+        {
+            tempStartDate.setTime( selectedPeriod.getStartDate() );
+            tempEndDate.setTime( selectedPeriod.getEndDate() );
 
-        if ( deType.equalsIgnoreCase( "ccmcy" ) )
+            tempStartDate.roll( Calendar.YEAR, -1 );
+            tempEndDate.roll( Calendar.YEAR, -1 );
+            
+            int currentYear = tempStartDate.get( Calendar.YEAR );
+            
+            if ( tempStartDate.get( Calendar.MONTH ) < Calendar.APRIL )
+            {
+                tempStartDate.set( Calendar.YEAR, currentYear-1 );
+                tempStartDate.set( Calendar.MONTH, Calendar.APRIL );
+                tempStartDate.set( Calendar.DATE, 1 );
+                
+                tempEndDate.set( Calendar.YEAR, currentYear );
+                tempEndDate.set( Calendar.MONTH, Calendar.MARCH );
+                tempEndDate.set( Calendar.DATE, 31 );
+            }
+            else
+            {
+                tempStartDate.set( Calendar.YEAR, currentYear );
+                tempStartDate.set( Calendar.MONTH, Calendar.APRIL );
+                tempStartDate.set( Calendar.DATE, 1 );
+                
+                tempEndDate.set( Calendar.YEAR, currentYear+1 );
+                tempEndDate.set( Calendar.MONTH, Calendar.MARCH );
+                tempEndDate.set( Calendar.DATE, 31 );                
+            }
+            
+        }
+        
+        
+        // Commutative current month and current year from April
+        else if ( deType.equalsIgnoreCase( "ccmcy" ) )
         {
             tempStartDate.setTime( selectedPeriod.getStartDate() );
             if ( tempStartDate.get( Calendar.MONTH ) < Calendar.APRIL )
@@ -1307,6 +1842,7 @@
             tempStartDate.set( Calendar.MONTH, Calendar.APRIL );
             tempEndDate.setTime( selectedPeriod.getEndDate() );
         }
+        
         else if ( deType.equalsIgnoreCase( "cpmcy" ) )
         {
             tempStartDate.setTime( previousPeriod.getStartDate() );
@@ -1317,6 +1853,8 @@
             tempStartDate.set( Calendar.MONTH, Calendar.APRIL );
             tempEndDate.setTime( previousPeriod.getEndDate() );
         }
+        
+        // current month previous year
         else if ( deType.equalsIgnoreCase( "cmpy" ) )
         {
             tempStartDate.setTime( selectedPeriod.getStartDate() );
@@ -1325,6 +1863,8 @@
             tempStartDate.roll( Calendar.YEAR, -1 );
             tempEndDate.roll( Calendar.YEAR, -1 );
         }
+        
+        // Commutative current month previous year
         else if ( deType.equalsIgnoreCase( "ccmpy" ) )
         {
             tempStartDate.setTime( selectedPeriod.getStartDate() );
@@ -1339,6 +1879,7 @@
             }
             tempStartDate.set( Calendar.MONTH, Calendar.APRIL );
         }
+        // previous month current year  
         else if ( deType.equalsIgnoreCase( "pmcy" ) )
         {
             tempStartDate.setTime( previousPeriod.getStartDate() );
@@ -1390,6 +1931,7 @@
             tempEndDate.set( Calendar.MONTH, Calendar.DECEMBER );
             tempEndDate.set( Calendar.DATE, 31 );
         }
+        
         else if ( deType.equalsIgnoreCase( "bfq1" ) )
         {
             tempStartDate.setTime( selectedPeriod.getStartDate() );
@@ -1428,6 +1970,7 @@
             tempEndDate.set( Calendar.MONTH, Calendar.JUNE );
             tempEndDate.set( Calendar.DATE, 30 );
         }
+        // CMCY current month current year
         else
         {
             tempStartDate.setTime( selectedPeriod.getStartDate() );
@@ -1440,7 +1983,7 @@
         return calendarList;
     }
 
-    // Function getPreviousPeriod Starts
+    // function getPreviousPeriod starts
     public Period getPreviousPeriod( Period selectedPeriod )
     {
         Period period = new Period();
@@ -1515,10 +2058,14 @@
             if ( deFlag1 == 0 )
             {
                 double d = 0.0;
+
                 try
                 {
+
                     d = MathUtils.calculateExpression( buffer.toString() );
-                    d = Math.round(d);
+
+                    d = Math.round( d );
+
                 }
                 catch ( Exception e )
                 {
@@ -1529,6 +2076,7 @@
                     d = 0.0;
                 }
                 else
+
                 {
                     d = Math.round( d * Math.pow( 10, 1 ) ) / Math.pow( 10, 1 );
                     resultValue = "" + d;
@@ -1640,8 +2188,11 @@
                 double d = 0.0;
                 try
                 {
+
                     d = MathUtils.calculateExpression( buffer.toString() );
-                    d = Math.round(d);
+
+                    d = Math.round( d );
+
                 }
                 catch ( Exception e )
                 {
@@ -1717,7 +2268,6 @@
 
             NodeList listOfDECodes = doc.getElementsByTagName( "de-code" );
             int totalDEcodes = listOfDECodes.getLength();
-            Map<String, String> globalValuesMap = mapGlobalValues();
 
             for ( int s = 0; s < totalDEcodes; s++ )
             {
@@ -1725,14 +2275,6 @@
                 NodeList textDECodeList = deCodeElement.getChildNodes();
 
                 String expression = ((Node) textDECodeList.item( 0 )).getNodeValue().trim();
-
-                // ------------------------replace global
-                // values------------------------------------------------
-
-                expression = getGlobalExpression( expression, globalValuesMap );
-
-                // ---------------------------------------------------------------------------------------------
-
                 String stype = deCodeElement.getAttribute( "stype" );
                 String ptype = deCodeElement.getAttribute( "type" );
                 int sheetno = new Integer( deCodeElement.getAttribute( "sheetno" ) );
@@ -1744,10 +2286,8 @@
                 Report_inDesign report_inDesign = new Report_inDesign( stype, ptype, sheetno, rowno, colno, rowMerge,
                     colMerge, expression );
                 reportDesignList.add( report_inDesign );
-            }
-            // end of for loop with s var
-        }
-        // try block end
+            }// end of for loop with s var
+        }// try block end
         catch ( SAXParseException err )
         {
             System.out.println( "** Parsing error" + ", line " + err.getLineNumber() + ", uri " + err.getSystemId() );
@@ -1804,7 +2344,6 @@
 
             NodeList listOfDECodes = doc.getElementsByTagName( "de-code" );
             int totalDEcodes = listOfDECodes.getLength();
-            Map<String, String> globalValuesMap = mapGlobalValues();
 
             for ( int s = 0; s < totalDEcodes; s++ )
             {
@@ -1812,18 +2351,6 @@
                 NodeList textDECodeList = deCodeElement.getChildNodes();
 
                 String expression = ((Node) textDECodeList.item( 0 )).getNodeValue().trim();
-
-                // ------------------------replace global
-                // values------------------------------------------------
-
-                System.out.println( "\n*INFO :<< CHECKING CONFIG FILE SETUP(2) >>" );
-                System.out.println( "*INFO :Global Value: " + expression );
-                expression = getGlobalExpression( expression, globalValuesMap );
-                System.out.println( "*INFO :Local Value: " + expression );
-                System.out.println( "*INFO :<<CHECK FINISHED>>\n" );
-
-                // ---------------------------------------------------------------------------------------------
-
                 String stype = deCodeElement.getAttribute( "stype" );
                 String ptype = deCodeElement.getAttribute( "type" );
                 int sheetno = new Integer( deCodeElement.getAttribute( "sheetno" ) );
@@ -1922,8 +2449,11 @@
                 double d = 0.0;
                 try
                 {
+
                     d = MathUtils.calculateExpression( buffer.toString() );
-                    d = Math.round(d);
+
+                    d = Math.round( d );
+
                 }
                 catch ( Exception e )
                 {
@@ -2030,9 +2560,9 @@
                         tempPeriod = periodService.getPeriod( periodIds.iterator().next() );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
-
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod, organisationUnit,  optionCombo );
+                    
                     if ( dataValue != null && dataValue.getValue() != null )
                     {
                         replaceString = dataValue.getValue();
@@ -2059,8 +2589,11 @@
                 double d = 0.0;
                 try
                 {
+
                     d = MathUtils.calculateExpression( buffer.toString() );
-                    d = Math.round(d);
+
+                    d = Math.round( d );
+
                 }
                 catch ( Exception e )
                 {
@@ -2155,9 +2688,10 @@
                 Integer deId = rs.getInt( 1 );
                 Integer optionComId = rs.getInt( 2 );
                 Double aggregatedValue = rs.getDouble( 3 );
+
                 if ( aggregatedValue != null )
                 {
-                    aggDeMap.put( deId + "." + optionComId, "" + aggregatedValue );
+                    aggDeMap.put( deId + "." + optionComId, "" + Math.round( aggregatedValue ) );
                 }
             }
 
@@ -2323,6 +2857,49 @@
         }
     }
 
+    public Map<String, String> getAggNonNumberDataFromDataValueTable( String orgUnitIdsByComma,
+        String dataElmentIdsByComma, String periodIdsByComma )
+    {
+        Map<String, String> aggDeMap = new HashMap<String, String>();
+        DatabaseInfo dataBaseInfo = databaseInfoProvider.getDatabaseInfo();
+        try
+        {
+            String query = "";
+            if ( dataBaseInfo.getType().equalsIgnoreCase( "postgresql" ) )
+            {
+                query = "SELECT dataelementid,categoryoptioncomboid, SUM( cast( value as numeric) ) FROM datavalue "
+                    + " WHERE dataelementid IN (" + dataElmentIdsByComma + " ) AND " + " sourceid IN ("
+                    + orgUnitIdsByComma + " ) AND " + " periodid IN (" + periodIdsByComma
+                    + ") GROUP BY dataelementid,categoryoptioncomboid";
+            }
+            else if ( dataBaseInfo.getType().equalsIgnoreCase( "mysql" ) )
+            {
+                query = "SELECT dataelementid,categoryoptioncomboid, GROUP_CONCAT(value) FROM datavalue "
+                    + " WHERE dataelementid IN (" + dataElmentIdsByComma + " ) AND " + " sourceid IN ("
+                    + orgUnitIdsByComma + " ) AND " + " periodid IN (" + periodIdsByComma
+                    + ") GROUP BY dataelementid,categoryoptioncomboid";
+            }
+            SqlRowSet rs = jdbcTemplate.queryForRowSet( query );
+
+            while ( rs.next() )
+            {
+                Integer deId = rs.getInt( 1 );
+                Integer optionComId = rs.getInt( 2 );
+                String aggregatedNonNumberValue = rs.getString( 3 );
+                if ( aggregatedNonNumberValue != null )
+                {
+                    aggDeMap.put( deId + "." + optionComId, aggregatedNonNumberValue );
+                }
+            }
+
+            return aggDeMap;
+        }
+        catch ( Exception e )
+        {
+            throw new RuntimeException( "Illegal DataElement id", e );
+        }
+    }
+
     public Map<String, String> getAggDataFromDataValueTable( String orgUnitIdsByComma, String dataElmentIdsByComma,
         String periodIdsByComma )
     {
@@ -2366,6 +2943,382 @@
         }
     }
 
+    
+    public Map<String, String> getBatchDataFromDataValueTable( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma )
+    {
+        Map<String, String> aggDeMap = new HashMap<String, String>();
+
+        try
+        {
+            String query = "";
+            query = "SELECT periodid, value FROM datavalue "
+                + " WHERE dataelementid IN (" + dataElmentIdsByComma + " ) AND " + " sourceid IN ("
+                + orgUnitIdsByComma + " ) AND " + " periodid IN (" + periodIdsByComma
+                + ")";
+            
+            SqlRowSet rs = jdbcTemplate.queryForRowSet( query );
+
+            while ( rs.next() )
+            {
+                Integer periodId = rs.getInt( 1 );
+                //Double aggregatedValue = rs.getDouble( 2 );
+                Integer aggregatedValue = rs.getInt( 2 );
+                if ( aggregatedValue != null )
+                {
+                    aggDeMap.put( "" + periodId ,"" + aggregatedValue );
+                }
+            }
+
+            return aggDeMap;
+        }
+        catch ( Exception e )
+        {
+            throw new RuntimeException( "Illegal DataElement id", e );
+        }
+    }
+    
+    
+    
+    
+    public List<Report_inDesign> getHeaderInfo( String fileName )
+    {
+        List<Report_inDesign> reportDesignList = new ArrayList<Report_inDesign>();
+
+        String path = System.getProperty( "user.home" ) + File.separator + "dhis" + File.separator
+            + configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue()
+            + File.separator + fileName;
+        try
+        {
+            String newpath = System.getenv( "DHIS2_HOME" );
+            if ( newpath != null )
+            {
+                path = newpath + File.separator
+                    + configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue()
+                    + File.separator + fileName;
+            }
+        }
+        catch ( NullPointerException npe )
+        {
+            System.out.println( "DHIS2_HOME not set" );
+        }
+
+        try
+        {
+            DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
+            DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
+            Document doc = docBuilder.parse( new File( path ) );
+            if ( doc == null )
+            {
+                System.out.println( "There is no DECodes related XML file in the ra folder" );
+                return null;
+            }
+
+            NodeList listOfDECodes = doc.getElementsByTagName( "header-info" );
+            int totalDEcodes = listOfDECodes.getLength();
+
+            for ( int s = 0; s < totalDEcodes; s++ )
+            {
+                Element deCodeElement = (Element) listOfDECodes.item( s );
+                NodeList textDECodeList = deCodeElement.getChildNodes();
+
+                String expression = ((Node) textDECodeList.item( 0 )).getNodeValue().trim();
+                String stype = deCodeElement.getAttribute( "stype" );
+                String ptype = deCodeElement.getAttribute( "type" );
+                int sheetno = new Integer( deCodeElement.getAttribute( "sheetno" ) );
+                int rowno = new Integer( deCodeElement.getAttribute( "rowno" ) );
+                int colno = new Integer( deCodeElement.getAttribute( "colno" ) );
+
+                Report_inDesign report_inDesign = new Report_inDesign( stype, ptype, sheetno, rowno, colno, expression );
+                reportDesignList.add( report_inDesign );
+            }// end of for loop with s var
+        }// try block end
+        catch ( SAXParseException err )
+        {
+            System.out.println( "** Parsing error" + ", line " + err.getLineNumber() + ", uri " + err.getSystemId() );
+            System.out.println( " " + err.getMessage() );
+        }
+        catch ( SAXException e )
+        {
+            Exception x = e.getException();
+            ((x == null) ? e : x).printStackTrace();
+        }
+        catch ( Throwable t )
+        {
+            t.printStackTrace();
+        }
+        return reportDesignList;
+    }
+    
+    // get text data and date from data value table
+    public String getTextDataFromDataValueTable( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma )
+    {
+        String textData = "";
+        
+        try
+        {            
+            String query = "";
+            
+            query = "SELECT  value  FROM datavalue "
+                + " WHERE dataelementid IN (" + dataElmentIdsByComma + " ) AND " + " sourceid IN ("
+                + orgUnitIdsByComma + " ) AND " + " periodid IN (" + periodIdsByComma
+                + ")";
+            
+            SqlRowSet rs = jdbcTemplate.queryForRowSet( query );
+            
+            while ( rs.next() )
+            {
+                String textValue = rs.getString( 1 );
+               
+                if ( textValue != null )
+                {
+                    //textData += "," + textValue;
+                    
+                    textData += textValue + ",";
+                }
+            }
+            
+            return textData;
+        }
+        catch ( Exception e )
+        {
+            throw new RuntimeException( "Illegal DataElement id", e );
+        }
+    }   
+    
+    // get count of dataElement from data value table
+    public Integer getDataCountFromDataValueTable( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma )
+    {
+        Integer dataCount = 0;
+        
+        try
+        {            
+            String query = "";
+            
+            query = "SELECT COUNT( value ) FROM datavalue "
+                + " WHERE dataelementid IN (" + dataElmentIdsByComma + " ) AND " + " sourceid IN ("
+                + orgUnitIdsByComma + " ) AND " + " periodid IN (" + periodIdsByComma
+                + ")";
+            
+            SqlRowSet rs = jdbcTemplate.queryForRowSet( query );
+            
+            if ( rs.next() )
+            {
+                dataCount = rs.getInt( 1 );
+            }
+            
+            return dataCount;
+        }
+        catch ( Exception e )
+        {
+            throw new RuntimeException( "Illegal DataElement id", e );
+        }
+    }
+    
+    public Map<String, String> getAggDataFromDataValueTableByDeAndOrgUnitwise( String orgUnitIdsByComma, String dataElmentIdsByComma, String startDate, String endDate )
+    {
+    	
+    	int ouMaxLevel = organisationUnitService.getMaxOfOrganisationUnitLevels();
+    	
+    	Map<String, String> aggDataMap = new HashMap<String, String>();
+        try
+        {
+            String query = 
+            		
+            		"SELECT sag.level, sag.parent, sag.name, IFNULL(sag1.dataelementid,0) AS DE,IFNULL(sag1.categoryoptioncomboid,0) AS CCI,SUM(IFNULL(sag1.value,0)) AS total, sag1.de_uid, sag1.coc_uid " +
+            				" FROM " +
+            					"( " +
+            						"SELECT os.level,os.organisationunitid AS parent,ou.name,os1.organisationunitid AS actual " +
+            						" FROM _orgunitstructure os " +
+            						" INNER JOIN organisationunit ou ON ou.organisationunitid=os.organisationunitid " +
+            						" INNER JOIN _orgunitstructure os1 ON os.organisationunitid = CASE ";
+            						
+            						for( int i = 2; i <= ouMaxLevel; i++ )
+            						{
+            							query += " WHEN os.level="+i+" THEN os1.idlevel"+i+ " ";
+            						}
+            						 
+            						query += " END" +
+            						" WHERE os.organisationunitid IN ("+ orgUnitIdsByComma +") " +
+            					")sag" +
+            		" INNER JOIN "+ 
+            		" ( " +
+            			" SELECT dv.dataelementid, de.uid AS de_uid, dv.categoryoptioncomboid, coc.uid AS coc_uid, dv.value,dv.sourceid " +
+            				" FROM datavalue dv "+
+            				" INNER JOIN period p ON p.periodid=dv.periodid "+ 
+            				" INNER JOIN dataelement de ON de.dataelementid=dv.dataelementid " +
+            				" INNER JOIN categoryoptioncombo coc ON coc.categoryoptioncomboid=dv.categoryoptioncomboid " +
+            				" WHERE dv.dataelementid IN ("+ dataElmentIdsByComma +") " +
+            				" AND p.startdate BETWEEN '"+ startDate +"' AND '"+ endDate +"'" +            				
+            		")sag1 " +
+            		"ON sag.actual = sag1.sourceid " +
+            		" GROUP BY sag.parent, sag1.dataelementid,sag1.categoryoptioncomboid " +
+            		" ORDER BY sag.level,sag.parent";
+
+            		
+            		/*
+            		
+            		"SELECT sag.level, sag.parent, sag.name, IFNULL(sag1.dataelementid,0) AS DE,IFNULL(sag1.categoryoptioncomboid,0) AS CCI,SUM(IFNULL(sag1.value,0)) AS total " +
+            				" FROM " +
+            					"( " +
+            						"SELECT os.level,os.organisationunitid AS parent,ou.name,os1.organisationunitid AS actual " +
+            						" FROM _orgunitstructure os " +
+            						" INNER JOIN organisationunit ou ON ou.organisationunitid=os.organisationunitid " +
+            						" INNER JOIN _orgunitstructure os1 ON os.organisationunitid = CASE ";
+            						
+            						for( int i = 2; i <= ouMaxLevel; i++ )
+            						{
+            							query += " WHEN os.level="+i+" THEN os1.idlevel"+i+ " ";
+            						}
+            						 
+            						query += " END" +
+            						" WHERE os.organisationunitid IN ("+ orgUnitIdsByComma +") " +
+            					")sag" +
+            		" INNER JOIN "+ 
+            		" ( " +
+            			" SELECT dv.dataelementid,dv.categoryoptioncomboid,dv.value,dv.sourceid " +
+            				" FROM datavalue dv "+
+            				" INNER JOIN period p ON p.periodid=dv.periodid "+ 
+            				" WHERE dv.dataelementid IN ("+ dataElmentIdsByComma +") " +
+            				" AND p.startdate BETWEEN '"+ startDate +"' AND '"+ endDate +"'" +            				
+            		")sag1 " +
+            		"ON sag.actual = sag1.sourceid " +
+            		" GROUP BY sag.parent, sag1.dataelementid,sag1.categoryoptioncomboid " +
+            		" ORDER BY sag.level,sag.parent";
+            		
+            		*/
+            		
+            SqlRowSet rs = jdbcTemplate.queryForRowSet( query );
+
+            while ( rs.next() )
+            {
+            	Integer ouId = rs.getInt(2 );
+                Integer deId = rs.getInt( 4 );
+                Integer optionComId = rs.getInt( 5 );
+                //Integer periodId = rs.getInt( 3 );
+                Double aggregatedValue = rs.getDouble( 6 );
+                String deUID = rs.getString( 7 );
+                String optionComUID = rs.getString( 8 );
+                
+                if ( aggregatedValue != null )
+                {
+                    aggDataMap.put( ouId + ":" + deUID + ":" + optionComUID, "" + aggregatedValue );
+                }
+            }
+
+            return aggDataMap;
+        }
+        catch ( Exception e )
+        {
+            throw new RuntimeException( "Illegal DataElement id", e );
+        }
+    }
+
+    public Map<String, String> getAggDataFromDataValueTableByDeAndOrgUnitwise( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma )
+    {
+    	
+    	int ouMaxLevel = organisationUnitService.getMaxOfOrganisationUnitLevels();
+    	
+    	Map<String, String> aggDataMap = new HashMap<String, String>();
+        try
+        {
+            String query = 
+            		
+            		"SELECT sag.level, sag.parent, sag.name, IFNULL(sag1.dataelementid,0) AS DE,IFNULL(sag1.categoryoptioncomboid,0) AS CCI,SUM(IFNULL(sag1.value,0)) AS total, sag1.de_uid, sag1.coc_uid " +
+            				" FROM " +
+            					"( " +
+            						"SELECT os.level,os.organisationunitid AS parent,ou.name,os1.organisationunitid AS actual " +
+            						" FROM _orgunitstructure os " +
+            						" INNER JOIN organisationunit ou ON ou.organisationunitid=os.organisationunitid " +
+            						" INNER JOIN _orgunitstructure os1 ON os.organisationunitid = CASE ";
+            						
+            						for( int i = 2; i <= ouMaxLevel; i++ )
+            						{
+            							query += " WHEN os.level="+i+" THEN os1.idlevel"+i+ " ";
+            						}
+            						 
+            						query += " END" +
+            						" WHERE os.organisationunitid IN ("+ orgUnitIdsByComma +") " +
+            					")sag" +
+            		" INNER JOIN "+ 
+            		" ( " +
+            			" SELECT dv.dataelementid, de.uid AS de_uid, dv.categoryoptioncomboid, coc.uid AS coc_uid, dv.value,dv.sourceid " +
+            				" FROM datavalue dv "+
+            				" INNER JOIN period p ON p.periodid=dv.periodid "+ 
+            				" INNER JOIN dataelement de ON de.dataelementid=dv.dataelementid " +
+            				" INNER JOIN categoryoptioncombo coc ON coc.categoryoptioncomboid=dv.categoryoptioncomboid " +
+            				" WHERE dv.dataelementid IN ("+ dataElmentIdsByComma +") " +
+            				" AND dv.periodid IN ("+ periodIdsByComma +")" +            				
+            		")sag1 " +
+            		"ON sag.actual = sag1.sourceid " +
+            		" GROUP BY sag.parent, sag1.dataelementid,sag1.categoryoptioncomboid " +
+            		" ORDER BY sag.level,sag.parent";
+
+            SqlRowSet rs = jdbcTemplate.queryForRowSet( query );
+
+            while ( rs.next() )
+            {
+            	Integer ouId = rs.getInt(2 );
+                //Integer deId = rs.getInt( 4 );
+                //Integer optionComId = rs.getInt( 5 );
+                Double aggregatedValue = rs.getDouble( 6 );
+                String deUID = rs.getString( 7 );
+                String optionComUID = rs.getString( 8 );
+                
+                if ( aggregatedValue != null )
+                {
+                    aggDataMap.put( ouId + ":" + deUID + ":" + optionComUID, "" + aggregatedValue );
+                }
+            }
+
+            return aggDataMap;
+        }
+        catch ( Exception e )
+        {
+            throw new RuntimeException( "Illegal DataElement id", e );
+        }
+    }
+
+
+    public Map<String, String> getCapturedDataFromDataValueTableByDeAndOrgUnitwise( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma )
+    {    	
+    	Map<String, String> aggDataMap = new HashMap<String, String>();
+        try
+        {
+            String query = 
+            			" SELECT dv.sourceid, de.uid AS de_uid, coc.uid AS coc_uid, SUM(dv.value) " +
+            				" FROM datavalue dv "+
+            				" INNER JOIN period p ON p.periodid=dv.periodid "+
+            				" INNER JOIN dataelement de ON de.dataelementid=dv.dataelementid " +
+            				" INNER JOIN categoryoptioncombo coc ON coc.categoryoptioncomboid=dv.categoryoptioncomboid " +
+            				" WHERE " +
+            					" dv.dataelementid IN ("+ dataElmentIdsByComma +") AND " +
+            					" dv.periodid IN ("+ periodIdsByComma +") AND " +
+            					" dv.sourceid IN ("+ orgUnitIdsByComma +") " +
+            				" GROUP BY dv.sourceid, dv.dataelementid, dv.categoryoptioncomboid ";
+
+            SqlRowSet rs = jdbcTemplate.queryForRowSet( query );
+
+            while ( rs.next() )
+            {
+            	Integer ouId = rs.getInt( 1 );
+                String deUID = rs.getString( 2 );
+                String optionComUID = rs.getString( 3 );
+                Double aggregatedValue = rs.getDouble( 4 );
+                
+                if ( aggregatedValue != null )
+                {
+                    aggDataMap.put( ouId + ":" + deUID + ":" + optionComUID, "" + aggregatedValue );
+                }
+            }
+
+            return aggDataMap;
+        }
+        catch ( Exception e )
+        {
+            throw new RuntimeException( "Illegal DataElement id", e );
+        }
+    }
+
     public Map<String, String> getAggDataFromDataValueTableByDeAndPeriodwise( String orgUnitIdsByComma,
         String dataElmentIdsByComma, String periodIdsByComma )
     {
@@ -2568,8 +3521,11 @@
             double d = 0.0;
             try
             {
+
                 d = MathUtils.calculateExpression( buffer.toString() );
-                d = Math.round(d);
+
+                d = Math.round( d );
+
             }
             catch ( Exception e )
             {
@@ -2707,9 +3663,19 @@
 
     public String getDataelementIdsAsString( List<Indicator> indicatorList )
     {
+    	Set<DataElement> dataElementList = expressionService.getDataElementsInIndicators( indicatorList );
+    	Collection<Integer> dataElementIds = new ArrayList<Integer>( getIdentifiers(DataElement.class, dataElementList ) );
+    	String dataElmentIdsByComma = getCommaDelimitedString( dataElementIds );
+    	
+    	if( dataElmentIdsByComma == null )
+    	{
+    		dataElmentIdsByComma = "-1";
+    	}
+    	
+    	/*
         String dataElmentIdsByComma = "-1";
         for ( Indicator indicator : indicatorList )
-        {
+        {        	
             String formula = indicator.getNumerator() + " + " + indicator.getDenominator();
             try
             {
@@ -2736,6 +3702,46 @@
 
             }
         }
+        */
+
+        return dataElmentIdsByComma;
+    }
+
+    public String getDataelementIdsByStype( List<Report_inDesign> reportDesignList, String sType )
+    {
+        String dataElmentIdsByComma = "-1";
+        for ( Report_inDesign report_inDesign : reportDesignList )
+        {
+            if ( report_inDesign.getStype().equalsIgnoreCase( sType ) )
+            {
+                String formula = report_inDesign.getExpression();
+
+                try
+                {
+                    Pattern pattern = Pattern.compile( "(\\[\\d+\\.\\d+\\])" );
+
+                    Matcher matcher = pattern.matcher( formula );
+                    StringBuffer buffer = new StringBuffer();
+
+                    while ( matcher.find() )
+                    {
+                        String replaceString = matcher.group();
+
+                        replaceString = replaceString.replaceAll( "[\\[\\]]", "" );
+                        replaceString = replaceString.substring( 0, replaceString.indexOf( '.' ) );
+
+                        int dataElementId = Integer.parseInt( replaceString );
+                        dataElmentIdsByComma += "," + dataElementId;
+                        replaceString = "";
+                        matcher.appendReplacement( buffer, replaceString );
+                    }
+                }
+                catch ( Exception e )
+                {
+
+                }
+            }
+        }
 
         return dataElmentIdsByComma;
     }
@@ -2809,8 +3815,11 @@
             double d = 0.0;
             try
             {
+
                 d = MathUtils.calculateExpression( buffer.toString() );
-                d = Math.round(d);
+
+                d = Math.round( d );
+
             }
             catch ( Exception e )
             {
@@ -3275,7 +4284,7 @@
                 dataStatusPercentatge = 100;
             }
 
-            System.out.println( query + "  : " + dataStatusPercentatge );
+            //System.out.println( query + "  : " + dataStatusPercentatge );
 
             dataStatusPercentatge = Math.round( dataStatusPercentatge * Math.pow( 10, 0 ) ) / Math.pow( 10, 0 );
             if ( dataStatusPercentatge > constValue )
@@ -3286,48 +4295,303 @@
 
         return reportingOrgUnitCount;
     }
-
-    public String getDataelementIdsByStype( List<Report_inDesign> reportDesignList, String sType )
+    
+    public String getResultDataValueForOrgUnitGroupMember( String formula, String orgUnitIdsByComma ,Date startDate, Date endDate,  String reportModelTB )
     {
-        String dataElmentIdsByComma = "-1";
-        for ( Report_inDesign report_inDesign : reportDesignList )
+        int deFlag1 = 0;
+        int isAggregated = 0;
+        
+        List<Period> tempPeriodList = new ArrayList<Period>( periodService.getIntersectingPeriods( startDate, endDate ) );
+        Collection<Integer> tempPeriodIds = new ArrayList<Integer>( getIdentifiers(Period.class, tempPeriodList ) );
+        String periodIdsByComma = getCommaDelimitedString( tempPeriodIds );
+        
+        try
         {
-            if ( report_inDesign.getStype().equalsIgnoreCase( sType ) )
-            {
-                String formula = report_inDesign.getExpression();
-
+            Pattern pattern = Pattern.compile( "(\\[\\d+\\.\\d+\\])" );
+
+            Matcher matcher = pattern.matcher( formula );
+            StringBuffer buffer = new StringBuffer();
+            
+            
+            String query = "";
+            String resultValue = "";
+            
+            while ( matcher.find() )
+            {
+                String replaceString = matcher.group();
+
+                replaceString = replaceString.replaceAll( "[\\[\\]]", "" );
+                String optionComboIdStr = replaceString.substring( replaceString.indexOf( '.' ) + 1, replaceString
+                    .length() );
+
+                replaceString = replaceString.substring( 0, replaceString.indexOf( '.' ) );
+
+                int dataElementId = Integer.parseInt( replaceString );
+                int optionComboId = Integer.parseInt( optionComboIdStr );
+
+                DataElement dataElement = dataElementService.getDataElement( dataElementId );
+                DataElementCategoryOptionCombo optionCombo = dataElementCategoryOptionComboService
+                    .getDataElementCategoryOptionCombo( optionComboId );
+                
+                
+                if ( dataElement == null || optionCombo == null )
+                {
+                    replaceString = "";
+                    matcher.appendReplacement( buffer, replaceString );
+                    continue;
+                }
+                
+                if ( dataElement.getType().equalsIgnoreCase( "int" ) )
+                {
+                    query = "SELECT SUM(value) FROM datavalue "
+                        + " WHERE dataelementid = " + dataElement.getId() + " AND " + " sourceid IN ("
+                        + orgUnitIdsByComma + " ) AND " + " periodid IN (" + periodIdsByComma + ")";
+                    
+                    SqlRowSet rs = jdbcTemplate.queryForRowSet( query );
+
+                    if ( rs.next() )
+                    {
+                        Double aggregatedValue = rs.getDouble( 1 );
+                        
+                        if ( aggregatedValue == null )
+                        {
+                            replaceString = NULL_REPLACEMENT;
+                        }
+                        else
+                        {
+                            replaceString = String.valueOf( aggregatedValue );
+                            isAggregated = 1;
+                        }
+                    }
+                }
+                
+                else
+                {
+                    deFlag1 = 1;
+                    PeriodType dePeriodType = getDataElementPeriodType( dataElement );
+
+                    List<Period> periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates(
+                        dePeriodType, startDate, endDate ) );
+                    Period tempPeriod = new Period();
+                    if ( periodList == null || periodList.isEmpty() )
+                    {
+                        replaceString = "";
+                        matcher.appendReplacement( buffer, replaceString );
+                        continue;
+                    }
+                    else
+                    {
+                        tempPeriod = (Period) periodList.get( 0 );
+                    }
+
+                    query = "SELECT CONCAT(value)  FROM datavalue "
+                        + " WHERE dataelementid =" + dataElement.getId() + " AND " + " sourceid IN ("
+                        + orgUnitIdsByComma + " ) AND " + " periodid = " + tempPeriod.getId() + ")";
+                    
+                    SqlRowSet rs = jdbcTemplate.queryForRowSet( query );
+
+                    if ( rs.next() )
+                    {
+                        String value = rs.getString( 1 );
+                        
+                        if ( value != null )
+                        {
+                            replaceString = value;
+                        }
+                        else
+                        {
+                            replaceString = "";
+                        }
+                    }
+                    
+                    if ( replaceString == null )
+                    {
+                        replaceString = "";
+                    }
+                }
+                matcher.appendReplacement( buffer, replaceString );
+
+                resultValue = replaceString;
+            }
+
+            matcher.appendTail( buffer );
+
+            if ( deFlag1 == 0 )
+            {
+                double d = 0.0;
                 try
                 {
-                    Pattern pattern = Pattern.compile( "(\\[\\d+\\.\\d+\\])" );
-
-                    Matcher matcher = pattern.matcher( formula );
-                    StringBuffer buffer = new StringBuffer();
-
-                    while ( matcher.find() )
-                    {
-                        String replaceString = matcher.group();
-
-                        replaceString = replaceString.replaceAll( "[\\[\\]]", "" );
-                        replaceString = replaceString.substring( 0, replaceString.indexOf( '.' ) );
-
-                        int dataElementId = Integer.parseInt( replaceString );
-                        dataElmentIdsByComma += "," + dataElementId;
-                        replaceString = "";
-                        matcher.appendReplacement( buffer, replaceString );
-                    }
+                    d = MathUtils.calculateExpression( buffer.toString() );
+                    d = Math.round( d );
                 }
                 catch ( Exception e )
                 {
-
-                }
-            }
-        }
-
-        return dataElmentIdsByComma;
-    }
-
-    public Map<String, String> getAggNonNumberDataFromDataValueTable( String orgUnitIdsByComma,
-        String dataElmentIdsByComma, String periodIdsByComma )
+                    d = 0.0;
+                    resultValue = "";
+                }
+                if ( d == -1 )
+                {
+                    d = 0.0;
+                    resultValue = "";
+                }
+                else
+                {
+                    // This is to display financial data as it is like 2.1476838
+                    resultValue = "" + d;
+
+                    // These lines are to display financial data that do not
+                    // have decimals
+                    d = d * 10;
+                    if ( d % 10 == 0 )
+                    {
+                        resultValue = "" + (int) d / 10;
+                    }
+
+                    d = d / 10;
+
+                    // These line are to display non financial data that do not
+                    // require decimals
+                    if ( !(reportModelTB.equalsIgnoreCase( "STATIC-FINANCIAL" )) )
+                    {
+                        resultValue = "" + (double) d;
+                    }
+                }
+
+            }
+            else
+            {
+                resultValue = buffer.toString();
+            }
+
+            if ( isAggregated == 0 )
+            {
+                resultValue = " ";
+            }
+
+            if ( resultValue.equalsIgnoreCase( "" ) )
+            {
+                resultValue = " ";
+            }
+
+            return resultValue;
+        }
+        
+        catch ( NumberFormatException ex )
+        {
+            throw new RuntimeException( "Illegal DataElement id", ex );
+        }
+    }
+  
+    public Map<String, String> getResultDataFromDataValueTable( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma )
+    {
+        //System.out.println( " Inside Query Start : " + new Date() ); 
+        
+        Map<String, String> aggDataMap = new HashMap<String, String>();
+        
+        try
+        {
+            String query = "SELECT sourceid,dataelementid,categoryoptioncomboid,periodid,value FROM datavalue "
+                + " WHERE dataelementid IN (" + dataElmentIdsByComma + " ) AND " + " sourceid IN (" + orgUnitIdsByComma
+                + " ) AND " + " periodid IN (" + periodIdsByComma + ")";
+
+            SqlRowSet rs = jdbcTemplate.queryForRowSet( query );
+
+            while ( rs.next() )
+            {
+                Integer orgUnitId = rs.getInt( 1 );
+                Integer deId = rs.getInt( 2 );
+                Integer optionComId = rs.getInt( 3 );
+                //Integer periodId = rs.getInt( 4 );
+                Double aggregatedValue = rs.getDouble( 5 );
+                if ( aggregatedValue != null )
+                {
+                    aggDataMap.put( deId + "." + optionComId + ":" + orgUnitId, "" + aggregatedValue );
+                }
+            }
+            
+            //System.out.println( " Inside Query End : " + new Date() );
+            
+            return aggDataMap;
+        }
+        catch ( Exception e )
+        {
+            throw new RuntimeException( "Illegal DataElement id", e );
+        }
+    }  
+
+    // delete Batch lock exception
+    public void deleteLockException( String orgUnitIdsByComma, String periodIdsByComma, String dataSetIdsByComma )
+    {
+        try
+        {
+            String query = "DELETE FROM lockexception WHERE organisationunitid IN (" + orgUnitIdsByComma + ")" + " AND periodid IN ("
+                + periodIdsByComma + ")" + " AND datasetid IN (" + dataSetIdsByComma + ")";
+
+            jdbcTemplate.execute( query );
+
+        }
+        catch ( Exception e )
+        {
+            e.printStackTrace();
+        }
+    }    
+    
+    // create batch lock exception
+    public void createBatchLockExceptions( String insertQuery )
+    {
+        try
+        {
+            jdbcTemplate.execute( insertQuery );
+        }
+        catch ( Exception e )
+        {
+            e.printStackTrace();
+        }
+    }    
+    
+    // get Lock Exception from organisationUnitId,periodId,dataSetId
+    public Boolean getLockException( Integer organisationUnitId, Integer periodId, Integer dataSetId )
+    {
+        Boolean recordExist = false;
+        
+        try
+        {
+            String query = "SELECT organisationunitid,periodid,datasetid FROM lockexception WHERE organisationunitid = " + organisationUnitId + " AND "
+                + " periodid = " + periodId + " AND datasetid = " + dataSetId;
+
+            SqlRowSet rs = jdbcTemplate.queryForRowSet( query );
+
+            if ( rs.next() )
+            {
+                recordExist = true;
+            }
+        }
+        catch ( Exception e )
+        {
+            e.printStackTrace();
+        }
+        
+        return recordExist;
+    }
+    
+    // Methods for delete Lock Exception
+    @Transactional
+    public void deleteLockException( DataSet dataSet, Period period, OrganisationUnit organisationUnit )
+    {
+        reportStore.deleteLockException( dataSet, period, organisationUnit );
+    }        
+    
+    // Get Data value for Latest Period
+    @Transactional
+    public DataValue getLatestDataValue( DataElement dataElement, DataElementCategoryOptionCombo optionCombo, OrganisationUnit organisationUnit )
+    {
+        return reportStore.getLatestDataValue( dataElement, optionCombo, organisationUnit );
+    }
+    
+    
+    
+    // methods for getting Data from data value for GOI Monthly Report
+    public Map<String, String> getDataFromDataValueTableForGoiMonthly( String orgUnitIdsByComma, String dataElmentIdsByComma, String periodIdsByComma )
     {
         Map<String, String> aggDeMap = new HashMap<String, String>();
         DatabaseInfo dataBaseInfo = databaseInfoProvider.getDatabaseInfo();
@@ -3343,21 +4607,23 @@
             }
             else if ( dataBaseInfo.getType().equalsIgnoreCase( "mysql" ) )
             {
-                query = "SELECT dataelementid,categoryoptioncomboid, GROUP_CONCAT(value) FROM datavalue "
-                    + " WHERE dataelementid IN (" + dataElmentIdsByComma + " ) AND " + " sourceid IN ("
-                    + orgUnitIdsByComma + " ) AND " + " periodid IN (" + periodIdsByComma
-                    + ") GROUP BY dataelementid,categoryoptioncomboid";
+                query = "SELECT dataelementid,categoryoptioncomboid, SUM(value) FROM datavalue " + 
+                             " WHERE "+
+                                 " dataelementid IN (" + dataElmentIdsByComma + " ) AND " + 
+                                 " sourceid = " + orgUnitIdsByComma + " AND " + 
+                                 " periodid IN (" + periodIdsByComma + ") GROUP BY dataelementid,categoryoptioncomboid";
             }
+            
             SqlRowSet rs = jdbcTemplate.queryForRowSet( query );
 
             while ( rs.next() )
             {
                 Integer deId = rs.getInt( 1 );
                 Integer optionComId = rs.getInt( 2 );
-                String aggregatedNonNumberValue = rs.getString( 3 );
-                if ( aggregatedNonNumberValue != null )
+                Double value = rs.getDouble( 3 );
+                if ( value != null )
                 {
-                    aggDeMap.put( deId + "." + optionComId, aggregatedNonNumberValue );
+                    aggDeMap.put( deId + "." + optionComId, "" + value );
                 }
             }
 
@@ -3368,4 +4634,5 @@
             throw new RuntimeException( "Illegal DataElement id", e );
         }
     }
+ 
 }

=== modified file 'local/in/dhis-in-services/dhis-in-service-reports/src/main/java/org/hisp/dhis/reports/DefaultStateDistrictFeedbackReportService.java'
--- local/in/dhis-in-services/dhis-in-service-reports/src/main/java/org/hisp/dhis/reports/DefaultStateDistrictFeedbackReportService.java	2012-07-26 09:20:56 +0000
+++ local/in/dhis-in-services/dhis-in-service-reports/src/main/java/org/hisp/dhis/reports/DefaultStateDistrictFeedbackReportService.java	2013-09-19 06:34:31 +0000
@@ -30,124 +30,110 @@
 /**
  * <gaurav>,Date: 7/4/12, Time: 12:47 PM
  */
-public class DefaultStateDistrictFeedbackReportService
-    implements StateDistrictFeedbackReportService
-{
+public class DefaultStateDistrictFeedbackReportService implements StateDistrictFeedbackReportService {
 
-    // ---------------------------------------------------------------------------------------
-    // Dependencies
-    // ---------------------------------------------------------------------------------------
+    //---------------------------------------------------------------------------------------
+    //                               Dependencies
+    //---------------------------------------------------------------------------------------
 
     private OrganisationUnitService organisationUnitService;
 
-    public void setOrganisationUnitService( OrganisationUnitService organisationUnitService )
-    {
+    public void setOrganisationUnitService(OrganisationUnitService organisationUnitService) {
         this.organisationUnitService = organisationUnitService;
     }
 
     private OrganisationUnitGroupService organisationUnitGroupService;
 
-    public void setOrganisationUnitGroupService( OrganisationUnitGroupService organisationUnitGroupService )
-    {
+    public void setOrganisationUnitGroupService(OrganisationUnitGroupService organisationUnitGroupService) {
         this.organisationUnitGroupService = organisationUnitGroupService;
     }
 
     private ConfigurationService configurationService;
 
-    public void setConfigurationService( ConfigurationService configurationService )
-    {
+    public void setConfigurationService(ConfigurationService configurationService) {
         this.configurationService = configurationService;
     }
 
     private PeriodService periodService;
 
-    public void setPeriodService( PeriodService periodService )
-    {
+    public void setPeriodService(PeriodService periodService) {
         this.periodService = periodService;
     }
 
     private DataValueService dataValueService;
 
-    public void setDataValueService( DataValueService dataValueService )
-    {
+    public void setDataValueService(DataValueService dataValueService) {
         this.dataValueService = dataValueService;
     }
 
     private DataSetService dataSetService;
 
-    public void setDataSetService( DataSetService dataSetService )
-    {
+    public void setDataSetService(DataSetService dataSetService) {
         this.dataSetService = dataSetService;
     }
 
     public DataElementService dataElementService;
 
-    public void setDataElementService( DataElementService dataElementService )
-    {
+    public void setDataElementService(DataElementService dataElementService) {
         this.dataElementService = dataElementService;
     }
 
     public JdbcTemplate jdbcTemplate;
 
-    public void setJdbcTemplate( JdbcTemplate jdbcTemplate )
-    {
+    public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {
         this.jdbcTemplate = jdbcTemplate;
     }
 
-    // ---------------------------------------------------------------------------------------
-    // Implementation
-    // ---------------------------------------------------------------------------------------
-
-    public Map<String, String> getDistrictFeedbackData( OrganisationUnit District, Date sDate, Date eDate,
-        String XmlFileName )
-    {
-        final String RA_FOLDER = System.getenv( "DHIS2_HOME" ) + File.separator
-            + configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue();
+    //---------------------------------------------------------------------------------------
+    //                                 Implementation
+    //---------------------------------------------------------------------------------------
+
+
+    public Map<String, String> getDistrictFeedbackData(OrganisationUnit District, Date sDate, Date eDate, String XmlFileName) {
+        final String RA_FOLDER = System.getenv("DHIS2_HOME") + File.separator + configurationService.getConfigurationByKey(Configuration_IN.KEY_REPORTFOLDER)
+                .getValue();
 
         String DistrictFeedBackXmlPath = RA_FOLDER + File.separator + XmlFileName;
 
-        Map<String, String> feedbackTemplateMap = new HashMap<String, String>();
-
-        try
-        {
+        Map<String,String> feedbackTemplateMap = new HashMap<String, String>();
+
+
+        try {
             DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
             DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
-            Document doc = docBuilder.parse( new File( DistrictFeedBackXmlPath ) );
-            if ( doc == null )
-            {
-                System.out.println( "District feedback XML file not found" );
+            Document doc = docBuilder.parse(new File(DistrictFeedBackXmlPath));
+            if (doc == null) {
+                System.out.println("District feedback XML file not found");
             }
 
-            NodeList excelFiles = doc.getElementsByTagName( "excel" );
+            NodeList excelFiles = doc.getElementsByTagName("excel");
             int numFile = excelFiles.getLength();
 
-            NodeList listOfDeFeed = doc.getElementsByTagName( "dfeed" );
+
+            NodeList listOfDeFeed = doc.getElementsByTagName("dfeed");
             int totalDeFeeds = listOfDeFeed.getLength();
 
-            List<OrganisationUnit> orgUnitList = new ArrayList<OrganisationUnit>( organisationUnitService
-                .getOrganisationUnitWithChildren( District.getId() ) );
-
-            for ( int s = 0; s < totalDeFeeds; s++ )
-            {
-                Element deFeedElement = (Element) listOfDeFeed.item( s );
-
-                int fCode = new Integer( deFeedElement.getAttribute( "fcode" ) );
-                int sheetNo = new Integer( deFeedElement.getAttribute( "sheetno" ) );
-                int rowNo = new Integer( deFeedElement.getAttribute( "rowno" ) );
-                int colNo = new Integer( deFeedElement.getAttribute( "colno" ) );
-                int dataSetID = new Integer( deFeedElement.getAttribute( "datasetid" ) );
-
-                if ( organisationUnitGroupService == null )
+            List<OrganisationUnit> orgUnitList = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren(District.getId()));
+
+            for (int s = 0; s < totalDeFeeds; s++) {
+                Element deFeedElement = (Element) listOfDeFeed.item(s);
+
+                int fCode = new Integer(deFeedElement.getAttribute("fcode"));
+                int sheetNo = new Integer(deFeedElement.getAttribute("sheetno"));
+                int rowNo = new Integer(deFeedElement.getAttribute("rowno"));
+                int colNo = new Integer(deFeedElement.getAttribute("colno"));
+                int dataSetID = new Integer(deFeedElement.getAttribute("datasetid"));
+
+                if (organisationUnitGroupService == null)
                 {
-                    System.out.println( "* ERROR !! OrganisationUnitGroupService is NULL" );
+                    System.out.println("* ERROR !! OrganisationUnitGroupService is NULL");
                 }
 
-                List<OrganisationUnit> orgUnitGroupList = new ArrayList<OrganisationUnit>( organisationUnitGroupService
-                    .getOrganisationUnitGroup( fCode ).getMembers() );
-
-                orgUnitGroupList.retainAll( orgUnitList );
-
-                Collection<Period> IntermediatePeriods = periodService.getPeriodsBetweenDates( sDate, eDate );
+                List<OrganisationUnit> orgUnitGroupList = new ArrayList<OrganisationUnit>(organisationUnitGroupService.getOrganisationUnitGroup(fCode).getMembers());
+
+                orgUnitGroupList.retainAll(orgUnitList);
+
+                Collection<Period> IntermediatePeriods = periodService.getPeriodsBetweenDates(sDate, eDate);
 
                 int totalMatchedFacilities = orgUnitGroupList.size();
 
@@ -161,228 +147,200 @@
 
                 int dataValueCount = 0;
 
-                for ( OrganisationUnit orgUnit : orgUnitGroupList )
-                {
-
-                    for ( Period period : IntermediatePeriods )
-                    {
-
-                        DataSet facilityDataSet = dataSetService.getDataSet( dataSetID );
+                for (OrganisationUnit orgUnit : orgUnitGroupList) {
+
+                    for (Period period : IntermediatePeriods) {
+
+                        DataSet facilityDataSet = dataSetService.getDataSet(dataSetID);
 
                         int expiryDays = facilityDataSet.getExpiryDays();
                         Calendar cal = Calendar.getInstance();
-                        cal.setTime( period.getStartDate() );
-                        cal.add( Calendar.DATE, expiryDays );
+                        cal.setTime(period.getStartDate());
+                        cal.add(Calendar.DATE, expiryDays);
                         Date expiryDate = cal.getTime();
 
-                        List<DataElement> dataElementList = new ArrayList<DataElement>( dataSetService
-                            .getDataElements( facilityDataSet ) );
-
-                        totalEntries = (dataElementList.size() * orgUnitGroupList.size());
-
-                        Collection<Integer> dataElementCollection = new ArrayList<Integer>( getIdentifiers(
-                            DataElement.class, dataElementList ) );
-
-                        String dataElementIdsByComma = getCommaDelimitedString( dataElementCollection );
-
-                        dataValueCount = jdbcTemplate.queryForInt(
-                            "SELECT COUNT(0) FROM datavalue WHERE dataelementid IN(?) AND periodid=? AND sourceid=?",
-                            new Object[] { new String( dataElementIdsByComma ), new Integer( period.getId() ),
-                                new Integer( orgUnit.getId() ) } );
-
-                        totalNonZero = jdbcTemplate
-                            .queryForInt(
-                                "SELECT COUNT(0) FROM datavalue WHERE dataelementid IN(?) AND periodid=? AND sourceid=? AND value>0 ",
-                                new Object[] { new String( dataElementIdsByComma ), new Integer( period.getId() ),
-                                    new Integer( orgUnit.getId() ) } );
-
-                        totalLate = jdbcTemplate
-                            .queryForInt(
-                                "SELECT COUNT(0) FROM datavalue WHERE dataelementid IN(?) AND periodid=? AND sourceid=? AND lastupdated>? ",
-                                new Object[] { new String( dataElementIdsByComma ), new Integer( period.getId() ),
-                                    new Integer( orgUnit.getId() ), (expiryDate) } );
+                        List<DataElement> dataElementList = new ArrayList<DataElement>(dataSetService.getDataElements(facilityDataSet));
+
+                        totalEntries = (dataElementList.size() * orgUnitGroupList.size()) ;
+
+                        Collection<Integer> dataElementCollection = new ArrayList<Integer>(getIdentifiers(DataElement.class, dataElementList));
+
+                        String dataElementIdsByComma = getCommaDelimitedString(dataElementCollection);
+
+                        dataValueCount = jdbcTemplate.queryForInt("SELECT COUNT(0) FROM datavalue WHERE dataelementid IN(?) AND periodid=? AND sourceid=?", new Object[]{new String(dataElementIdsByComma), new Integer(period.getId()), new Integer(orgUnit.getId())});
+
+                        totalNonZero = jdbcTemplate.queryForInt("SELECT COUNT(0) FROM datavalue WHERE dataelementid IN(?) AND periodid=? AND sourceid=? AND value>0 ", new Object[]{new String(dataElementIdsByComma), new Integer(period.getId()), new Integer(orgUnit.getId())});
+
+                        totalLate = jdbcTemplate.queryForInt("SELECT COUNT(0) FROM datavalue WHERE dataelementid IN(?) AND periodid=? AND sourceid=? AND lastupdated>? ", new Object[]{new String(dataElementIdsByComma), new Integer(period.getId()), new Integer(orgUnit.getId()), (expiryDate)});
 
                     }
 
-                    if ( dataValueCount > 0 )
+                    if (dataValueCount>0)
                     {
                         ++totalReported;
                     }
 
                 }
 
-                totalNonZero = (totalNonZero / IntermediatePeriods.size());
-
-                for ( int iNum = 1; iNum <= 9; ++iNum )
-                {
-                    if ( iNum == 1 )
-                    {
+
+
+                totalNonZero = (totalNonZero/IntermediatePeriods.size());
+
+                for (int iNum = 1; iNum <= 9; ++iNum) {
+                    if (iNum == 1) {
                         int tempColNo = colNo + 1;
                         int tempRowNo = rowNo;
-                        String tempStr = String.valueOf( totalMatchedFacilities );
-
-                        String cellPos = String.valueOf( tempColNo ) + ":" + String.valueOf( tempRowNo );
-
-                        feedbackTemplateMap.put( cellPos, tempStr );
+                        String tempStr = String.valueOf(totalMatchedFacilities);
+
+                        String cellPos = String.valueOf(tempColNo)+":"+String.valueOf(tempRowNo);
+
+                        feedbackTemplateMap.put(cellPos,tempStr);
 
                     }
-                    if ( iNum == 2 )
-                    {
+                    if (iNum == 2) {
                         int tempColNo = colNo + 3;
                         int tempRowNo = rowNo;
-                        String tempStr = String.valueOf( (totalMatchedFacilities - totalReported) );
-
-                        String cellPos = String.valueOf( tempColNo ) + ":" + String.valueOf( tempRowNo );
-
-                        feedbackTemplateMap.put( cellPos, tempStr );
+                        String tempStr = String.valueOf((totalMatchedFacilities - totalReported));
+
+                        String cellPos = String.valueOf(tempColNo)+":"+String.valueOf(tempRowNo);
+
+                        feedbackTemplateMap.put(cellPos,tempStr);
 
                     }
-                    if ( iNum == 3 )
-                    {
+                    if (iNum == 3) {
                         int tempColNo = colNo + 5;
                         int tempRowNo = rowNo;
                         String tempStr;
-                        if ( totalMatchedFacilities > 0 )
+                        if (totalMatchedFacilities > 0)
                         {
-                            tempStr = String.valueOf( Math.round( ((totalReported) * 100) / totalMatchedFacilities ) )
-                                + " %";
+                            tempStr = String.valueOf(Math.round(((totalReported) * 100) / totalMatchedFacilities)) + " %";
                         }
                         else
                         {
                             tempStr = "0 %";
                         }
 
-                        String cellPos = String.valueOf( tempColNo ) + ":" + String.valueOf( tempRowNo );
-
-                        feedbackTemplateMap.put( cellPos, tempStr );
+                        String cellPos = String.valueOf(tempColNo)+":"+String.valueOf(tempRowNo);
+
+                        feedbackTemplateMap.put(cellPos,tempStr);
+
 
                     }
-                    if ( iNum == 4 )
-                    {
+                    if (iNum == 4) {
                         int tempColNo = colNo + 1;
                         int tempRowNo = rowNo + 10;
                         String tempStr;
 
-                        if ( totalEntries > 0 )
+                        if (totalEntries > 0)
                         {
-                            tempStr = String
-                                .valueOf( Math.round( ((totalEntries - totalNonZero) * 100) / totalEntries ) )
-                                + " %";
+                            tempStr = String.valueOf(Math.round(((totalEntries - totalNonZero) * 100) / totalEntries)) + " %";
                         }
                         else
                         {
                             tempStr = "0 %";
                         }
 
-                        String cellPos = String.valueOf( tempColNo ) + ":" + String.valueOf( tempRowNo );
+                        String cellPos = String.valueOf(tempColNo)+":"+String.valueOf(tempRowNo);
 
-                        feedbackTemplateMap.put( cellPos, tempStr );
+                        feedbackTemplateMap.put(cellPos,tempStr);
 
                     }
-                    if ( iNum == 5 )
-                    {
+                    if (iNum == 5) {
                         int tempColNo = colNo + 4;
                         int tempRowNo = rowNo + 10;
                         String tempStr;
-                        if ( totalEntries > 0 )
+                        if (totalEntries > 0)
                         {
-                            tempStr = String.valueOf( Math.round( ((totalNonZero * 100) / totalEntries) ) ) + " %";
+                            tempStr = String.valueOf(Math.round(((totalNonZero * 100) / totalEntries))) + " %";
                         }
                         else
                         {
                             tempStr = "0 %";
                         }
 
-                        String cellPos = String.valueOf( tempColNo ) + ":" + String.valueOf( tempRowNo );
-
-                        feedbackTemplateMap.put( cellPos, tempStr );
+                        String cellPos = String.valueOf(tempColNo)+":"+String.valueOf(tempRowNo);
+
+                        feedbackTemplateMap.put(cellPos,tempStr);
+
 
                     }
-                    if ( iNum == 6 )
-                    {
+                    if (iNum == 6) {
                         int tempColNo = colNo + 1;
                         int tempRowNo = rowNo + 20;
-                        String tempStr = String.valueOf( totalMatchedFacilities - totalLate );
-
-                        String cellPos = String.valueOf( tempColNo ) + ":" + String.valueOf( tempRowNo );
-
-                        feedbackTemplateMap.put( cellPos, tempStr );
+                        String tempStr = String.valueOf(totalMatchedFacilities - totalLate);
+
+                        String cellPos = String.valueOf(tempColNo)+":"+String.valueOf(tempRowNo);
+
+                        feedbackTemplateMap.put(cellPos,tempStr);
 
                     }
-                    if ( iNum == 7 )
-                    {
+                    if (iNum == 7) {
                         int tempColNo = colNo + 3;
                         int tempRowNo = rowNo + 20;
                         String tempStr;
-                        if ( totalMatchedFacilities > 0 )
+                        if (totalMatchedFacilities > 0)
                         {
-                            tempStr = String.valueOf( Math.round( ((totalMatchedFacilities - totalLate) * 100)
-                                / totalMatchedFacilities ) )
-                                + " %";
+                            tempStr = String.valueOf(Math.round(((totalMatchedFacilities - totalLate) * 100) / totalMatchedFacilities)) + " %";
                         }
                         else
                         {
                             tempStr = "0 %";
                         }
 
-                        String cellPos = String.valueOf( tempColNo ) + ":" + String.valueOf( tempRowNo );
-
-                        feedbackTemplateMap.put( cellPos, tempStr );
+                        String cellPos = String.valueOf(tempColNo)+":"+String.valueOf(tempRowNo);
+
+                        feedbackTemplateMap.put(cellPos,tempStr);
+
 
                     }
-                    if ( iNum == 8 )
+                    if (iNum == 8)
                     {
                         int tempColNo = colNo + 4;
                         int tempRowNo = rowNo + 20;
 
-                        String tempStr = String.valueOf( totalLate );
-
-                        String cellPos = String.valueOf( tempColNo ) + ":" + String.valueOf( tempRowNo );
-
-                        feedbackTemplateMap.put( cellPos, tempStr );
+                        String tempStr = String.valueOf(totalLate);
+
+                        String cellPos = String.valueOf(tempColNo)+":"+String.valueOf(tempRowNo);
+
+                        feedbackTemplateMap.put(cellPos,tempStr);
+
 
                     }
-                    if ( iNum == 9 )
-                    {
+                    if (iNum == 9) {
                         int tempColNo = colNo + 6;
                         int tempRowNo = rowNo + 20;
                         String tempStr;
-                        if ( totalMatchedFacilities > 0 )
+                        if (totalMatchedFacilities > 0)
                         {
-                            tempStr = String.valueOf( Math.round( ((totalLate) * 100) / totalMatchedFacilities ) )
-                                + " %";
+                            tempStr = String.valueOf(Math.round(((totalLate) * 100) / totalMatchedFacilities)) + " %";
                         }
                         else
                         {
                             tempStr = "0 %";
                         }
 
-                        String cellPos = String.valueOf( tempColNo ) + ":" + String.valueOf( tempRowNo );
+                        String cellPos = String.valueOf(tempColNo)+":"+String.valueOf(tempRowNo);
 
-                        feedbackTemplateMap.put( cellPos, tempStr );
+                        feedbackTemplateMap.put(cellPos,tempStr);
                     }
 
                 }
 
             }
 
-        }
-        catch ( SAXParseException err )
-        {
-            System.out.println( "** Parsing error" + ", line " + err.getLineNumber() + ", uri " + err.getSystemId() );
-            System.out.println( " " + err.getMessage() );
-        }
-        catch ( SAXException e )
-        {
+        } catch (SAXParseException err) {
+            System.out.println("** Parsing error" + ", line " + err.getLineNumber() + ", uri " + err.getSystemId());
+            System.out.println(" " + err.getMessage());
+        } catch (SAXException e) {
             Exception x = e.getException();
             ((x == null) ? e : x).printStackTrace();
-        }
-        catch ( Throwable t )
-        {
+        } catch (Throwable t) {
             t.printStackTrace();
         }
 
+
         return feedbackTemplateMap;
     }
 
+
 }
\ No newline at end of file

=== modified file 'local/in/dhis-in-services/dhis-in-service-reports/src/main/java/org/hisp/dhis/reports/hibernate/HibernateReportStore.java'
--- local/in/dhis-in-services/dhis-in-service-reports/src/main/java/org/hisp/dhis/reports/hibernate/HibernateReportStore.java	2011-04-27 17:15:13 +0000
+++ local/in/dhis-in-services/dhis-in-service-reports/src/main/java/org/hisp/dhis/reports/hibernate/HibernateReportStore.java	2014-07-04 10:26:29 +0000
@@ -3,10 +3,16 @@
 import java.util.Collection;
 
 import org.hibernate.Criteria;
+import org.hibernate.Query;
 import org.hibernate.Session;
 import org.hibernate.SessionFactory;
 import org.hibernate.criterion.Restrictions;
+import org.hisp.dhis.dataelement.DataElement;
+import org.hisp.dhis.dataelement.DataElementCategoryOptionCombo;
+import org.hisp.dhis.dataset.DataSet;
+import org.hisp.dhis.datavalue.DataValue;
 import org.hisp.dhis.organisationunit.OrganisationUnit;
+import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodStore;
 import org.hisp.dhis.period.PeriodType;
 import org.hisp.dhis.reports.ReportStore;
@@ -164,4 +170,94 @@
 
         return criteria.list();
     }
-}
+	
+    /*
+    @SuppressWarnings( "unchecked" )
+    public Collection<Patient> getPatientByOrgUnit( OrganisationUnit organisationUnit )
+    {
+        Session session = sessionFactory.getCurrentSession();
+        
+        Criteria criteria = session.createCriteria( Patient.class );
+        
+        criteria.add( Restrictions.eq( "organisationUnit", organisationUnit ) );
+        
+        return criteria.list();
+        
+       
+    }
+    */
+    
+    /*
+    String hql = "select p from Patient p where p.organisationUnit = :organisationUnit order by p.id DESC";
+
+    Query query = getQuery( hql );
+    query.setEntity( "organisationUnit", organisationUnit );
+
+    if ( min != null && max != null )
+    {
+        query.setFirstResult( min ).setMaxResults( max );
+    }
+    return query.list();
+    */
+    
+    
+    
+    /*
+    @SuppressWarnings( "unchecked" )
+    public Collection<Patient> getPatientByOrgUnitAndProgram( OrganisationUnit organisationUnit, Program program )
+    {
+        Session session = sessionFactory.getCurrentSession();
+        
+        Criteria criteria = session.createCriteria( Patient.class );
+        criteria.add( Restrictions.eq( "organisationUnit", organisationUnit ) );
+        
+        criteria.createAlias( "programs", "program" );
+        
+        criteria.add(Restrictions.eq( "program.id", program.getId() ) );
+        
+        //criteria.addOrder( Order.desc( "id" ) );
+        
+        return criteria.list();
+        
+        //Criteria criteria = getCriteria( Restrictions.eq( "organisationUnit", organisationUnit ) ).createAlias( "programs", "program" ).add( Restrictions.eq( "program.id", program.getId() ) );
+
+    }    
+    */
+    
+    // Get Data value for Latest Period
+    public DataValue getLatestDataValue( DataElement dataElement, DataElementCategoryOptionCombo optionCombo, OrganisationUnit organisationUnit )
+    {
+        final String hsql = "SELECT v FROM DataValue v, Period p WHERE  v.dataElement =:dataElement "
+            + " AND v.period=p AND v.optionCombo=:optionCombo AND v.source=:source ORDER BY p.endDate DESC";
+
+        Session session = sessionFactory.getCurrentSession();
+
+        Query query = session.createQuery( hsql );
+
+        query.setParameter( "dataElement", dataElement );
+        query.setParameter( "optionCombo", optionCombo );
+        query.setParameter( "source", organisationUnit );
+        
+        query.setFirstResult( 0 );
+        query.setMaxResults( 1 );
+
+        return (DataValue) query.uniqueResult();
+    }
+
+    // Methods for delete Lock Exception
+    public void deleteLockException( DataSet dataSet, Period period, OrganisationUnit organisationUnit )
+    {
+        final String hql = "delete from LockException where dataSet=:dataSet and period=:period and organisationUnit=:organisationUnit";
+        
+        Session session = sessionFactory.getCurrentSession();
+        Query query = session.createQuery( hql );
+        
+        //Query query = getQuery( hql );
+        query.setParameter( "dataSet", dataSet );
+        query.setParameter( "period", period );
+        query.setParameter( "organisationUnit", organisationUnit );
+
+        query.executeUpdate();
+    }    
+    
+}
\ No newline at end of file

=== modified file 'local/in/dhis-in-services/dhis-in-service-reports/src/main/resources/META-INF/dhis/beans.xml'
--- local/in/dhis-in-services/dhis-in-service-reports/src/main/resources/META-INF/dhis/beans.xml	2012-07-26 09:20:56 +0000
+++ local/in/dhis-in-services/dhis-in-service-reports/src/main/resources/META-INF/dhis/beans.xml	2013-09-19 06:34:31 +0000
@@ -4,8 +4,8 @@
 	xsi:schemaLocation="
 http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">
 
-	<!-- State District Feedback Report Service -->
-   <bean id="org.hisp.dhis.reports.StateDistrictFeedbackReportService"
+
+    <bean id="org.hisp.dhis.reports.StateDistrictFeedbackReportService"
           class="org.hisp.dhis.reports.DefaultStateDistrictFeedbackReportService">
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
         <property name="organisationUnitGroupService" ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService" />
@@ -16,8 +16,7 @@
         <property name="dataSetService" ref="org.hisp.dhis.dataset.DataSetService" />
         <property name="jdbcTemplate" ref="jdbcTemplate"/>
     </bean>
-	
-	<!-- Report Org Specific Data Service -->
+
     <bean id="org.hisp.dhis.reports.ReportOrgSpecificDataService"
           class="org.hisp.dhis.reports.DefaultReportOrgSpecificDataService">
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
@@ -28,8 +27,10 @@
         <property name="dataSetService" ref="org.hisp.dhis.dataset.DataSetService" />
         <property name="jdbcTemplate" ref="jdbcTemplate"/>
         <property name="databaseInfoProvider" ref="databaseInfoProvider" />
-    </bean>	
-		
+    </bean>
+
+
+	
 	<!-- Store definitions -->
 	
 	<bean id="org.hisp.dhis.reports.ReportStore"
@@ -41,8 +42,9 @@
 	<!-- Service definitions -->
 	
 	<bean id="org.hisp.dhis.reports.ReportService"
-		class="org.hisp.dhis.reports.DefaultReportService">
+		class="org.hisp.dhis.reports.DefaultReportService">		
 		<property name="reportStore" ref="org.hisp.dhis.reports.ReportStore"/>
+		<property name="expressionService" ref="org.hisp.dhis.expression.ExpressionService"/>
 		<property name="configurationService" ref="org.hisp.dhis.config.ConfigurationService"/>
 		<property name="jdbcTemplate" ref="jdbcTemplate"/>
 		<property name="periodService" ref="org.hisp.dhis.period.PeriodService"/>
@@ -57,18 +59,9 @@
 		<property name="aggregatedDataValueService" ref="org.hisp.dhis.aggregation.AggregatedDataValueService" />
 		<property name="databaseInfoProvider" ref="databaseInfoProvider" />
 		<property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
+		<property name="programService" ref="org.hisp.dhis.program.ProgramService" />
 	</bean>
-
-
-    <bean id="org.hisp.dhis.reports.GlobalConfigService"
-          class="org.hisp.dhis.reports.DefaultGlobalConfigService">
-        <property name="dataElementService" ref="org.hisp.dhis.dataelement.DataElementService" />
-        <property name="dataElementCategoryService" ref="org.hisp.dhis.dataelement.DataElementCategoryService" />
-        <property name="configurationService" ref="org.hisp.dhis.config.ConfigurationService"/>
-    </bean>
-
-
-
+	
 	<!-- DeletionHandlers -->
 	<bean id="org.hisp.dhis.reports.Report_inDeletionHandler"
 		class="org.hisp.dhis.reports.Report_inDeletionHandler">

=== modified file 'local/in/dhis-in-services/dhis-in-service-reports/src/main/resources/org/hisp/dhis/reports/hibernate/Reports.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-reports/src/main/resources/org/hisp/dhis/reports/hibernate/Reports.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-reports/src/main/resources/org/hisp/dhis/reports/hibernate/Reports.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   <class name="org.hisp.dhis.reports.Report_in" table="reportin">

=== modified file 'local/in/dhis-in-services/dhis-in-service-scheduler/pom.xml'
--- local/in/dhis-in-services/dhis-in-service-scheduler/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-in-services/dhis-in-service-scheduler/pom.xml	2013-11-20 05:15:27 +0000
@@ -6,7 +6,7 @@
   <parent>
     <groupId>org.hisp.dhis</groupId>
     <artifactId>dhis-in-services</artifactId>
-    <version>2.15-SNAPSHOT</version>
+    <version>2.13</version>
   </parent>
   
   <artifactId>dhis-in-service-scheduler</artifactId>

=== modified file 'local/in/dhis-in-services/dhis-in-service-survey/pom.xml'
--- local/in/dhis-in-services/dhis-in-service-survey/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-in-services/dhis-in-service-survey/pom.xml	2014-07-03 10:20:40 +0000
@@ -6,7 +6,7 @@
 	<parent>
 		<groupId>org.hisp.dhis</groupId>
 		<artifactId>dhis-in-services</artifactId>
-		<version>2.15-SNAPSHOT</version>
+		<version>2.15</version>
 	</parent>
 	
 	<artifactId>dhis-in-service-survey</artifactId>

=== modified file 'local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/detarget/hibernate/DeTarget.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/detarget/hibernate/DeTarget.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/detarget/hibernate/DeTarget.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   

=== modified file 'local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/detarget/hibernate/DeTargetDataValue.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/detarget/hibernate/DeTargetDataValue.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/detarget/hibernate/DeTargetDataValue.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   <class name="org.hisp.dhis.detargetdatavalue.DeTargetDataValue" table="detargetdatavalue">

=== modified file 'local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/detarget/hibernate/DeTargetMember.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/detarget/hibernate/DeTargetMember.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/detarget/hibernate/DeTargetMember.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   

=== modified file 'local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/survey/hibernate/Survey.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/survey/hibernate/Survey.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/survey/hibernate/Survey.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   

=== modified file 'local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/survey/hibernate/SurveyDataValue.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/survey/hibernate/SurveyDataValue.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/survey/hibernate/SurveyDataValue.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   <class name="org.hisp.dhis.surveydatavalue.SurveyDataValue" table="surveydatavalue">

=== modified file 'local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/target/hibernate/TargetMapping.hbm.xml'
--- local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/target/hibernate/TargetMapping.hbm.xml	2012-04-17 11:59:19 +0000
+++ local/in/dhis-in-services/dhis-in-service-survey/src/main/resources/org/hisp/dhis/target/hibernate/TargetMapping.hbm.xml	2013-09-19 06:34:31 +0000
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <!DOCTYPE hibernate-mapping PUBLIC
- "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
- "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
+  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
+  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
 <hibernate-mapping>
   

=== modified file 'local/in/dhis-in-services/dhis-service-aggregationengine/pom.xml'
--- local/in/dhis-in-services/dhis-service-aggregationengine/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-in-services/dhis-service-aggregationengine/pom.xml	2014-07-03 12:32:35 +0000
@@ -6,7 +6,7 @@
   <parent>
     <groupId>org.hisp.dhis</groupId>
     <artifactId>dhis-services</artifactId>
-    <version>2.15-SNAPSHOT</version>
+    <version>2.15</version>
   </parent>
   
   <artifactId>dhis-service-aggregationengine-default</artifactId>
@@ -27,12 +27,12 @@
     </dependency>
     
     <!-- Other -->
-    
+    <!--
     <dependency>
       <groupId>jep</groupId>
       <artifactId>jep</artifactId>
     </dependency>    
-    
+    -->
   </dependencies>
   <properties>
     <rootDir>../../</rootDir>

=== modified file 'local/in/dhis-in-services/dhis-service-aggregationengine/src/main/java/org/hisp/dhis/aggregation/impl/indicator/IndicatorAggregation.java'
--- local/in/dhis-in-services/dhis-service-aggregationengine/src/main/java/org/hisp/dhis/aggregation/impl/indicator/IndicatorAggregation.java	2013-08-23 16:05:01 +0000
+++ local/in/dhis-in-services/dhis-service-aggregationengine/src/main/java/org/hisp/dhis/aggregation/impl/indicator/IndicatorAggregation.java	2014-07-04 10:24:31 +0000
@@ -150,6 +150,8 @@
     {
         Map<String, Double> constantMap = constantService.getConstantMap();
         
+        Map<String, Integer> constantMap1 = new HashMap<String, Integer>();
+        
         Set<DataElementOperand> operands = expressionService.getOperandsInExpression( expression );
         
         Map<DataElementOperand, Double> valueMap = new HashMap<DataElementOperand, Double>();
@@ -162,6 +164,8 @@
             valueMap.put( operand, aggregationCache.getAggregatedDataValue( dataElement, optionCombo, startDate, endDate, organisationUnit ) );            
         }
         
-        return expressionService.generateExpression( expression, valueMap, constantMap, null, false );
+        return expressionService.generateExpression( expression, valueMap, constantMap, constantMap1, null, false );
+        
+        //return expressionService.generateExpression( expression, valueMap, constantMap, null, false );
     }
 }

=== modified file 'local/in/dhis-in-services/pom.xml'
--- local/in/dhis-in-services/pom.xml	2014-06-02 09:44:51 +0000
+++ local/in/dhis-in-services/pom.xml	2014-07-03 09:52:47 +0000
@@ -14,19 +14,17 @@
   <name>DHIS India Services Parent Project</name>
   
   <modules>
-	<!--
+	
+ 	<module>dhis-in-service-configuration</module>
     <module>dhis-in-service-dbmanager</module>
 	<module>dhis-in-service-linelisting</module> 
 	<module>dhis-in-service-reports</module>
     <module>dhis-in-service-survey</module>
 	<module>dhis-in-service-dataentrystatus</module>
-	<module>dhis-in-service-coldchain</module>
-	<module>dhis-in-service-lookup</module>
-
-	-->
-
+	<module>dhis-service-aggregationengine</module>
 	<!--<module>dhis-service-aggregationengine-default</module> -->
-		<module>dhis-in-service-configuration</module>
+
+	
   </modules>
   
   <dependencies>

=== modified file 'local/in/dhis-web-alert/pom.xml'
--- local/in/dhis-web-alert/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-web-alert/pom.xml	2014-07-04 12:38:58 +0000
@@ -6,7 +6,7 @@
 	<parent>
 		<groupId>org.hisp.dhis</groupId>
 		<artifactId>dhis-web</artifactId>
-		<version>2.15-SNAPSHOT</version>
+		<version>2.15</version>
 	</parent>
 	
 	<artifactId>dhis-web-alert</artifactId>
@@ -31,13 +31,13 @@
             <groupId>org.hisp.dhis</groupId>
             <artifactId>dhis-service-core</artifactId>
         </dependency>
-		
+		<!-- 
         <dependency>
             <groupId>org.hisp.dhis</groupId>
             <artifactId>dhis-service-patient</artifactId>
             <version>${project.version}</version>
         </dependency>
-		
+		-->
         <dependency>
             <groupId>org.hisp.dhis</groupId>
             <artifactId>dhis-web-commons</artifactId>
@@ -104,6 +104,7 @@
         <dependency>
             <groupId>jfree</groupId>
             <artifactId>jfreechart</artifactId>
+			<version>1.0.13</version>
         </dependency>
 		
         <dependency>
@@ -115,6 +116,7 @@
         <dependency>
             <groupId>jfree</groupId>
             <artifactId>jcommon</artifactId>
+			<version>1.0.13</version>
         </dependency>
 		
         <dependency>

=== modified file 'local/in/dhis-web-alert/src/main/java/org/hisp/dhis/alert/idsp/action/IDSPOutbreakAction.java'
--- local/in/dhis-web-alert/src/main/java/org/hisp/dhis/alert/idsp/action/IDSPOutbreakAction.java	2012-06-06 09:55:27 +0000
+++ local/in/dhis-web-alert/src/main/java/org/hisp/dhis/alert/idsp/action/IDSPOutbreakAction.java	2013-09-19 06:34:31 +0000
@@ -74,13 +74,6 @@
     // Dependencies
     // ---------------------------------------------------------------
 
-    private StatementManager statementManager;
-
-    public void setStatementManager( StatementManager statementManager )
-    {
-        this.statementManager = statementManager;
-    }
-
     private OrganisationUnitService organisationUnitService;
 
     public void setOrganisationUnitService( OrganisationUnitService organisationUnitService )
@@ -263,8 +256,7 @@
         int idspFlag = 0;
         if ( currentUserService.getCurrentUser().getId() != 0 )
         {
-            UserCredentials userCredentials = userService.getUserCredentialsByUsername( currentUserService
-                .getCurrentUsername() );
+            UserCredentials userCredentials = userService.getUserCredentialsByUsername( currentUserService.getCurrentUsername() );
 
             for ( UserAuthorityGroup userAuthorityGroup : userCredentials.getUserAuthorityGroups() )
             {
@@ -312,10 +304,8 @@
 
             if ( drillDownOrgUnitId != null )
             {
-                rootOrgUnitList.add( organisationUnitService
-                    .getOrganisationUnit( Integer.parseInt( drillDownOrgUnitId ) ) );
-                List<OrganisationUnit> orgUnitBrach = new ArrayList<OrganisationUnit>( organisationUnitService
-                    .getOrganisationUnitBranch( Integer.parseInt( drillDownOrgUnitId ) ) );
+                rootOrgUnitList.add( organisationUnitService.getOrganisationUnit( Integer.parseInt( drillDownOrgUnitId ) ) );
+                List<OrganisationUnit> orgUnitBrach = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitBranch( Integer.parseInt( drillDownOrgUnitId ) ) );
                 int flag = 1;
                 for ( OrganisationUnit orgUnit : orgUnitBrach )
                 {
@@ -345,20 +335,26 @@
 
                 for ( OrganisationUnit ou : tempOuList )
                 {
-                    List<OrganisationUnit> childTree = new ArrayList<OrganisationUnit>( organisationUnitService
-                        .getOrganisationUnitWithChildren( ou.getId() ) );
-                    String orgUnitIdsByComma1 = getCommaDelimitedString( getIdentifiers( OrganisationUnit.class,
-                        childTree ) );
-                    List<OrganisationUnit> orgUnitGroupMembers = new ArrayList<OrganisationUnit>( orgUnitGroup
-                        .getMembers() );
+                    List<OrganisationUnit> childTree = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( ou.getId() ) );
+                    String orgUnitIdsByComma1 = getCommaDelimitedString( getIdentifiers( OrganisationUnit.class, childTree ) );
+                    
+                    List<OrganisationUnit> orgUnitGroupMembers = new ArrayList<OrganisationUnit>( orgUnitGroup.getMembers() );
                     childTree.retainAll( orgUnitGroupMembers );
-                    String orgUnitIdsByComma = getCommaDelimitedString( getIdentifiers( OrganisationUnit.class,
-                        childTree ) );
-
-                    int populationData = alertUtility.getAggregatedData( orgUnitIdsByComma1, populationDeId,
-                        populationPeriodId );
-
-                    int confirmedCount = alertUtility.getConfirmedCount( orgUnitIdsByComma, dataSetId, periodId );
+                    String orgUnitIdsByComma = getCommaDelimitedString( getIdentifiers( OrganisationUnit.class, childTree ) );
+
+                    int populationData = 0;
+                    int confirmedCount = 0;
+                    
+                    if( orgUnitIdsByComma1 != null && !orgUnitIdsByComma1.trim().equals("") )
+                    {
+                    	populationData = alertUtility.getAggregatedData( orgUnitIdsByComma1, populationDeId, populationPeriodId );
+                    }
+
+                    if( orgUnitIdsByComma != null && !orgUnitIdsByComma.trim().equals("") )
+                    {
+                    	confirmedCount = alertUtility.getConfirmedCount( orgUnitIdsByComma, dataSetId, periodId );
+                    }
+                    
                     int totalSubcentreCount = childTree.size();
                     // System.out.println(confirmedCount + " : " +
                     // totalSubcentreCount );
@@ -370,9 +366,17 @@
                         String deathId = norm.split( "@:@" )[2];
                         String normName = norm.split( "@:@" )[3];
 
-                        int caseData = alertUtility.getAggregatedData( orgUnitIdsByComma, caseId, periodId );
-
-                        int deathData = alertUtility.getAggregatedData( orgUnitIdsByComma, deathId, periodId );
+                        int caseData = 0;
+                        int deathData = 0;
+                        
+                        if( orgUnitIdsByComma != null && !orgUnitIdsByComma.trim().equals("") )
+                        {
+                        	caseData = alertUtility.getAggregatedData( orgUnitIdsByComma, caseId, periodId );
+                        }
+                        if( orgUnitIdsByComma != null && !orgUnitIdsByComma.trim().equals("") )
+                        {
+                        	deathData = alertUtility.getAggregatedData( orgUnitIdsByComma, deathId, periodId );
+                        }
 
                         if ( deathData >= 1 )
                         {
@@ -393,6 +397,7 @@
                             long maxLimit = Math.round( (populationData / 1000.0) * 5 );
                             outBreakAlertMap.put( normName + ":" + ou.getId(), caseData + " Cases" );
 
+							//System.out.println( minLimit + " :  " + maxLimit + " : " + populationData );
                             if ( confirmedCount != totalSubcentreCount )
                             {
                                 outBreakAlertColorMap.put( normName + ":" + ou.getId(), "PINK" );

=== modified file 'local/in/dhis-web-alert/src/main/java/org/hisp/dhis/alert/tdb/action/GetPatientDataRecordsAction.java'
--- local/in/dhis-web-alert/src/main/java/org/hisp/dhis/alert/tdb/action/GetPatientDataRecordsAction.java	2012-06-13 06:35:38 +0000
+++ local/in/dhis-web-alert/src/main/java/org/hisp/dhis/alert/tdb/action/GetPatientDataRecordsAction.java	2014-07-04 12:43:13 +0000
@@ -27,31 +27,10 @@
  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */
 
-import java.text.SimpleDateFormat;
-import java.util.ArrayList;
-import java.util.Collection;
-import java.util.Collections;
-import java.util.HashMap;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Map;
-
-import org.hisp.dhis.organisationunit.OrganisationUnit;
-import org.hisp.dhis.organisationunit.OrganisationUnitService;
 import org.hisp.dhis.paging.ActionPagingSupport;
-import org.hisp.dhis.patient.Patient;
-import org.hisp.dhis.patient.PatientAttribute;
-import org.hisp.dhis.patient.PatientAttributeService;
-import org.hisp.dhis.patient.PatientService;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValue;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValueService;
-import org.hisp.dhis.program.Program;
-import org.hisp.dhis.program.ProgramInstance;
-import org.hisp.dhis.program.ProgramInstanceService;
-import org.hisp.dhis.program.ProgramService;
-import org.hisp.dhis.program.ProgramStageInstance;
-import org.hisp.dhis.program.ProgramStageInstanceService;
-import org.hisp.dhis.program.comparator.ProgramStageInstanceComparator;
+//import org.hisp.dhis.program.comparator.ProgramStageInstanceComparator;
+
+import com.opensymphony.xwork2.Action;
 
 /**
  * @author Samta Bajpai
@@ -59,13 +38,13 @@
  * @version TrackerDashBoardAction.java May 28, 2012 12:45 PM
  */
 
-public class GetPatientDataRecordsAction
-    extends ActionPagingSupport<Patient>
+public class GetPatientDataRecordsAction implements Action
 {
+    //extends ActionPagingSupport<Patient>
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-
+    /*
     private OrganisationUnitService organisationUnitService;
 
     public void setOrganisationUnitService( OrganisationUnitService organisationUnitService )
@@ -114,11 +93,12 @@
     {
         this.patientAttributeValueService = patientAttributeValueService;
     }
-
+    */
+    
     // -------------------------------------------------------------------------
     // Input/output
     // -------------------------------------------------------------------------
-
+    /*
     private Integer sortPatientAttributeId;
 
     public void setSortPatientAttributeId( Integer sortPatientAttributeId )
@@ -219,7 +199,8 @@
     {
         return program;
     }
-
+    */
+    
     // -------------------------------------------------------------------------
     // Implementation Action
     // -------------------------------------------------------------------------
@@ -227,10 +208,10 @@
     public String execute()
         throws Exception
     {
-
-        OrganisationUnit organisationUnit = organisationUnitService.getOrganisationUnit( orgUnitId );
-
-        program = programService.getProgram( programId );
+        
+        //OrganisationUnit organisationUnit = organisationUnitService.getOrganisationUnit( orgUnitId );
+
+        //program = programService.getProgram( programId );
 
         // sortPatientAttribute = patientAttributeService.getPatientAttribute(
         // sortPatientAttributeId );
@@ -239,16 +220,16 @@
         // Program instances for the selected program
         // ---------------------------------------------------------------------
 
-        Collection<ProgramStageInstance> programStageInstances = new ArrayList<ProgramStageInstance>();
-
-        total = patientService.countGetPatientsByOrgUnitProgram( organisationUnit, program );
-
-        this.paging = createPaging( total );
+        //Collection<ProgramStageInstance> programStageInstances = new ArrayList<ProgramStageInstance>();
+
+        //total = patientService.countGetPatientsByOrgUnitProgram( organisationUnit, program );
+
+        //this.paging = createPaging( total );
 
         // patientListByOrgUnit = new ArrayList<Patient>(
         // patientService.getPatients( organisationUnit, program, paging
         // .getStartPos(), paging.getPageSize() ) );
-
+        /*
         patientListByOrgUnit = new ArrayList<Patient>( patientService.getPatients( organisationUnit, program, paging
             .getStartPos(), total ) );
 
@@ -267,12 +248,13 @@
                 }
             }
         }
-
+    */
+        /*
         for ( Patient patient : patientListByOrgUnit )
         {
-            Collection<ProgramInstance> _programInstances = programInstanceService.getProgramInstances( patient,
-                program, false );
-
+            //Collection<ProgramInstance> _programInstances = programInstanceService.getProgramInstances( patient,
+            //    program, false );
+			Collection<ProgramInstance> _programInstances = null;
             if ( _programInstances == null || _programInstances.size() == 0 )
             {
                 programInstanceMap.put( patient, null );
@@ -292,14 +274,15 @@
 
                     List<ProgramStageInstance> programStageInstanceList = new ArrayList<ProgramStageInstance>(
                         programInstance.getProgramStageInstances() );
-                    Collections.sort( programStageInstanceList, new ProgramStageInstanceComparator() );
+                    //Collections.sort( programStageInstanceList, new ProgramStageInstanceComparator() );
 
                     programStageInstanceMap.put( programInstance, programStageInstanceList );
                     programStageInstances.addAll( programStageInstanceList );
                 }
             }
         }
-
+    */
+        
         // ---------------------------------------------------------------------
         // Sorting PatientList by selected Patient Attribute
         // ---------------------------------------------------------------------

=== modified file 'local/in/dhis-web-alert/src/main/java/org/hisp/dhis/alert/tdb/action/GetPatientDetailsAction.java'
--- local/in/dhis-web-alert/src/main/java/org/hisp/dhis/alert/tdb/action/GetPatientDetailsAction.java	2012-06-02 08:51:09 +0000
+++ local/in/dhis-web-alert/src/main/java/org/hisp/dhis/alert/tdb/action/GetPatientDetailsAction.java	2014-07-04 12:40:43 +0000
@@ -27,20 +27,6 @@
  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */
 
-import java.util.Collection;
-import java.util.HashMap;
-import java.util.Map;
-
-import org.hisp.dhis.patient.Patient;
-import org.hisp.dhis.patient.PatientAttribute;
-import org.hisp.dhis.patient.PatientIdentifier;
-import org.hisp.dhis.patient.PatientIdentifierService;
-import org.hisp.dhis.patient.PatientService;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValue;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValueService;
-import org.hisp.dhis.program.Program;
-import org.hisp.dhis.program.ProgramService;
-
 import com.opensymphony.xwork2.Action;
 
 /**
@@ -55,7 +41,7 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-
+    /*
     private PatientService patientService;
 
     public void setPatientService( PatientService patientService )
@@ -84,10 +70,18 @@
         this.patientAttributeValueService = patientAttributeValueService;
     }
 
+    private PatientAttributeService patientAttributeService;
+    
+    public void setPatientAttributeService( PatientAttributeService patientAttributeService )
+    {
+        this.patientAttributeService = patientAttributeService;
+    }
+    */
+    
     // -------------------------------------------------------------------------
     // Input/Output
     // -------------------------------------------------------------------------
-
+    /*
     private int id;
 
     public void setId( int id )
@@ -122,7 +116,8 @@
     {
         return patientAttributeValueMap;
     }
-
+    */
+    
     // -------------------------------------------------------------------------
     // Implementation Action
     // -------------------------------------------------------------------------
@@ -130,11 +125,12 @@
     public String execute()
         throws Exception
     {
+        /*
         patient = patientService.getPatient( id );
 
         patientIdentifier = patientIdentifierService.getPatientIdentifier( patient );
 
-        for ( PatientAttribute patientAttribute : patient.getAttributes() )
+        for ( PatientAttribute patientAttribute : patientAttributeService.getAllPatientAttributes() )
         {
             patientAttributeValueMap.put( patientAttribute.getId(), PatientAttributeValue.UNKNOWN );
         }
@@ -147,9 +143,10 @@
             patientAttributeValueMap.put( patientAttributeValue.getPatientAttribute().getId(), patientAttributeValue
                 .getValue() );
         }
-
+         
+        
         programs = programService.getAllPrograms();
-
+    */
         return SUCCESS;
     }
 }
\ No newline at end of file

=== modified file 'local/in/dhis-web-alert/src/main/java/org/hisp/dhis/alert/util/AlertUtility.java'
--- local/in/dhis-web-alert/src/main/java/org/hisp/dhis/alert/util/AlertUtility.java	2012-06-06 09:55:27 +0000
+++ local/in/dhis-web-alert/src/main/java/org/hisp/dhis/alert/util/AlertUtility.java	2013-09-19 06:34:31 +0000
@@ -486,8 +486,8 @@
             SimpleDateFormat simpleDateFormat = new SimpleDateFormat( "yyyy-MM-dd" );
             String toDaysDate = simpleDateFormat.format( toDay );
 
-            String query = "SELECT periodid FROM period WHERE periodtypeid = 6 AND " + " startdate <= '" + toDaysDate
-                + "' AND enddate >= '" + toDaysDate + "'";
+            String query = "SELECT periodid FROM period INNER JOIN periodtype ON period.periodtypeid = period.periodtypeid "+ 
+							" WHERE periodtype.name LIKE 'Yearly' AND startdate <= '" + toDaysDate + "' AND enddate >= '" + toDaysDate + "'";
 
             SqlRowSet rs1 = jdbcTemplate.queryForRowSet( query );
             if ( rs1 != null && rs1.next() )
@@ -511,7 +511,7 @@
 
         try
         {
-            String query = "SELECT SUM(value) FROM datavalue " + " WHERE sourceid IN (" + orgUnitIdsByComma + ") AND "
+            String query = "SELECT SUM( CAST( value AS DECIMAL) ) FROM datavalue " + " WHERE sourceid IN (" + orgUnitIdsByComma + ") AND "
                 + " dataelementid IN (" + deIdsByComma + ") AND " + " periodid = " + periodId;
 
             SqlRowSet rs1 = jdbcTemplate.queryForRowSet( query );

=== modified file 'local/in/dhis-web-alert/src/main/resources/META-INF/dhis/beans.xml'
--- local/in/dhis-web-alert/src/main/resources/META-INF/dhis/beans.xml	2012-06-06 09:55:27 +0000
+++ local/in/dhis-web-alert/src/main/resources/META-INF/dhis/beans.xml	2014-07-04 12:43:31 +0000
@@ -10,9 +10,7 @@
 		class="org.hisp.dhis.alert.util.AlertUtility" scope="prototype">
 		<property name="reportService" ref="org.hisp.dhis.reports.ReportService"/>
 		<property name="jdbcTemplate" ref="jdbcTemplate"/>
-		<property name="organisationUnitService"
-			ref="org.hisp.dhis.organisationunit.OrganisationUnitService"/>
-		
+		<property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService"/>
 	</bean>
 	
 	<!-- Common Action  -->
@@ -56,6 +54,7 @@
 	
 	<bean id="org.hisp.dhis.alert.tdb.action.GetPatientDataRecordsAction" class="org.hisp.dhis.alert.tdb.action.GetPatientDataRecordsAction"
 		scope="prototype">
+		<!-- 
 		<property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
 		<property name="programService" ref="org.hisp.dhis.program.ProgramService" />
 		<property name="programInstanceService" ref="org.hisp.dhis.program.ProgramInstanceService" />
@@ -63,14 +62,18 @@
 		<property name="patientService" ref="org.hisp.dhis.patient.PatientService" />
 		<property name="patientAttributeService" ref="org.hisp.dhis.patient.PatientAttributeService" />
 		<property name="patientAttributeValueService" ref="org.hisp.dhis.patientattributevalue.PatientAttributeValueService" />
+		-->
   </bean>
 	
 	<bean id="org.hisp.dhis.alert.tdb.action.GetPatientDetailsAction" class="org.hisp.dhis.alert.tdb.action.GetPatientDetailsAction"
 		scope="prototype">
+		<!-- 
 		<property name="patientService" ref="org.hisp.dhis.patient.PatientService" />
 		<property name="patientIdentifierService" ref="org.hisp.dhis.patient.PatientIdentifierService" />
 		<property name="programService" ref="org.hisp.dhis.program.ProgramService" />
 		<property name="patientAttributeValueService" ref="org.hisp.dhis.patientattributevalue.PatientAttributeValueService" />
+		<property name="patientAttributeService" ref="org.hisp.dhis.patient.PatientAttributeService" />
+		-->
   </bean>
 	
 	<!-- IDSP Outbreak Action  -->

=== modified file 'local/in/dhis-web-alert/src/main/resources/struts.xml'
--- local/in/dhis-web-alert/src/main/resources/struts.xml	2012-06-06 09:55:27 +0000
+++ local/in/dhis-web-alert/src/main/resources/struts.xml	2013-09-19 06:34:31 +0000
@@ -10,12 +10,9 @@
 		
 		<!-- Index action -->
 		<action name="index" class="org.hisp.dhis.alert.action.HomePageAction">
-			<result name="dashboardpage" type="redirect">
-				dashboardPage.action</result>
-			<result name="trackerdashboardpage" type="redirect">
-				trackerDashboardPage.action</result>
-			<result name="idspoutbreak" type="redirect">
-				idspoutbreak.action</result>
+			<result name="dashboardpage" type="redirect">dashboardPage.action</result>
+			<result name="trackerdashboardpage" type="redirect">trackerDashboardPage.action</result>
+			<result name="idspoutbreak" type="redirect">idspoutbreak.action</result>
 		</action>
 		
 		<!-- Tracker Dashboard -->
@@ -57,7 +54,8 @@
 			<result name="standard" type="redirect">index.action</result>
 			<result name="success" type="velocity">/main.vm</result>
 			<param name="page">/dhis-web-alert/idspOutBreak.vm</param>
-			<param name="stylesheets">css/ext-all.css,example.css</param>
+			<param name="javascripts">javascript/ext-all.js</param>
+			<param name="stylesheets">css/ext-all.css,example.css</param>			
 			<param name="requiredAuthorities">F_IDSP_OUTBREAK</param>
 		</action>
 		

=== modified file 'local/in/dhis-web-alert/src/main/webapp/WEB-INF/web.xml'
--- local/in/dhis-web-alert/src/main/webapp/WEB-INF/web.xml	2012-04-04 05:46:52 +0000
+++ local/in/dhis-web-alert/src/main/webapp/WEB-INF/web.xml	2013-09-19 06:34:31 +0000
@@ -2,7 +2,7 @@
 <!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
   "http://java.sun.com/dtd/web-app_2_3.dtd">
 <web-app>
-  <display-name>DHIS Dashboard</display-name>
+  <display-name>DHIS Alert</display-name>
     
   <context-param>
     <param-name>contextConfigLocation</param-name>
@@ -31,7 +31,7 @@
   </filter>
   <filter>
     <filter-name>Struts</filter-name>
-    <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
+    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
   </filter>
   
   <filter-mapping>

=== modified file 'local/in/dhis-web-birtreports/pom.xml'
--- local/in/dhis-web-birtreports/pom.xml	2014-06-02 09:44:51 +0000
+++ local/in/dhis-web-birtreports/pom.xml	2014-07-08 09:18:09 +0000
@@ -66,6 +66,17 @@
 		  <groupId>org.hisp.dhis</groupId>
 		  <artifactId>dhis-web-api</artifactId>
 		</dependency>
-
+    	
+		<dependency>
+      		<groupId>org.hisp.dhis</groupId>
+      		<artifactId>dhis-in-service-survey</artifactId>
+      		<version>${project.version}</version>
+    	</dependency>    	
+    	
+    	<dependency>
+      		<groupId>org.hisp.dhis</groupId>
+      		<artifactId>dhis-in-service-reports</artifactId>
+      		<version>${project.version}</version>
+    	</dependency>
     </dependencies>
 </project>

=== modified file 'local/in/dhis-web-birtreports/src/main/java/org/hisp/dhis/birtreports/action/ReportFormAction.java'
--- local/in/dhis-web-birtreports/src/main/java/org/hisp/dhis/birtreports/action/ReportFormAction.java	2014-07-04 12:23:40 +0000
+++ local/in/dhis-web-birtreports/src/main/java/org/hisp/dhis/birtreports/action/ReportFormAction.java	2014-07-08 11:33:36 +0000
@@ -21,6 +21,7 @@
 import org.hisp.dhis.period.MonthlyPeriodType;
 import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodType;
+import org.hisp.dhis.reports.ReportType;
 import org.hisp.dhis.system.filter.PastAndCurrentPeriodFilter;
 import org.hisp.dhis.system.util.FilterUtils;
 
@@ -107,6 +108,14 @@
         return orgUnitGroupNameMap;
     }
     
+    private String reportTypeName;
+
+    public String getReportTypeName()
+    {
+        return reportTypeName;
+    }
+    
+
     // -------------------------------------------------------------------------
     // Action
     // -------------------------------------------------------------------------
@@ -126,7 +135,11 @@
         Calendar cal = PeriodType.createCalendarInstance();
 
         periods = _periodType.generatePeriods( cal.getTime() );
-
+        
+        
+        reportTypeName = ReportType.RT_BIRT;
+        
+               
         // periods = new ArrayList<Period>(
         // periodService.getPeriodsByPeriodType( periodType ) );
 
@@ -146,6 +159,9 @@
         
         OrganisationUnitGroupSet organisationUnitGroupSet = organisationUnitGroupService.getOrganisationUnitGroupSet( (int) orgUnitGroupSetId.getValue()  );
         
+        
+        
+        
         //System.out.println( "  organisationUnit List size   " + orgUnitList.size() );orgUnitGroupSetId
         
         /*
@@ -174,6 +190,7 @@
         //System.out.println( "  organisationUnit Group Set List size After Remove  " + organisationUnitGroupSetList.size() );
         
         orgUnitGroupNameMap = new HashMap<String, String>();
+        
         for( OrganisationUnit orgUnit : orgUnitList )
         {
             for ( OrganisationUnitGroup organisationUnitGroup : organisationUnitGroupSet.getOrganisationUnitGroups() )
@@ -188,7 +205,7 @@
                 }
             }
         }
-
+        
         return SUCCESS;
     }
 

=== modified file 'local/in/dhis-web-birtreports/src/main/resources/META-INF/dhis/beans.xml'
--- local/in/dhis-web-birtreports/src/main/resources/META-INF/dhis/beans.xml	2014-07-04 12:23:40 +0000
+++ local/in/dhis-web-birtreports/src/main/resources/META-INF/dhis/beans.xml	2014-07-08 09:03:32 +0000
@@ -17,5 +17,13 @@
 	    <property name="organisationUnitGroupService" ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService" />
 	    <property name="constantService" ref="org.hisp.dhis.constant.ConstantService" />
 	</bean>	
+	
+	<!--  Birt Reports List -->
+	<bean id="org.hisp.dhis.birtreports.action.GetBirtReportsAction" class="org.hisp.dhis.birtreports.action.GetBirtReportsAction"
+	    scope="prototype">
+	    <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
+	    <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
+	    <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
+	</bean>	
 
 </beans>

=== modified file 'local/in/dhis-web-birtreports/src/main/resources/struts.xml'
--- local/in/dhis-web-birtreports/src/main/resources/struts.xml	2014-07-04 12:23:40 +0000
+++ local/in/dhis-web-birtreports/src/main/resources/struts.xml	2014-07-08 09:43:12 +0000
@@ -22,8 +22,14 @@
 	        <result name="success" type="velocity">/main.vm</result>
 	        <param name="page">/dhis-web-birtreports/reportForm.vm</param>
 	        <param name="menu">/dhis-web-birtreports/menu.vm</param>
-	        <param name="javascripts">javascript/prevNextPeriods.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/util/lists.js,javascript/reportManagement.js,../dhis-web-commons/util/validate/jquery.validate.js,../dhis-web-commons/util/jquery.metadata.js,../dhis-web-commons/util/validate/additional-methods.js,../dhis-web-commons/util/validate/messages_locale.js</param>	        
+	        <param name="javascripts">javascript/prevNextPeriods.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/util/lists.js,javascript/birtReport.js</param>	        
 	   </action>
 		
+        <action name="getBirtReports" class="org.hisp.dhis.birtreports.action.GetBirtReportsAction">
+            <result name="success" type="velocity-xml">/dhis-web-birtreports/responseBirtReport.vm</result>
+            <param name="javascripts">javascript/birtReport.js</param>
+            <param name="onExceptionReturn">plainTextError</param>
+        </action>		
+		
     </package>
 </struts>

=== modified file 'local/in/dhis-web-birtreports/src/main/webapp/dhis-web-birtreports/menu.vm'
--- local/in/dhis-web-birtreports/src/main/webapp/dhis-web-birtreports/menu.vm	2014-06-02 09:44:51 +0000
+++ local/in/dhis-web-birtreports/src/main/webapp/dhis-web-birtreports/menu.vm	2014-07-08 09:07:36 +0000
@@ -1,1 +1,23 @@
-<h2>Birt Reports Engine</h2>
\ No newline at end of file
+<!--<h2>Birt Reports Engine</h2>-->
+	
+<a href="index.action"><h2>Birt Reports Engine</h2></a>
+
+#parse( "/dhis-web-commons/ouwt/orgunittreesearch.vm" )
+
+<script type="text/javascript">
+
+	function orgUnitHasBeenSelected( orgUnitIds )
+	{
+		document.generateReportForm.ouIDTB.value = orgUnitIds;
+
+		reportTypeName = document.generateReportForm.reportTypeNameTB.value;
+
+		if(orgUnitIds != null && orgUnitIds != "" )
+		{
+			getReports( orgUnitIds, reportTypeName);
+		}
+	}
+
+	selection.setListenerFunction( orgUnitHasBeenSelected );
+
+</script>

=== modified file 'local/in/dhis-web-birtreports/src/main/webapp/dhis-web-birtreports/reportForm.vm'
--- local/in/dhis-web-birtreports/src/main/webapp/dhis-web-birtreports/reportForm.vm	2014-07-04 12:23:40 +0000
+++ local/in/dhis-web-birtreports/src/main/webapp/dhis-web-birtreports/reportForm.vm	2014-08-21 10:05:14 +0000
@@ -25,12 +25,45 @@
 		
 		var reportFormatList = document.getElementById("selectedReportFormat");
         var reportFormatIndex = reportFormatList.selectedIndex;
-        if( reportFormatList.options[reportFormatIndex].value == null || reportFormatList.options[reportFormatIndex].value== "-1" )
+        
+		if( reportFormatList.options[reportFormatIndex].value == null || reportFormatList.options[reportFormatIndex].value== "-1" )
         {
             showWarningMessage( "Please Select Report Format" );
             return false; 
         }
 		
+		
+		
+        var startDateValue = $('#startDate').val();
+        var endDateValue = $('#endDate').val();
+        var orgunitIdValue = $('#orgUnitUid').val();
+                                                        
+        if( startDateValue == null || startDateValue== "" ) 
+		{
+			showWarningMessage("Please Select Start Date"); 
+			return false;
+		}
+		
+		else if( endDateValue == null || endDateValue=="" ) 
+		{
+			showWarningMessage( "Please Select End Date" ); 
+			return false;
+		}
+		
+        else if( startDateValue > endDateValue )
+		{
+			showWarningMessage( "Starte Date is Greaterthan End Date" ); 
+			return false;
+		}
+        else if( orgunitIdValue == null || orgunitIdValue == "" ) 
+		{
+			showWarningMessage("Please Select OrganisationUnit"); 
+			return false;
+		}
+		
+		
+		/*
+		
 		var startPeriodList = document.getElementById("selectedPeriodId");
 	    var startPeriodIndex = startPeriodList.selectedIndex;
 	    
@@ -39,7 +72,7 @@
 			showWarningMessage( "Please Select Period" );
 			return false; 
 		}
-
+		*/	
 		
 	    return redirectTorptDesign();
 	}
@@ -64,66 +97,130 @@
 		
         var orgunit = $('#treeSelectedId').val();
 		
-		var orgUnitId = selectionTreeSelection.getSelectedUid()[0];
+		//var orgUnitId = selectionTreeSelection.getSelectedUid()[0];
+		
+		var orgUnitId = $('#orgUnitUid').val();
 				
 		var orgUnitGroupName = tempOrgUnitGroupNameMap[orgUnitId];
 		
-		if( rprDesign == "MATERNAL_HEALTH")
+		//alert( rprDesign )
+
+		//window.location.href = "http://localhost:8090/birt/run?__report=C:/Program Files/Apache Software Foundation/Tomcat 7.0/webapps/birt/report/"+rprDesign+"&__format="+reportFormat+"&startDate="+startPeriod+"&endDate="+endPeriod+"&orgUnit="+orgunit;
+	
+		
+		var birtReportURL = "http://192.168.0.21:8092/birt_ippf/run?__report=/home/ccem/tomcat_ippf/webapps/birt_ippf/report/Nepal Reports/"+rprDesign+"&__format="+reportFormat+"&startDate="+startPeriod+"&endDate="+endPeriod+"&orgUnit="+orgUnitId;
+		window.location.href =  birtReportURL;
+		
+
+		
+		
+		
+		/*
+		if( rprDesign == "MATERNAL_HEALTH_1")
 		{
+
+			var birtReportURL = "http://192.168.0.21:8092/birt_ippf/run?__report=/home/ccem/tomcat_ippf/webapps/birt_ippf/report/Nepal Reports/Government VCT Report_MA.rptdesign&__format="+reportFormat+"&startDate="+startPeriod+"&endDate="+endPeriod+"&orgUnit="+orgUnitId;
+			window.location.href =  birtReportURL;
+			
+			
+
 			if( orgUnitGroupName == "Health Center")
 			{
-				var birtReportURL = "http://0.0.0.1:8080/birt/run?__report=/home/birt/report/Mathealth_report3_HC.rptdesign&__format="+reportFormat+"&startDate="+startPeriod+"&endDate="+endPeriod+"&orgUnit="+orgUnitId;
+				var birtReportURL = "http://192.168.0.21:8092/birt_ippf/run?__report=/home/ccem/tomcat_ippf/webapps/birt_ippf/report/Nepal Reports/4453_nepa-govt_VCT.rptdesign&__format="+reportFormat+"&startDate="+startPeriod+"&endDate="+endPeriod+"&orgUnit="+orgUnitId;
 				window.location.href =  birtReportURL;
 			}
-		}
+			
+			
+		}
+
+		else if( rprDesign == "MATERNAL_HEALTH_2")
+		{
+
+			var birtReportURL = "http://192.168.0.21:8092/birt_ippf/run?__report=/home/ccem/tomcat_ippf/webapps/birt_ippf/report/Nepal Reports/Government VCT Report_Branch.rptdesign&__format="+reportFormat+"&startDate="+startPeriod+"&endDate="+endPeriod+"&orgUnit="+orgUnitId;
+			window.location.href =  birtReportURL;
+			
+			
+		}
+
+		else if( rprDesign == "MATERNAL_HEALTH_3")
+		{
+
+			var birtReportURL = "http://192.168.0.21:8092/birt_ippf/run?__report=/home/ccem/tomcat_ippf/webapps/birt_ippf/report/Nepal Reports/Government VCT Report_Clinic.rptdesign&__format="+reportFormat+"&startDate="+startPeriod+"&endDate="+endPeriod+"&orgUnit="+orgUnitId;
+			window.location.href =  birtReportURL;
+			
+			
+		}
+
+		*/
+		
+
 		
 	    return true;
     }
 
 </script>
 
-
-
-
 <h3>$i18n.getString( "report_management" )</h3>
 
-<form id="generateReport"  method="Get" action="#" onsubmit="return formValidations()" >
+<form id="generateReportForm" name="generateReportForm" method="Get" action="#" onsubmit="return formValidations()" >
 	<table>
+		
+		<tr style="display:none;">
+			<td class="NormalB">
+   			    <select id="periodTypeId" name="periodTypeId" style="width:200px; display:none">
+					<option value="$periodTypeName">$periodTypeName</option>
+				</select>
+    		</td>
+       	</tr>
+		
+        <tr>
+			<td class="NormalB">OrganisationUnit</td>
+			<td>
+				<input type="text" name="ouNameTB" id="ouNameTB" style="width:215px" disabled>
+				<input type="hidden" name="orgUnitUid" id="orgUnitUid">	
+			</td>
+		</tr>
+		
 		<tr>
 			<td><label for="report">$i18n.getString( "report" )</label></td>
 			<td>
 				<select id="selectedReportId" name="selectedReportId" style="width:220px" >
 					<option value="-1">[$i18n.getString( "select" )]</option>
-					<option value="MATERNAL_HEALTH" >Maternal Health</option>
+					<!--
+					<option value="MATERNAL_HEALTH_1">Government VCT Report MA</option>
+					<option value="MATERNAL_HEALTH_2">Government VCT Report Branch</option>
+					<option value="MATERNAL_HEALTH_3">Government VCT Report Clinic</option>
+					<option value="-1" >SAR SS Report</option>
+					-->
 				</select>
 			</td>
 		</tr>	
 		
-		
-		</tr>
-            <td><label for="outputFormat">$i18n.getString( "output_type" )</label></td>
-			<td>
+		<tr>
+			<td><label for="outputFormat">$i18n.getString( "output_type" )</label></td>
+	    	<td>
 				<select id="selectedReportFormat" name="selectedReportFormat" style="width:220px" >
-                    <option value="-1">[$i18n.getString( "select" )]</option>
+					<option value="-1">[$i18n.getString( "select" )]</option>
                     <option value="pdf">PDF</option>
                     <option value="xls_spudsoft">XLS</option>       
-                </select>
+				</select>
             </td>
 		</tr>
 		
 		<tr>
 			<td><label for="startDate">$i18n.getString( 'start_date' ) ($i18n.getString( "format.date.label" ))</label></td>
-            <td><input type="text" id="startDate" name="startDate" onChange="if(!isDate( this.value )) this.value='';" style="width:180px" class="{validate:{required:true,dateISO:true}}" /></td>			
+            <td><input type="text" id="startDate" name="startDate" onChange="if(!isDate( this.value )) this.value='';" style="width:215px" class="{validate:{required:true,dateISO:true}}" /></td>			
 		</tr>
 
 		<tr>
 			<td><label for="endDate">$i18n.getString( 'end_date' ) ($i18n.getString( "format.date.label" ))</label></td>
-			<td><input type="text" id="endDate" name="endDate" onChange="if(!isDate( this.value )) this.value='';"  style="width:180px" class="{validate:{required:true,dateISO:true}}" /></td>
+			<td><input type="text" id="endDate" name="endDate" onChange="if(!isDate( this.value )) this.value='';"  style="width:215px" class="{validate:{required:true,dateISO:true}}" /></td>
 		</tr>		
 		
 		<tr style="display:none;">
 			<td><label for="selectedPeriodId">$i18n.getString( "period" )</label></td>
-			<td><select id="selectedPeriodId" name="selectedPeriodId" style="width:220px" >
+			<td>
+				<select id="selectedPeriodId" name="selectedPeriodId" style="width:220px" >
 					<option value="-1">[$i18n.getString( "select" )]</option>
 						#foreach( $period in $periods )
 							<!--<option value="$period.isoDate">$encoder.htmlEncode( $period.name )</option>-->
@@ -136,22 +233,21 @@
 				<input type="button" id="nextButton"  style="width:75px" value="$i18n.getString( 'next_year' )" title="$i18n.getString('later_periods')" onclick="getAvailablePeriodsTemp( '$periodTypeName', 'selectedPeriodId', '1' )" >
 			</td>
 		</tr>	
+
+		<tr>
+			<td>&nbsp;</td>
+			<td>
+				<input type="button" id="generate" name="generate" value="$i18n.getString( 'generate' )" style="width:10em" onclick="formValidations()" />
+            
+			</td>
+			<td>
+				<input type="hidden" name="ouIDTB" id="ouIDTB">
+				<input type="hidden" name="reportTypeNameTB" id="reportTypeNameTB" value="$reportTypeName">
+      		</td>
+		</tr>	
+	
 	</table>
-	
-	  <table id="selectionTable">
-		<tr>
-		  <td>
-			#organisationUnitSelectionTree( false, false, false )
-		  </td>
-	    </tr>
-	    <tr>
-            <td>
-                <!--<input type="submit" id="submitButton" value="$i18n.getString( 'generate' )" style="width:10em"  />-->
-				<input type="button" id="submitButton" value="$i18n.getString( 'generate' )" style="width:10em" onclick="formValidations()" />
-                <!--<input type="text" id="birtpath" name="birtpath" value="$birtPath" />-->
-            </td>
-	    </tr>
-	  </table>
+
 </form>
 
 <script type="text/javascript"> 

=== modified file 'local/in/dhis-web-dashboard/pom.xml'
--- local/in/dhis-web-dashboard/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-web-dashboard/pom.xml	2014-07-05 07:01:42 +0000
@@ -6,11 +6,11 @@
 	<parent>
 		<groupId>org.hisp.dhis</groupId>
 		<artifactId>dhis-web</artifactId>
-		<version>2.15-SNAPSHOT</version>
+		<version>2.15</version>
 	</parent>
 	
 	<artifactId>dhis-web-dashboard</artifactId>
-	<packaging>jar</packaging>
+	<packaging>war</packaging>
 	<name>DHIS DashBoard</name>
 	
 	<build>
@@ -24,28 +24,34 @@
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-api</artifactId>
-			<version>2.12-SNAPSHOT</version>
 		</dependency>
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-service-core</artifactId>
-			<version>2.12-SNAPSHOT</version>
 		</dependency>
+		<!-- 
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-service-patient</artifactId>
-			<version>2.12-SNAPSHOT</version>
-		</dependency>
+			<version>${project.version}</version>
+		</dependency>
+		-->
+		<dependency>
+			<groupId>org.hisp.dhis</groupId>
+			<artifactId>dhis-service-aggregationengine-default</artifactId>
+			<version>${project.version}</version>
+		</dependency>
+		
 		
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-in-service-linelisting</artifactId>
-			<version>2.12-SNAPSHOT</version>
+			<version>${project.version}</version>
 		</dependency>
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-in-service-dbmanager</artifactId>
-			<version>2.12-SNAPSHOT</version>
+			<version>${project.version}</version>
 		</dependency>
 		
 		<dependency>
@@ -59,43 +65,36 @@
 		</dependency>
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-service-aggregationengine-default</artifactId>
-			<version>${project.version}</version>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-support-external</artifactId>
-			<version>2.12-SNAPSHOT</version>
 		</dependency>
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-support-system</artifactId>
-			<version>2.12-SNAPSHOT</version>
 		</dependency>
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-in-api</artifactId>
-			<version>2.12-SNAPSHOT</version>
+			<version>${project.version}</version>
 		</dependency>
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-in-service-survey</artifactId>
-			<version>2.12-SNAPSHOT</version>
+			<version>${project.version}</version>
 		</dependency>
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-in-service-configuration</artifactId>
-			<version>2.12-SNAPSHOT</version>
+			<version>${project.version}</version>
 		</dependency>
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-in-service-reports</artifactId>
-			<version>2.12-SNAPSHOT</version>
+			<version>${project.version}</version>
 		</dependency>
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-in-service-dataentrystatus</artifactId>
-			<version>2.12-SNAPSHOT</version>
+			<version>${project.version}</version>
 		</dependency>
         <!--<dependency>
             <groupId>org.hisp.dhis</groupId>
@@ -130,15 +129,17 @@
 		<dependency>
 			<groupId>jfree</groupId>
 			<artifactId>jfreechart</artifactId>
+			<version>1.0.9</version>
 		</dependency>
 		<dependency>
 			<groupId>jfree</groupId>
 			<artifactId>jfreechart-experimental</artifactId>
-			<version>1.0.3</version>
+			<version>1.0.9</version>
 		</dependency>
 		<dependency>
 			<groupId>jfree</groupId>
 			<artifactId>jcommon</artifactId>
+			<version>1.0.9</version>
 		</dependency>
 		<dependency>
 			<groupId>com.lowagie</groupId>
@@ -151,6 +152,7 @@
 		<dependency>
 			<groupId>net.sourceforge.jexcelapi</groupId>
 			<artifactId>jxl</artifactId>
+			<version>2.6.12</version>
 		</dependency>
 	</dependencies>
 	<properties>

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/aa/action/GenerateAnnualAnalysisDataAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/aa/action/GenerateAnnualAnalysisDataAction.java	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/aa/action/GenerateAnnualAnalysisDataAction.java	2013-09-19 06:34:31 +0000
@@ -352,9 +352,20 @@
         {
             selectedDataElement = new DataElement();
             selectedDataElement = dataElementService.getDataElement(availableDataElements);
-            if (selectedDataElement.getAlternativeName() != null) 
+			             /**
+				* TODO
+				* HACKED JUST TO RUN WITH 2.11	
+				*/
+            if (selectedDataElement.getName() != null) 
+            //if (selectedDataElement.getAlternativeName() != null) 
             {
-                chartTitle += "\n DataElement : " + selectedDataElement.getAlternativeName();
+			             /**
+				* TODO
+				* HACKED JUST TO RUN WITH 2.11	
+				*/
+
+                //chartTitle += "\n DataElement : " + selectedDataElement.getAlternativeName();
+				chartTitle += "\n DataElement : " ;
             } 
             else {
                 chartTitle += "\n DataElement : " + selectedDataElement.getName();

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/ExportIndicatorToExcelAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/ExportIndicatorToExcelAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/ExportIndicatorToExcelAction.java	2013-12-13 07:09:00 +0000
@@ -176,9 +176,10 @@
         WritableWorkbook outputReportWorkbook = Workbook.createWorkbook( new File(outputReportFile) );
         WritableSheet sheet0 = outputReportWorkbook.createSheet( "IndicatorChartOutput", 0 );
         
+		
         if(viewSummary.equals( "no" ))
         {
-            WritableImage writableImage = new WritableImage(0,1,10,23,encoderBytes);
+        	WritableImage writableImage = new WritableImage(0,1,10,23,encoderBytes);
             sheet0.addImage( writableImage );
             tempRow1 = 24;
         }    
@@ -278,8 +279,7 @@
         
         for(int j=0; j< series1.length; j++)
         {
-            Indicator indicator =  indicatorService.getIndicatorByName( series1[j] );
-            
+            Indicator indicator = indicatorService.getIndicatorByName( series1[j] ).get(0);
             sheet0.addCell( new Label( tempCol1, tempRow1, indicator.getName(), wCellformat1 ) );
             String formula = indicator.getNumeratorDescription() + "/" +  indicator.getDenominatorDescription();
             

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/ExportSurveyDataToExcelAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/ExportSurveyDataToExcelAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/ExportSurveyDataToExcelAction.java	2013-09-19 06:34:31 +0000
@@ -373,7 +373,12 @@
          
          for(int j=0; j< series1.length; j++)
          {
-             Indicator indicator =  indicatorService.getIndicatorByName( series1[j] );
+             /**
+				* TODO
+				* HACKED JUST TO RUN WITH 2.11	
+				*/
+			 //Indicator indicator =  indicatorService.getIndicatorByName( series1[j] );
+			 Indicator indicator =  null;
              
              sheet0.addCell( new Label( tempCol1, tempRow1, indicator.getName(), wCellformat1 ) );
              String formula = indicator.getNumeratorDescription() + "/" +  indicator.getDenominatorDescription();

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/GetDataElementsAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/GetDataElementsAction.java	2012-07-02 07:39:05 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/GetDataElementsAction.java	2013-12-13 07:09:00 +0000
@@ -160,7 +160,7 @@
         System.out.println( " id = " + id );
         if ( id == null || id == 0 )
         {
-            dataElements = new ArrayList<DataElement>( dataElementService.getAllDataElements() );
+            dataElements = new ArrayList<DataElement>( dataElementService.getAllActiveDataElements() );
             System.out.println( "id = " + id + " dataElements size = " + dataElements.size() );
         }
         else

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/GetDataElementsForTabularAnalysisAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/GetDataElementsForTabularAnalysisAction.java	2012-07-02 07:39:05 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/GetDataElementsForTabularAnalysisAction.java	2013-12-13 07:09:00 +0000
@@ -130,7 +130,7 @@
         if ( id == null || id == ALL )
         {
             System.out.println("The id is null");
-            dataElements = new ArrayList<DataElement>( dataElementService.getAllDataElements() );
+            dataElements = new ArrayList<DataElement>( dataElementService.getAllActiveDataElements() );
             System.out.println( " DataElements size = "+ dataElements.size() );
         } 
         else

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/GetOrgUnitNameAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/GetOrgUnitNameAction.java	2011-03-01 09:39:28 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/GetOrgUnitNameAction.java	2014-04-01 09:46:33 +0000
@@ -22,13 +22,21 @@
     // -------------------------------------------------------------------------
     // Input/Output
     // -------------------------------------------------------------------------
-    
+    /*
     private Integer id;
 
     public void setId( Integer id )
     {
         this.id = id;
     }
+    */
+    
+    private String id;
+  
+    public void setId( String id )
+    {
+        this.id = id;
+    }
 
     private OrganisationUnit organisationUnit;
 

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/GetOrgUnitsAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/GetOrgUnitsAction.java	2011-12-14 10:18:12 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/action/GetOrgUnitsAction.java	2014-04-01 09:48:49 +0000
@@ -36,14 +36,24 @@
     // -------------------------------------------------------------------------
     // Getters & Setters
     // -------------------------------------------------------------------------
-
+    
+    /*
     private Integer orgUnitId;
 
     public void setOrgUnitId( Integer orgUnitId )
     {
         this.orgUnitId = orgUnitId;
     }
-    
+    */
+    
+    
+    private String orgUnitId;
+    
+    public void setOrgUnitId( String orgUnitId )
+    {
+        this.orgUnitId = orgUnitId;
+    }
+
     private String type;
     
     public void setType( String type )

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/action/GenerateCommentsResultAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/action/GenerateCommentsResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/action/GenerateCommentsResultAction.java	2013-09-19 06:34:31 +0000
@@ -289,7 +289,13 @@
                 orgUnitList = new ArrayList<OrganisationUnit>();            
                 orgUnitList.add( selectedOrgUnit );
                 
-                OrganisationUnitGroup oug = organisationUnitGroupService.getOrganisationUnitGroupByName( "Districts" );                
+				/**
+				* TODO
+				* HACKED JUST TO RUN WITH 2.11	
+				*/
+
+                //OrganisationUnitGroup oug = organisationUnitGroupService.getOrganisationUnitGroupByName( "Districts" );                
+				OrganisationUnitGroup oug = null;
                 if(oug != null)
                 {
                     List<OrganisationUnit> tempOUList = new ArrayList<OrganisationUnit>(oug.getMembers());
@@ -297,8 +303,15 @@
                     Collections.sort( tempOUList, new IdentifiableObjectNameComparator() );
                     orgUnitList.addAll( tempOUList );
                 }   
-                
-                oug = organisationUnitGroupService.getOrganisationUnitGroupByName( "Corporations" );
+
+   				/**
+				* TODO
+				* HACKED JUST TO RUN WITH 2.11	
+				*/
+
+                //oug = organisationUnitGroupService.getOrganisationUnitGroupByName( "Corporations" );
+                oug = null;
+
                 if(oug != null)
                 {
                     List<OrganisationUnit> tempOUList = new ArrayList<OrganisationUnit>(oug.getMembers());

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/action/GenerateDataStatusResultAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/action/GenerateDataStatusResultAction.java	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/action/GenerateDataStatusResultAction.java	2014-11-28 10:59:27 +0000
@@ -23,6 +23,8 @@
 import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
+import org.hisp.dhis.system.database.DatabaseInfo;
+import org.hisp.dhis.system.database.DatabaseInfoProvider;
 import org.springframework.jdbc.core.JdbcTemplate;
 import org.springframework.jdbc.support.rowset.SqlRowSet;
 
@@ -112,7 +114,12 @@
     }
 */    
 
+    private DatabaseInfoProvider databaseInfoProvider;
 
+    public void setDatabaseInfoProvider( DatabaseInfoProvider databaseInfoProvider )
+    {
+        this.databaseInfoProvider = databaseInfoProvider;
+    }
 
     // ---------------------------------------------------------------
     // Output Parameters
@@ -376,6 +383,7 @@
         maxOULevel = 1;
         minOULevel = organisationUnitService.getNumberOfOrganisationalLevels();
         
+        DatabaseInfo dataBaseInfo = databaseInfoProvider.getDatabaseInfo();
         
         if( includeZeros.equalsIgnoreCase( "false" ))
         {
@@ -567,20 +575,40 @@
                             orgUnitInfo = "-1";
                             orgUnitCount = 0;
                             getOrgUnitInfo( o, dso );
-        
-                            if ( includeZeros == null )
+                            
+                            if ( dataBaseInfo.getType().equalsIgnoreCase( "postgresql" ) )
                             {
-                                query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
-                                    + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo
-                                    + ") and value <> 0";
-                                
+                                if ( includeZeros == null )
+                                {
+                                    query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                                        + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo
+                                        + ") and CAST(value AS NUMERIC) != 0 ";
+                                    
+                                }
+                                else
+                                {
+                                    query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                                        + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ")";
+                                }
                             }
+                            
                             else
                             {
-                                query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
-                                    + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ")";
+                                if ( includeZeros == null )
+                                {
+                                    query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                                        + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo
+                                        + ") and value != 0 ";
+                                    
+                                }
+                                else
+                                {
+                                    query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                                        + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ")";
+                                }
+            
                             }
-        
+                            
                             System.out.println("Used Query is :::::::" + query );
                             SqlRowSet sqlResultSet = jdbcTemplate.queryForRowSet( query );
         
@@ -615,17 +643,35 @@
                     }
 
                 orgUnitInfo = "" + o.getId();
-
-                if ( includeZeros == null )
+                
+                if ( dataBaseInfo.getType().equalsIgnoreCase( "postgresql" ) )
                 {
-                    query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
-                        + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ") and value <> 0";
+                    if ( includeZeros == null )
+                    {
+                        query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                            + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ") AND CAST(value AS NUMERIC) != 0 ";
+                    }
+                    else
+                    {
+                        query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                            + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ")";
+                    }
                 }
+                
                 else
                 {
-                    query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
-                        + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ")";
+                    if ( includeZeros == null )
+                    {
+                        query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                            + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ") and value != 0 ";
+                    }
+                    else
+                    {
+                        query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                            + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ")";
+                    }
                 }
+                
 
                 SqlRowSet sqlResultSet = jdbcTemplate.queryForRowSet( query );
 

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/action/GenerateGroupWiseDataStatusResultAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/action/GenerateGroupWiseDataStatusResultAction.java	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/action/GenerateGroupWiseDataStatusResultAction.java	2014-07-08 11:22:35 +0000
@@ -27,6 +27,8 @@
 import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
+import org.hisp.dhis.system.database.DatabaseInfo;
+import org.hisp.dhis.system.database.DatabaseInfoProvider;
 import org.springframework.jdbc.core.JdbcTemplate;
 import org.springframework.jdbc.support.rowset.SqlRowSet;
 
@@ -123,6 +125,14 @@
         this.sectionService = sectionService;
     }
  */  
+    
+    private DatabaseInfoProvider databaseInfoProvider;
+
+    public void setDatabaseInfoProvider( DatabaseInfoProvider databaseInfoProvider )
+    {
+        this.databaseInfoProvider = databaseInfoProvider;
+    }
+    
     // ---------------------------------------------------------------
     // Output Parameters
     // ---------------------------------------------------------------
@@ -407,6 +417,8 @@
         
         results = new ArrayList<Integer>();
         
+        DatabaseInfo dataBaseInfo = databaseInfoProvider.getDatabaseInfo();
+        
         //ouGroupMapDeMapCount = new HashMap<DataElementGroup,Map<OrganisationUnit, List<Integer>>>();
         
         ouGroupMapDeMapCount = new HashMap<Section,Map<OrganisationUnit, List<Integer>>>();
@@ -703,8 +715,23 @@
                     }
 
                     orgUnitInfo = "" + o.getId();
-
-                    if(includeZeros == null)
+                    
+                    if ( dataBaseInfo.getType().equalsIgnoreCase( "postgresql" ) )
+                    {
+                        if(includeZeros == null)
+                        {
+                            query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                        + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ") CAST(value AS NUMERIC) <> 0 ";
+                        }
+                        else
+                        {
+                            query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                        + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ")";
+                        }
+                    }
+                    else
+                    {
+                        if(includeZeros == null)
                         {
                             query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
                         + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ") AND value <> 0";
@@ -714,6 +741,8 @@
                             query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
                         + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ")";
                         }
+                    }
+                    
                     
                     SqlRowSet sqlResultSet = jdbcTemplate.queryForRowSet( query );
                   

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/action/GenerateSummaryDataStatusResultAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/action/GenerateSummaryDataStatusResultAction.java	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/action/GenerateSummaryDataStatusResultAction.java	2015-03-26 08:54:30 +0000
@@ -14,9 +14,9 @@
 import java.util.Set;
 import java.util.UUID;
 
+import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
 import org.hisp.dhis.constant.Constant;
 import org.hisp.dhis.constant.ConstantService;
-import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
 import org.hisp.dhis.dataanalyser.util.DashBoardService;
 import org.hisp.dhis.dataelement.DataElement;
 import org.hisp.dhis.dataset.DataSet;
@@ -27,6 +27,8 @@
 import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
+import org.hisp.dhis.system.database.DatabaseInfo;
+import org.hisp.dhis.system.database.DatabaseInfoProvider;
 import org.springframework.jdbc.core.JdbcTemplate;
 import org.springframework.jdbc.support.rowset.SqlRowSet;
 
@@ -93,7 +95,15 @@
     }
     
     private List<Constant> constants;
+    
+    private DatabaseInfoProvider databaseInfoProvider;
 
+    public void setDatabaseInfoProvider( DatabaseInfoProvider databaseInfoProvider )
+    {
+        this.databaseInfoProvider = databaseInfoProvider;
+    }
+    
+    
     // ---------------------------------------------------------------
     // Output Parameters
     // ---------------------------------------------------------------
@@ -309,6 +319,7 @@
         constName =  constant.getName();
         constValue = constant.getValue();
         
+        DatabaseInfo dataBaseInfo = databaseInfoProvider.getDatabaseInfo();
         
         /*
         constants = new ArrayList<Constant>( constantService.getAllConstants());
@@ -518,19 +529,38 @@
                         orgUnitId = ""+ cUnit.getId();
                         orgUnitCount = 0;
                         getOrgUnitInfo( o, dso );
-
-                        if ( includeZeros == null )
+                        
+                        if ( dataBaseInfo.getType().equalsIgnoreCase( "postgresql" ) )
                         {
-                            query2 = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
-                                + ") AND sourceid IN (" + orgUnitId + ") AND periodid IN (" + periodInfo
-                                + ") and value <> 0";
+                            if ( includeZeros == null )
+                            {
+                                query2 = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                                    + ") AND sourceid IN (" + orgUnitId + ") AND periodid IN (" + periodInfo
+                                    + ") and CAST(value AS NUMERIC) != 0 ";
+                            }
+                            else
+                            {
+                                query2 = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                                    + ") AND sourceid IN (" + orgUnitId + ") AND periodid IN (" + periodInfo + ")";
+                            }
                         }
+                        
                         else
                         {
-                            query2 = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
-                                + ") AND sourceid IN (" + orgUnitId + ") AND periodid IN (" + periodInfo + ")";
+                            if ( includeZeros == null )
+                            {
+                                query2 = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                                    + ") AND sourceid IN (" + orgUnitId + ") AND periodid IN (" + periodInfo
+                                    + ") and value != 0 ";
+                            }
+                            else
+                            {
+                                query2 = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                                    + ") AND sourceid IN (" + orgUnitId + ") AND periodid IN (" + periodInfo + ")";
+                            }
                         }
-
+                        
+                        
                         Double tempDataStatusCount = tempOuMapResult.get( orgUnitId+":"+periodInfo );
                         if( tempDataStatusCount == null )
                         {
@@ -583,17 +613,36 @@
 
                 orgUnitInfo = "" + o.getId();
                 
-                
-                if ( includeZeros == null )
+                if ( dataBaseInfo.getType().equalsIgnoreCase( "postgresql" ) )
                 {
-                    query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
-                        + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ") and value <> 0";
+                    if ( includeZeros == null )
+                    {
+                        query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                            + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ") AND CAST(value AS NUMERIC) != 0 ";
+                    }
+                    else
+                    {
+                        query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                            + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ")";
+                    }
                 }
+                
+                
                 else
                 {
-                    query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
-                        + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ")";
+                    if ( includeZeros == null )
+                    {
+                        query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                            + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ") and value != 0 ";
+                    }
+                    else
+                    {
+                        query = "SELECT COUNT(*) FROM " + dataViewName + " WHERE dataelementid IN (" + deInfo
+                            + ") AND sourceid IN (" + orgUnitInfo + ") AND periodid IN (" + periodInfo + ")";
+                    }
                 }
+                
+                
 
                 SqlRowSet sqlResultSet = jdbcTemplate.queryForRowSet( query );
 

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/mobile/action/GenerateDataStatusMobileFormAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/mobile/action/GenerateDataStatusMobileFormAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ds/mobile/action/GenerateDataStatusMobileFormAction.java	2014-03-05 05:45:11 +0000
@@ -121,10 +121,12 @@
                 
                 // Remove datasets which are nor mobile datasets
                 //else if ( d.getMobile() == null || !d.getMobile())
-                else if ( !d.isMobile() )    
+                /*
+                else if ( !d.isLinelisting() )
                 {
                    dataSetListIterator.remove();
                 }
+                */
             }
         }
        

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/GenerateGraphicalAnalyserDataElementsFormAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/GenerateGraphicalAnalyserDataElementsFormAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/GenerateGraphicalAnalyserDataElementsFormAction.java	2014-03-05 05:45:27 +0000
@@ -235,7 +235,12 @@
         return financialAprilPeriodType;
     }
 
+    private String forteenPeriodTypeName;
     
+    public String getForteenPeriodTypeName()
+    {
+        return forteenPeriodTypeName;
+    }
     // -------------------------------------------------------------------------
     // Action Implementation
     // -------------------------------------------------------------------------
@@ -247,13 +252,9 @@
         sections = new ArrayList<Section>();
         sections = new ArrayList<Section>( sectionService.getAllSections() );
         Collections.sort( sections, new SectionOrderComparator() );
-        
-        
-        
-        
-        
+       
         /* DataElements and Groups */
-        dataElements = new ArrayList<DataElement>( dataElementService.getAllDataElements() );
+        dataElements = new ArrayList<DataElement>( dataElementService.getAllActiveDataElements() );
         
         // take only those dataElement which are VALUE_TYPE_INT and DOMAIN_TYPE_AGGREGATE
         Iterator<DataElement> alldeIterator = dataElements.iterator();
@@ -289,6 +290,7 @@
         
         dailyPeriodTypeName = DailyPeriodType.NAME;
         weeklyPeriodTypeName = WeeklyPeriodType.NAME;
+        //forteenPeriodTypeName = ForteenPeriodType.NAME;
         monthlyPeriodTypeName = MonthlyPeriodType.NAME;
         quarterlyPeriodTypeName = QuarterlyPeriodType.NAME;
         sixMonthPeriodTypeName = SixMonthlyPeriodType.NAME;

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/GetDataElementGroupAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/GetDataElementGroupAction.java	2012-07-02 07:39:05 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/GetDataElementGroupAction.java	2013-09-19 06:34:31 +0000
@@ -89,7 +89,8 @@
         {
             sections = new ArrayList<Section>();
             sections = new ArrayList<Section>( sectionService.getAllSections() );
-            Collections.sort( sections, new SectionOrderComparator() );
+            //Collections.sort( sections, new SectionOrderComparator() );
+            Collections.sort( sections, new IdentifiableObjectNameComparator() );
         }
         
         

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/IndicatorwiseGAFormAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/IndicatorwiseGAFormAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/IndicatorwiseGAFormAction.java	2014-03-05 05:45:41 +0000
@@ -194,6 +194,12 @@
         return financialAprilPeriodType;
     }
     
+    private String forteenPeriodTypeName;
+    
+    public String getForteenPeriodTypeName()
+    {
+        return forteenPeriodTypeName;
+    }
     // -------------------------------------------------------------------------
     // Action Implementation
     // -------------------------------------------------------------------------
@@ -238,6 +244,7 @@
         
         dailyPeriodTypeName = DailyPeriodType.NAME;
         weeklyPeriodTypeName = WeeklyPeriodType.NAME;
+        //forteenPeriodTypeName = ForteenPeriodType.NAME;
         monthlyPeriods = new ArrayList<Period>( periodService.getPeriodsByPeriodType( new MonthlyPeriodType() ) );
         periodNameList = new ArrayList<String>();
         Collections.sort( monthlyPeriods, new PeriodComparator() );

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/charts/GenerateChartDataAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/charts/GenerateChartDataAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/charts/GenerateChartDataAction.java	2014-03-05 05:50:43 +0000
@@ -913,7 +913,8 @@
 
                             if( aggDataCB == null )
                             {
-                                DataValue dv1 = dataValueService.getDataValue( selectedOrgUnit, dElement, p, decoc );
+                                //DataValue dv1 = dataValueService.getDataValue( selectedOrgUnit, dElement, p, decoc );
+                                DataValue dv1 = dataValueService.getDataValue( dElement, p, selectedOrgUnit, decoc );
                                 if ( dv1 != null && dv1.getValue() != null )
                                     serviceValues[countForServiceList][countForPeriodList] = Double.parseDouble( dv1
                                         .getValue() );
@@ -940,7 +941,8 @@
                                     OrganisationUnit ou = (OrganisationUnit) orgUnitsIterator.next();
 
                                     double tempd = -1.0;
-                                    DataValue dv1 = dataValueService.getDataValue( ou, dElement, p, decoc );
+                                    //DataValue dv1 = dataValueService.getDataValue( ou, dElement, p, decoc );
+                                    DataValue dv1 = dataValueService.getDataValue( dElement, p, ou, decoc );
                                     if ( dv1 != null && dv1.getValue() != null )
                                         tempd = Double.parseDouble( dv1.getValue() );
                                     if ( tempd == -1.0 )
@@ -998,7 +1000,8 @@
 
                                 if ( aggDataCB == null )
                                 {
-                                    DataValue dv1 = dataValueService.getDataValue( selectedOrgUnit, dElement, p, decoc1 );
+                                    //DataValue dv1 = dataValueService.getDataValue( selectedOrgUnit, dElement, p, decoc1 );
+                                    DataValue dv1 = dataValueService.getDataValue( dElement, p, selectedOrgUnit, decoc1 );
                                     if ( dv1 != null && dv1.getValue() != null )
                                         aggDataValue = Double.parseDouble( dv1.getValue() );
                                     else
@@ -1022,7 +1025,8 @@
                                     Double tempd = 0.0;
                                     if ( aggDataCB == null )
                                     {
-                                        DataValue dv1 = dataValueService.getDataValue( ou, dElement, p, decoc1 );
+                                        //DataValue dv1 = dataValueService.getDataValue( ou, dElement, p, decoc1 );
+                                        DataValue dv1 = dataValueService.getDataValue( dElement, p, ou, decoc1 );
                                         if ( dv1 != null && dv1.getValue() != null )
                                             tempd = Double.parseDouble( dv1.getValue() );
                                     }
@@ -1436,7 +1440,8 @@
                                 double tempAggValue = 0.0;
                                 for ( Period p1 : pList )
                                 {
-                                    DataValue dv1 = dataValueService.getDataValue( childOrgUnit, dElement, p1, decoc );
+                                    //DataValue dv1 = dataValueService.getDataValue( childOrgUnit, dElement, p1, decoc );
+                                    DataValue dv1 = dataValueService.getDataValue( dElement, p1, childOrgUnit, decoc );
                                     if ( dv1 != null && dv1.getValue() != null )
                                         tempAggValue += Double.parseDouble( dv1.getValue() );
                                 }
@@ -1466,7 +1471,8 @@
                                     double tempAggValue = 0.0;
                                     for ( Period p1 : pList )
                                     {
-                                        DataValue dv1 = dataValueService.getDataValue( ou, dElement, p1, decoc );
+                                        //DataValue dv1 = dataValueService.getDataValue( ou, dElement, p1, decoc );
+                                        DataValue dv1 = dataValueService.getDataValue( dElement, p1, ou, decoc );
                                         if ( dv1 != null && dv1.getValue() != null )
                                             tempAggValue += Double.parseDouble( dv1.getValue() );
                                     }
@@ -1510,8 +1516,8 @@
                                     double tempAggValue = 0.0;
                                     for ( Period p1 : pList )
                                     {
-                                        DataValue dv1 = dataValueService.getDataValue( childOrgUnit, dElement, p1,
-                                            decoc1 );
+                                        //DataValue dv1 = dataValueService.getDataValue( childOrgUnit, dElement, p1, decoc1 );
+                                        DataValue dv1 = dataValueService.getDataValue( dElement, p1, childOrgUnit, decoc );
                                         if ( dv1 != null && dv1.getValue() != null )
                                             tempAggValue += Double.parseDouble( dv1.getValue() );
                                     }
@@ -1541,7 +1547,8 @@
                                         double tempAggValue = 0.0;
                                         for ( Period p1 : pList )
                                         {
-                                            DataValue dv1 = dataValueService.getDataValue( ou, dElement, p1, decoc1 );
+                                            //DataValue dv1 = dataValueService.getDataValue( ou, dElement, p1, decoc1 );
+                                            DataValue dv1 = dataValueService.getDataValue( dElement, p1, ou, decoc1 );
                                             if ( dv1 != null && dv1.getValue() != null )
                                                 tempAggValue += Double.parseDouble( dv1.getValue() );
                                         }

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/charts/GenerateChartDataElementAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/charts/GenerateChartDataElementAction.java	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/charts/GenerateChartDataElementAction.java	2014-03-05 06:21:56 +0000
@@ -426,7 +426,8 @@
         drillDownPeriodNames = "";
         SimpleDateFormat simpleDateFormat = new SimpleDateFormat( "MMM-yyyy" );
         periodNames = new ArrayList<String>();
-
+        
+        // for weekly period
         if ( periodTypeLB.equalsIgnoreCase( WeeklyPeriodType.NAME ) )
         {
             int periodCount = 0;
@@ -461,6 +462,42 @@
                 periodCount++;
             }
         }
+        
+        // for Forteen period
+        /*
+        if ( periodTypeLB.equalsIgnoreCase( ForteenPeriodType.NAME ) )
+        {
+            int periodCount = 0;
+            for ( String periodStr : periodLB )
+            {
+                
+                String  startForteenPeriodDate = periodStr.split( "To" )[0].trim(); //for start forteen period
+                String  endForteenPeriodDate = periodStr.split( "To" )[1].trim(); //for end forteen period
+                
+                startD = startForteenPeriodDate.trim();
+                endD = endForteenPeriodDate.trim();
+                
+                if ( periodCount == periodLB.size() - 1 )
+                {
+                    drillDownPeriodStartDate += startD;
+                    drillDownPeriodEndDate += endD;
+                    drillDownPeriodNames += periodStr;
+                }
+                else
+                {
+                    drillDownPeriodStartDate += startD + ";";
+                    drillDownPeriodEndDate += endD + ";";
+                    drillDownPeriodNames += periodStr + ";";
+                }
+
+                selStartPeriodList.add( format.parseDate( startD ) );
+                selEndPeriodList.add( format.parseDate( endD ) );
+                periodNames.add( periodStr );
+                periodCount++;
+            }
+        }        
+        */
+        
         // for FinancialAprilPeriodType
         else if ( periodTypeLB.equalsIgnoreCase( FinancialAprilPeriodType.NAME ) )
         {
@@ -932,7 +969,9 @@
                         Collection<Period> periods = periodService.getPeriodsBetweenDates( startDate, endDate );
                         for ( Period period : periods )
                         {
-                            DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc );
+                            //DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc );
+                            DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgUnit, decoc );
+                            
                             try
                             {
                                 aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -964,7 +1003,8 @@
                             Collection<Period> periods = periodService.getPeriodsBetweenDates( startDate, endDate );
                             for ( Period period : periods )
                             {
-                                DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc1 );
+                                //DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc1 );
+                                DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgUnit, decoc1 );
                                 try
                                 {
                                     aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -1079,7 +1119,8 @@
                         {
                             for ( Period period : periods )
                             {
-                                DataValue dataValue = dataValueService.getDataValue( orgChild, dataElement, period, decoc );
+                                //DataValue dataValue = dataValueService.getDataValue( orgChild, dataElement, period, decoc );
+                                DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgChild, decoc );
                                 try
                                 {
                                     aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -1109,8 +1150,8 @@
                             {
                                 for ( Period period : periods )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( orgChild, dataElement, period,
-                                        decoc1 );
+                                    //DataValue dataValue = dataValueService.getDataValue( orgChild, dataElement, period, decoc1 );
+                                    DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgChild, decoc1 );
                                     try
                                     {
                                         aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -1222,8 +1263,8 @@
                         {
                             for ( Period period : periods )
                             {
-                                DataValue dataValue = dataValueService.getDataValue( orgunit, dataElement, period,
-                                    decoc );
+                                //DataValue dataValue = dataValueService.getDataValue( orgunit, dataElement, period, decoc );
+                                DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgunit, decoc );
                                 try
                                 {
                                     aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -1253,8 +1294,8 @@
                             {
                                 for ( Period period : periods )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( orgunit, dataElement, period,
-                                        decoc1 );
+                                    //DataValue dataValue = dataValueService.getDataValue( orgunit, dataElement, period, decoc1 );
+                                    DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgunit, decoc1 );
                                     try
                                     {
                                         aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -1372,8 +1413,8 @@
                         {
                             for ( Period period : periods )
                             {
-                                DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period,
-                                    decoc );
+                                //DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc );
+                                DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgUnit, decoc );
                                 try
                                 {
                                     aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -1403,8 +1444,8 @@
                             {
                                 for ( Period period : periods )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period,
-                                        decoc1 );
+                                    //DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc1 );
+                                    DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgUnit, decoc1 );
                                     try
                                     {
                                         aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -1535,9 +1576,8 @@
                             {
                                 for ( Period period : periods )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period,
-                                        decoc );
-
+                                    //DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc );
+                                    DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgUnit, decoc );
                                     try
                                     {
                                         aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -1568,8 +1608,8 @@
                                 {
                                     for ( Period period : periods )
                                     {
-                                        DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period,
-                                            decoc1 );
+                                        //DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc1 );
+                                        DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgUnit, decoc1 );
 
                                         try
                                         {

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/charts/GenerateChartIndicatorAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/charts/GenerateChartIndicatorAction.java	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/charts/GenerateChartIndicatorAction.java	2014-03-05 06:26:08 +0000
@@ -456,6 +456,48 @@
                 //System.out.println( startD + " : " + endD );
             }
         }
+        
+        
+        // for Forteen period
+        /*
+        if ( periodTypeLB.equalsIgnoreCase( ForteenPeriodType.NAME ) )
+        {
+          //  System.out.println( " Inside  weekly" );
+            int periodCount = 0;
+            for ( String periodStr : periodLB )
+            {
+                String  startForteenPeriodDate = periodStr.split( "To" )[0].trim() ; //for start week
+                String  endForteenPeriodDate = periodStr.split( "To" )[1].trim() ; //for end week
+                
+                startD = startForteenPeriodDate.trim();
+                endD = endForteenPeriodDate.trim();
+                
+                // for DrillDown Period String
+                if( periodCount == periodLB.size()-1 )
+                {
+                    drillDownPeriodStartDate += startD;
+                    drillDownPeriodEndDate += endD;
+                    drillDownPeriodNames += periodStr;
+                }
+                else
+                {
+                    drillDownPeriodStartDate += startD + ";";
+                    drillDownPeriodEndDate += endD + ";";
+                    drillDownPeriodNames += periodStr + ";";
+                }
+                
+                selStartPeriodList.add( format.parseDate( startD ) );
+                selEndPeriodList.add( format.parseDate( endD ) );
+                
+                periodNames.add( periodStr );
+                periodCount++;
+                //System.out.println( startD + " : " + endD );
+            }
+        }
+                
+        */
+        
+        
         // for FinancialAprilPeriodType
         else if ( periodTypeLB.equalsIgnoreCase( FinancialAprilPeriodType.NAME ) )
         {

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/charts/GenerateDrillDownResultAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/charts/GenerateDrillDownResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ga/action/charts/GenerateDrillDownResultAction.java	2014-07-05 07:08:54 +0000
@@ -1,62 +1,32 @@
 package org.hisp.dhis.dataanalyser.ga.action.charts;
 
-import java.io.BufferedInputStream;
 import java.io.File;
-import java.io.FileInputStream;
 import java.io.InputStream;
-import java.text.SimpleDateFormat;
 import java.util.ArrayList;
 import java.util.Collection;
 import java.util.Collections;
 import java.util.Date;
-import java.util.HashMap;
 import java.util.Iterator;
 import java.util.List;
-import java.util.Map;
 import java.util.UUID;
 
 import javax.xml.parsers.DocumentBuilder;
 import javax.xml.parsers.DocumentBuilderFactory;
 
-import jxl.Workbook;
-import jxl.format.Alignment;
-import jxl.format.Border;
-import jxl.format.BorderLineStyle;
-import jxl.format.Colour;
-import jxl.format.VerticalAlignment;
-import jxl.write.Label;
-import jxl.write.WritableCellFormat;
-import jxl.write.WritableSheet;
-import jxl.write.WritableWorkbook;
-
 import org.amplecode.quick.StatementManager;
-import org.hisp.dhis.caseaggregation.CaseAggregationCondition;
 import org.hisp.dhis.caseaggregation.CaseAggregationConditionService;
 import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
 import org.hisp.dhis.config.ConfigurationService;
 import org.hisp.dhis.config.Configuration_IN;
-import org.hisp.dhis.dataelement.DataElement;
 import org.hisp.dhis.dataelement.DataElementCategoryOptionCombo;
 import org.hisp.dhis.dataelement.DataElementCategoryService;
 import org.hisp.dhis.dataelement.DataElementService;
 import org.hisp.dhis.i18n.I18nFormat;
 import org.hisp.dhis.organisationunit.OrganisationUnit;
 import org.hisp.dhis.organisationunit.OrganisationUnitService;
-import org.hisp.dhis.patient.Patient;
-import org.hisp.dhis.patient.PatientAttribute;
-import org.hisp.dhis.patient.PatientAttributeService;
-import org.hisp.dhis.patient.PatientIdentifier;
-import org.hisp.dhis.patient.PatientIdentifierService;
-import org.hisp.dhis.patient.PatientIdentifierType;
-import org.hisp.dhis.patient.PatientIdentifierTypeService;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValue;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValueService;
-import org.hisp.dhis.patientdatavalue.PatientDataValue;
 import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
-import org.hisp.dhis.program.ProgramInstance;
-import org.hisp.dhis.program.ProgramStageInstance;
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
 import org.w3c.dom.Node;
@@ -127,6 +97,7 @@
         this.periodService = periodService;
     }
 
+    /*
     private PatientAttributeValueService patientAttributeValueService;
 
     public void setPatientAttributeValueService( PatientAttributeValueService patientAttributeValueService )
@@ -154,7 +125,8 @@
     {
         this.patientIdentifierTypeService = patientIdentifierTypeService;
     }
-
+    */
+    
     
     // -------------------------------------------------------------------------
     // Input & Output
@@ -195,7 +167,7 @@
 
     private OrganisationUnit selectedOrgUnit;
 
-    private DataElement de;
+    //private DataElement de;
 
     private DataElementCategoryOptionCombo coc;
 
@@ -257,7 +229,7 @@
         periods = periodService.getPeriodsBetweenDates( periodType, tempStartDate, tempEndDate );
         
         selectedOrgUnit = organisationUnitService.getOrganisationUnit( orgunit );
-        de = dataElementService.getDataElement( deid );
+        //de = dataElementService.getDataElement( deid );
         coc = dataElementCategoryOptionComboService.getDataElementCategoryOptionCombo( cocid );
         
         inputTemplatePath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "template"
@@ -266,13 +238,13 @@
         outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "output"
             + File.separator + UUID.randomUUID().toString() + ".xls";
 
-        generatDrillDownReport();
+        //generatDrillDownReport();
 
         statementManager.destroy();
         
         return SUCCESS;
     }
-
+/*   
     public void generatDrillDownReport()
         throws Exception
     {
@@ -312,10 +284,13 @@
             
             for( Period period : periods )
             {
-                patientDataValues.addAll( caseAggregationConditionService.getPatientDataValues( caseAggregationCondition, ou, period ) );
-            }
+				/**
+				* TODO - Commented this to fix compilation error while merging to 2.12
+				*/	
+                //patientDataValues.addAll( caseAggregationConditionService.getPatientDataValues( caseAggregationCondition, ou, period ) );
+            //}
             
-            if ( patientDataValues != null )
+            /*if ( patientDataValues != null )
             {
                 ouPatientDataValueMap.put( ou, patientDataValues );
                 orgUnitDataList.add( ou );
@@ -326,18 +301,18 @@
                         des.add( patientDataValue.getDataElement() );
                     }
                 }
-            }
-        }
+            }*/
+        //}
 
-        WritableSheet sheet0 = outputReportWorkbook.getSheet( 0 );
+ /*       WritableSheet sheet0 = outputReportWorkbook.getSheet( 0 );
         WritableCellFormat wCellformat1 = new WritableCellFormat();
         wCellformat1.setBorder( Border.ALL, BorderLineStyle.THIN );
         wCellformat1.setAlignment( Alignment.CENTRE );
         wCellformat1.setVerticalAlignment( VerticalAlignment.CENTRE );
         wCellformat1.setWrap( true );
         wCellformat1.setBackground( Colour.GREY_40_PERCENT );
-
-        int count1 = 0;
+*/
+/*        int count1 = 0;
         for ( DataElement de : des )
         {
             // DEName
@@ -380,14 +355,15 @@
                         {
                             if ( deCodeString.equalsIgnoreCase( "Name" ) )
                             {
-                                tempStr = patient.getFullName();
-                            }
+                                tempStr = patient.getName();
+                                }
                             else if ( deCodeString.equalsIgnoreCase( "Age" ) )
                             {
-                                tempStr = patient.getAge();
+                                tempStr = "";
                             }
                             else if ( deCodeString.equalsIgnoreCase( "Sex" ) )
-                            {
+                            {*/
+                                /*
                                 if ( patient.getGender().equalsIgnoreCase( "M" ) )
                                 {
                                     tempStr = "Male";
@@ -400,7 +376,8 @@
                                 {
                                     tempStr = "";
                                 }
-                            }
+                                */
+/*                            }
                         }
                         else if ( sType.equalsIgnoreCase( "caseAttribute" ) )
                         {
@@ -462,10 +439,10 @@
                     sheet0.addCell( new Label( colNo, rowNo, value, wCellformat ) );
 
                 }
-                colNo++;
+                colNo++;*/
 
                 // Execution date
-                SimpleDateFormat simpleDateFormat = new SimpleDateFormat( "yyyy-MM-dd" );
+/*                SimpleDateFormat simpleDateFormat = new SimpleDateFormat( "yyyy-MM-dd" );
                 String eDate = simpleDateFormat.format( executionDate );
                 sheet0.addCell( new Label( colNo, rowNo, "" + eDate, wCellformat ) );
 
@@ -483,9 +460,9 @@
                 rowNo++;
                 srno++;
             }
-        }
-        outputReportWorkbook.write();
-        outputReportWorkbook.close();
+        }*/
+        //outputReportWorkbook.write();
+ /*       outputReportWorkbook.close();
 
         fileName = reportFileNameTB.replace( ".xls", "" );
         fileName += "_" + selectedOrgUnit.getShortName() + ".xls";
@@ -493,7 +470,7 @@
         inputStream = new BufferedInputStream( new FileInputStream( outputReportFile ) );
         outputReportFile.deleteOnExit();
 
-    }
+    }*/
 
     @SuppressWarnings( "unchecked" )
     public List<OrganisationUnit> getChildOrgUnitTree( OrganisationUnit orgUnit )

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/nr/action/GenerateNullReporterResultAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/nr/action/GenerateNullReporterResultAction.java	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/nr/action/GenerateNullReporterResultAction.java	2014-03-05 06:15:04 +0000
@@ -306,14 +306,14 @@
     private Map<OrganisationUnit, Integer> ouChildCountMap;
     
     private String selectedDataSet;
-    
+
     public void setSelectedDataSet( String selectedDataSet )
     {
         this.selectedDataSet = selectedDataSet;
     }
-    
+
     private String dataSetName;
-    
+
     public String getDataSetName()
     {
         return dataSetName;
@@ -326,7 +326,6 @@
         throws Exception
     {
         statementManager.initialise();
-        // VelocityContext context = new VelocityContext();
         System.out.println( "Null Report Generation Start Time is : " + new Date() );
         simpleDateFormat = new SimpleDateFormat( "MMM y" );
 
@@ -341,7 +340,6 @@
         nullReportResult = new HashMap<OrganisationUnit, Map<Period, List<DataElement>>>();
         selOUList = new ArrayList<OrganisationUnit>();
         ouChildCountMap = new HashMap<OrganisationUnit, Integer>();
-        // OrgUnit Related Info
 
         if ( ouSelCB != null )
         {
@@ -372,7 +370,7 @@
         minOULevel = 1;
         minOULevel = organisationUnitService.getLevelOfOrganisationUnit( selOUList.get( 0 ).getId() );
 
-        int maxOuLevel = 1;
+        int maxOuLevel;
         if ( orgUnitLevelCB != null )
         {
             maxOuLevel = orgUnitLevelCB;
@@ -382,25 +380,17 @@
             maxOuLevel = minOULevel;
         }
 
-        //Period startDate = periodService.getPeriod( sDateLB );
-        //Period endDate = periodService.getPeriod( eDateLB );
         List<OrganisationUnit> ouHavingNullValuesWithHigherLevel = new ArrayList<OrganisationUnit>();
         ouHavingNullValuesWithLowerLevel = new ArrayList<OrganisationUnit>();
         ouHavingNullValues = new ArrayList<OrganisationUnit>();
         List<DataElement> deList = new ArrayList<DataElement>();
 
         dePeriodTypeMap = new HashMap<DataElement, PeriodType>();
-        // periodDeListMap = new HashMap<Period, List<DataElement>>();
         
         DataSet dataSet = dataSetService.getDataSet( Integer.parseInt( selectedDataSet ) );
         dataSetName = dataSet.getName();
-       // Collection<DataElement> dataElements = dataSet.getDataElements();
         List<DataElement> dataElementList = new ArrayList<DataElement>( dataSet.getDataElements()  );
         
-        
-        
-        //System.out.println("----------------Data Element  Size is ------- " + dataElementList.size()  );
-        
         for ( DataElement dataElement : dataElementList )
         {
             DataElement de1 = dataElementService.getDataElement( dataElement.getId() );
@@ -413,25 +403,22 @@
         Period endPeriod = periodService.getPeriod( eDateLB );
         PeriodType dataSetPeriodType = dataSet.getPeriodType(); 
         periodsColl = new ArrayList<Period>( periodService.getPeriodsBetweenDates( dataSetPeriodType, startPeriod.getStartDate(), endPeriod.getEndDate() ));
-        
-        //periodsColl = new ArrayList<Period>( periodService.getIntersectingPeriods( startDate.getStartDate(), endDate.getEndDate() ) );
         size = periodsColl.size();
-       // System.out.println("periods size is " + size );
-        Collections.sort( periodsColl, new PeriodTypeComparator() );
+        //Collections.sort( periodsColl, new PeriodTypeComparator() );
+        
+        Collections.sort( periodsColl );
+        
         periods = new ArrayList<Period>();
 
         for ( OrganisationUnit curOu : selOUList )
         {
-            // System.out.println("OrganisationUnit "+curOu);
 
             periodDeListMap = new HashMap<Period, List<DataElement>>();
             for ( Period p : periodsColl )
             {
-                // System.out.println(p.getStartDate() + " - "+p.getEndDate());
-                
+
                 List<DataElement> resultDeList = new ArrayList<DataElement>();
-               // List<String> resultDeList1 = new ArrayList<String>();
-                //String comment = "";
+
                 for ( DataElement de : deList )
                 {
 
@@ -447,7 +434,7 @@
                             {
                                 Double tempVal = aggregationService.getAggregatedDataValue( de, decoc,
                                     p.getStartDate(), p.getEndDate(), curOu );
-                                // System.out.println("tempVal = " + tempVal);
+
                                 if ( includeZeros != null )
                                 {
                                     if(tempVal == null)
@@ -485,12 +472,9 @@
                                     }
                                 }
                             }
-
-                            // System.out.println("aggValue = "+aggValue);
                             if ( aggValue < 0.0 )
                             {
                                 resultDeList.add( de );
-                               // resultDeList1.add( de + ":" + comment );
                             }
                         }
                         else
@@ -503,18 +487,17 @@
                             Iterator<DataElementCategoryOptionCombo> optionComboIterator = optionCombos.iterator();
                             while ( optionComboIterator.hasNext() )
                             {
-                                DataElementCategoryOptionCombo decoc1 = (DataElementCategoryOptionCombo) optionComboIterator.next();
+                                DataElementCategoryOptionCombo dataElementCategoryOptionCombo =  optionComboIterator.next();
                                     
-                                DataValue dv1 = dataValueService.getDataValue( curOu, de, p, decoc1 );
-                                //comment = dv1.getComment();
-                                if ( dv1 != null )
+                                //DataValue dataValue = dataValueService.getDataValue( curOu, de, p, dataElementCategoryOptionCombo );
+                                DataValue dataValue = dataValueService.getDataValue( de, p, curOu, dataElementCategoryOptionCombo );
+
+                                if ( dataValue != null )
                                 {
                                     if ( includeZeros != null )
                                     {
-                                        // System.out.println("dataValue is not null, dataValue = "+dataValue.getValue());
-                                        if ( Double.parseDouble( dv1.getValue() ) != 0 )
+                                        if ( Double.parseDouble( dataValue.getValue() ) != 0 )
                                         {
-                                            //resultDeList.add( de );
                                             flag = 1;
                                         }
                                     }
@@ -528,44 +511,19 @@
                             if( flag == 0 )
                             {
                                 resultDeList.add( de );
-                                //resultDeList1.add( de + ":" + comment );
-                            }
-                                
-                            /*
-                            
-                            DataValue dataValue = dataValueService.getDataValue( curOu, de, p );
-
-                            if ( dataValue == null )
-                            {
-                                resultDeList.add( de );
-                                // System.out.println("dataValue is null ");
-                            }
-                            else
-                            {
-                                if ( includeZeros != null )
-                                {
-                                    // System.out.println("dataValue is not null, dataValue = "+dataValue.getValue());
-                                    if ( Integer.parseInt( dataValue.getValue() ) == 0 )
-                                    {
-                                        resultDeList.add( de );
-
-                                    }
-                                }
-
-                            }
-                            */
+
+                            }
 
                         }
                     }
                 }
-               // System.out.println("---------------Size of data element List is  " + resultDeList.size() );
+
                 if ( resultDeList.size() != 0 )
                 {
                     periodDeListMap.put( p, resultDeList );
-                    // nullReportResult.put(curOu, periodDeListMap);
+
                 }
             }
-            //System.out.println("----------------------- " + periodDeListMap.size() + " " + curOu );
 
             if ( periodDeListMap.size() != 0 )
             {
@@ -584,8 +542,7 @@
             }
 
         }
-        // System.out.println("ouHavingNullValues size = "+ouHavingNullValues.size()
-        // + "minOULevel = "+minOULevel + " maxOuLevel = "+maxOuLevel);
+
         for ( int level = minOULevel; level < maxOuLevel; level++ )
         {
             for ( OrganisationUnit ou : ouHavingNullValuesWithHigherLevel )
@@ -595,7 +552,6 @@
                 {
                     ouHavingNullValues.remove( ou );
                     ouHavingNullValuesWithLowerLevel.add( ou );
-                    // System.out.println("--------------------- removing ou "+ou.getName());
                 }
             }
         }
@@ -608,11 +564,14 @@
         {
             size = 0;
         }
-        
-        //System.out.println("periods size is " + size );
+
         Collections.sort( ouHavingNullValues, new IdentifiableObjectNameComparator() );
         Collections.sort( periods, new PeriodComparator() );
-        Collections.sort( periods, new PeriodTypeComparator() );
+        
+        //Collections.sort( periods, new PeriodTypeComparator() );
+        
+        Collections.sort( periods);
+        
         statementManager.destroy();
         System.out.println( "Null Report Generation End Time is : " + new Date() );
         return SUCCESS;
@@ -634,9 +593,9 @@
         OrganisationUnit child;
         while ( childIterator.hasNext() )
         {
-            child = (OrganisationUnit) childIterator.next();
+            child = childIterator.next();
             orgUnitTree.addAll( getChildOrgUnitTree( child ) );
         }
         return orgUnitTree;
-    }// getChildOrgUnitTree end
+    }
 }

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/sms/action/GenerateDueDatesFormAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/sms/action/GenerateDueDatesFormAction.java	2011-11-03 06:07:39 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/sms/action/GenerateDueDatesFormAction.java	2014-03-05 06:15:45 +0000
@@ -1,26 +1,26 @@
 package org.hisp.dhis.dataanalyser.sms.action;
 
 import java.io.IOException;
+import java.text.SimpleDateFormat;
 import java.util.ArrayList;
+import java.util.Calendar;
 import java.util.Collection;
 import java.util.HashMap;
 import java.util.Iterator;
-import org.hisp.dhis.organisationunit.OrganisationUnit;
-
-import org.hisp.dhis.period.PeriodService;
-
-import com.opensymphony.xwork2.Action;
-import java.text.SimpleDateFormat;
-import java.util.Calendar;
+
 import org.hisp.dhis.dataanalyser.util.BulkSMSHttpInterface;
 import org.hisp.dhis.dataanalyser.util.DashBoardService;
 import org.hisp.dhis.dataset.DataSetService;
+import org.hisp.dhis.organisationunit.OrganisationUnit;
 import org.hisp.dhis.oust.manager.SelectionTreeManager;
+import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.program.Program;
 import org.hisp.dhis.program.ProgramService;
 import org.hisp.dhis.program.ProgramStage;
 import org.hisp.dhis.program.ProgramStageService;
 
+import com.opensymphony.xwork2.Action;
+
 public class GenerateDueDatesFormAction implements Action
 {
     

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ta/action/GenerateTabularAnalysisFormAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ta/action/GenerateTabularAnalysisFormAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ta/action/GenerateTabularAnalysisFormAction.java	2014-03-05 05:57:37 +0000
@@ -248,11 +248,22 @@
         return sections;
     }
     
+    private String forteenPeriodTypeName;
+    
+    public String getForteenPeriodTypeName()
+    {
+        return forteenPeriodTypeName;
+    }
+    
+    // -------------------------------------------------------------------------
+    // Action Implementation
+    // -------------------------------------------------------------------------    
+    
     public String execute()
         throws Exception
     {
         /* DataElements and Groups */
-        dataElements = new ArrayList<DataElement>( dataElementService.getAllDataElements() );
+        dataElements = new ArrayList<DataElement>( dataElementService.getAllActiveDataElements() );
         
         System.out.println(" dataElements size = "+dataElements.size());
         // take only those dataElement which are VALUE_TYPE_INT and DOMAIN_TYPE_AGGREGATE
@@ -317,6 +328,7 @@
         
         dailyPeriodTypeName = DailyPeriodType.NAME;
         weeklyPeriodTypeName = WeeklyPeriodType.NAME;
+        //forteenPeriodTypeName = ForteenPeriodType.NAME;
         monthlyPeriodTypeName = MonthlyPeriodType.NAME;
         quarterlyPeriodTypeName = QuarterlyPeriodType.NAME;
         sixMonthPeriodTypeName = SixMonthlyPeriodType.NAME;

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ta/action/GenerateTabularAnalysisResultAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ta/action/GenerateTabularAnalysisResultAction.java	2011-12-14 10:18:12 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/ta/action/GenerateTabularAnalysisResultAction.java	2014-03-05 06:12:56 +0000
@@ -364,6 +364,36 @@
                 periodNames.add( periodStr );
             }
         }
+        
+        // for Forteen period
+        /*
+        if ( periodTypeLB.equalsIgnoreCase( ForteenPeriodType.NAME ) )
+        {
+            Integer pCount = 0;
+            for ( String periodStr : periodLB )
+            {
+                String  startForteenPeriodDate = periodStr.split( "To" )[0].trim(); //for start forteen period
+                String  endForteenPeriodDate = periodStr.split( "To" )[1].trim(); //for end forteen period
+                
+                startD = startForteenPeriodDate.trim();
+                endD = endForteenPeriodDate.trim();
+                
+                Date sDate = format.parseDate( startD );
+                Date eDate = format.parseDate( endD );
+                selStartPeriodList.add( sDate );
+                selEndPeriodList.add( eDate );
+                
+                List<Period> periodList = new ArrayList<Period>( periodService.getIntersectingPeriods( sDate, eDate ) );
+                List<Integer> periodIds = new ArrayList<Integer>( getIdentifiers(Period.class, periodList ) );
+                periodMap.put( pCount, periodIds );
+                
+                pCount++;
+                
+                periodNames.add( periodStr );
+            }
+        }
+        */
+        
         // for FinancialAprilPeriodType
         else if ( periodTypeLB.equalsIgnoreCase( FinancialAprilPeriodType.NAME ) )
         {
@@ -658,12 +688,12 @@
             }
             else if ( aggData.equalsIgnoreCase( GENERATEAGGDATA ) && aggPeriodCB == null )
             {
-                System.out.println("Inside generateOrgUnitLevelData_GenerateAggregateData_Periodwise method");
+                System.out.println("Inside generateOrgUnitLevelData_GenerateAggregateData_Periodwise method: " + new Date());
                 generateOrgUnitLevelData_GenerateAggregateData_Periodwise();
             }
             else if ( aggData.equalsIgnoreCase( GENERATEAGGDATA ) && aggPeriodCB != null )
             {
-                System.out.println("Inside generateOrgUnitLevelData_GenerateAggregateData_AggPeriods method");
+                System.out.println("Inside generateOrgUnitLevelData_GenerateAggregateData_AggPeriods method: " + new Date());
                 generateOrgUnitLevelData_GenerateAggregateData_AggPeriods();
             }
             else if ( aggData.equalsIgnoreCase( USECAPTUREDDATA ) && aggPeriodCB == null )
@@ -708,7 +738,7 @@
         Collection<Integer> periodIds = new ArrayList<Integer>( getIdentifiers(Period.class, periods ) );
         periodIdsByComma = getCommaDelimitedString( periodIds );
         
-        System.out.println("PeriodIds: "+ periodIdsByComma );
+        //System.out.println("PeriodIds: "+ periodIdsByComma );
         
         for ( String service : selectedServices )
         {
@@ -729,7 +759,10 @@
         }
         
         String indicaotrDes = reportService.getDataelementIdsAsString( indicatorList );
-        dataElementIdsByComma += "," + indicaotrDes;
+        //System.out.println("indicaotrDes: "+ indicaotrDes );
+		
+		if( indicaotrDes != null && !indicaotrDes.trim().equals( "" ) )
+			dataElementIdsByComma += "," + indicaotrDes;
     }
 
     // -------------------------------------------------------------------------
@@ -741,8 +774,6 @@
         int headerRow = 0;
         int headerCol = 0;
 
-        //String raFolderName = configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue();
-        //String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "output" + File.separator + UUID.randomUUID().toString() + ".xls";
         String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator +  Configuration_IN.DEFAULT_TEMPFOLDER;
         File newdir = new File( outputReportPath );
         if( !newdir.exists() )
@@ -796,17 +827,37 @@
         DataElementCategoryOptionCombo selDecoc = new DataElementCategoryOptionCombo();
         int flag = 0;
 
+        List<Integer> periodIds = new ArrayList<Integer>();
+        for( Integer periodMapKey : periodMap.keySet() )
+        {
+        	periodIds.addAll( periodMap.get( periodMapKey ) );
+        }
+        periodIdsByComma = getCommaDelimitedString( periodIds );
+        
+        int periodCount = 0;
+        long totalDiffDays = 0;
+        for ( Date sDate : selStartPeriodList )
+        {
+            Date eDate = selEndPeriodList.get( periodCount++ );
+            
+            long diff = eDate.getTime() - sDate.getTime();
+            long diffDays = ( diff / (24 * 60 * 60 * 1000) )+1;
+            totalDiffDays += diffDays;
+        }
+
         List<Integer> orgUnitIds = new ArrayList<Integer>( getIdentifiers(OrganisationUnit.class, selOUList ) );
         orgUnitIdsByComma = getCommaDelimitedString( orgUnitIds );
         
-        Map<String, String> aggDataMap = new HashMap<String, String>( reportService.getDataFromDataValueTableByPeriodAgg( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
-    
+        Map<String, String> aggDataMap = new HashMap<String, String>( );
+        System.out.println("Before getting UseCaptured Data : " + new Date() );
+        aggDataMap.putAll( reportService.getCapturedDataFromDataValueTableByDeAndOrgUnitwise( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
+        System.out.println("After getting UseCaptured Data : " + new Date() + " ---- " + aggDataMap.size() );
+        
         /* Calculation Part */
         int rowCount = 1;
         int colCount = 0;
         for( OrganisationUnit ou : selOUList )
         {
-            System.out.println("Entered into orgunitloop :"+new Date());
             sheet0.addCell( new Number( headerCol, headerRow + rowCount, rowCount, getCellFormat2() ) );
             
             Integer level = orgunitLevelMap.get( ou.getId() );
@@ -841,20 +892,29 @@
                     
                     try
                     {
-                        numValue = Double.parseDouble( getAggValByOrgUnit( selIndicator.getNumerator(), aggDataMap, ou.getId() ) );
-                    }
-                    catch( Exception e )
-                    {
-                    }
-                    
-                    try
-                    {
-                        denValue = Double.parseDouble( getAggValByOrgUnit( selIndicator.getDenominator(), aggDataMap, ou.getId() ) );
-                    }
-                    catch( Exception e )
-                    {
-                    }
-                    
+                        numValue = Double.parseDouble( getAggValByOrgUnit_UID( selIndicator.getNumerator(), aggDataMap, ou.getId() ) );
+                    }
+                    catch( Exception e )
+                    {
+                    	numValue = 0.0;
+                    }
+                    
+                    if( !selIndicator.getDenominator().trim().equals( "1" ) )
+                    {
+	                    try
+	                    {
+	                        denValue = Double.parseDouble( getDenominatorValueByOrgUnit_UID( selIndicator.getDenominator(), aggDataMap, ou.getId(), totalDiffDays ) );
+	                    }
+	                    catch( Exception e )
+	                    {
+	                    	denValue = 0.0;
+	                    }
+                    }
+                    else 
+                    {
+                        denValue = 1.0;
+                    }
+
                     try
                     {
                         if( denValue != 0.0 )
@@ -888,7 +948,7 @@
                         
                         if ( selDataElement.getType().equalsIgnoreCase( DataElement.VALUE_TYPE_INT ) )
                         {
-                            tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getId()+":"+selDecoc.getId() );
+                            tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+selDecoc.getUid() );
                             if( tempStr != null )
                             {
                                 try
@@ -917,7 +977,7 @@
                         {
                             for( DataElementCategoryOptionCombo optionCombo : optionCombos )
                             {
-                                tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getId()+":"+optionCombo.getId() );
+                                tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+optionCombo.getUid() );
                                 if( tempStr != null )
                                 {
                                     try
@@ -970,9 +1030,6 @@
     {
         int headerRow = 0;
         int headerCol = 0;
-
-        //String raFolderName = configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue();
-        //String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "output" + File.separator + UUID.randomUUID().toString() + ".xls";
         
         String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator +  Configuration_IN.DEFAULT_TEMPFOLDER;
         File newdir = new File( outputReportPath );
@@ -1014,10 +1071,33 @@
         DataElementCategoryOptionCombo selDecoc = new DataElementCategoryOptionCombo();
         int flag = 0;
 
+		List<Integer> periodIds = new ArrayList<Integer>();
+        for( Integer periodMapKey : periodMap.keySet() )
+        {
+        	periodIds.addAll( periodMap.get( periodMapKey ) );
+        }
+        periodIdsByComma = getCommaDelimitedString( periodIds );
+        
+        int periodCount = 0;
+        long totalDiffDays = 0;
+        for ( Date sDate : selStartPeriodList )
+        {
+            Date eDate = selEndPeriodList.get( periodCount++ );
+            
+            long diff = eDate.getTime() - sDate.getTime();
+            long diffDays = ( diff / (24 * 60 * 60 * 1000) )+1;
+            totalDiffDays += diffDays;
+        }
+
         List<Integer> orgUnitIds = new ArrayList<Integer>( getIdentifiers(OrganisationUnit.class, selOUList ) );
         orgUnitIdsByComma = getCommaDelimitedString( orgUnitIds );
         
-        Map<String, String> aggDataMap = new HashMap<String, String>( reportService.getDataFromDataValueTableByPeriodAgg( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
+        //Map<String, String> aggDataMap = new HashMap<String, String>( reportService.getDataFromDataValueTableByPeriodAgg( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
+        Map<String, String> aggDataMap = new HashMap<String, String>( );
+        System.out.println("Before getting UseCaptured Data : " + new Date() );
+        aggDataMap.putAll( reportService.getCapturedDataFromDataValueTableByDeAndOrgUnitwise( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
+        System.out.println("After getting UseCaptured Data : " + new Date() + " ---- " + aggDataMap.size() );
+
     
         /* Calculation Part */
         int rowCount = 1;
@@ -1069,18 +1149,27 @@
                     
                     try
                     {
-                        numValue = Double.parseDouble( getAggValByOrgUnit( selIndicator.getNumerator(), aggDataMap, ou.getId() ) );
+                        numValue = Double.parseDouble( getAggValByOrgUnit_UID( selIndicator.getNumerator(), aggDataMap, ou.getId() ) );
                     }
                     catch( Exception e )
                     {
+                    	numValue = 0.0;
                     }
                     
-                    try
+                    if( !selIndicator.getDenominator().trim().equals( "1" ) )
                     {
-                        denValue = Double.parseDouble( getAggValByOrgUnit( selIndicator.getDenominator(), aggDataMap, ou.getId() ) );
+	                    try
+	                    {
+	                        denValue = Double.parseDouble( getDenominatorValueByOrgUnit_UID( selIndicator.getDenominator(), aggDataMap, ou.getId(), totalDiffDays ) );
+	                    }
+	                    catch( Exception e )
+	                    {
+	                    	denValue = 0.0;
+	                    }
                     }
-                    catch( Exception e )
+                    else 
                     {
+                        denValue = 1.0;
                     }
                     
                     try
@@ -1116,7 +1205,7 @@
                         
                         if ( selDataElement.getType().equalsIgnoreCase( DataElement.VALUE_TYPE_INT ) )
                         {
-                            tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getId()+":"+selDecoc.getId() );
+                            tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+selDecoc.getUid() );
                             if( tempStr != null )
                             {
                                 try
@@ -1145,7 +1234,7 @@
                         {
                             for( DataElementCategoryOptionCombo optionCombo : optionCombos )
                             {
-                                tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getId()+":"+optionCombo.getId() );
+                                tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+optionCombo.getUid() );
                                 if( tempStr != null )
                                 {
                                     try
@@ -1383,8 +1472,10 @@
                                 Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                 if ( tempPeriod != null )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
-
+                                    //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    
+                                    DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, selDecoc );
+                                    
                                     if ( dataValue != null && dataValue.getValue() != null )
                                     {
                                         tempStr = dataValue.getValue();
@@ -1436,7 +1527,8 @@
                                     Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                     if( tempPeriod != null )
                                     {
-                                        DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, decoc1 );
 
                                         if ( dataValue != null )
                                         {
@@ -1705,9 +1797,10 @@
                                 Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                 if ( tempPeriod != null )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( ou, selDataElement,
-                                        tempPeriod, selDecoc );
-
+                                    //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    
+                                    DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, selDecoc );
+                                    
                                     if ( dataValue != null )
                                     {
                                         tempStr = dataValue.getValue();
@@ -1783,8 +1876,9 @@
                                     Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                     if ( tempPeriod != null )
                                     {
-                                        DataValue dataValue = dataValueService.getDataValue( ou, selDataElement,
-                                            tempPeriod, decoc1 );
+                                        //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        
+                                        DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, decoc1 );
 
                                         if ( dataValue != null )
                                         {
@@ -2097,9 +2191,10 @@
                                 Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                 if ( tempPeriod != null )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( ou, selDataElement,
-                                        tempPeriod, selDecoc );
-
+                                    //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    
+                                    DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, selDecoc );
+                                    
                                     if ( dataValue != null )
                                     {
                                         tempStr = dataValue.getValue();
@@ -2149,8 +2244,8 @@
                                     Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                     if ( tempPeriod != null )
                                     {
-                                        DataValue dataValue = dataValueService.getDataValue( ou, selDataElement,
-                                            tempPeriod, decoc1 );
+                                        //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, decoc1 );
 
                                         if ( dataValue != null )
                                         {
@@ -2274,9 +2369,6 @@
         int headerRow = 0;
         int headerCol = 0;
 
-        //String raFolderName = configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue();
-        //String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "output" + File.separator + UUID.randomUUID().toString() + ".xls";
-        
         String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator +  Configuration_IN.DEFAULT_TEMPFOLDER;
         File newdir = new File( outputReportPath );
         if( !newdir.exists() )
@@ -2335,19 +2427,39 @@
         List<Integer> orgUnitIds = new ArrayList<Integer>( getIdentifiers(OrganisationUnit.class, selOUList ) );
         orgUnitIdsByComma = getCommaDelimitedString( orgUnitIds );
         
-        Map<String, String> aggDataMap = new HashMap<String, String>( reportService.getDataFromDataValueTable( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
+        Map<String, Map<String, String>> aggDataMapByPeriod = new HashMap<String, Map<String, String>>();
+        
+        System.out.println("Before getting Captured Data : " + new Date() );
+        
+        SimpleDateFormat standardDateFormat = new SimpleDateFormat("yyyy-MM-dd");
+        int pCount = 0;
+        for ( Date sDate : selStartPeriodList )
+        {
+            String startDate = standardDateFormat.format( sDate );
+        	List<Integer> periodIds = new ArrayList<Integer>( periodMap.get( pCount++ ) );
+            periodIdsByComma = getCommaDelimitedString( periodIds );
+        	
+            Map<String, String> tempAggDataMap = reportService.getCapturedDataFromDataValueTableByDeAndOrgUnitwise( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma );
+            if( tempAggDataMap == null )
+            {
+            	tempAggDataMap = new HashMap<String, String>();
+            }
+            aggDataMapByPeriod.put( startDate, tempAggDataMap );
+        }
+        System.out.println("After getting Captured Data : " + new Date() );
     
         /* Calculation Part */
         int rowCount = 1;
         int colCount = 0;
         for( OrganisationUnit ou : selOUList )
         {
-            System.out.println("Entered into orgunitloop :"+new Date());
             sheet0.addCell( new Number( headerCol, headerRow + 1 + rowCount, rowCount, getCellFormat2() ) );
             
             Integer level = orgunitLevelMap.get( ou.getId() );
             if( level == null )
+            {
                 level = organisationUnitService.getLevelOfOrganisationUnit( ou.getId() );
+            }
             
             colCount = 1 + level - minOULevel;
             sheet0.addCell( new Label( colCount, headerRow + 1 + rowCount, ou.getName(), getCellFormat2() ) );
@@ -2397,9 +2509,13 @@
                 for ( Date sDate : selStartPeriodList )
                 {
                     Date eDate = selEndPeriodList.get( periodCount );
-                
-                    Collection<Integer> periodIds = new ArrayList<Integer>( periodMap.get( periodCount ) );
-                    System.out.println( periodIds );
+
+                    long diff = eDate.getTime() - sDate.getTime();
+                    long diffDays = ( diff / (24 * 60 * 60 * 1000) )+1;
+
+                    String keyDate = standardDateFormat.format( sDate );
+
+                    Map<String, String> aggDataMap = new HashMap<String, String>( aggDataMapByPeriod.get( keyDate ) );
 
                     double pwdvAggValue = 0.0;
                     double pwdAggIndValue = 0.0;
@@ -2410,46 +2526,34 @@
                         Double numValue = 0.0;
                         Double denValue = 0.0;
                         Double indValue = 0.0;
-                        for( Integer periodId : periodIds )
-                        {
-                            try
-                            {
-                                numValue += Double.parseDouble( getAggVal( selIndicator.getNumerator(), aggDataMap, ou.getId(), periodId ) );
-                            }
-                            catch( Exception e )
-                            {
-                                numValue = 0.0;
-                            }
-                            Double tempDenValue = 0.0;
-                            try
-                            {
-                                //denValue += Double.parseDouble( getAggVal( selIndicator.getDenominator(), aggDataMap, ou.getId(), periodId ) );
-                                tempDenValue = Double.parseDouble( getAggVal( selIndicator.getDenominator(), aggDataMap, ou.getId(), periodId ) );
-                            }
-                            catch( Exception e )
-                            {
-                                tempDenValue =1.0;
-                            }
-                            if( !selIndicator.getDenominator().trim().equals( "1" ) )
-                            {
-                                denValue += tempDenValue;
-                            }
-                            else 
-                            {
-                                denValue = 1.0;
-                            }
+                        try
+                        {
+                            numValue += Double.parseDouble( getAggValByOrgUnit_UID( selIndicator.getNumerator(), aggDataMap, ou.getId() ) );
+                        }
+                        catch( Exception e )
+                        {
+                            numValue = 0.0;
                         }
                         
+                        if ( !selIndicator.getDenominator().trim().equals( "1" ) )
+                        {
+                            denValue = Double.parseDouble( getDenominatorValueByOrgUnit_UID( selIndicator.getDenominator(), aggDataMap, ou.getId(), diffDays ) );;
+                        }
+                        else 
+                        {
+                            denValue = 1.0;
+                        }
+
                         try
                         {
-                            if( denValue != 0.0 )
-                            {
-                                indValue = ( numValue / denValue ) * selIndicator.getIndicatorType().getFactor();
-                            }
-                            else
-                            {
-                                indValue = 0.0;
-                            }
+	                        if( denValue != 0.0 )
+	                        {
+	                            indValue = ( numValue / denValue ) * selIndicator.getIndicatorType().getFactor();
+	                        }
+	                        else
+	                        {
+	                            indValue = 0.0;
+	                        }
                         }
                         catch( Exception e )
                         {
@@ -2466,18 +2570,15 @@
                         {
                             if ( selDataElement.getType().equalsIgnoreCase( DataElement.VALUE_TYPE_INT ) )
                             {
-                                for( Integer periodId : periodIds )
+                                tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+selDecoc.getUid() );
+                                if( tempStr != null )
                                 {
-                                    tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getId()+":"+selDecoc.getId()+":"+periodId );
-                                    if( tempStr != null )
-                                    {
-                                        try
-                                        {
-                                            pwdvAggValue += Double.parseDouble( tempStr );
-                                        }
-                                        catch( Exception e )
-                                        {
-                                        }
+                                    try
+                                    {
+                                        pwdvAggValue += Double.parseDouble( tempStr );
+                                    }
+                                    catch( Exception e )
+                                    {
                                     }
                                 }
                                 tempStr = "" + (int) pwdvAggValue;
@@ -2488,8 +2589,8 @@
                                 Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                 if ( tempPeriod != null )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
-
+                                    //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, selDecoc );
                                     if ( dataValue != null && dataValue.getValue() != null )
                                     {
                                         tempStr = dataValue.getValue();
@@ -2513,18 +2614,15 @@
                             {
                                 for( DataElementCategoryOptionCombo optionCombo : optionCombos )
                                 {
-                                    for( Integer periodId : periodIds )
+                                    tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+optionCombo.getUid() );
+                                    if( tempStr != null )
                                     {
-                                        tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getId()+":"+optionCombo.getId()+":"+periodId );
-                                        if( tempStr != null )
-                                        {
-                                            try
-                                            {
-                                                pwdvAggValue += Double.parseDouble( tempStr );
-                                            }
-                                            catch( Exception e )
-                                            {
-                                            }
+                                        try
+                                        {
+                                            pwdvAggValue += Double.parseDouble( tempStr );
+                                        }
+                                        catch( Exception e )
+                                        {
                                         }
                                     }
                                 }
@@ -2541,7 +2639,8 @@
                                     Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                     if( tempPeriod != null )
                                     {
-                                        DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                       // DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, decoc1 );
 
                                         if ( dataValue != null )
                                         {
@@ -2609,9 +2708,6 @@
         int startRow = 0;
         int headerRow = 0;
         int headerCol = 0;
-
-        //String raFolderName = configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue();
-        //String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "output" + File.separator + UUID.randomUUID().toString() + ".xls";
         
         String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator +  Configuration_IN.DEFAULT_TEMPFOLDER;
         File newdir = new File( outputReportPath );
@@ -2657,7 +2753,25 @@
         List<Integer> orgUnitIds = new ArrayList<Integer>( getIdentifiers(OrganisationUnit.class, selOUList ) );
         orgUnitIdsByComma = getCommaDelimitedString( orgUnitIds );
         
-        Map<String, String> aggDataMap = new HashMap<String, String>( reportService.getDataFromDataValueTable( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
+        Map<String, Map<String, String>> aggDataMapByPeriod = new HashMap<String, Map<String, String>>();
+        SimpleDateFormat standardDateFormat = new SimpleDateFormat("yyyy-MM-dd");
+        int pCount = 0;
+        for ( Date sDate : selStartPeriodList )
+        {
+            String startDate = standardDateFormat.format( sDate );
+        	List<Integer> periodIds = new ArrayList<Integer>( periodMap.get( pCount++ ) );
+            periodIdsByComma = getCommaDelimitedString( periodIds );
+        	
+            Map<String, String> tempAggDataMap = reportService.getCapturedDataFromDataValueTableByDeAndOrgUnitwise( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma );
+            if( tempAggDataMap == null )
+            {
+            	tempAggDataMap = new HashMap<String, String>();
+            }
+            aggDataMapByPeriod.put( startDate, tempAggDataMap );
+        }
+
+
+        //Map<String, String> aggDataMap = new HashMap<String, String>( reportService.getDataFromDataValueTable( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
     
         /* Calculation Part */
         int rowCount = 1;
@@ -2730,9 +2844,13 @@
                 {
                     Date eDate = selEndPeriodList.get( periodCount );
                 
-                    Collection<Integer> periodIds = new ArrayList<Integer>( periodMap.get( periodCount ) );
-                    System.out.println( periodIds );
+                    long diff = eDate.getTime() - sDate.getTime();
+                    long diffDays = ( diff / (24 * 60 * 60 * 1000) )+1;
 
+					String keyDate = standardDateFormat.format( sDate );
+					
+					Map<String, String> aggDataMap = new HashMap<String, String>( aggDataMapByPeriod.get( keyDate ) );
+					
                     double pwdvAggValue = 0.0;
                     double pwdAggIndValue = 0.0;
 
@@ -2742,45 +2860,35 @@
                         Double numValue = 0.0;
                         Double denValue = 0.0;
                         Double indValue = 0.0;
-                        for( Integer periodId : periodIds )
-                        {
-                            try
-                            {
-                                numValue += Double.parseDouble( getAggVal( selIndicator.getNumerator(), aggDataMap, ou.getId(), periodId ) );
-                            }
-                            catch( Exception e )
-                            {
-                            }
-                            Double tempDenValue = 0.0;
-                            try
-                            {
-                                //denValue += Double.parseDouble( getAggVal( selIndicator.getDenominator(), aggDataMap, ou.getId(), periodId ) );
-                                tempDenValue = Double.parseDouble( getAggVal( selIndicator.getDenominator(), aggDataMap, ou.getId(), periodId ) );
-                            }
-                            catch( Exception e )
-                            {
-                                tempDenValue = 1.0;
-                            }
-                            if( !selIndicator.getDenominator().trim().equals( "1" ) )
-                            {
-                                denValue += tempDenValue;
-                            }
-                            else 
-                            {
-                                denValue = 1.0;
-                            }
+						
+                        try
+                        {
+                            numValue += Double.parseDouble( getAggValByOrgUnit_UID( selIndicator.getNumerator(), aggDataMap, ou.getId() ) );
+                        }
+                        catch( Exception e )
+                        {
+                            numValue = 0.0;
                         }
                         
+                        if ( !selIndicator.getDenominator().trim().equals( "1" ) )
+                        {
+                            denValue = Double.parseDouble( getDenominatorValueByOrgUnit_UID( selIndicator.getDenominator(), aggDataMap, ou.getId(), diffDays ) );;
+                        }
+                        else 
+                        {
+                            denValue = 1.0;
+                        }
+						
                         try
                         {
-                            if( denValue != 0.0 )
-                            {
-                                indValue = ( numValue / denValue ) * selIndicator.getIndicatorType().getFactor();
-                            }
-                            else
-                            {
-                                indValue = 0.0;
-                            }
+	                        if( denValue != 0.0 )
+	                        {
+	                            indValue = ( numValue / denValue ) * selIndicator.getIndicatorType().getFactor();
+	                        }
+	                        else
+	                        {
+	                            indValue = 0.0;
+	                        }
                         }
                         catch( Exception e )
                         {
@@ -2797,18 +2905,15 @@
                         {
                             if ( selDataElement.getType().equalsIgnoreCase( DataElement.VALUE_TYPE_INT ) )
                             {
-                                for( Integer periodId : periodIds )
+                                tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+selDecoc.getUid() );
+                                if( tempStr != null )
                                 {
-                                    tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getId()+":"+selDecoc.getId()+":"+periodId );
-                                    if( tempStr != null )
-                                    {
-                                        try
-                                        {
-                                            pwdvAggValue += Double.parseDouble( tempStr );
-                                        }
-                                        catch( Exception e )
-                                        {
-                                        }
+                                    try
+                                    {
+                                        pwdvAggValue += Double.parseDouble( tempStr );
+                                    }
+                                    catch( Exception e )
+                                    {
                                     }
                                 }
                                 tempStr = "" + (int) pwdvAggValue;
@@ -2819,7 +2924,8 @@
                                 Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                 if ( tempPeriod != null )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, selDecoc );
 
                                     if ( dataValue != null && dataValue.getValue() != null )
                                     {
@@ -2844,18 +2950,15 @@
                             {
                                 for( DataElementCategoryOptionCombo optionCombo : optionCombos )
                                 {
-                                    for( Integer periodId : periodIds )
+                                    tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+optionCombo.getUid() );
+                                    if( tempStr != null )
                                     {
-                                        tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getId()+":"+optionCombo.getId()+":"+periodId );
-                                        if( tempStr != null )
-                                        {
-                                            try
-                                            {
-                                                pwdvAggValue += Double.parseDouble( tempStr );
-                                            }
-                                            catch( Exception e )
-                                            {
-                                            }
+                                        try
+                                        {
+                                            pwdvAggValue += Double.parseDouble( tempStr );
+                                        }
+                                        catch( Exception e )
+                                        {
                                         }
                                     }
                                 }
@@ -2872,7 +2975,9 @@
                                     Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                     if( tempPeriod != null )
                                     {
-                                        DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        
+                                        DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, decoc1 );
 
                                         if ( dataValue != null )
                                         {
@@ -3393,9 +3498,7 @@
         selOrgUnit = organisationUnitService.getOrganisationUnit( Integer.parseInt( orgUnitListCB.get( 0 ) ) );
         selOUList = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( selOrgUnit.getId() ) );
 
-        System.out.println( "Before getting orgunitlevelmap "+new Date() );
         Map<Integer, Integer> orgunitLevelMap = new HashMap<Integer, Integer>( reportService.getOrgunitLevelMap() );
-        System.out.println( "After getting orgunitlevelmap "+new Date() );
     
         Iterator<OrganisationUnit> ouIterator = selOUList.iterator();
         while ( ouIterator.hasNext() )
@@ -3432,25 +3535,49 @@
         DataElementCategoryOptionCombo selDecoc = new DataElementCategoryOptionCombo();
         int flag = 0;
 
+        List<Integer> periodIds = new ArrayList<Integer>();
+        for( Integer periodMapKey : periodMap.keySet() )
+        {
+        	periodIds.addAll( periodMap.get( periodMapKey ) );
+        }
+        periodIdsByComma = getCommaDelimitedString( periodIds );
+        
+        int periodCount = 0;
+        long totalDiffDays = 0;
+        for ( Date sDate : selStartPeriodList )
+        {
+            Date eDate = selEndPeriodList.get( periodCount++ );
+            
+            long diff = eDate.getTime() - sDate.getTime();
+            long diffDays = ( diff / (24 * 60 * 60 * 1000) )+1;
+            totalDiffDays += diffDays;
+        }
+        
+        List<Integer> orgUnitIds = new ArrayList<Integer>( getIdentifiers(OrganisationUnit.class, selOUList ) );
+        orgUnitIdsByComma = getCommaDelimitedString( orgUnitIds );
+        
+        Map<String, String> aggDataMap = new HashMap<String, String>();
+        
+        System.out.println("Before getting Aggregated Data : " + new Date() );
+        aggDataMap.putAll( reportService.getAggDataFromDataValueTableByDeAndOrgUnitwise( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
+        System.out.println("After getting Aggregated Data : " + new Date() + " ---- " + aggDataMap.size() );
+
         /* Calculation Part */
         int rowCount = 1;
         int colCount = 0;
         for( OrganisationUnit ou : selOUList )
         {
-            System.out.println("Entered into orgunitloop :"+new Date());
             sheet0.addCell( new Number( headerCol, headerRow + rowCount, rowCount, getCellFormat2() ) );
             
             Integer level = orgunitLevelMap.get( ou.getId() );
             if( level == null )
+            {
                 level = organisationUnitService.getLevelOfOrganisationUnit( ou.getId() );
+            }
             
             colCount = 1 + level - minOULevel;
             sheet0.addCell( new Label( colCount, headerRow + rowCount, ou.getName(), getCellFormat2() ) );
 
-            List<OrganisationUnit> ouChildList = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( ou.getId() ) );
-            List<Integer> orgUnitIds = new ArrayList<Integer>( getIdentifiers(OrganisationUnit.class, ouChildList ) );
-            orgUnitIdsByComma = getCommaDelimitedString( orgUnitIds );
-            Map<String, String> aggDataMap = new HashMap<String, String>( reportService.getAggDataFromDataValueTable( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
             colCount = c1;
             int deListCount = 0;
             int indListCount = 0;
@@ -3476,7 +3603,7 @@
                     
                     try
                     {
-                        numValue = Double.parseDouble( reportService.getAggVal( selIndicator.getNumerator(), aggDataMap ) );
+                        numValue = Double.parseDouble( getAggValByOrgUnit_UID( selIndicator.getNumerator(), aggDataMap, ou.getId() ) );
                     }
                     catch( Exception e )
                     {
@@ -3487,7 +3614,7 @@
                     {
                         try
                         {
-                            denValue = Double.parseDouble( reportService.getAggVal( selIndicator.getDenominator(), aggDataMap ) );
+                            denValue = Double.parseDouble( getDenominatorValueByOrgUnit_UID( selIndicator.getDenominator(), aggDataMap, ou.getId(), totalDiffDays ) );
                         }
                         catch( Exception e )
                         {
@@ -3499,15 +3626,6 @@
                         denValue = 1.0;
                     }
                    
-                   /*
-                    try
-                    {
-                        denValue = Double.parseDouble( reportService.getAggVal( selIndicator.getDenominator(), aggDataMap ) );
-                    }
-                    catch( Exception e )
-                    {
-                    }
-                   */
                     try
                     {
                         if( denValue != 0.0 )
@@ -3541,7 +3659,7 @@
                         
                         if ( selDataElement.getType().equalsIgnoreCase( DataElement.VALUE_TYPE_INT ) )
                         {
-                            tempStr = aggDataMap.get( selDataElement.getId()+"."+selDecoc.getId() );
+                            tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+selDecoc.getUid() );
                             if( tempStr != null )
                             {
                                 try
@@ -3570,7 +3688,7 @@
                         {
                             for( DataElementCategoryOptionCombo optionCombo : optionCombos )
                             {
-                                tempStr = aggDataMap.get( selDataElement.getId()+"."+optionCombo.getId() );
+                                tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+optionCombo.getUid() );
                                 if( tempStr != null )
                                 {
                                     try
@@ -3666,6 +3784,33 @@
         DataElement selDataElement = new DataElement();
         DataElementCategoryOptionCombo selDecoc = new DataElementCategoryOptionCombo();
         int flag = 0;
+		
+		List<Integer> periodIds = new ArrayList<Integer>();
+        for( Integer periodMapKey : periodMap.keySet() )
+        {
+        	periodIds.addAll( periodMap.get( periodMapKey ) );
+        }
+        periodIdsByComma = getCommaDelimitedString( periodIds );
+        
+        int periodCount = 0;
+        long totalDiffDays = 0;
+        for ( Date sDate : selStartPeriodList )
+        {
+            Date eDate = selEndPeriodList.get( periodCount++ );
+            
+            long diff = eDate.getTime() - sDate.getTime();
+            long diffDays = ( diff / (24 * 60 * 60 * 1000) )+1;
+            totalDiffDays += diffDays;
+        }
+        
+        List<Integer> orgUnitIds = new ArrayList<Integer>( getIdentifiers(OrganisationUnit.class, selOUList ) );
+        orgUnitIdsByComma = getCommaDelimitedString( orgUnitIds );
+        
+        Map<String, String> aggDataMap = new HashMap<String, String>();
+        
+        System.out.println("Before getting Aggregated Data : " + new Date() );
+        aggDataMap.putAll( reportService.getAggDataFromDataValueTableByDeAndOrgUnitwise( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
+        System.out.println("After getting Aggregated Data : " + new Date() + " ---- " + aggDataMap.size() );
 
         /* Calculation Part */
         int rowCount = 1;
@@ -3692,11 +3837,13 @@
                 count1++;
             }
 
+			/*
             List<OrganisationUnit> ouChildList = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( ou.getId() ) );
             List<Integer> orgUnitIds = new ArrayList<Integer>( getIdentifiers(OrganisationUnit.class, ouChildList ) );
             orgUnitIdsByComma = getCommaDelimitedString( orgUnitIds );
             Map<String, String> aggDataMap = new HashMap<String, String>( reportService.getAggDataFromDataValueTable( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
-            
+            */
+			
             colCount = c1;
             int deListCount = 0;
             int indListCount = 0;
@@ -3722,17 +3869,18 @@
                     
                     try
                     {
-                        numValue = Double.parseDouble( reportService.getAggVal( selIndicator.getNumerator(), aggDataMap ) );
+                        numValue = Double.parseDouble( getAggValByOrgUnit_UID( selIndicator.getNumerator(), aggDataMap, ou.getId() ) );
                     }
                     catch( Exception e )
                     {
                         numValue = 0.0;
                     }
+                   
                     if( !selIndicator.getDenominator().trim().equals( "1" ) )
                     {
                         try
                         {
-                            denValue = Double.parseDouble( reportService.getAggVal( selIndicator.getDenominator(), aggDataMap ) );
+                            denValue = Double.parseDouble( getDenominatorValueByOrgUnit_UID( selIndicator.getDenominator(), aggDataMap, ou.getId(), totalDiffDays ) );
                         }
                         catch( Exception e )
                         {
@@ -3742,16 +3890,7 @@
                     else 
                     {
                         denValue = 1.0;
-                    }
-                    /*
-                    try
-                    {
-                        denValue = Double.parseDouble( reportService.getAggVal( selIndicator.getDenominator(), aggDataMap ) );
-                    }
-                    catch( Exception e )
-                    {
-                    }
-                    */
+                    }                    
                     
                     try
                     {
@@ -3786,7 +3925,7 @@
                         
                         if ( selDataElement.getType().equalsIgnoreCase( DataElement.VALUE_TYPE_INT ) )
                         {
-                            tempStr = aggDataMap.get( selDataElement.getId()+"."+selDecoc.getId() );
+                            tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+selDecoc.getUid() );
                             if( tempStr != null )
                             {
                                 try
@@ -3815,7 +3954,7 @@
                         {
                             for( DataElementCategoryOptionCombo optionCombo : optionCombos )
                             {
-                                tempStr = aggDataMap.get( selDataElement.getId()+"."+optionCombo.getId() );
+                                tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+optionCombo.getUid() );
                                 if( tempStr != null )
                                 {
                                     try
@@ -3870,9 +4009,6 @@
         int headerRow = 0;
         int headerCol = 0;
 
-        //String raFolderName = configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue();
-        //String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "output" + File.separator + UUID.randomUUID().toString() + ".xls";
-        
         String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator +  Configuration_IN.DEFAULT_TEMPFOLDER;
         File newdir = new File( outputReportPath );
         if( !newdir.exists() )
@@ -3927,34 +4063,56 @@
         DataElement selDataElement = new DataElement();
         DataElementCategoryOptionCombo selDecoc = new DataElementCategoryOptionCombo();
         int flag = 0;
-
+        
+        List<Integer> orgUnitIds = new ArrayList<Integer>( getIdentifiers(OrganisationUnit.class, selOUList ) );
+        orgUnitIdsByComma = getCommaDelimitedString( orgUnitIds );
+        
+        Map<String, Map<String, String>> aggDataMapByPeriod = new HashMap<String, Map<String, String>>();
+        
+        System.out.println("Before getting Aggregated Data : " + new Date() );
+        
+        SimpleDateFormat standardDateFormat = new SimpleDateFormat("yyyy-MM-dd");
+        int pCount = 0;
+        for ( Date sDate : selStartPeriodList )
+        {
+            //Date eDate = selEndPeriodList.get( pCount++ );
+            String startDate = standardDateFormat.format( sDate );
+            //String endDate = standardDateFormat.format( eDate );
+        	List<Integer> periodIds = new ArrayList<Integer>( periodMap.get( pCount++ ) );
+            periodIdsByComma = getCommaDelimitedString( periodIds );
+        	
+            Map<String, String> tempAggDataMap = reportService.getAggDataFromDataValueTableByDeAndOrgUnitwise( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma );
+            if( tempAggDataMap == null )
+            {
+            	tempAggDataMap = new HashMap<String, String>();
+            }
+            aggDataMapByPeriod.put( startDate, tempAggDataMap );
+        }
+        System.out.println("After getting Aggregated Data : " + new Date() );
+        
         /* Calculation Part */
         int rowCount = 1;
         int colCount = 0;
         for( OrganisationUnit ou : selOUList )
-        {
-            System.out.println( ou.getName() +" : "+ new Date());
+        {            
             sheet0.addCell( new Number( headerCol, headerRow + 1 + rowCount, rowCount, getCellFormat2() ) );
             
             Integer level = orgunitLevelMap.get( ou.getId() );
             if( level == null )
+            {
                 level = organisationUnitService.getLevelOfOrganisationUnit( ou.getId() );
+            }
             
             colCount = 1 + level - minOULevel;
             sheet0.addCell( new Label( colCount, headerRow + 1 + rowCount, ou.getName(), getCellFormat2() ) );
 
-            List<OrganisationUnit> ouChildList = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( ou.getId() ) );
-            List<Integer> orgUnitIds = new ArrayList<Integer>( getIdentifiers(OrganisationUnit.class, ouChildList ) );
-            orgUnitIdsByComma = getCommaDelimitedString( orgUnitIds );
-            Map<String, String> aggDataMap = new HashMap<String, String>( reportService.getAggDataFromDataValueTableByDeAndPeriodwise( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
-            
             colCount = c1;
             int deListCount = 0;
             int indListCount = 0;
             int serviceListCount = 0;
             for( String serviceType : serviceTypeList )
             {
-                if ( serviceType.equalsIgnoreCase( "I" ) )
+                if( serviceType.equalsIgnoreCase( "I" ) )
                 {
                     flag = 1;
                     selIndicator = indicatorList.get( indListCount );
@@ -3993,9 +4151,14 @@
                 for ( Date sDate : selStartPeriodList )
                 {
                     Date eDate = selEndPeriodList.get( periodCount );
-                
-                    Collection<Integer> periodIds = new ArrayList<Integer>( periodMap.get( periodCount ) );
+                    
+                    long diff = eDate.getTime() - sDate.getTime();
+                    long diffDays = ( diff / (24 * 60 * 60 * 1000) )+1;
+                    
+                    String keyDate = standardDateFormat.format( sDate );
 
+                    Map<String, String> aggDataMap = new HashMap<String, String>( aggDataMapByPeriod.get( keyDate ) );
+                    
                     double pwdvAggValue = 0.0;
                     double pwdAggIndValue = 0.0;
 
@@ -4006,34 +4169,22 @@
                         Double denValue = 0.0;
                         Double indValue = 0.0;
                         
-                        for( Integer periodId : periodIds )
-                        {
-                            try
-                            {
-                                numValue += Double.parseDouble( getAggValByPeriod( selIndicator.getNumerator(), aggDataMap, periodId ) );
-                            }
-                            catch( Exception e )
-                            {
-                                numValue = 0.0;
-                            }
-                            Double tempDenValue = 0.0;
-                            try
-                            {
-                               // denValue += Double.parseDouble( getAggValByPeriod( selIndicator.getDenominator(), aggDataMap, periodId ) );
-                                tempDenValue = Double.parseDouble( getAggValByPeriod( selIndicator.getDenominator(), aggDataMap, periodId ) );
-                            }
-                            catch( Exception e )
-                            {
-                                tempDenValue = 1.0;
-                            }
-                            if ( !selIndicator.getDenominator().trim().equals( "1" ) )
-                            {
-                                denValue += tempDenValue;
-                            }
-                            else 
-                            {
-                                denValue = 1.0;
-                            }
+                        try
+                        {
+                            numValue = Double.parseDouble( getAggValByOrgUnit_UID( selIndicator.getNumerator(), aggDataMap, ou.getId() ) );
+                        }
+                        catch( Exception e )
+                        {
+                            numValue = 0.0;
+                        }
+                        
+                        if ( !selIndicator.getDenominator().trim().equals( "1" ) )
+                        {
+                            denValue = Double.parseDouble( getDenominatorValueByOrgUnit_UID( selIndicator.getDenominator(), aggDataMap, ou.getId(), diffDays ) );;
+                        }
+                        else 
+                        {
+                            denValue = 1.0;
                         }
                         
                         try
@@ -4062,18 +4213,15 @@
                         {
                             if ( selDataElement.getType().equalsIgnoreCase( DataElement.VALUE_TYPE_INT ) )
                             {
-                                for( Integer periodId : periodIds )
+                                tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+selDecoc.getUid() );
+                                if( tempStr != null )
                                 {
-                                    tempStr = aggDataMap.get( selDataElement.getId()+":"+selDecoc.getId()+":"+periodId );
-                                    if( tempStr != null )
-                                    {
-                                        try
-                                        {
-                                            pwdvAggValue += Double.parseDouble( tempStr );
-                                        }
-                                        catch( Exception e )
-                                        {
-                                        }
+                                    try
+                                    {
+                                        pwdvAggValue += Double.parseDouble( tempStr );
+                                    }
+                                    catch( Exception e )
+                                    {
                                     }
                                 }
                                 tempStr = "" + (int) pwdvAggValue;
@@ -4084,7 +4232,8 @@
                                 Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                 if ( tempPeriod != null )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, selDecoc );
 
                                     if ( dataValue != null && dataValue.getValue() != null )
                                     {
@@ -4109,18 +4258,15 @@
                             {
                                 for( DataElementCategoryOptionCombo optionCombo : optionCombos )
                                 {
-                                    for( Integer periodId : periodIds )
+                                    tempStr = aggDataMap.get( ou.getId() + ":" +selDataElement.getUid()+":"+optionCombo.getUid() );
+                                    if( tempStr != null )
                                     {
-                                        tempStr = aggDataMap.get( selDataElement.getId()+":"+optionCombo.getId()+":"+periodId );
-                                        if( tempStr != null )
-                                        {
-                                            try
-                                            {
-                                                pwdvAggValue += Double.parseDouble( tempStr );
-                                            }
-                                            catch( Exception e )
-                                            {
-                                            }
+                                        try
+                                        {
+                                            pwdvAggValue += Double.parseDouble( tempStr );
+                                        }
+                                        catch( Exception e )
+                                        {
                                         }
                                     }
                                 }
@@ -4137,7 +4283,8 @@
                                     Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                     if( tempPeriod != null )
                                     {
-                                        DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, decoc1 );
 
                                         if ( dataValue != null )
                                         {
@@ -4205,9 +4352,6 @@
         int startRow = 0;
         int headerRow = 0;
         int headerCol = 0;
-
-        //String raFolderName = configurationService.getConfigurationByKey( Configuration_IN.KEY_REPORTFOLDER ).getValue();
-        //String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "output" + File.separator + UUID.randomUUID().toString() + ".xls";
         
         String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator +  Configuration_IN.DEFAULT_TEMPFOLDER;
         File newdir = new File( outputReportPath );
@@ -4251,6 +4395,32 @@
         DataElementCategoryOptionCombo selDecoc = new DataElementCategoryOptionCombo();
         int flag = 0;
 
+		List<Integer> orgUnitIds = new ArrayList<Integer>( getIdentifiers(OrganisationUnit.class, selOUList ) );
+        orgUnitIdsByComma = getCommaDelimitedString( orgUnitIds );
+        
+        Map<String, Map<String, String>> aggDataMapByPeriod = new HashMap<String, Map<String, String>>();
+        
+        System.out.println("Before getting Aggregated Data : " + new Date() );
+        
+        SimpleDateFormat standardDateFormat = new SimpleDateFormat("yyyy-MM-dd");
+        int pCount = 0;
+        for ( Date sDate : selStartPeriodList )
+        {
+            //Date eDate = selEndPeriodList.get( pCount++ );
+            String startDate = standardDateFormat.format( sDate );
+            //String endDate = standardDateFormat.format( eDate );
+        	List<Integer> periodIds = new ArrayList<Integer>( periodMap.get( pCount++ ) );
+            periodIdsByComma = getCommaDelimitedString( periodIds );
+        	
+            Map<String, String> tempAggDataMap = reportService.getAggDataFromDataValueTableByDeAndOrgUnitwise( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma );
+            if( tempAggDataMap == null )
+            {
+            	tempAggDataMap = new HashMap<String, String>();
+            }
+            aggDataMapByPeriod.put( startDate, tempAggDataMap );
+        }
+        System.out.println("After getting Aggregated Data : " + new Date() );
+       
         /* Calculation Part */
         int rowCount = 1;
         int colCount = 0;
@@ -4275,12 +4445,13 @@
                 sheet0.addCell( new Label( colCount-count1, headerRow + rowCount + 1, orgUnit.getName(), getCellFormat2() ) );
                 count1++;
             }
-
+/*
             List<OrganisationUnit> ouChildList = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( ou.getId() ) );
             List<Integer> orgUnitIds = new ArrayList<Integer>( getIdentifiers(OrganisationUnit.class, ouChildList ) );
             orgUnitIdsByComma = getCommaDelimitedString( orgUnitIds );
             Map<String, String> aggDataMap = new HashMap<String, String>( reportService.getAggDataFromDataValueTableByDeAndPeriodwise( orgUnitIdsByComma, dataElementIdsByComma, periodIdsByComma ) );
-            
+            */
+			
             colCount = c1;
             int deListCount = 0;
             int indListCount = 0;
@@ -4327,7 +4498,12 @@
                 {
                     Date eDate = selEndPeriodList.get( periodCount );
                 
-                    Collection<Integer> periodIds = new ArrayList<Integer>( periodMap.get( periodCount ) );
+                    long diff = eDate.getTime() - sDate.getTime();
+                    long diffDays = ( diff / (24 * 60 * 60 * 1000) )+1;
+                    
+                    String keyDate = standardDateFormat.format( sDate );
+
+                    Map<String, String> aggDataMap = new HashMap<String, String>( aggDataMapByPeriod.get( keyDate ) );
 
                     double pwdvAggValue = 0.0;
                     double pwdAggIndValue = 0.0;
@@ -4338,34 +4514,22 @@
                         Double numValue = 0.0;
                         Double denValue = 0.0;
                         Double indValue = 0.0;
-                        for( Integer periodId : periodIds )
-                        {
-                            try
-                            {
-                                numValue += Double.parseDouble( getAggValByPeriod( selIndicator.getNumerator(), aggDataMap, periodId ) );
-                            }
-                            catch( Exception e )
-                            {
-                                numValue = 0.0;
-                            }
-                            Double tempDenValue = 0.0;
-                            try
-                            {
-                                //denValue += Double.parseDouble( getAggValByPeriod( selIndicator.getDenominator(), aggDataMap, periodId ) );
-                                tempDenValue = Double.parseDouble( getAggValByPeriod( selIndicator.getDenominator(), aggDataMap, periodId ) );
-                            }
-                            catch( Exception e )
-                            {
-                                tempDenValue = 1.0;
-                            }
-                            if ( !selIndicator.getDenominator().trim().equals( "1" ) )
-                            {
-                                denValue += tempDenValue;
-                            }
-                            else 
-                            {
-                                denValue = 1.0;
-                            }
+                        try
+                        {
+                            numValue = Double.parseDouble( getAggValByOrgUnit_UID( selIndicator.getNumerator(), aggDataMap, ou.getId() ) );
+                        }
+                        catch( Exception e )
+                        {
+                            numValue = 0.0;
+                        }
+                        
+                        if ( !selIndicator.getDenominator().trim().equals( "1" ) )
+                        {
+                            denValue = Double.parseDouble( getDenominatorValueByOrgUnit_UID( selIndicator.getDenominator(), aggDataMap, ou.getId(), diffDays ) );;
+                        }
+                        else 
+                        {
+                            denValue = 1.0;
                         }
                         
                         try
@@ -4394,18 +4558,15 @@
                         {
                             if ( selDataElement.getType().equalsIgnoreCase( DataElement.VALUE_TYPE_INT ) )
                             {
-                                for( Integer periodId : periodIds )
+                                tempStr = aggDataMap.get( ou.getId()+":"+selDataElement.getUid()+":"+selDecoc.getUid() );
+                                if( tempStr != null )
                                 {
-                                    tempStr = aggDataMap.get( selDataElement.getId()+":"+selDecoc.getId()+":"+periodId );
-                                    if( tempStr != null )
-                                    {
-                                        try
-                                        {
-                                            pwdvAggValue += Double.parseDouble( tempStr );
-                                        }
-                                        catch( Exception e )
-                                        {
-                                        }
+                                    try
+                                    {
+                                        pwdvAggValue += Double.parseDouble( tempStr );
+                                    }
+                                    catch( Exception e )
+                                    {
                                     }
                                 }
                                 tempStr = "" + (int) pwdvAggValue;
@@ -4416,7 +4577,8 @@
                                 Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                 if ( tempPeriod != null )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, selDecoc );
 
                                     if ( dataValue != null && dataValue.getValue() != null )
                                     {
@@ -4441,18 +4603,15 @@
                             {
                                 for( DataElementCategoryOptionCombo optionCombo : optionCombos )
                                 {
-                                    for( Integer periodId : periodIds )
+                                    tempStr = aggDataMap.get( ou.getId() + ":" +selDataElement.getUid()+":"+optionCombo.getUid() );
+                                    if( tempStr != null )
                                     {
-                                        tempStr = aggDataMap.get( selDataElement.getId()+":"+optionCombo.getId()+":"+periodId );
-                                        if( tempStr != null )
-                                        {
-                                            try
-                                            {
-                                                pwdvAggValue += Double.parseDouble( tempStr );
-                                            }
-                                            catch( Exception e )
-                                            {
-                                            }
+                                        try
+                                        {
+                                            pwdvAggValue += Double.parseDouble( tempStr );
+                                        }
+                                        catch( Exception e )
+                                        {
                                         }
                                     }
                                 }
@@ -4469,8 +4628,8 @@
                                     Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                     if( tempPeriod != null )
                                     {
-                                        DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
-
+                                        //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, decoc1 );
                                         if ( dataValue != null )
                                         {
                                             tempStr += dataValue.getValue() + " : ";
@@ -4721,8 +4880,8 @@
                                 Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                 if ( tempPeriod != null )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
-
+                                    //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, selDecoc );
                                     if ( dataValue != null && dataValue.getValue() != null )
                                     {
                                         tempStr = dataValue.getValue();
@@ -4774,8 +4933,8 @@
                                     Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                     if( tempPeriod != null )
                                     {
-                                        DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
-
+                                        //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, decoc1 );
                                         if ( dataValue != null )
                                         {
                                             tempStr += dataValue.getValue() + " : ";
@@ -5062,7 +5221,8 @@
                                 Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                 if ( tempPeriod != null )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, selDecoc );
 
                                     if ( dataValue != null && dataValue.getValue() != null )
                                     {
@@ -5115,7 +5275,8 @@
                                     Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                     if( tempPeriod != null )
                                     {
-                                        DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, decoc1 );
 
                                         if ( dataValue != null )
                                         {
@@ -5395,8 +5556,8 @@
                                 Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                 if ( tempPeriod != null )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
-
+                                    //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, selDecoc );
                                     if ( dataValue != null && dataValue.getValue() != null )
                                     {
                                         tempStr = dataValue.getValue();
@@ -5448,7 +5609,8 @@
                                     Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                     if( tempPeriod != null )
                                     {
-                                        DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, decoc1 );
 
                                         if ( dataValue != null )
                                         {
@@ -5703,7 +5865,8 @@
                                 Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                 if ( tempPeriod != null )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, selDecoc );
 
                                     if ( dataValue != null && dataValue.getValue() != null )
                                     {
@@ -5756,7 +5919,8 @@
                                     Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                     if( tempPeriod != null )
                                     {
-                                        DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, decoc1 );
+                                        DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, decoc1 );
 
                                         if ( dataValue != null )
                                         {
@@ -6766,7 +6930,8 @@
                                 Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                 if ( tempPeriod != null )
                                 {
-                                    DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement, tempPeriod, selDecoc );
+                                    DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod, ou, selDecoc );
 
                                     if ( dataValue != null && dataValue.getValue() != null )
                                     {
@@ -6848,8 +7013,8 @@
                                     Period tempPeriod = periodService.getPeriod( sDate, eDate, periodType );
                                     if ( tempPeriod != null )
                                     {
-                                        DataValue dataValue = dataValueService.getDataValue( ou, selDataElement,
-                                            tempPeriod, decoc1 );
+                                        //DataValue dataValue = dataValueService.getDataValue( ou, selDataElement,tempPeriod, decoc1 );
+                                        DataValue dataValue = dataValueService.getDataValue( selDataElement, tempPeriod,ou, decoc1 );
 
                                         if ( dataValue != null )
                                         {
@@ -6988,10 +7153,12 @@
     
     public String getAggVal( String expression, Map<String, String> aggDataMap, Integer orgUnitId, Integer periodId )
     {
+    	//System.out.println("inside getAggVal ");
         try
         {
-            Pattern pattern = Pattern.compile( "(\\[\\d+\\.\\d+\\])" );
-
+            //Pattern pattern = Pattern.compile( "(\\[\\d+\\.\\d+\\])" );
+        	Pattern pattern = Pattern.compile( "#\\{(\\w+)\\.?(\\w*)\\}" );
+        	
             Matcher matcher = pattern.matcher( expression );
             StringBuffer buffer = new StringBuffer();
 
@@ -7001,9 +7168,22 @@
             {
                 String replaceString = matcher.group();
 
-                replaceString = replaceString.replaceAll( "[\\[\\]]", "" );
-
-                String keyString = orgUnitId + ":" + replaceString.replaceAll( "\\.", ":" ) + ":" + periodId;
+                
+                //replaceString = replaceString.replaceAll( "[\\[\\]]", "" );
+                //replaceString = replaceString.replaceAll( "#{", "" );
+                //replaceString = replaceString.replaceAll( "}", "" );
+                
+                String de = matcher.group( 1 );
+                String coc = matcher.group( 2 );
+                
+                DataElement dataElement = dataElementService.getDataElement( de );
+                DataElementCategoryOptionCombo categoryOptionCombo = dataElementCategoryService.getDataElementCategoryOptionCombo( coc );
+
+                
+                //System.out.println( "getAggVal - Replace String: "+ de + " --- " + coc );
+
+
+                String keyString = orgUnitId + ":" + dataElement.getId() + ":" + categoryOptionCombo.getId() + ":" + periodId;
                 
                 replaceString = aggDataMap.get( keyString );
                 
@@ -7043,10 +7223,12 @@
 
     public String getAggValByPeriod( String expression, Map<String, String> aggDataMap, Integer periodId )
     {
+    	//System.out.println("inside getAggValByPeriod ");
         try
         {
-            Pattern pattern = Pattern.compile( "(\\[\\d+\\.\\d+\\])" );
-
+            //Pattern pattern = Pattern.compile( "(\\[\\d+\\.\\d+\\])" );
+        	Pattern pattern = Pattern.compile( "#\\{(\\w+)\\.?(\\w*)\\}" );
+        	
             Matcher matcher = pattern.matcher( expression );
             StringBuffer buffer = new StringBuffer();
 
@@ -7056,9 +7238,18 @@
             {
                 String replaceString = matcher.group();
 
-                replaceString = replaceString.replaceAll( "[\\[\\]]", "" );
-
-                String keyString = replaceString.replaceAll( "\\.", ":" ) + ":" + periodId;
+                //replaceString = replaceString.replaceAll( "#{\\}", "" );
+                //System.out.println( "getAggValByPeriod - Replace String: "+ replaceString );
+
+                //replaceString = replaceString.replaceAll( "[\\[\\]]", "" );
+
+                String de = matcher.group( 1 );
+                String coc = matcher.group( 2 );
+                
+                DataElement dataElement = dataElementService.getDataElement( de );
+                DataElementCategoryOptionCombo categoryOptionCombo = dataElementCategoryService.getDataElementCategoryOptionCombo( coc );
+
+                String keyString = dataElement.getId() + ":" + categoryOptionCombo.getId() + ":" + periodId;
                 
                 replaceString = aggDataMap.get( keyString );
                 
@@ -7097,47 +7288,197 @@
 
     public String getAggValByOrgUnit( String expression, Map<String, String> aggDataMap, Integer orgUnitId )
     {
-        try
-        {
-            Pattern pattern = Pattern.compile( "(\\[\\d+\\.\\d+\\])" );
-
-            Matcher matcher = pattern.matcher( expression );
-            StringBuffer buffer = new StringBuffer();
-
-            String resultValue = "";
-
-            while ( matcher.find() )
-            {
-                String replaceString = matcher.group();
-
-                replaceString = replaceString.replaceAll( "[\\[\\]]", "" );
-
-                String keyString = orgUnitId + ":" + replaceString.replaceAll( "\\.", ":" );
-                
-                replaceString = aggDataMap.get( keyString );
-                
-                if( replaceString == null )
-                {
-                    replaceString = "0";
-                }
-                
-                matcher.appendReplacement( buffer, replaceString );
-
-                resultValue = replaceString;
-            }
-
-            matcher.appendTail( buffer );
-            
-            double d = 0.0;
-            try
-            {
-                d = MathUtils.calculateExpression( buffer.toString() );
-            }
-            catch ( Exception e )
-            {
-                d = 0.0;
-                resultValue = "";
-            }
+    	//System.out.println("inside getAggValByOrgUnit ");
+        try
+        {
+            //Pattern pattern = Pattern.compile( "(\\[\\d+\\.\\d+\\])" );
+            
+            Pattern pattern = Pattern.compile( "#\\{(\\w+)\\.?(\\w*)\\}" );
+
+            Matcher matcher = pattern.matcher( expression );
+            StringBuffer buffer = new StringBuffer();
+
+            String resultValue = "";
+
+            while ( matcher.find() )
+            {
+                String replaceString = matcher.group();
+                
+                //replaceString = replaceString.replaceAll( "#{\\{\\}}", "" );
+
+                String de = matcher.group( 1 );
+                String coc = matcher.group( 2 );
+                
+                DataElement dataElement = dataElementService.getDataElement( de );
+                DataElementCategoryOptionCombo categoryOptionCombo = dataElementCategoryService.getDataElementCategoryOptionCombo( coc );
+
+                //System.out.println( "getAggValByOrgUnit - Replace String: "+ replaceString );
+
+                String keyString = orgUnitId + ":" + dataElement.getId() + ":" + categoryOptionCombo.getId();
+                
+                replaceString = aggDataMap.get( keyString );
+                
+                if( replaceString == null )
+                {
+                    replaceString = "0";
+                }
+                
+                matcher.appendReplacement( buffer, replaceString );
+
+                resultValue = replaceString;
+            }
+
+            matcher.appendTail( buffer );
+            
+            double d = 0.0;
+            try
+            {
+                d = MathUtils.calculateExpression( buffer.toString() );
+            }
+            catch ( Exception e )
+            {
+                d = 0.0;
+                resultValue = "";
+            }
+            
+            resultValue = "" + (double) d;
+
+            return resultValue;
+        }
+        catch ( NumberFormatException ex )
+        {
+            throw new RuntimeException( "Illegal DataElement id", ex );
+        }
+    }
+    
+    
+    public String getAggValByOrgUnit_UID( String expression, Map<String, String> aggDataMap, Integer orgUnitId )
+    {
+        try
+        {
+            
+            Pattern pattern = Pattern.compile( "#\\{(\\w+)\\.?(\\w*)\\}" );
+
+            Matcher matcher = pattern.matcher( expression );
+            StringBuffer buffer = new StringBuffer();
+
+            String resultValue = "";
+
+            while ( matcher.find() )
+            {
+                String replaceString = matcher.group();
+                
+                String de = matcher.group( 1 );
+                String coc = matcher.group( 2 );
+                
+                //DataElement dataElement = dataElementService.getDataElement( de );
+                //DataElementCategoryOptionCombo categoryOptionCombo = dataElementCategoryService.getDataElementCategoryOptionCombo( coc );
+
+                //System.out.println( "getAggValByOrgUnit - Replace String: "+ replaceString );
+
+                String keyString = orgUnitId + ":" + de + ":" + coc;
+                
+                replaceString = aggDataMap.get( keyString );
+                
+                if( replaceString == null )
+                {
+                    replaceString = "0";
+                }
+                
+                matcher.appendReplacement( buffer, replaceString );
+
+                resultValue = replaceString;
+            }
+
+            matcher.appendTail( buffer );
+            
+            double d = 0.0;
+            try
+            {
+                d = MathUtils.calculateExpression( buffer.toString() );
+            }
+            catch ( Exception e )
+            {
+                d = 0.0;
+                resultValue = "";
+            }
+            
+            resultValue = "" + (double) d;
+
+            return resultValue;
+        }
+        catch ( NumberFormatException ex )
+        {
+            throw new RuntimeException( "Illegal DataElement id", ex );
+        }
+    }
+
+    
+    public String getDenominatorValueByOrgUnit_UID( String expression, Map<String, String> aggDataMap, Integer orgUnitId, long diffDays )
+    {
+        try
+        {
+        	long totalDayCount = diffDays;
+        	
+            Pattern pattern = Pattern.compile( "#\\{(\\w+)\\.?(\\w*)\\}" );
+
+            Matcher matcher = pattern.matcher( expression );
+            StringBuffer buffer = new StringBuffer();
+
+            String resultValue = "";
+
+            while ( matcher.find() )
+            {
+                String replaceString = matcher.group();
+                
+                String de = matcher.group( 1 );
+                String coc = matcher.group( 2 );
+                
+                DataElement dataElement = dataElementService.getDataElement( de );
+                //DataElementCategoryOptionCombo categoryOptionCombo = dataElementCategoryService.getDataElementCategoryOptionCombo( coc );
+                
+                PeriodType periodType =  dataElement.getPeriodType();
+                
+                if( periodType != null )
+                {
+                	if( periodType.getName().equalsIgnoreCase( "yearly") )
+                	{
+                		totalDayCount = 365;
+                	}
+                }
+
+                //System.out.println( "getAggValByOrgUnit - Replace String: "+ replaceString );
+
+                String keyString = orgUnitId + ":" + de + ":" + coc;
+                
+                replaceString = aggDataMap.get( keyString );
+                
+                if( replaceString == null )
+                {
+                    replaceString = "0";
+                }
+                
+                matcher.appendReplacement( buffer, replaceString );
+
+                resultValue = replaceString;
+            }
+
+            matcher.appendTail( buffer );
+            
+            double d = 0.0;
+            try
+            {
+                d = MathUtils.calculateExpression( buffer.toString() );
+            }
+            catch ( Exception e )
+            {
+                d = 0.0;
+                resultValue = "";
+            }
+            
+            System.out.println(orgUnitId+" : "+ d + " --- " + diffDays + " --- " + totalDayCount );
+            
+            d = ( d * diffDays ) / totalDayCount;
             
             resultValue = "" + (double) d;
 

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/tr/action/GenerateTargetAnalysisFormAction.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/tr/action/GenerateTargetAnalysisFormAction.java	2011-09-03 09:46:15 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/tr/action/GenerateTargetAnalysisFormAction.java	2013-09-19 06:34:31 +0000
@@ -8,6 +8,7 @@
 import java.util.Iterator;
 import java.util.List;
 
+import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
 import org.hisp.dhis.dataelement.DataElementGroup;
 import org.hisp.dhis.dataset.Section;
 import org.hisp.dhis.dataset.SectionService;
@@ -105,8 +106,9 @@
         // for dataSet Sections
         sections = new ArrayList<Section>();
         sections = new ArrayList<Section>( sectionService.getAllSections() );
-        Collections.sort( sections, new SectionOrderComparator() );
+        //Collections.sort( sections, new SectionOrderComparator() );
         
+        Collections.sort( sections, new IdentifiableObjectNameComparator() );
         
         orgUnitGroups = new ArrayList<OrganisationUnitGroup> ( orgUnitGroupService.getAllOrganisationUnitGroups() );
         

=== modified file 'local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/util/DashBoardService.java'
--- local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/util/DashBoardService.java	2012-06-14 05:58:42 +0000
+++ local/in/dhis-web-dashboard/src/main/java/org/hisp/dhis/dataanalyser/util/DashBoardService.java	2014-03-05 06:25:16 +0000
@@ -782,7 +782,10 @@
                        {
                            for( Period period : periods )
                            {
-                               DataValue dataValue = dataValueService.getDataValue( orgChild, dataElement, period, decoc );                               
+                               //DataValue dataValue = dataValueService.getDataValue( orgChild, dataElement, period, decoc );
+                               
+                               DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgChild, decoc );
+                               
                                try
                                {
                                    aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -810,7 +813,9 @@
                            {
                                for( Period period : periods )
                                {
-                                   DataValue dataValue = dataValueService.getDataValue( orgChild, dataElement, period, decoc1 );                               
+                                   //DataValue dataValue = dataValueService.getDataValue( orgChild, dataElement, period, decoc1 );
+                                   DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgChild, decoc1 );
+                                   
                                    try
                                    {
                                        aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -921,7 +926,8 @@
                        {
                            for( Period period : periods )
                            {
-                               DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc );
+                               //DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc );
+                               DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgUnit, decoc );
                                try
                                {
                                    aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -948,7 +954,9 @@
                            {
                                for( Period period : periods )
                                {
-                                   DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc1 );
+                                   //DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc1 );
+                                   DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgUnit, decoc1 );
+                                   
                                    try
                                    {
                                        aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -1046,7 +1054,9 @@
                        Collection<Period> periods = periodService.getPeriodsBetweenDates( startDate, endDate );
                        for( Period period : periods )
                        {
-                           DataValue dataValue = dataValueService.getDataValue( selectedOrgUnit, dataElement, period, decoc );
+                           //DataValue dataValue = dataValueService.getDataValue( selectedOrgUnit, dataElement, period, decoc );
+                           DataValue dataValue = dataValueService.getDataValue( dataElement, period, selectedOrgUnit, decoc );
+                           
                            try
                            {
                                aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -1074,7 +1084,8 @@
                            Collection<Period> periods = periodService.getPeriodsBetweenDates( startDate, endDate );
                            for( Period period : periods )
                            {
-                               DataValue dataValue = dataValueService.getDataValue( selectedOrgUnit, dataElement, period, decoc1 );
+                               //DataValue dataValue = dataValueService.getDataValue( selectedOrgUnit, dataElement, period, decoc1 );
+                               DataValue dataValue = dataValueService.getDataValue( dataElement, period, selectedOrgUnit, decoc1 );
                                try
                                {
                                    aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -1176,7 +1187,8 @@
                        {
                            for( Period period : periods )
                            {
-                               DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc );
+                               //DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc );
+                               DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgUnit, decoc );
                                try
                                {
                                    aggDataValue += Double.parseDouble( dataValue.getValue() );
@@ -1203,7 +1215,8 @@
                            {
                                for( Period period : periods )
                                {
-                                   DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc1 );
+                                   //DataValue dataValue = dataValueService.getDataValue( orgUnit, dataElement, period, decoc1 );
+                                   DataValue dataValue = dataValueService.getDataValue( dataElement, period, orgUnit, decoc1 );
                                    try
                                    {
                                        aggDataValue += Double.parseDouble( dataValue.getValue() );

=== modified file 'local/in/dhis-web-dashboard/src/main/resources/META-INF/dhis/beans.xml'
--- local/in/dhis-web-dashboard/src/main/resources/META-INF/dhis/beans.xml	2012-07-02 07:39:05 +0000
+++ local/in/dhis-web-dashboard/src/main/resources/META-INF/dhis/beans.xml	2014-07-08 11:23:02 +0000
@@ -286,6 +286,7 @@
     <bean id="org.hisp.dhis.dataanalyser.ga.action.charts.GenerateDrillDownResultAction"
         class="org.hisp.dhis.dataanalyser.ga.action.charts.GenerateDrillDownResultAction"
         scope="prototype">
+        <!-- 
         <property name="statementManager" ref="statementManager"/>
         <property name="organisationUnitService">
             <ref bean="org.hisp.dhis.organisationunit.OrganisationUnitService"/>
@@ -317,6 +318,7 @@
         <property name="configurationService">
             <ref bean="org.hisp.dhis.config.ConfigurationService"/>
         </property>
+        -->
     </bean>
 	
 	<!-- Annual Analyser -->
@@ -635,6 +637,7 @@
         <property name="sessionFactory" ref="sessionFactory"/>
         <property name="jdbcTemplate" ref="jdbcTemplate"/>
 <!--		<property name="serviceProvider" ref="dataCompletenessServiceProvider"/>-->
+		<property name="databaseInfoProvider" ref="databaseInfoProvider" />
     </bean>
 	
 	 <!-- Null report for DataEntry Status -->
@@ -881,6 +884,7 @@
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
 		<property name="constantService" ref="org.hisp.dhis.constant.ConstantService" />
         <property name="jdbcTemplate" ref="jdbcTemplate"/>
+        <property name="databaseInfoProvider" ref="databaseInfoProvider" />
     </bean>
 	
     <bean
@@ -907,6 +911,7 @@
 <!--	<property name="sectionService">
             <ref bean="org.hisp.dhis.dataset.SectionService"/>
         </property>-->
+        <property name="databaseInfoProvider" ref="databaseInfoProvider" />
     </bean>
 	
     <bean id="org.hisp.dhis.dataanalyser.ds.action.ExportToExcelAction"
@@ -1199,6 +1204,16 @@
 		</property>
     </bean>
 
+
+	<!-- Get Forteen Period List -->
+	
+	<bean id="org.hisp.dhis.dataanalyser.action.GetForteenPeriodAction"
+        class="org.hisp.dhis.dataanalyser.action.GetForteenPeriodAction"
+        scope="prototype">
+		<property name="periodService" ref="org.hisp.dhis.period.PeriodService">
+		</property>
+    </bean>	
+
 	<!-- Get Financial Year List  -->
 	
 	<bean id="org.hisp.dhis.dataanalyser.action.GetFinacialYearAction"
@@ -1523,5 +1538,33 @@
                 <ref bean="cronTriggerForBulkSMSByExcelJob" />
             </list>
         </property>
-   </bean>		
+   </bean>
+<!-- Validation Rule for Odisha -->
+	<bean
+		id="org.hisp.dhis.dataanalyser.vr.action.GenerateValidationRuleFormAction"
+		class="org.hisp.dhis.dataanalyser.vr.action.GenerateValidationRuleFormAction"
+		scope="prototype">       
+        <property name="periodService">
+            <ref bean="org.hisp.dhis.period.PeriodService"/>
+        </property>       
+        <property name="organisationUnitService">
+            <ref bean="org.hisp.dhis.organisationunit.OrganisationUnitService"/>
+        </property>
+        <property name="organisationUnitGroupService">
+            <ref bean="org.hisp.dhis.organisationunit.OrganisationUnitGroupService"/>
+        </property>        	
+    </bean>	
+	
+	<bean
+		id="org.hisp.dhis.dataanalyser.vr.action.GenerateValidationRuleResultAction"
+		class="org.hisp.dhis.dataanalyser.vr.action.GenerateValidationRuleResultAction"
+		scope="prototype"> 
+        <property name="organisationUnitService" ref = "org.hisp.dhis.organisationunit.OrganisationUnitService"/>
+		<property name="jdbcTemplate" ref="jdbcTemplate"/> 
+		<property name="periodService" ref="org.hisp.dhis.period.PeriodService"/> 
+		<property name="organisationUnitGroupService" ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService"/>
+		<property name="reportService" ref="org.hisp.dhis.reports.ReportService"/>    	
+    </bean>	
+
+   
 </beans>
\ No newline at end of file

=== modified file 'local/in/dhis-web-dashboard/src/main/resources/struts.xml'
--- local/in/dhis-web-dashboard/src/main/resources/struts.xml	2012-07-02 07:39:05 +0000
+++ local/in/dhis-web-dashboard/src/main/resources/struts.xml	2013-10-04 07:31:37 +0000
@@ -128,7 +128,8 @@
 		
 		<action name="getDataElemetGrp"
             class="org.hisp.dhis.dataanalyser.ga.action.GetDataElementGroupAction">
-            <result name="success" type="velocity-xml">/dhis-web-dashboard/getDataElementGrp.vm</result>
+            <result name="success" type="velocity">/dhis-web-dashboard/getDataElementGrp.vm</result>
+			<!--<result name="success" type="velocity-xml">/dhis-web-dashboard/getDataElementGrp.vm</result>-->
             <!--<interceptor-ref name="transactionStack"/>-->
             <param name="onExceptionReturn">plainTextError</param>
         </action>		
@@ -847,6 +848,15 @@
 			<param name="onExceptionReturn">plainTextError</param>
 		</action>
 		
+		
+		<!-- Getting Forteen Period -->
+		<action name="getForteenPeriod"
+			class="org.hisp.dhis.dataanalyser.action.GetForteenPeriodAction">
+			<result name="success" type="velocity-xml">/dhis-web-dashboard/responseForteenPeriods.vm</result>
+			<param name="onExceptionReturn">plainTextError</param>
+		</action>		
+		
+		
 		<action name="getDataElements"
 			class="org.hisp.dhis.dataanalyser.action.GetDataElementsAction">
 			<result name="success" type="velocity-xml">
@@ -1047,8 +1057,28 @@
             <param name="page">/dhis-web-dashboard/BulkSMSForExcelSheetResult.vm</param>
 			<interceptor-ref name="fileUploadStack"/>
         </action>		
-
+	
+		<!-- Validation Rule for Odisha -->
+		<action name="validationRuleForm"
+			class="org.hisp.dhis.dataanalyser.vr.action.GenerateValidationRuleFormAction">
+			<result name="success" type="velocity">/main.vm</result>
+			<param name="page">
+				/dhis-web-dashboard/validationRuleForm.vm</param>
+			<param name="menu">/dhis-web-dashboard/menuWithTreeForValidation.vm</param>
+			<param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,javascript/ta.js,javascript/hashtable.js</param>
+			<param name="stylesheets">css/StylesForTags.css</param>
+			<interceptor-ref name="organisationUnitTreeStack"/>
+		</action>
 		
+		<action name="validationRuleResult"
+			class="org.hisp.dhis.dataanalyser.vr.action.GenerateValidationRuleResultAction">
+			<result name="success" type="stream">
+				<param name="contentType">application/vnd.ms-excel</param>
+				<param name="inputName">inputStream</param>
+				<param name="contentDisposition">filename="${fileName}"</param>
+				<param name="bufferSize">1024</param>
+			</result>
+		</action>		
 	</package>
 
 </struts>
\ No newline at end of file

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/WEB-INF/web.xml'
--- local/in/dhis-web-dashboard/src/main/webapp/WEB-INF/web.xml	2012-04-04 05:46:52 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/WEB-INF/web.xml	2013-09-19 06:34:31 +0000
@@ -31,7 +31,7 @@
   </filter>
   <filter>
     <filter-name>Struts</filter-name>
-    <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
+    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
   </filter>
   
   <filter-mapping>

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataEntryStatusResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataEntryStatusResult.vm	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataEntryStatusResult.vm	2013-09-19 06:34:31 +0000
@@ -91,7 +91,7 @@
                 <input type="hidden" name="htmlCode" id="htmlCode" />
 
                 <div align="right" class="NormalB">
-                    <input type="checkbox" name="includeZeros" id="includeZeros" #if($includeZeros) checked #end /> Include Zero<br />
+
                     <input type="submit" name="ExportToWorkBook" value="Export To WorkBook" style="width: 160; height: 25; font-family:Arial; font-weight:bold; color:#000000">
                 </div>
 

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataEntrySummaryStatusResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataEntrySummaryStatusResult.vm	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataEntrySummaryStatusResult.vm	2014-07-07 11:04:09 +0000
@@ -22,8 +22,8 @@
                     evt.target.href = "dataEntrySummaryStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType+"&includeZeros="+includeZeros;
                 	*/
  			   		var url = "dataEntrySummaryStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType+"&includeZeros="+includeZeros;
-					$('#contentDataRecord').dialog('destroy').remove();
-			   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+					$('#contentDiv').dialog('destroy').remove();
+			   	    $('<div id="contentDiv">' ).load(url).dialog({
 			        title: 'Data Entry Status Result',
 					maximize: true, 
 					closable: true,
@@ -42,8 +42,8 @@
                     evt.target.href = "dataEntrySummaryStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType;
  			   		*/
  			   		var url = "dataEntrySummaryStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType;
-					$('#contentDataRecord').dialog('destroy').remove();
-			   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+					$('#contentDiv').dialog('destroy').remove();
+			   	    $('<div id="contentDiv">' ).load(url).dialog({
 			        title: 'Data Entry Status Result',
 					maximize: true, 
 					closable: true,
@@ -90,7 +90,7 @@
                 <input type="hidden" name="htmlCode" id="htmlCode" />
 
                 <div align="right" class="NormalB">
-                    <input type="checkbox" name="includeZeros" id="includeZeros" #if($includeZeros) checked #end /> Include Zero<br />
+
                     <input type="submit" name="ExportToWorkBook" value="Export To WorkBook" style="width: 160; height: 25; font-family:Arial; font-weight:bold; color:#000000">
                 </div>
 
@@ -133,8 +133,9 @@
                             <tr class="TableHeadingCellStyles">
                                 #foreach( $levelName in $levelNames )
                                     #if( $count1 == $curOrgUnitLevel )
-                                        <td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')" target="_blank">$chiildorgUnit.name #if( $orgunitCount !=-1 ) ( $orgunitCount ) #end</a></td>
-                                    #else
+                                        <!--<td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')" target="_blank">$chiildorgUnit.name #if( $orgunitCount !=-1 ) ( $orgunitCount ) #end</a></td>-->
+										<td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')">$chiildorgUnit.name #if( $orgunitCount !=-1 ) ( $orgunitCount ) #end</a></td>	
+									#else
                                         <td>&nbsp;</td>
                                     #end
                                     #set($count1 = $count1 + 1)

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataStatusDataSetWiseResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataStatusDataSetWiseResult.vm	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataStatusDataSetWiseResult.vm	2013-09-19 06:34:31 +0000
@@ -35,7 +35,7 @@
 		<form id="form1" name="form1" action="exportDataStatusToExcel.action" method="post" onsubmit="return exportDataStatusResultToWorkBook()" target="_newtab">
 			<input type="hidden" name="htmlCode" id="htmlCode" />
 			<div align="right" class="NormalB">
-			    <input type="checkbox" name="includeZeros" id="includeZeros" #if($includeZeros) checked #end /> Include Zero<br />
+
 				<input type="submit" name="ExportToWorkBook" value="Export To WorkBook" style="width: 160; height: 25; font-family:Arial; font-weight:bold; color:#000000">
 			</div>
 

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataStatusFront.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataStatusFront.vm	2012-06-01 10:12:47 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataStatusFront.vm	2014-07-07 10:19:49 +0000
@@ -1,3 +1,23 @@
+<style>
+    #overlay {
+    z-index:9998;
+    position:absolute;
+    top:0;
+    bottom:0;
+    left:0;
+    width:100%;
+    background:#000;
+    opacity:0.45;
+    -moz-opacity:0.45;
+    filter:alpha(opacity=45);
+    visibility:hidden;   
+    }
+    #overlayImg{ width: 50px; height: 50px; z-index: 9999; position: absolute; left:50%}
+</style>
+<div id="overlay">
+    <div id="overlayImg"><img  width="50" height="50" src="images/ajax-loader.gif" style="margin:auto;position:fixed;top: 50%;left: 50%;"/></div>
+</div>
+
 <style type='text/css'>
     .hidden{ display: none; }
 </style>
@@ -53,7 +73,7 @@
                 <select id="eDateLB" name="eDateLB" style="width:300px"></select>
             </td>
             <td class="NormalB">
-                <input type="checkbox" name="includeZeros" id="includeZeros" checked> Include Zero &nbsp;&nbsp; <input type="checkbox" name="usingDataEntryStatus" id="usingDataEntryStatus" > Data Entry Status
+                <input type="checkbox" name="includeZeros" id="includeZeros" checked> Include Zero &nbsp;&nbsp; <input type="checkbox" style="display:none" name="usingDataEntryStatus" id="usingDataEntryStatus" ><!-- Data Entry Status -->
                 <br/><br/>
                 <input type="button" name="ViewSummary" value="View DataSummary - Data Set" style="width:250px;height:30px;font-family: Arial; font-weight: bold; color: rgb(0, 0, 0);" onclick="textvalue('SummaryStatus')"/><br/><br/>
                 <input type="button" name="ViewStatus" value="View DataStatus - Data Set" style="width:250px;height:30px;font-family: Arial; font-weight: bold; color: rgb(0, 0, 0);" onclick="textvalue('DataStatus')"/><br/><br/>

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataStatusResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataStatusResult.vm	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataStatusResult.vm	2014-07-07 10:54:41 +0000
@@ -2,8 +2,7 @@
 <html>
     <head>
     <title>DataStatus Result</title>
-    <link type="text/css" rel="stylesheet" media="screen" href="css/StylesForTags.css">
-    </link>
+	<link type="text/css" rel="stylesheet" media="screen" href="css/StylesForTags.css"></link>
       <script>
             var startDate = "$sDateLB";
             var endDate = "$eDateLB";
@@ -23,8 +22,9 @@
                     evt.target.href = "dataStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType+"&includeZeros="+includeZeros;
                 	*/
 			   		var url = "dataStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType+"&includeZeros="+includeZeros;
-					$('#contentDataRecord').dialog('destroy').remove();
-			   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+				
+					$('#contentDiv').dialog('destroy').remove();
+			   	    $('<div id="contentDiv">' ).load(url).dialog({
 			        title: 'Data Entry Status Result',
 					maximize: true, 
 					closable: true,
@@ -34,9 +34,6 @@
 			        height: 800
 			    	});                
                 
-                
-                
-                
                 }
                 else
                 {
@@ -45,8 +42,9 @@
                     evt.target.href = "dataStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType;
                 	*/
                 	var url = "dataStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType;
-					$('#contentDataRecord').dialog('destroy').remove();
-			   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+					
+					$('#contentDiv').dialog('destroy').remove();
+			   	    $('<div id="contentDiv">' ).load(url).dialog({
 			        title: 'Data Entry Status Result',
 					maximize: true, 
 					closable: true,
@@ -56,9 +54,6 @@
 			        height: 800
 			    	});                
                 
-                
-                
-                
                 }
             }
             function exportDataStatusResultToWorkBook()
@@ -70,8 +65,9 @@
 		  function getNullReportInfo( dsId, periodId, selOrgUnit )
 		  {	
 			var url = "nullReportResult.action?dsId="+dsId+"&periodId="+periodId+"&ouId="+selOrgUnit;
-			$('#contentDataRecord').dialog('destroy').remove();
-	   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+			
+			$('#contentDiv').dialog('destroy').remove();
+	   	    $('<div id="contentDiv">' ).load(url).dialog({
 	        title: 'Null Report',
 			maximize: true, 
 			closable: true,
@@ -82,7 +78,7 @@
 	    	});
 		 }
             
-    </script>
+	</script>
     </head>
     <body>
 
@@ -93,7 +89,7 @@
                 <input type="hidden" name="htmlCode" id="htmlCode" />
 
                 <div align="right" class="NormalB">
-                    <input type="checkbox" name="includeZeros" id="includeZeros" #if($includeZeros) checked #end /> Include Zero<br />
+
                     <input type="submit" name="ExportToWorkBook" value="Export To WorkBook" style="width: 160; height: 25; font-family:Arial; font-weight:bold; color:#000000">
                 </div>
 
@@ -142,7 +138,8 @@
                             <tr class="TableHeadingCellStyles">
                                 #foreach( $levelName in $levelNames )
                                     #if( $count1 == $curOrgUnitLevel )
-                                        <td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')" target="_blank">$chiildorgUnit.name</a></td>
+                                        <!--<td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')" target="_blank">$chiildorgUnit.name</a></td>-->
+										<td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')">$chiildorgUnit.name</a></td>
                                     #else
                                         <td>&nbsp;</td>
                                     #end

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataStatusResult_Test.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataStatusResult_Test.vm	2011-12-14 10:18:12 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/dataStatusResult_Test.vm	2013-09-19 06:34:31 +0000
@@ -53,7 +53,7 @@
                 <input type="hidden" name="htmlCode" id="htmlCode" />
 
                 <div align="right" class="NormalB">
-                    <input type="checkbox" name="includeZeros" id="includeZeros" #if($includeZeros) checked #end /> Include Zero<br />
+
                     <input type="submit" name="ExportToWorkBook" value="Export To WorkBook" style="width: 160; height: 25; font-family:Arial; font-weight:bold; color:#000000">
                 </div>
 

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/graphicalAnalysisDataElementFront.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/graphicalAnalysisDataElementFront.vm	2012-07-02 07:39:05 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/graphicalAnalysisDataElementFront.vm	2013-12-13 07:09:00 +0000
@@ -1,3 +1,25 @@
+
+<style>
+    #overlay {
+    z-index:9998;
+    position:absolute;
+    top:0;
+    bottom:0;
+    left:0;
+    width:100%;
+    background:#000;
+    opacity:0.45;
+    -moz-opacity:0.45;
+    filter:alpha(opacity=45);
+    visibility:hidden;   
+    }
+    #overlayImg{ width: 50px; height: 50px; z-index: 9999; position: absolute; left:50%}
+</style>
+<div id="overlay">
+    <div id="overlayImg"><img  width="50" height="50" src="images/ajax-loader.gif" style="margin:auto;position:fixed;top: 50%;left: 50%;"/></div>
+</div>
+
+
 <script>
 	
 	jQuery(document).ready(function() {
@@ -10,6 +32,7 @@
 	var selFacility = "";
     var dailyPeriodTypeName = '$dailyPeriodTypeName';
     var weeklyPeriodTypeName = '$weeklyPeriodTypeName';
+	var forteenPeriodTypeName = '$forteenPeriodTypeName';
     var monthlyPeriodTypeName = '$monthlyPeriodTypeName';
     var quarterlyPeriodTypeName = '$quarterlyPeriodTypeName';
     var sixmonthPeriodTypeName = '$sixMonthPeriodTypeName';
@@ -90,12 +113,12 @@
 		<tr>
 		<td class="NormalB">$i18n.getString( "ga_filter_by_degroup_section" )<br>
             #parse( "dhis-web-commons/loader/loader.vm" )
-            <div id="dataElementGrpDiv" name="dataElementGrpDiv"></div>		
+            <div id="dataElementGrpDiv" name="dataElementGrpDiv" style="width:450px"></div>		
 			
 		</td>
 	    <td class="NormalB">&nbsp;</td>
 		<td class="NormalB">$i18n.getString( "compare_view" )<br>
-			<select id="deSelection" name="deSelection" style="width:350px" onChange="deSelectionChangeFuntion(event)" >
+			<select id="deSelection" name="deSelection" style="width:450px" onChange="deSelectionChangeFuntion(event)" >
 				<option value="dataelement" selected>DataElements</option>
 				<option value="optioncombo">Options in DataElements</option>
 			</select>
@@ -108,7 +131,7 @@
     </tr>    
     
     <tr>
-      <td class="NormalB">$i18n.getString( "filter" ):&nbsp;<input type="text" id="availableDataElementsFilter" onkeyup="filterAvailableDataElements()" style="min-width:24em"></td>
+      <td class="NormalB">$i18n.getString( "filter" ):&nbsp;<input type="text" id="availableDataElementsFilter" onkeyup="filterAvailableDataElements()" style="width:400px"></td>
       <td class="NormalB">&nbsp;</td>
       <td class="NormalB">$i18n.getString( "ga_filter_by_degroup" ) &nbsp;<input type="checkbox" checked="true" id="chkDataGrp" onchange="checkedDataElementGroup()"/></td>
     </tr>
@@ -120,7 +143,7 @@
     
     <tr>
 		<td class="NormalB">$i18n.getString( "ga_available_delist" )<br>
-			<select multiple size="7" id="availableDataElements" name="availableDataElements"  style="width:325px; height:100px" ondblclick="moveSelectedById( 'availableDataElements', 'selectedDataElements' )">
+			<select multiple size="7" id="availableDataElements" name="availableDataElements"  style="width:450px; height:100px" ondblclick="moveSelectedById( 'availableDataElements', 'selectedDataElements' )">
 				#foreach ( $element in $dataElements )
 				<option value="$element.id" title="$element.name">$element.name</option>
 				#end
@@ -133,7 +156,7 @@
 			&nbsp;&nbsp;<input type="button" value="&lt;&lt;" style="width:40px" onClick="moveAllById( 'selectedDataElements', 'availableDataElements' )">&nbsp;&nbsp;
 		</td>
 		<td class="NormalB"> $i18n.getString( "ga_selected_delist" )<br />
-			<select multiple size="7" id="selectedDataElements" name="selectedDataElements" style="width:350px; height:100px" ondblclick="moveSelectedById( 'selectedDataElements', 'availableDataElements' )">
+			<select multiple size="7" id="selectedDataElements" name="selectedDataElements" style="width:450px; height:100px" ondblclick="moveSelectedById( 'selectedDataElements', 'availableDataElements' )">
 			</select>
 		</td>
 	</tr>
@@ -151,7 +174,7 @@
 			<table>
 				<tr>
 					<td class="NormalB"> $i18n.getString( "ga_viewby" )<br>
-						<select id="categoryLB" name="categoryLB" onChange="categoryChangeFunction1(event)" disabled="true" style="width: 150px;">
+						<select id="categoryLB" name="categoryLB" onChange="categoryChangeFunction1(event)" disabled="true" style="width: 200px;">
 							<option value="period">Period Wise</option>
 							<option value="children">Children</option>
 							<option value="random">Selected</option>    
@@ -159,7 +182,7 @@
 					</td>
 					<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
 					<td align="left" class="NormalB"> $i18n.getString( "periodType" )<br>
-						<select id="periodTypeLB" name="periodTypeLB" onchange="getPeriods()" style="width: 175px;" disabled="true">                                
+						<select id="periodTypeLB" name="periodTypeLB" onchange="getPeriods()" style="width: 225px;" disabled="true">                                
 						#foreach ( $periodType in $periodTypes )
 							<option value="$periodType.name" #if($periodType.name==$monthlyPeriodTypeName) selected #end>$periodType.name</option>                              
 						#end
@@ -174,11 +197,11 @@
 			<table>
 				<tr>
 					<td class="NormalB">$i18n.getString( "ga_orgunit" )<br>
-						<select name="orgUnitListCB" id="orgUnitListCB" multiple size="7" style="width:150px;height:100px"  ondblclick="remOUFunction()"> >
+						<select name="orgUnitListCB" id="orgUnitListCB" multiple size="7" style="width:200px;height:100px"  ondblclick="remOUFunction()"> >
 						</select>                       
 					</td>
 					<td class="NormalB"><input type="checkbox" id="ougGroupSetCB" name="ougGroupSetCB" onChange="getOrgUnitGroupsDataElements()"  disabled="true">$i18n.getString( "ga_orgUnitGroups" )<br>
-						<select name="orgUnitGroupList" id="orgUnitGroupList" multiple size="7"  onChange="selectSingleOptionOrgUnitGroup()"  style="width:150px;height:100px" disabled="true">
+						<select name="orgUnitGroupList" id="orgUnitGroupList" multiple size="7"  onChange="selectSingleOptionOrgUnitGroup()"  style="width:200px;height:100px" disabled="true">
 						</select>
 					</td>
 				</tr>
@@ -189,7 +212,7 @@
 			<table>
 				<tr>
 					<td class="NormalB">$i18n.getString( "year" )<br>
-						<select id="yearLB" name="yearLB" onchange="getWeeklyPeriod()" size="7" multiple style="width:150px;height:100px" disabled="true">                                                                                
+						<select id="yearLB" name="yearLB" onchange="getWeeklyPeriod()" onblur="getTempForteenPeriod()" size="7" multiple style="width:200px;height:100px" disabled="true">                                                                                
 						#foreach($periodName in $periodNameList)
 						<option value="$periodName">$periodName</option>                                
 						#end
@@ -197,7 +220,7 @@
 					</td>
 					<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
 					<td class="NormalB">$i18n.getString( "period" )<br>
-						<select id="periodLB" name="periodLB" size="7" multiple style="width:175px;height:100px" disabled="true">                              
+						<select id="periodLB" name="periodLB" size="7" multiple style="width:225px;height:100px" disabled="true">                              
 						</select>
 					</td>
 				</tr>
@@ -210,9 +233,9 @@
         <td class="NormalB" align="center">
             <table>
                 <tr>
-		            <td><input type="button" name="ViewChart" value="$i18n.getString( 'ga_viewchart' )" style="width:150px; height: 25; font-family:Arial; font-weight:bold; color:#000000" onClick="javascript:selButtonFunction1('ViewChart')"></td>
+		            <td><input type="button" name="ViewChart" value="$i18n.getString( 'ga_viewchart' )" style="width:200px; height: 25; font-family:Arial; font-weight:bold; color:#000000" onClick="javascript:selButtonFunction1('ViewChart')"></td>
 					<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
-					<td align="right"><input type="button" name="ViewSummary" value="$i18n.getString( 'ga_viewsummary' )" style="width:175px; height: 25; font-family:Arial; font-weight:bold; color:#000000" onClick="javascript:selButtonFunction1('ViewSummary')"></td>
+					<td align="right"><input type="button" name="ViewSummary" value="$i18n.getString( 'ga_viewsummary' )" style="width:225px; height: 25; font-family:Arial; font-weight:bold; color:#000000" onClick="javascript:selButtonFunction1('ViewSummary')"></td>
 					<input type="hidden" name="selectedButton" id="selectedButton">
 					<input type="hidden" name="validation" id="validation" value="dataelement">
                 </tr>
@@ -221,7 +244,7 @@
     </tr>   			
   </table>
 </form>
-<div id="contentDiv"></div>
+<!--<div id="contentDiv"></div>-->
 <script>
 	getPeriods();
 </script>

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/graphicalAnalysisDataElementResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/graphicalAnalysisDataElementResult.vm	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/graphicalAnalysisDataElementResult.vm	2013-09-20 07:04:46 +0000
@@ -45,8 +45,9 @@
 	   */
 	   
    		var url = "generatedrillDownPeriodToOrgChildChartDataElement.action?selDrillDownData="+selDrillDownData + "&selectedButton=" + selectedButton + "&categoryLB=" + viewBy + "&aggDataCB=" + aggDataCB;
-		$('#contentDataRecord').dialog('destroy').remove();
-   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+		
+		$('#contentDiv').dialog('destroy').remove();
+   	    $('<div id="contentDiv">' ).load(url).dialog({
         title: 'Period to Org Child',
 		maximize: true, 
 		closable: true,
@@ -109,8 +110,8 @@
         */
         
    		var url = "generatedrillDownOurUnitToPeriodChartDataElement.action?selDrillDownData="+selDrillDownData + "&selectedButton=" + selectedButton + "&categoryLB=" + viewBy + "&aggDataCB=" + aggDataCB;
-		$('#contentDataRecord').dialog('destroy').remove();
-   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+		$('#contentDiv').dialog('destroy').remove();
+   	    $('<div id="contentDiv">' ).load(url).dialog({
         title: 'Org Unit to Period',
 		maximize: true, 
 		closable: true,
@@ -177,8 +178,8 @@
        */ 
         
    		var url = "generatedrillDownOurUnitToPeriodChartDataElement.action?selDrillDownData="+selDrillDownData + "&selectedButton=" + selectedButton + "&categoryLB=" + viewBy + "&aggDataCB=" + aggDataCB;
-		$('#contentDataRecord').dialog('destroy').remove();
-   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+		$('#contentDiv').dialog('destroy').remove();
+   	    $('<div id="contentDiv">' ).load(url).dialog({
         title: 'Org Unit Group to Period',
 		maximize: true, 
 		closable: true,
@@ -343,7 +344,8 @@
                     <input type="radio" id="riRadio" name="riRadio" value="childrenWiseDrillDown" >Children Wise Drill Down
                     &nbsp;&nbsp;&nbsp;
                #end 
-              </td> -->  
+              </td> --> 
+	</td>
 			  <td class="NormalB"><a id="exportExcelAnchor2" name="exportExcelAnchor2" href="#" onclick="javascript:exportToExcelFunction2('yes')" target="_blank">Export To WorkBook</a></td>
 			  <td class="NormalB">&nbsp;&nbsp;
 			            <select id="chartDisplayOption" name="chartDisplayOption" onchange="getSortedListForSummary()">

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/graphicalAnalysisIndicatorFront.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/graphicalAnalysisIndicatorFront.vm	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/graphicalAnalysisIndicatorFront.vm	2013-12-13 07:09:00 +0000
@@ -1,3 +1,23 @@
+<style>
+    #overlay {
+    z-index:9998;
+    position:absolute;
+    top:0;
+    bottom:0;
+    left:0;
+    width:100%;
+    background:#000;
+    opacity:0.45;
+    -moz-opacity:0.45;
+    filter:alpha(opacity=45);
+    visibility:hidden;   
+    }
+    #overlayImg{ width: 50px; height: 50px; z-index: 9999; position: absolute; left:50%}
+</style>
+<div id="overlay">
+    <div id="overlayImg"><img  width="50" height="50" src="images/ajax-loader.gif" style="margin:auto;position:fixed;top: 50%;left: 50%;"/></div>
+</div>
+
 <script>
 	
 	// Global Variables
@@ -6,6 +26,7 @@
 	var selFacility = "";
 	var dailyPeriodTypeName = '$dailyPeriodTypeName';
 	var weeklyPeriodTypeName = '$weeklyPeriodTypeName';
+	var forteenPeriodTypeName = '$forteenPeriodTypeName';
 	var monthlyPeriodTypeName = '$monthlyPeriodTypeName';
 	var quarterlyPeriodTypeName = '$quarterlyPeriodTypeName';
 	var sixmonthPeriodTypeName = '$sixMonthPeriodTypeName';
@@ -86,7 +107,7 @@
 	<table style=" border-collapse: collapse; margin-top: 0;" cellpadding="0" cellspacing="0" border=0>
 	<tr>
 		<td class="NormalB">$i18n.getString( "ga_filter_by_indicatorgroup" )<br>
-			<select id="indicatorGroupId" name="indicatorGroupId" style="width:325px" onChange="getIndicators()" >
+			<select id="indicatorGroupId" name="indicatorGroupId" style="width:450px" onChange="getIndicators()" >
 				<option value="$ALL">[ Select IndicatorGroup / All ]</option>
 				#foreach ( $group in $indicatorGroups )
 				<option value="$group.id" title="$group.name">$group.name</option>
@@ -102,7 +123,7 @@
 		<td class="NormalB">&nbsp;</td>
     </tr>    
     <tr>
-		<td class="NormalB">$i18n.getString( "filter" ):&nbsp;<input type="text" id="availableIndicatorsFilter" onkeyup="filterAvailableIndicators()" style="min-width:24em"></td>
+		<td class="NormalB">$i18n.getString( "filter" ):&nbsp;<input type="text" id="availableIndicatorsFilter" onkeyup="filterAvailableIndicators()" style="width:400px"></td>
 		<td class="NormalB">&nbsp;</td>
 		<td class="NormalB">&nbsp;</td>
     </tr>
@@ -113,7 +134,7 @@
     </tr>        
     <tr>
 		<td class="NormalB">$i18n.getString( "ga_available_indicatorList" )<br>
-			<select multiple size="7" id="availableIndicators" name="availableIndicators"  style="width:325px; height:100px" ondblclick="moveSelectedById( 'availableIndicators', 'selectedIndicators' )">
+			<select multiple size="7" id="availableIndicators" name="availableIndicators"  style="width:450px; height:100px" ondblclick="moveSelectedById( 'availableIndicators', 'selectedIndicators' )">
 				#foreach ( $element in $indicators )
 					<option value="$element.id" title="$element.name">$element.name</option>
 				#end
@@ -126,7 +147,7 @@
 			&nbsp;&nbsp;<input type="button" value="&lt;&lt;" style="width:40px" onClick="moveAllById( 'selectedIndicators', 'availableIndicators' )">&nbsp;&nbsp;
 		</td>
 		<td class="NormalB"> $i18n.getString( "ga_selected_IndicatorList" )<br />
-			<select multiple size="7" id="selectedIndicators" name="selectedIndicators"  style="width:350px; height:100px" ondblclick="moveSelectedById( 'selectedIndicators', 'availableIndicators' )">
+			<select multiple size="7" id="selectedIndicators" name="selectedIndicators"  style="width:450px; height:100px" ondblclick="moveSelectedById( 'selectedIndicators', 'availableIndicators' )">
 			</select>
 		</td>
     </tr>
@@ -144,7 +165,7 @@
             <table>
                 <tr>
                     <td class="NormalB"> $i18n.getString( "ga_viewby" )<br>
-                        <select id="categoryLB" name="categoryLB" onChange="categoryChangeFunction1(event)" disabled="true" style="width: 150px;">
+                        <select id="categoryLB" name="categoryLB" onChange="categoryChangeFunction1(event)" disabled="true" style="width: 200px;">
                             <option value="period">Period Wise</option>
                             <option value="children">Children</option>
                             <option value="random">Selected</option>    
@@ -152,7 +173,7 @@
                     </td>
                     <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
                     <td align="left" class="NormalB"> $i18n.getString( "periodType" )<br>
-                        <select id="periodTypeLB" name="periodTypeLB" onchange="getPeriods()" style="width: 175px;" disabled="true">                                
+                        <select id="periodTypeLB" name="periodTypeLB" onchange="getPeriods()" style="width: 225px;" disabled="true">                                
                         #foreach ( $periodType in $periodTypes )
                             <option value="$periodType.name" #if($periodType.name==$monthlyPeriodTypeName) selected #end>$periodType.name</option>                              
                         #end
@@ -167,11 +188,11 @@
             <table>
                 <tr>
                     <td class="NormalB">$i18n.getString( "ga_orgunit" )<br>
-                        <select name="orgUnitListCB" id="orgUnitListCB" multiple size="7" style="width:150px;height:100px"  ondblclick="remOUFunction()"> >
+                        <select name="orgUnitListCB" id="orgUnitListCB" multiple size="7" style="width:200px;height:100px"  ondblclick="remOUFunction()"> >
                         </select>                       
                     </td>
                     <td class="NormalB"><input type="checkbox" id="ougGroupSetCB" name="ougGroupSetCB" onChange="getOrgUnitGroupsDataElements()"  disabled="true">$i18n.getString( "ga_orgUnitGroups" )<br>
-                        <select name="orgUnitGroupList" id="orgUnitGroupList" multiple size="7"  onChange="selectSingleOptionOrgUnitGroup()"  style="width:150px;height:100px" disabled="true">
+                        <select name="orgUnitGroupList" id="orgUnitGroupList" multiple size="7"  onChange="selectSingleOptionOrgUnitGroup()"  style="width:200px;height:100px" disabled="true">
                         </select>
                     </td>
                 </tr>
@@ -182,7 +203,7 @@
             <table>
                 <tr>
                     <td class="NormalB">$i18n.getString( "year" )<br>
-                        <select id="yearLB" name="yearLB" onchange="getWeeklyPeriod()" size="7" multiple style="width:150px;height:100px" disabled="true">                                                                                
+                        <select id="yearLB" name="yearLB" onchange="getWeeklyPeriod()" onblur="getTempForteenPeriod()" size="7" multiple style="width:200px;height:100px" disabled="true">                                                                                
                         #foreach($periodName in $periodNameList)
                         <option value="$periodName">$periodName</option>                                
                         #end
@@ -190,7 +211,7 @@
                     </td>
                     <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
                     <td class="NormalB">$i18n.getString( "period" )<br>
-                        <select id="periodLB" name="periodLB" size="7" multiple style="width:175px;height:100px" disabled="true">                              
+                        <select id="periodLB" name="periodLB" size="7" multiple style="width:225px;height:100px" disabled="true">                              
                         </select>
                     </td>
                 </tr>
@@ -203,9 +224,9 @@
         <td class="NormalB" align="center">
             <table>
                 <tr>
-					<td><input type="button" name="ViewChart" value="$i18n.getString( 'ga_viewchart' )" style="width:150px; height: 25; font-family:Arial; font-weight:bold; color:#000000" onClick="javascript:selButtonFunction('ViewChart')"></td>
+					<td><input type="button" name="ViewChart" value="$i18n.getString( 'ga_viewchart' )" style="width:200px; height: 25; font-family:Arial; font-weight:bold; color:#000000" onClick="javascript:selButtonFunction('ViewChart')"></td>
 					<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
-					<td align="right"><input type="button" name="ViewSummary" value="$i18n.getString( 'ga_viewsummary' )" style="width:175px; height: 25; font-family:Arial; font-weight:bold; color:#000000" onClick="javascript:selButtonFunction('ViewSummary')" /></td>
+					<td align="right"><input type="button" name="ViewSummary" value="$i18n.getString( 'ga_viewsummary' )" style="width:225px; height: 25; font-family:Arial; font-weight:bold; color:#000000" onClick="javascript:selButtonFunction('ViewSummary')" /></td>
                     <input type="hidden" name="selectedButton" id="selectedButton">
                     <input type="hidden" name="validation" id="validation" value="indicator">
                 </tr>
@@ -214,7 +235,7 @@
     </tr>               
   </table>
 </form>
-<div id="contentDiv"></div>
+<!--<div id="contentDiv"></div>-->
 <script>
 	getPeriods();
 </script>

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/graphicalAnalysisIndicatorResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/graphicalAnalysisIndicatorResult.vm	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/graphicalAnalysisIndicatorResult.vm	2013-09-20 07:05:50 +0000
@@ -39,8 +39,8 @@
       */  
         
    		var url = "generateDrillDownPeriodToOrgChildChartIndicator.action?selDrillDownData="+selDrillDownData + "&selectedButton=" + selectedButton + "&categoryLB=" + viewBy + "&aggDataCB=" + aggDataCB;
-		$('#contentDataRecord').dialog('destroy').remove();
-   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+		$('#contentDiv').dialog('destroy').remove();
+   	    $('<div id="contentDiv">' ).load(url).dialog({
         title: 'Period to Org Child',
 		maximize: true, 
 		closable: true,
@@ -87,8 +87,8 @@
        */ 
         
    		var url = "generatedrillDownOugUnitToPeriodChartIndicator.action?selDrillDownData="+selDrillDownData + "&selectedButton=" + selectedButton + "&categoryLB=" + viewBy + "&aggDataCB=" + aggDataCB;
-		$('#contentDataRecord').dialog('destroy').remove();
-   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+		$('#contentDiv').dialog('destroy').remove();
+   	    $('<div id="contentDiv">' ).load(url).dialog({
         title: 'Org Unit to Period',
 		maximize: true, 
 		closable: true,
@@ -132,8 +132,8 @@
        */ 
  
    		var url = "generatedrillDownOugUnitToPeriodChartIndicator.action?selDrillDownData="+selDrillDownData + "&selectedButton=" + selectedButton + "&categoryLB=" + viewBy + "&aggDataCB=" + aggDataCB;
-		$('#contentDataRecord').dialog('destroy').remove();
-   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+		$('#contentDiv').dialog('destroy').remove();
+   	    $('<div id="contentDiv">' ).load(url).dialog({
         title: 'Org Unit Group to Period',
 		maximize: true, 
 		closable: true,
@@ -278,7 +278,7 @@
         <tr>
             <td class="NormalB">
               #if($selectedButton.equals("ViewSummary"))
-                      
+			</td>          
               <td class="NormalB"><a id="exportExcelAnchor2" name="exportExcelAnchor2" href="#" onclick="javascript:exportToExcelFunction2('yes')" target="_blank">Export To WorkBook</a></td>
               <td class="NormalB">&nbsp;&nbsp;
                         <select id="chartDisplayOption" name="chartDisplayOption" onchange="getSortedListForSummary()">

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/groupWiseDataStatusResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/groupWiseDataStatusResult.vm	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/groupWiseDataStatusResult.vm	2014-07-07 11:21:40 +0000
@@ -23,8 +23,8 @@
                 	//alert("inside include zero : " + immChildOption );
  			   		var url = "groupWiseDataStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType+"&includeZeros="+includeZeros;
 					//alert( url );
-					$('#contentDataRecord').dialog('destroy').remove();
-			   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+					$('#contentDiv').dialog('destroy').remove();
+			   	    $('<div id="contentDiv">' ).load(url).dialog({
 			        title: 'Data Entry Status Result',
 					maximize: true, 
 					closable: true,
@@ -43,8 +43,8 @@
                     evt.target.href = "groupWiseDataStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType;
                 	*/
  			   		var url = "groupWiseDataStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType;
-					$('#contentDataRecord').dialog('destroy').remove();
-			   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+					$('#contentDiv').dialog('destroy').remove();
+			   	    $('<div id="contentDiv">' ).load(url).dialog({
 			        title: 'Data Entry Status Result',
 					maximize: true, 
 					closable: true,
@@ -72,7 +72,7 @@
         <form id="form1" name="form1" action="exportDataStatusToExcel.action" method="post" onsubmit="return exportDataStatusResultToWorkBook()" target="_newtab">
             <input type="hidden" name="htmlCode" id="htmlCode" />
             <div align="right" class="NormalB">
-                <input type="checkbox" name="includeZeros" id="includeZeros" #if($includeZeros) checked #end /> Include Zero<br />
+
                 <input type="submit" name="ExportToWorkBook" value="Export To WorkBook" style="width: 160; height: 25; font-family:Arial; font-weight:bold; color:#000000">
             </div>
             
@@ -121,7 +121,8 @@
                                   <tr class="TableHeadingCellStyles">
                                       #foreach($levelName in $levelNames)
                                           #if($count1 == $curOrgUnitLevel)
-                                              <td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')" target="_blank">$chiildorgUnit.name</a></td>
+                                              <!--<td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')" target="_blank">$chiildorgUnit.name</a></td>-->
+											  <td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')">$chiildorgUnit.name</a></td>
                                           #else
                                               <td>&nbsp;</td>
                                           #end

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/groupWiseMobileDataStatusResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/groupWiseMobileDataStatusResult.vm	2011-12-14 10:18:12 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/groupWiseMobileDataStatusResult.vm	2013-09-19 06:34:31 +0000
@@ -39,7 +39,7 @@
         <form id="form1" name="form1" action="exportDataStatusToExcel.action" method="post" onsubmit="return exportDataStatusResultToWorkBook()" target="_newtab">
             <input type="hidden" name="htmlCode" id="htmlCode" />
             <div align="right" class="NormalB">
-                <input type="checkbox" name="includeZeros" id="includeZeros" #if($includeZeros) checked #end /> Include Zero<br />
+
                 <input type="submit" name="ExportToWorkBook" value="Export To WorkBook" style="width: 160; height: 25; font-family:Arial; font-weight:bold; color:#000000">
             </div>
             

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/javascript/ds.js'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/javascript/ds.js	2012-06-01 10:12:47 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/javascript/ds.js	2014-07-07 10:29:06 +0000
@@ -1,3 +1,9 @@
+
+window.onload=function()
+{
+	jQuery('#contentDiv').dialog({autoOpen: false});	
+}
+
 // Removes slected orgunits from the Organisation List
 function remOUFunction()
 {
@@ -22,7 +28,6 @@
 */
 function getImmChildInfo1(evt, dsId, selOrgUnit)
 {
-
     alert("urlForImmChild");
 }
 			
@@ -242,9 +247,33 @@
 	url += getParamsStringBySelected( 'periodLB', 'periodLB' )+ "&"
 	*/	
 	//alert(url);
-	jQuery('#loaderDiv').show();
+	
+	
+	document.getElementById('overlay').style.visibility = 'visible';
 	jQuery('#contentDiv').dialog('destroy').remove();
-	jQuery( '<div id="contentDiv">' ).load( url,
+	
+	jQuery( '<div id="contentDiv">'  ).load( url,
+			{
+				selectedDataSets : getFieldValue( 'selectedDataSets' ),
+				facilityLB : getFieldValue( 'facilityLB' ),
+				sDateLB : getFieldValue( 'sDateLB' ),
+				eDateLB : getFieldValue( 'eDateLB' ),
+				includeZeros : isChecked( 'includeZeros' )
+			} ).dialog( {
+				title: 'Data Entry Status Result',
+				maximize: true, 
+				closable: true,
+				modal:true,
+				overlay:{ background:'#000000', opacity:0.1 },
+				width: 1000,
+				height: 800
+			} );
+			document.getElementById('overlay').style.visibility = 'hidden';	
+	
+	/*
+	 * 
+	 * jQuery('#loaderDiv').show();
+	jQuery( '#contentDiv' ).load( url,
 	{
 		selectedDataSets : getFieldValue( 'selectedDataSets' ),
 		facilityLB : getFieldValue( 'facilityLB' ),
@@ -263,6 +292,11 @@
 		height: 800
 	} );
 	jQuery('#loaderDiv').hide();
+	*/
+	
+	
+	
+	
 }
 
 function getParamsStringBySelected( elementId, param )

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/javascript/gadataelement.js'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/javascript/gadataelement.js	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/javascript/gadataelement.js	2013-09-20 06:53:06 +0000
@@ -1,4 +1,9 @@
 
+window.onload=function(){
+	jQuery('#contentDiv').dialog({autoOpen: false});	
+}
+
+
 function getOUDeatilsForGADataElements( orgUnitIds )
 {
 	document.getElementById( "ougGroupSetCB" ).disabled = false;
@@ -122,6 +127,22 @@
         }
 
     }
+	
+	// forteen period
+    else if( periodTypeId == forteenPeriodTypeName )
+    {
+        if( yearLB.selectedIndex < 0 ) 
+        {
+            alert("Please select Year(s) First");
+            return false;
+        }
+        else
+        {
+        	getForteenPeriod();
+        }
+
+    }	
+	
     else if( periodTypeId == financialAprilPeriodType )
     {
     	//getFinacialYear();
@@ -186,6 +207,87 @@
     }
     
 }
+
+
+//getting forteen period
+
+function getTempForteenPeriod()
+{
+    var periodTypeList = document.getElementById( "periodTypeLB" );
+    var periodTypeId = periodTypeList.options[ periodTypeList.selectedIndex ].value;
+    
+    if( periodTypeId == forteenPeriodTypeName )
+    {
+    	getForteenPeriod();
+    }
+    
+}
+
+// get forteen period
+
+function getForteenPeriod()
+{
+	var yearLB = document.getElementById("yearLB");
+	
+	if( yearLB.selectedIndex < 0 ) 
+     {
+         alert("Please select Year(s) First");
+         return false;
+     }
+	
+	else
+	{
+		var yearListObj = document.getElementById('yearLB');
+		var yearListval = yearListObj.options[ yearListObj.selectedIndex ].value;
+		//alert(yearListval); 
+		var year = yearListval.split( "-" )[0] ;
+		var yearList = "" ;
+		
+		var yearLB = document.getElementById("yearLB");
+	    for(k = 0; k < yearLB.options.length; k++)
+	    {
+	    	if ( yearLB.options[k].selected == true )
+	    	{
+	    		yearList += yearLB.options[k].value + ";" ;
+	    	}
+	    }
+	    //alert( yearList );
+	    $.post("getForteenPeriod.action",
+				{
+					yearList:yearList
+				},
+				function (data)
+				{
+					getForteenPeriodReceived(data);
+				},'xml');
+	    
+	    
+	}
+}
+
+
+//Forteen Period received
+function getForteenPeriodReceived( xmlObject )
+{	
+	var periodList = document.getElementById( "periodLB" );
+	
+	clearList( periodList );
+	
+	var forteenPeriodList = xmlObject.getElementsByTagName( "forteenPeriod" );
+	
+	for ( var i = 0; i < forteenPeriodList.length; i++ )
+	{
+	    var forteenPeriodName = forteenPeriodList[ i ].getElementsByTagName( "name" )[0].firstChild.nodeValue;
+		
+	        var option = document.createElement( "option" );
+	        option.value = forteenPeriodName;
+	        option.text = forteenPeriodName;
+	        option.title = forteenPeriodName;
+	        periodList.add( option, null );
+	}
+}
+
+
 //get week period Ajax calling
 function getWeeks()
 {
@@ -533,6 +635,8 @@
 
 function generateChartDataElement()
 {
+	document.getElementById('overlay').style.visibility = 'visible';
+	jQuery('#contentDiv').dialog('destroy').remove();
 
 	var url = "generateChartDataElement.action?" + getParamString( 'selectedDataElements', 'selectedDataElements' ) + "&"
 	          + getParamsStringBySelected( 'orgUnitGroupList', 'orgUnitGroupList' )+ "&" + getParamString( 'orgUnitListCB', 'orgUnitListCB' )+ "&"
@@ -547,7 +651,7 @@
 		url += getParamsStringBySelected( 'periodLB', 'periodLB' )+ "&"
 	*/	
 		//alert(url);
-	jQuery( "#contentDiv" ).load( url,
+	jQuery( '<div id="contentDiv">'  ).load( url,
 	{
 		deSelection : getFieldValue( 'deSelection' ),
 		categoryLB : getFieldValue( 'categoryLB' ),
@@ -564,6 +668,7 @@
 		width: 1000,
 		height: 800
 	} );
+	document.getElementById('overlay').style.visibility = 'hidden';
 }
 
 function getParamsStringBySelected( elementId, param )
@@ -585,6 +690,8 @@
 	return result;
 }
  
+
+
 /*
  
 function generateChartDataElement()
@@ -712,7 +819,8 @@
            return false;
        }
    }
-  
+ 
+    
  /*
 	if( selIndicatorsListSize > 0 )
 	{
@@ -745,7 +853,9 @@
 
 function generateChartIndicator()
 {
-
+	document.getElementById('overlay').style.visibility = 'visible';
+	jQuery('#contentDiv').dialog('destroy').remove();
+	
 	var url = "generateChartIndicator.action?" + getParamString( 'selectedIndicators', 'selectedIndicators' ) + "&"
 	          + getParamsStringBySelected( 'orgUnitGroupList', 'orgUnitGroupList' )+ "&" + getParamString( 'orgUnitListCB', 'orgUnitListCB' )+ "&"
 	          + getParamsStringBySelected( 'yearLB', 'yearLB' )+ "&" + getParamsStringBySelected( 'periodLB', 'periodLB' ) ;
@@ -759,7 +869,7 @@
 		url += getParamsStringBySelected( 'periodLB', 'periodLB' )+ "&"
 	*/	
 		//alert(url);
-	jQuery( "#contentDiv" ).load( url,
+	jQuery( '<div id="contentDiv">' ).load( url,
 	{
 		categoryLB : getFieldValue( 'categoryLB' ),
 		periodTypeLB : getFieldValue( 'periodTypeLB' ),
@@ -775,6 +885,8 @@
 		width: 1000,
 		height: 800
 	} );
+	
+	document.getElementById('overlay').style.visibility = 'hidden';
 }
 
 

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/javascript/ta.js'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/javascript/ta.js	2012-07-02 07:39:05 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/javascript/ta.js	2013-10-04 07:42:56 +0000
@@ -278,6 +278,7 @@
 {
 	var checkValue = document.getElementById("hiddenChkValue").value;
     var dataElementGroupList = document.getElementById("dataElementGroupId");
+    
     //var dataElementGroupId = dataElementGroupList.options[ dataElementGroupList.selectedIndex ].value;
     
     var dataSetSectionId = dataElementGroupList.options[ dataElementGroupList.selectedIndex ].value;
@@ -514,6 +515,22 @@
         	getWeeks();
         }
     }
+    
+	// forteen period
+    else if( periodTypeId == forteenPeriodTypeName )
+    {
+        if( yearLB.selectedIndex < 0 ) 
+        {
+            alert("Please select Year(s) First");
+            return false;
+        }
+        else
+        {
+        	getForteenPeriod();
+        }
+
+    }	    
+    
     else if( periodTypeId == financialAprilPeriodType )
     {
     	//getFinacialYear();
@@ -575,6 +592,87 @@
     
 }
 
+
+//getting forteen period
+
+function getTempForteenPeriod()
+{
+    var periodTypeList = document.getElementById( "periodTypeLB" );
+    var periodTypeId = periodTypeList.options[ periodTypeList.selectedIndex ].value;
+    
+    if( periodTypeId == forteenPeriodTypeName )
+    {
+    	getForteenPeriod();
+    }
+    
+}
+
+
+function getForteenPeriod()
+{
+	var yearLB = document.getElementById("yearLB");
+	
+	if( yearLB.selectedIndex < 0 ) 
+     {
+         alert("Please select Year(s) First");
+         return false;
+     }
+	
+	else
+	{
+		var yearListObj = document.getElementById('yearLB');
+		var yearListval = yearListObj.options[ yearListObj.selectedIndex ].value;
+
+		var year = yearListval.split( "-" )[0] ;
+		var yearList = "" ;
+		
+		var yearLB = document.getElementById("yearLB");
+	    for(k = 0; k < yearLB.options.length; k++)
+	    {
+	    	if ( yearLB.options[k].selected == true )
+	    	{
+	    		yearList += yearLB.options[k].value + ";" ;
+	    	}
+	    }
+
+	    $.post("getForteenPeriod.action",
+				{
+					yearList:yearList
+				},
+				function (data)
+				{
+					getForteenPeriodReceived(data);
+				},'xml');
+	    
+	    
+	}
+}
+
+//Forteen Period received
+function getForteenPeriodReceived( xmlObject )
+{	
+	var periodList = document.getElementById( "periodLB" );
+	
+	clearList( periodList );
+	
+	var forteenPeriodList = xmlObject.getElementsByTagName( "forteenPeriod" );
+	
+	for ( var i = 0; i < forteenPeriodList.length; i++ )
+	{
+	    var forteenPeriodName = forteenPeriodList[ i ].getElementsByTagName( "name" )[0].firstChild.nodeValue;
+		
+	        var option = document.createElement( "option" );
+	        option.value = forteenPeriodName;
+	        option.text = forteenPeriodName;
+	        option.title = forteenPeriodName;
+	        periodList.add( option, null );
+	}
+}
+
+
+
+
+
 //get week period Ajax calling
 function getWeeks()
 {
@@ -936,3 +1034,83 @@
         }
     }
 }
+
+
+
+// form Validation for Validation rule
+
+function formValidationsForValidationRule()
+{
+    var orgUnitListCB = document.getElementById("orgUnitListCB");
+    var selOUListLength = document.validationRuleForm.orgUnitListCB.options.length;
+    var orgUnitLevelCB = document.getElementById("orgUnitLevelCB");
+    var yearLB = document.getElementById("yearLB");
+    var periodLB = document.getElementById("periodLB");
+    var ouSelCB = document.getElementById("ouSelCB");
+    var aggPeriodCB = document.getElementById("aggPeriodCB");
+    var periodTypeList = document.getElementById( "periodTypeLB" );
+    var periodTypeId = periodTypeList.options[ periodTypeList.selectedIndex ].value;
+	var orgUnitSelListCB = document.getElementById( "orgUnitSelListCB" );
+	var ouRadioVal = orgUnitSelListCB.options[ orgUnitSelListCB.selectedIndex ].value;
+
+    var k=0;
+    
+   
+    if( periodTypeId == yearlyPeriodTypeName )
+    {
+        if( yearLB.selectedIndex < 0 ) 
+        {
+            alert("Please select Year(s)");
+            return false;
+        }
+    }
+    else
+    {
+        if( yearLB.selectedIndex < 0 ) 
+        {
+            alert("Please select Year(s)");
+            return false;
+        }
+        if( periodLB.selectedIndex < 0 ) 
+        {
+            alert("Please select Period(s)");
+            return false;
+        }
+    }
+	
+    if( ouRadioVal == "orgUnitSelectedRadio" )
+    {
+    	if( selOUListLength <= 0 )
+        {
+            alert( "Please select OrgUnit(s)" );
+            return false;
+        }
+    }
+    else if( ouRadioVal == "orgUnitGroupRadio" ) 
+    { 
+    	if( orgUnitLevelCB.selectedIndex < 0 ) 
+    	{
+            alert( "Please select OrgUnitGroup" );
+            return false;
+        }
+    }
+    else if( ouRadioVal == "orgUnitLevelRadio" )
+    {
+	   if(orgUnitLevelCB.selectedIndex < 0  ) 
+	   {
+           alert( "Please select OrgUnitLevel" );
+           return false;
+       }
+    }
+	   
+    orgUnitListCB.disabled = false;
+	
+    for(k = 0; k < orgUnitListCB.options.length; k++)
+    {
+        orgUnitListCB.options[k].selected = true;
+    }
+
+    return true;
+} 
+
+// formValidations for Validation rule Function End

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/javascript/tr.js'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/javascript/tr.js	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/javascript/tr.js	2013-09-19 06:34:31 +0000
@@ -27,6 +27,8 @@
 
 function getDataElements()
 {
+	var checkValue = document.getElementById("hiddenChkValue").value;
+	
 	var dataElementGroupList = document.getElementById("dataElementGroupId");
     //var dataElementGroupId = dataElementGroupList.options[ dataElementGroupList.selectedIndex ].value;
 	var dataSetSectionId = dataElementGroupList.options[ dataElementGroupList.selectedIndex ].value;
@@ -40,6 +42,7 @@
 		$.post("getDataElementsForTA.action",
 		{
 			id:dataSetSectionId,
+			chkValue:checkValue,
 			deOptionValue:deOptionValue
 		},
 		function (data)
@@ -229,7 +232,7 @@
 	});
 	
 	//result = result.substring( 0, list.length - 1 );
-	alert( result );
+	//alert( result );
 	return result;
 }
 

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/lastUpdatedDataSetSatusResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/lastUpdatedDataSetSatusResult.vm	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/lastUpdatedDataSetSatusResult.vm	2014-07-07 11:23:56 +0000
@@ -18,8 +18,8 @@
 	      		evt.target.href = "lastUpdatedDataSetResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType;
 				*/   
 				var url = "lastUpdatedDataSetResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType;
-				$('#contentDataRecord').dialog('destroy').remove();
-		   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+				$('#contentDiv').dialog('destroy').remove();
+		   	    $('<div id="contentDiv">' ).load(url).dialog({
 		        title: 'Data Entry Status Result',
 				maximize: true, 
 				closable: true,
@@ -55,7 +55,7 @@
 			
 			
 			<div align="right" class="NormalB">
-			    <!--<input type="checkbox" name="includeZeros" id="includeZeros" #if($includeZeros) checked #end /> Include Zero<br />-->
+			    <!-- -->
 				<input type="submit" name="ExportToWorkBook" value="Export To WorkBook" style="width: 160; height: 25; font-family:Arial; font-weight:bold; color:#000000">
 			</div>
 			
@@ -85,7 +85,8 @@
   				                  <tr class="TableHeadingCellStyles">
   				                      #foreach($levelName in $levelNames)
   				                          #if($count1 == $curOrgUnitLevel)
-  				                              <td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')" target="_blank">$chiildorgUnit.name</a></td>
+  				                              <!--<td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')" target="_blank">$chiildorgUnit.name</a></td>-->
+											  <td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')">$chiildorgUnit.name</a></td>
   				                          #else
   				                              <td>&nbsp;</td>
   				                          #end

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/lastUpdatedMobileDataSetSatusResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/lastUpdatedMobileDataSetSatusResult.vm	2011-12-14 10:18:12 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/lastUpdatedMobileDataSetSatusResult.vm	2013-09-19 06:34:31 +0000
@@ -37,7 +37,7 @@
             
             
             <div align="right" class="NormalB">
-                <!--<input type="checkbox" name="includeZeros" id="includeZeros" #if($includeZeros) checked #end /> Include Zero<br />-->
+                <!-- -->
                 <input type="submit" name="ExportToWorkBook" value="Export To WorkBook" style="width: 160; height: 25; font-family:Arial; font-weight:bold; color:#000000">
             </div>
             

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/menu.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/menu.vm	2011-12-03 07:44:11 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/menu.vm	2014-07-05 10:50:34 +0000
@@ -1,29 +1,36 @@
 
-<h2>$i18n.getString( "dataanalyser" )</h2>
+<h2>$i18n.getString( "dataanalyser" )&nbsp;</h2>
 	<ul>
-		<li>$i18n.getString( "ga" )</li>
+		<!--
+		<li>$i18n.getString( "ga" )&nbsp;</li>
 			<ul>
-		    	<li><a href="graphicalAnalyser.action">$i18n.getString( "regular" )</a></li>
+		    	<!--<li><a href="graphicalAnalyser.action">$i18n.getString( "regular" )</a></li>
 		        <li><a href="annualAnalyser.action">$i18n.getString( "annual" )</a></li>
-		        <li><a href="graphicalAnalyserDataElement.action">$i18n.getString( "dataelements_wise" )</a></li>
-		        <li><a href="graphicalAnalyserIndicator.action">$i18n.getString( "indicator_wise" )</a></li>
-		        <li><a href="surveyAnalyser.action">$i18n.getString( "survey" )</a></li>
+				
+		        <li><a href="graphicalAnalyserDataElement.action">$i18n.getString( "dataelements_wise" )&nbsp;</a></li>
+		        <li><a href="graphicalAnalyserIndicator.action">$i18n.getString( "indicator_wise" )&nbsp;</a></li>
+				
+		        <!--<li><a href="surveyAnalyser.action">$i18n.getString( "survey" )</a></li>
 		        <li><a href="targetAnalyser.action">$i18n.getString( "target" )</a></li>
-		      <!--  <li><a href="motionChartForm.action">MotionChart</a></li> -->
+			    <li><a href="motionChartForm.action">MotionChart</a></li> 
 		   	</ul>
-		<li><a href="tabularAnalysisForm.action">$i18n.getString( "ta" )</a></li>
+			
+		<li><a href="tabularAnalysisForm.action">$i18n.getString( "ta" )&nbsp;</a></li>
+		<li><a href="validationRuleForm.action">Validation Rule</a></li>
 		<!--<li><a href="viewCommentForm.action">$i18n.getString( "vc" )</a></li>-->
-		<li>$i18n.getString( "ds_datastatus" )</li>
+		
+		<li>$i18n.getString( "ds_datastatus" )&nbsp;</li>
 			<ul>				
-		   		<li><a href="dataStatusMartForm.action">$i18n.getString( "ds_mart" )</a></li>
-		   		<li><a href="dataStatusForm.action">$i18n.getString( "ds_regular" )</a></li>
-		   		<li><a href="dataStatusMobileForm.action">$i18n.getString( "ds_mobile" )</a></li>
-				<li><a href="dataStatusOrgnisationunitGroupSetWiseForm.action">$i18n.getString( "orgunit_group_ds" )</a></li>
-				<li><a href="NullReporter.action">$i18n.getString( "nr_null_reporter" )</a></li>
-				<li><a href="dataStatusDataSetWiseForm.action">$i18n.getString( "ds_dataset_wise" )</a></li>	
+		   		<!--<li><a href="dataStatusMartForm.action">$i18n.getString( "ds_mart" )</a></li>-->
+		   		<li><a href="dataStatusForm.action">$i18n.getString( "ds_regular" )&nbsp;</a></li>
+		   		<!--<li><a href="dataStatusMobileForm.action">$i18n.getString( "ds_mobile" )</a></li>
+				<li><a href="dataStatusOrgnisationunitGroupSetWiseForm.action">$i18n.getString( "orgunit_group_ds" )</a></li>-->
+				<li><a href="NullReporter.action">$i18n.getString( "nr_null_reporter" )&nbsp;</a></li>
+				<!--<li><a href="dataStatusDataSetWiseForm.action">$i18n.getString( "ds_dataset_wise" )</a></li>-->	
 	    		<!-- <li><a href="commentsForm.action">Comments</a></li>
 		   		<li><a href="dashBoardMatrixForm.action">DashBoard matrix</a></li> -->
 		   	</ul>
+		<!--
 		<li>$i18n.getString( "bulk_sms" )</li>
 			<ul>
 
@@ -31,4 +38,5 @@
 				<li><a href="dueDates.action">$i18n.getString( "due_dates" )</a></li>
 				<li><a href="prgwiseSummaryBulkSMSForm.action">$i18n.getString( "Programwise Summary" )</a></li>
 			</ul>
+		-->	
 	</ul>
\ No newline at end of file

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/mobileDataStatusResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/mobileDataStatusResult.vm	2011-12-14 10:18:12 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/mobileDataStatusResult.vm	2013-09-19 06:34:31 +0000
@@ -40,7 +40,7 @@
 <form id="form1" name="form1" action="exportDataStatusToExcel.action" method="post" onsubmit="return exportDataStatusResultToWorkBook()" target="_newtab">
     <input type="hidden" name="htmlCode" id="htmlCode" />
 	    <div align="right" class="NormalB">
-	        <input type="checkbox" name="includeZeros" id="includeZeros" #if($includeZeros) checked #end /> Include Zero<br /> 
+
 	        <input type="submit" name="ExportToWorkBook" value="Export To WorkBook" style="width: 160; height: 25; font-family:Arial; font-weight:bold; color:#000000">
 	    </div>
             

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/percentageWiseDataStatusResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/percentageWiseDataStatusResult.vm	2011-12-14 10:18:12 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/percentageWiseDataStatusResult.vm	2013-09-19 06:34:31 +0000
@@ -40,7 +40,7 @@
 <form id="form1" name="form1" action="exportDataStatusToExcel.action" method="post" onsubmit="return exportDataStatusResultToWorkBook()" target="_newtab">
     <input type="hidden" name="htmlCode" id="htmlCode" />
 	    <div align="right" class="NormalB">
-	       <!-- <input type="checkbox" name="includeZeros" id="includeZeros" #if($includeZeros) checked #end /> Include Zero<br /> -->
+	       <!--   -->
 	        <input type="submit" name="ExportToWorkBook" value="Export To WorkBook" style="width: 160; height: 25; font-family:Arial; font-weight:bold; color:#000000">
 	    </div>
             

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/summaryMobileSatusResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/summaryMobileSatusResult.vm	2011-12-14 10:18:12 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/summaryMobileSatusResult.vm	2013-09-19 06:34:31 +0000
@@ -39,7 +39,7 @@
         <form id="form1" name="form1" action="exportDataStatusToExcel.action" method="post" onsubmit="return exportDataStatusResultToWorkBook()" target="_newtab">
             <input type="hidden" name="htmlCode" id="htmlCode" />
             <div align="right" class="NormalB">
-                <input type="checkbox" name="includeZeros" id="includeZeros" #if($includeZeros) checked #end /> Include Zero<br />
+
                 <input type="submit" name="ExportToWorkBook" value="Export To WorkBook" style="width: 160; height: 25; font-family:Arial; font-weight:bold; color:#000000">
             </div>
             

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/summarySatusResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/summarySatusResult.vm	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/summarySatusResult.vm	2014-07-07 11:07:16 +0000
@@ -20,8 +20,8 @@
                 	*/
  			   		
  			   		var url = "summaryStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType+"&includeZeros="+includeZeros;
-					$('#contentDataRecord').dialog('destroy').remove();
-			   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+					$('#contentDiv').dialog('destroy').remove();
+			   	    $('<div id="contentDiv">' ).load(url).dialog({
 			        title: 'Data Entry Status Result',
 					maximize: true, 
 					closable: true,
@@ -40,8 +40,8 @@
                 	*/
                 	
  			   		var url = "summaryStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType;
-					$('#contentDataRecord').dialog('destroy').remove();
-			   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+					$('#contentDiv').dialog('destroy').remove();
+			   	    $('<div id="contentDiv">' ).load(url).dialog({
 			        title: 'Data Entry Status Result',
 					maximize: true, 
 					closable: true,
@@ -69,7 +69,7 @@
         <form id="form1" name="form1" action="exportDataStatusToExcel.action" method="post" onsubmit="return exportDataStatusResultToWorkBook()" target="_newtab">
             <input type="hidden" name="htmlCode" id="htmlCode" />
             <div align="right" class="NormalB">
-                <input type="checkbox" name="includeZeros" id="includeZeros" #if($includeZeros) checked #end /> Include Zero<br />
+
                 <input type="submit" name="ExportToWorkBook" value="Export To WorkBook" style="width: 160; height: 25; font-family:Arial; font-weight:bold; color:#000000">
             </div>
             
@@ -109,7 +109,8 @@
                         <tr class="TableHeadingCellStyles">
                             #foreach( $levelName in $levelNames )
                                 #if( $count1 == $curOrgUnitLevel )
-                                    <td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')" target="_blank">$chiildorgUnit.name #if( $orgunitCount !=-1 ) ( $orgunitCount ) #end</a></td>
+                                    <!--<td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')" target="_blank">$chiildorgUnit.name #if( $orgunitCount !=-1 ) ( $orgunitCount ) #end</a></td>-->
+									<td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')">$chiildorgUnit.name #if( $orgunitCount !=-1 ) ( $orgunitCount ) #end</a></td>	
                                 #else
                                     <td>&nbsp;</td>
                                 #end

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/tabularAnalysisFront.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/tabularAnalysisFront.vm	2012-07-02 07:39:05 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/tabularAnalysisFront.vm	2013-12-13 07:09:00 +0000
@@ -27,6 +27,7 @@
     // Global Variables
     var dailyPeriodTypeName = '$dailyPeriodTypeName';
     var weeklyPeriodTypeName = '$weeklyPeriodTypeName';
+	var forteenPeriodTypeName = '$forteenPeriodTypeName';
     var monthlyPeriodTypeName = '$monthlyPeriodTypeName';
     var quarterlyPeriodTypeName = '$quarterlyPeriodTypeName';
     var sixmonthPeriodTypeName = '$sixMonthPeriodTypeName';
@@ -128,7 +129,7 @@
             </td>   
             <td class="NormalB">&nbsp;</td>
             <td class="NormalB">$i18n.getString( "compare_view" )<br>
-                <select id="deSelection" name="deSelection" style="width:350px" onchange="deSelectionChangeFuntion( 'availableDataElements', 'selectedServices' )">
+                <select id="deSelection" name="deSelection" style="width:450px" onchange="deSelectionChangeFuntion( 'availableDataElements', 'selectedServices' )">
                     <option value="dataelement" selected>DataElements</option>
                     <option value="optioncombo">Options in DataElements</option>
                 </select>
@@ -141,13 +142,13 @@
             <td class="NormalB">&nbsp;</td>
         </tr>
         <tr>
-     	    <td class="NormalB">$i18n.getString( "filter" ):&nbsp;<input type="text" id="availableDataElementsFilter" onkeyup="filterAvailableDataElements()" style="min-width:26em"></td>
+     	    <td class="NormalB">$i18n.getString( "filter" ):&nbsp;<input type="text" id="availableDataElementsFilter" onkeyup="filterAvailableDataElements()" style="width:400px"></td>
             <td class="NormalB">&nbsp;</td>
             <td class="NormalB">$i18n.getString( "ga_filter_by_degroup" ) &nbsp;<input type="checkbox" checked="true" id="chkDataGrp" onchange="checkedDataElementGroup()"/></td>
         </tr>                           
         <tr>
             <td class="NormalB">$i18n.getString( "ga_available_delist" )<br>
-                <select multiple size="5" id="availableDataElements" name="availableDataElements" style="width:350px; height:85px" ondblclick="moveSelectedById( 'availableDataElements', 'selectedServices' )">                    
+                <select multiple size="5" id="availableDataElements" name="availableDataElements" style="width:450px; height:85px" ondblclick="moveSelectedById( 'availableDataElements', 'selectedServices' )">                    
                     #foreach ( $element in $dataElements )
                         <option value="D:$element.id" title="$element.name">$element.name</option>                  
                     #end
@@ -163,7 +164,7 @@
                     <tr>
                         <td class="NormalB">
                             $i18n.getString( "ta_selected_servicelist" )<br />
-                            <select multiple id="selectedServices" name="selectedServices" style="width:350px; height:250px" ondblclick="moveSelectedServices( 'selectedServices', 'availableDataElements', 'availableIndicators' )">                           
+                            <select multiple id="selectedServices" name="selectedServices" style="width:450px; height:250px" ondblclick="moveSelectedServices( 'selectedServices', 'availableDataElements', 'availableIndicators' )">                           
                             </select>                           
                         </td>
                         <td>
@@ -182,7 +183,7 @@
 
         <tr>
             <td class="NormalB">$i18n.getString( "ga_filter_by_indicatorgroup" )<br>
-                <select id="indicatorGroupId" name="indicatorGroupId" style="width:350px" onchange="getIndicators()">
+                <select id="indicatorGroupId" name="indicatorGroupId" style="width:450px" onchange="getIndicators()">
                     <option value="0">[ Select IndicatorGroup / All ]</option>                    
                         #foreach ( $group in $indicatorGroups )
                             <option value="$group.id">$group.name</option>
@@ -192,13 +193,13 @@
             <td class="NormalB">&nbsp;</td>
         </tr>
         <tr>
-            <td class="NormalB"><br>$i18n.getString( "filter" ):&nbsp;<input type="text" id="availableIndicatorsFilter" onkeyup="filterAvailableIndicators()" style="min-width:26em"></td>
+            <td class="NormalB"><br>$i18n.getString( "filter" ):&nbsp;<input type="text" id="availableIndicatorsFilter" onkeyup="filterAvailableIndicators()" style="width:400px"></td>
             <td class="NormalB">&nbsp;</td>
         </tr>
                             
         <tr>
             <td class="NormalB">$i18n.getString( "ga_available_indicatorlist" )<br>
-                <select multiple size="5" id="availableIndicators" name="availableIndicators" style="width:350px; height:85px" ondblclick="moveSelectedById( 'availableIndicators', 'selectedServices' )">                  
+                <select multiple size="5" id="availableIndicators" name="availableIndicators" style="width:450px; height:85px" ondblclick="moveSelectedById( 'availableIndicators', 'selectedServices' )">                  
                     #foreach ( $indicator in $indicators )
                         <option value="I:$indicator.id">$indicator.name</option>
                     #end
@@ -220,7 +221,7 @@
                 <table>
                     <tr>
                         <td class="NormalB">
-                            <select name="orgUnitSelListCB" id="orgUnitSelListCB" style="width: 150px;" onchange="ouListSelection()" >
+                            <select name="orgUnitSelListCB" id="orgUnitSelListCB" style="width: 200px;" onchange="ouListSelection()" >
                                 <option value="orgUnitLevelRadio">OrgUnit Levels</option>
                                 <option value="orgUnitSelectedRadio">Selected</option>
                                 <option value="orgUnitGroupRadio">OrgUnitGroups</option>
@@ -228,9 +229,9 @@
                         </td>
                         <td class="NormalB">&nbsp;</td>  
                         <td class="NormalB">
-                            <select id="aggData" name="aggData" style="width:150px">
+                            <select id="aggData" name="aggData" style="width:200px">
                                 <option value="generateaggdata">$i18n.getString( "generate_agg_data" )</option>
-                                <option value="useexistingaggdata">$i18n.getString( "use_existing_agg_data" )</option>
+                                <!--<option value="useexistingaggdata">$i18n.getString( "use_existing_agg_data" )</option>-->
                                 <option value="usecaptureddata">$i18n.getString( "use_captured_data" )</option>
                             </select>
                         </td>
@@ -253,12 +254,12 @@
 -->
                     <tr>
                         <td class="NormalB">$i18n.getString( "ga_orgunit" )<br>
-                            <select name="orgUnitListCB" id="orgUnitListCB" multiple size="7" style="width: 150px;" ondblclick="remOUFunction()" disabled >
+                            <select name="orgUnitListCB" id="orgUnitListCB" multiple size="7" style="width: 200px;" ondblclick="remOUFunction()" disabled >
                             </select>                       
                         </td>
                         <td class="NormalB">&nbsp;</td>  
                         <td class="NormalB">OrgUnitGroups/Level<br>
-                            <select name="orgUnitLevelCB" id="orgUnitLevelCB" size="7" style="width: 150px;">
+                            <select name="orgUnitLevelCB" id="orgUnitLevelCB" size="7" style="width: 200px;">
                             </select>
                         </td>
                     </tr>
@@ -270,7 +271,7 @@
                     <tr>
                         <td class="NormalB">
                             PeriodType: <br>
-                            <select id="periodTypeLB" name="periodTypeLB" onchange="getPeriods()" style="width: 150px;">                                
+                            <select id="periodTypeLB" name="periodTypeLB" onchange="getPeriods()" style="width: 200px;">                                
                                 #foreach ( $periodType in $periodTypes )
                                     <option value="$periodType.name" #if($periodType.name==$monthlyPeriodTypeName) selected #end>$periodType.name</option>                              
                                 #end
@@ -285,7 +286,7 @@
                     <tr>
                         <td class="NormalB">
                             Year : <br>
-                            <select id="yearLB" name="yearLB" onchange="getWeeklyPeriod()"  size="5" multiple style="width: 150px;">                                                                                
+                            <select id="yearLB" name="yearLB" onchange="getWeeklyPeriod()"  onblur="getTempForteenPeriod()" size="5" multiple style="width: 200px;">                                                                                
                                 #foreach($periodName in $periodNameList)
                                     <option value="$periodName">$periodName</option>                                
                                 #end
@@ -294,7 +295,7 @@
                         <td>&nbsp;</td>
                         <td class="NormalB">
                             Period : <br>
-                            <select id="periodLB" name="periodLB" size="5" multiple style="width: 175px;">                              
+                            <select id="periodLB" name="periodLB" size="5" multiple style="width: 225px;">                              
                             </select>
                         </td>
                     </tr>
@@ -305,7 +306,7 @@
                     </tr>                                                                   
                     <tr>
                         <td>
-                            <input type="submit" id="ViewReport" name="ViewReport" value="$i18n.getString( 'ta_generatereport' )" style="width: 120; height: 25; font-family:Arial; font-weight:bold; color:#000000">
+                            <input type="submit" id="ViewReport" name="ViewReport" value="$i18n.getString( 'ta_generatereport' )" style="width: 200; height: 25; font-family:Arial; font-weight:bold; color:#000000">
                         </td>
                         <td>&nbsp;</td>
                         <td align="right">&nbsp;</td>

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/targetAnalysisFront.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/targetAnalysisFront.vm	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/targetAnalysisFront.vm	2013-09-19 06:34:31 +0000
@@ -16,6 +16,8 @@
 
 <!--<form id="targetAnalysisForm" name="targetAnalysisForm" action="generateChartDeTarget.action" method="post" onsubmit="return formValidationsForDeTarget()" target="chartWindow1">-->
 <form id="targetAnalysisForm" name="targetAnalysisForm">
+	<input type="hidden" id="hiddenChkValue" value="false"/>
+
 	<table align="center" style=" border-collapse: collapse; margin-top: 0;" cellpadding="0" cellspacing="0" width="100%" border=0>
   	    <tr>
 			<td class="NormalB">

=== modified file 'local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/validationSatusResult.vm'
--- local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/validationSatusResult.vm	2012-03-19 06:07:21 +0000
+++ local/in/dhis-web-dashboard/src/main/webapp/dhis-web-dashboard/validationSatusResult.vm	2014-07-07 11:25:19 +0000
@@ -13,8 +13,8 @@
         evt.target.href = "validationStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType;
     	*/
 		var url = "validationStatusResult.action?immChildOption="+immChildOption+"&dsId="+dsId+"&sDateLB="+startDate+"&eDateLB="+endDate+"&ouId="+selOrgUnit+"&selectedButton="+dsType;
-		$('#contentDataRecord').dialog('destroy').remove();
-   	    $('<div id="contentDataRecord">' ).load(url).dialog({
+		$('#contentDiv').dialog('destroy').remove();
+   	    $('<div id="contentDiv">' ).load(url).dialog({
         title: 'Data Entry Status Result',
 		maximize: true,
 		closable: true,
@@ -76,7 +76,8 @@
 	                <tr class="TableHeadingCellStyles" >
 	                    #foreach($levelName in $levelNames)
 	                    	#if($count1 == $curOrgUnitLevel)
-	                           <td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')" target="_blank">$chiildorgUnit.name</a></td>
+	                           <!--<td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')" target="_blank">$chiildorgUnit.name</a></td>-->
+							   <td><a href="#" onclick="javascript:getImmChildInfo(event, '$selDataSet.id', '$chiildorgUnit.id')">$chiildorgUnit.name</a></td>
 	  			            #else
 	                           <td>&nbsp;</td>
 	  			            #end

=== modified file 'local/in/dhis-web-dataentry-linelisting/pom.xml'
--- local/in/dhis-web-dataentry-linelisting/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-web-dataentry-linelisting/pom.xml	2014-07-05 07:36:03 +0000
@@ -1,20 +1,20 @@
 <project xmlns="http://maven.apache.org/POM/4.0.0"
-	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
-	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
-	<modelVersion>4.0.0</modelVersion>
-  
-	<parent>
-		<groupId>org.hisp.dhis</groupId>
-		<artifactId>dhis-web</artifactId>
-		<version>2.15-SNAPSHOT</version>
-	</parent>
-  
-  <artifactId>dhis-web-dataentry-national</artifactId>
+  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <modelVersion>4.0.0</modelVersion>
+  
+  <parent>
+    <groupId>org.hisp.dhis</groupId>
+    <artifactId>dhis-web</artifactId>
+    <version>2.15</version>
+  </parent>
+  
+  <artifactId>dhis-web-dataentry-linelisting-bihar</artifactId>
   <packaging>war</packaging>
-  <name>DHIS LineListing Data Entry</name>
+  <name>DHIS LineListing Data Entry Bihar</name>
   
   <build>
-    <finalName>dhis-web-dataentry-national</finalName>
+    <finalName>dhis-web-dataentry-linelisting-bihar</finalName>
   </build>
   
   <dependencies>

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/action/FormAction.java'
--- local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/action/FormAction.java	2012-03-19 06:11:45 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/action/FormAction.java	2014-07-05 07:45:07 +0000
@@ -362,7 +362,20 @@
         return llcoldchain;
     }
 
-    
+    private String llFamilyPlaning;
+    
+    public String getLlFamilyPlaning()
+    {
+        return llFamilyPlaning;
+    }
+    
+    private String llYuktiStatus;
+    
+    public String getLlYuktiStatus()
+    {
+        return llYuktiStatus;
+    }
+
     private int maxRecordNo;
     
     public int getMaxRecordNo()
@@ -513,7 +526,7 @@
         }
 
         Iterator<DataSet> it = dataSets.iterator();
-
+        
         while ( it.hasNext() )
         {
             DataSet temp = it.next();
@@ -525,7 +538,9 @@
                 temp.getName().equalsIgnoreCase( LLDataSets.LL_DEATHS )  || 
                 temp.getName().equalsIgnoreCase( LLDataSets.LL_MATERNAL_DEATHS ) || 
                 temp.getName().equalsIgnoreCase( LLDataSets.LL_UU_IDSP_EVENTS ) || 
-                temp.getName().equalsIgnoreCase( LLDataSets.LL_COLD_CHAIN ))
+                temp.getName().equalsIgnoreCase( LLDataSets.LL_COLD_CHAIN ) || 
+                temp.getName().equalsIgnoreCase( LLDataSets.LL_FAMILY_PLANING ) ||
+                temp.getName().equalsIgnoreCase( LLDataSets.LL_YUKTI_STATUS ) )
             {
                 if ( !( temp.getPeriodType() instanceof CalendarPeriodType ) )
                 {
@@ -537,7 +552,8 @@
                 it.remove();
             }
         }
-
+        //System.out.println(" DataSet Size : -- " + dataSets.size()  );
+        //System.out.println(" DataSet  : -- " + dataSets  );
         Collections.sort( dataSets, new IdentifiableObjectNameComparator() );
 
         // ---------------------------------------------------------------------
@@ -674,6 +690,8 @@
         lldidsp = LLDataSets.LL_DEATHS_IDSP;
         llidspl = LLDataSets.LL_IDSP_LAB;
         llcoldchain = LLDataSets.LL_COLD_CHAIN;
+        llFamilyPlaning = LLDataSets.LL_FAMILY_PLANING;
+        llYuktiStatus = LLDataSets.LL_YUKTI_STATUS;
         
         OrganisationUnit organisationUnit = selectedStateManager.getSelectedOrganisationUnit();
 
@@ -738,6 +756,13 @@
 
         Collection<LLDataValue> dataValues = dataValueService.getDataValues( organisationUnit, period, dataElements, defaultOptionCombo );
         
+        /*
+        for( LLDataValue dataValue : dataValues )
+        {
+            System.out.println(" DataElement id is: -- " + dataValue.getDataElement().getId()  +  " -- "  + dataValue.getValue() + " -- "  + dataValue.getRecordNo() );
+        }
+        */
+        
         dataValueMap = new HashMap<Integer, DataValue>( dataValues.size() );
         
         // ---------------------------------------------------------------------
@@ -803,12 +828,21 @@
         {
             prepareLLColdChainFormCode(organisationUnit, period, dataElements, dataValues);
         }
+        else if(selDSName.equalsIgnoreCase( llFamilyPlaning ))
+        {
+            prepareLLFamilyPlaningFormCode(organisationUnit, period, dataElements, dataValues);
+        }
+        else if(selDSName.equalsIgnoreCase( llYuktiStatus ))
+        {
+            prepareLLYuktiStatusFormCode(organisationUnit, period, dataElements, dataValues);
+        }        
         else
         {
             
         }
         
-        lockStatus = dataSetService.isLocked( dataSet, period, organisationUnit, null );
+        //lockStatus = dataSetService.isLocked( dataSet, period, organisationUnit, null );
+        lockStatus = dataSetService.isLocked( dataSet, period, organisationUnit, null, null );
         
         
         
@@ -839,12 +873,262 @@
             //}
         }
         
-        
-        
         maxRecordNo = dataValueService.getMaxRecordNo();
         
         return SUCCESS;
     }
+ 
+    // Supportive Methods
+    
+    // Supportive Methods for prepare Line Listing  Yukti Status Form Code
+    
+    private void prepareLLYuktiStatusFormCode( OrganisationUnit organisationUnit, Period period, Collection<DataElement> dataElements,
+        Collection<LLDataValue> dataValues)
+    {
+        lldataValueMap = new HashMap<String, List<LLDataValue>>();
+        
+        for ( LLDataValue dataValue : dataValues )
+        {
+            Integer recordNo = dataValue.getRecordNo();
+            List<LLDataValue> tempLLDVList;
+            if(lldataValueMap == null || lldataValueMap.isEmpty() || lldataValueMap.get(String.valueOf(recordNo)) == null || lldataValueMap.get(String.valueOf(recordNo)).isEmpty())
+            {
+                tempLLDVList = new ArrayList<LLDataValue>();
+            }
+            else
+            {
+                tempLLDVList = new ArrayList<LLDataValue>(lldataValueMap.get(String.valueOf(recordNo)));
+            }
+            
+            tempLLDVList.add( dataValue );
+            lldataValueMap.put( String.valueOf(recordNo), tempLLDVList );
+        }
+
+        Set<String> llDataValueMapKeys = lldataValueMap.keySet();
+        Iterator<String> it1 = llDataValueMapKeys.iterator();
+        while( it1.hasNext() )
+        {
+            String tempRecordNo = (String) it1.next();
+            List<LLDataValue> tempLLDVList1 = new ArrayList<LLDataValue>(lldataValueMap.get(tempRecordNo));
+            List<LLDataValue> tempLLDVList2 = new ArrayList<LLDataValue>();
+            LLDataValue existingLLDV = new LLDataValue();
+            
+            for(int i = 0; i<=7; i++)
+            {
+                LLDataValue tempLLDV1 = new LLDataValue();
+                tempLLDVList2.add(tempLLDV1);
+            }
+
+            Iterator<LLDataValue> it2 = tempLLDVList1.iterator();
+            while( it2.hasNext() )
+            {
+                LLDataValue tempLLDV = (LLDataValue) it2.next();
+                
+                if( tempLLDV.getDataElement().getId() == LLDataSets.LLYS_ACCREDITATION_ID )
+                {
+                    tempLLDVList2.set( 0, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }    
+                
+                else if( tempLLDV.getDataElement().getId() == LLDataSets.LLYS_SITE_NAME )
+                {
+                    tempLLDVList2.set( 1, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }    
+                else if(tempLLDV.getDataElement().getId() == LLDataSets.LLYS_CONTACT_NO )
+                {
+                    tempLLDVList2.set( 2, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+                else if(tempLLDV.getDataElement().getId() == LLDataSets.LLYS_MTP_PERFORMED )
+                {
+                    tempLLDVList2.set( 3, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+                else if( tempLLDV.getDataElement().getId() == LLDataSets.LLYS_ACCREDITED_CASE_PAID )
+                {
+                    tempLLDVList2.set( 4, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+                else if( tempLLDV.getDataElement().getId() == LLDataSets.LLYS_AMOUNT_PAID )
+                {
+                    tempLLDVList2.set( 5, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+                else if( tempLLDV.getDataElement().getId() == LLDataSets.LLYS_AMOUNT_DUE )
+                {
+                    tempLLDVList2.set( 6, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+                else if( tempLLDV.getDataElement().getId() == LLDataSets.LLYS_REMARK )
+                {
+                    tempLLDVList2.set( 7, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+            }
+
+            int llbDes[] = { LLDataSets.LLYS_ACCREDITATION_ID, LLDataSets.LLYS_SITE_NAME, LLDataSets.LLYS_CONTACT_NO, LLDataSets.LLYS_MTP_PERFORMED,
+                                LLDataSets.LLYS_ACCREDITED_CASE_PAID, LLDataSets.LLYS_AMOUNT_PAID,
+                                LLDataSets.LLYS_AMOUNT_DUE, LLDataSets.LLYS_REMARK  };
+            
+            for(int i = 0; i<=7; i++)
+            {
+                LLDataValue llDv = tempLLDVList2.get(i);
+                if(tempLLDVList2.get(i).getDataElement() == null || tempLLDVList2.get(i).getDataElement().getId() != llbDes[i])
+                {
+                    llDv.setPeriod(existingLLDV.getPeriod());
+                    llDv.setSource(existingLLDV.getSource());
+                    llDv.setDataElement(dataElementService.getDataElement(llbDes[i]));
+                    llDv.setRecordNo(existingLLDV.getRecordNo());
+                    llDv.setOptionCombo(existingLLDV.getOptionCombo());
+                    llDv.setValue(" ");
+                    
+                    tempLLDVList2.set(i, llDv);
+                 }                               
+            }
+
+            lldataValueMap.put( tempRecordNo, tempLLDVList2 );            
+        }
+     
+        recordNos = new ArrayList<String>(lldataValueMap.keySet());
+        Collections.sort( recordNos );
+    }
+
+    // Supportive Methods for prepare Line Listing  Family Planing Form Code
+    
+    private void prepareLLFamilyPlaningFormCode( OrganisationUnit organisationUnit, Period period, Collection<DataElement> dataElements,
+        Collection<LLDataValue> dataValues)
+    {
+        lldataValueMap = new HashMap<String, List<LLDataValue>>();
+        
+        for ( LLDataValue dataValue : dataValues )
+        {
+            Integer recordNo = dataValue.getRecordNo();
+            
+            //System.out.println(" DataElement id is: -- " + dataValue.getDataElement().getId()  +  " -- "  + dataValue.getValue() + " -- "  + dataValue.getRecordNo() );
+            
+            List<LLDataValue> tempLLDVList;
+            if(lldataValueMap == null || lldataValueMap.isEmpty() || lldataValueMap.get(String.valueOf(recordNo)) == null || lldataValueMap.get(String.valueOf(recordNo)).isEmpty())
+            {
+                tempLLDVList = new ArrayList<LLDataValue>();
+            }
+            else
+            {
+                tempLLDVList = new ArrayList<LLDataValue>(lldataValueMap.get(String.valueOf(recordNo)));
+            }
+            
+            tempLLDVList.add( dataValue );
+            lldataValueMap.put( String.valueOf(recordNo), tempLLDVList );
+        }
+
+        Set<String> llDataValueMapKeys = lldataValueMap.keySet();
+        Iterator<String> it1 = llDataValueMapKeys.iterator();
+        while( it1.hasNext() )
+        {
+            String tempRecordNo = (String) it1.next();
+            List<LLDataValue> tempLLDVList1 = new ArrayList<LLDataValue>(lldataValueMap.get(tempRecordNo));
+            List<LLDataValue> tempLLDVList2 = new ArrayList<LLDataValue>();
+            LLDataValue existingLLDV = new LLDataValue();
+            
+            for(int i = 0; i<=9; i++)
+            {
+                LLDataValue tempLLDV1 = new LLDataValue();
+                tempLLDVList2.add(tempLLDV1);
+            }
+
+            Iterator<LLDataValue> it2 = tempLLDVList1.iterator();
+            while( it2.hasNext() )
+            {
+                LLDataValue tempLLDV = (LLDataValue) it2.next();
+                
+                if( tempLLDV.getDataElement().getId() == LLDataSets.LLFP_ACCREDITATION_ID )
+                {
+                    //System.out.println(" DataElement id is: -- " + tempLLDV.getDataElement().getId()  +  " -- "  + LLDataSets.LLFP_ACCREDITATION_ID );
+                    tempLLDVList2.set( 0, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }    
+                
+                else if( tempLLDV.getDataElement().getId() == LLDataSets.LLFP_HOSPITAL_NAME )
+                {
+                    //System.out.println(" DataElement id is: -- " + tempLLDV.getDataElement().getId()  +  " -- "  + LLDataSets.LLFP_ACCREDITATION_ID );
+                    tempLLDVList2.set( 1, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }    
+                else if(tempLLDV.getDataElement().getId() == LLDataSets.LLFP_CONTACT_NO )
+                {
+                    tempLLDVList2.set( 2, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+                else if(tempLLDV.getDataElement().getId() == LLDataSets.LLFP_STERILISATION_FEMALE )
+                {
+                    tempLLDVList2.set( 3, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+                else if( tempLLDV.getDataElement().getId() == LLDataSets.LLFP_STERILISATION_MALE )
+                {
+                    tempLLDVList2.set( 4, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+                else if( tempLLDV.getDataElement().getId() == LLDataSets.LLFP_CASES_PAID_FEMALE )
+                {
+                    tempLLDVList2.set( 5, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+                else if( tempLLDV.getDataElement().getId() == LLDataSets.LLFP_CASES_PAID_MALE )
+                {
+                    tempLLDVList2.set( 6, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+                else if( tempLLDV.getDataElement().getId() == LLDataSets.LLFP_AMOUNT_PAID )
+                {
+                    tempLLDVList2.set( 7, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+                else if( tempLLDV.getDataElement().getId() == LLDataSets.LLFP_AMOUNT_DUE )
+                {
+                    tempLLDVList2.set( 8, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+                else if( tempLLDV.getDataElement().getId() == LLDataSets.LLFP_REMARK )
+                {
+                    tempLLDVList2.set( 9, tempLLDV );
+                    existingLLDV = tempLLDV;
+                }
+            }
+
+            int llbDes[] = { LLDataSets.LLFP_ACCREDITATION_ID, LLDataSets.LLFP_HOSPITAL_NAME, LLDataSets.LLFP_CONTACT_NO, LLDataSets.LLFP_STERILISATION_FEMALE,
+                                LLDataSets.LLFP_STERILISATION_MALE, LLDataSets.LLFP_CASES_PAID_FEMALE,LLDataSets.LLFP_CASES_PAID_MALE,
+                                LLDataSets.LLFP_AMOUNT_PAID, LLDataSets.LLFP_AMOUNT_DUE, LLDataSets.LLFP_REMARK  };
+            
+            for(int i = 0; i<=9; i++)
+            {
+                LLDataValue llDv = tempLLDVList2.get(i);
+                if(tempLLDVList2.get(i).getDataElement() == null || tempLLDVList2.get(i).getDataElement().getId() != llbDes[i])
+                {
+                    //System.out.println( " -- "  + llbDes[i] );
+                    //System.out.println(" DataElement id is: -- " + tempLLDVList2.get(i).getDataElement().getId()  +  " -- "  + llbDes[i] );
+                    llDv.setPeriod(existingLLDV.getPeriod());
+                    llDv.setSource(existingLLDV.getSource());
+                    llDv.setDataElement(dataElementService.getDataElement(llbDes[i]));
+                    llDv.setRecordNo(existingLLDV.getRecordNo());
+                    llDv.setOptionCombo(existingLLDV.getOptionCombo());
+                    llDv.setValue(" ");
+                    
+                    tempLLDVList2.set(i, llDv);
+                 }                               
+            }
+
+            lldataValueMap.put( tempRecordNo, tempLLDVList2 );            
+        }
+     
+        recordNos = new ArrayList<String>(lldataValueMap.keySet());
+        Collections.sort( recordNos );
+    }
+
+    
+    
+    
+    
     
     
     private void prepareLLColdChainFormCode( OrganisationUnit organisationUnit, Period period, Collection<DataElement> dataElements,
@@ -1049,6 +1333,7 @@
                         {
                                 llDv.setPeriod(existingLLDV.getPeriod());
                                 llDv.setSource(existingLLDV.getSource());
+
                                 llDv.setDataElement(dataElementService.getDataElement(llbDes[i]));
                                 llDv.setRecordNo(existingLLDV.getRecordNo());
                                 llDv.setOptionCombo(existingLLDV.getOptionCombo());

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/action/RemoveLLRecordAction.java'
--- local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/action/RemoveLLRecordAction.java	2011-10-13 09:13:08 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/action/RemoveLLRecordAction.java	2013-09-19 06:34:31 +0000
@@ -33,7 +33,7 @@
 
     public String execute() throws Exception
     {
-        System.out.println("Inside remove ll record action");
+        //System.out.println("Inside remove ll record action");
         
         lldataValueService.removeLLRecord( recordId );
 

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/action/SaveLineListingAggData.java'
--- local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/action/SaveLineListingAggData.java	2011-04-27 17:15:13 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/action/SaveLineListingAggData.java	2014-07-05 07:44:45 +0000
@@ -212,14 +212,16 @@
         }
         else
         {
-            DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, period, optionCombo );
+            //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, period, optionCombo );
+            DataValue dataValue = dataValueService.getDataValue( dataElement, period, organisationUnit, optionCombo );
+            
             if ( dataValue == null )
             {
                 if ( value != null )
                 {
-                    dataValue = new DataValue( dataElement, period, organisationUnit, value, storedBy, new Date(),
-                        null, optionCombo );
-
+                    //dataValue = new DataValue( dataElement, period, organisationUnit, value, storedBy, new Date(), null, optionCombo );
+                    dataValue = new DataValue( dataElement, period, organisationUnit,optionCombo,null , value, storedBy, new Date(), null  );
+                    
                     dataValueService.addDataValue( dataValue );
                     llValueMap.put( dataElement.getId(), value );
                     liDEMap.put( dataElement.getId(), optionCombo.getId() );

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/api/LLDataSets.java'
--- local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/api/LLDataSets.java	2012-06-30 08:05:32 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/api/LLDataSets.java	2013-09-19 06:34:31 +0000
@@ -37,7 +37,60 @@
     public static final String LL_DEATHS_IDSP = "Line listing Deaths IDSP";
     public static final String LL_IDSP_LAB = "Line Listing IDSP Lab";
     public static final String LL_COLD_CHAIN = "Line listing Cold Chain";
-
+    
+    public static final String LL_FAMILY_PLANING = "Line listing Family Planing";
+    public static final String LL_YUKTI_STATUS = "Line listing Yukti Status";
+
+    //----------------------------------------------------------------
+    // LineListing Family Planing Data Element for Bihar
+    //----------------------------------------------------------------
+    
+    
+
+    // 7271 : LLFP- Name of the Hospital 7271
+    public static final int LLFP_HOSPITAL_NAME = 7271;
+    // 7272 :  LLFP- Contact No 7272
+    public static final int LLFP_CONTACT_NO = 7272;
+    // 7273 :  LLFP- Sterilisation done for Female 7273
+    public static final int LLFP_STERILISATION_FEMALE = 7273;
+    // 7274 :  LLFP- Sterilisation done for Male 7274
+    public static final int LLFP_STERILISATION_MALE = 7274;
+    // 7275 :  LLFP- No of Cases Paid for Female 7275
+    public static final int LLFP_CASES_PAID_FEMALE = 7275;
+    // 7276 :  LLFP- No of Cases Paid for Male 7276
+    public static final int LLFP_CASES_PAID_MALE = 7276;
+    // 7277 :  LLFP- Amount Paid 7277
+    public static final int LLFP_AMOUNT_PAID = 7277;
+    // 7278 :  LLFP- Amount Due 7278
+    public static final int LLFP_AMOUNT_DUE = 7278;
+    // 7279 :  LLFP- Remark 7279
+    public static final int LLFP_REMARK = 7279;
+    // 7287 : LLFP- Name of the Hospital 7314
+    public static final int LLFP_ACCREDITATION_ID = 7314;
+    
+    //----------------------------------------------------------------
+    // LineListing Yukti status ata Element for Bihar
+    //----------------------------------------------------------------
+    
+    
+    
+    // 7280 : LLYS- Name of the Site 7280
+    public static final int LLYS_SITE_NAME = 7280;
+    // 7281 :  LLYS- Contact No 7281
+    public static final int LLYS_CONTACT_NO = 7281;
+    // 7282 :  LLYS- No of MTPs Performed 7282
+    public static final int LLYS_MTP_PERFORMED = 7282;
+    // 7283 :  LLYS- No of Accredited Cases Paid 7283
+    public static final int LLYS_ACCREDITED_CASE_PAID = 7283;
+    // 7284 :  LLYS- Amount Paid 7284
+    public static final int LLYS_AMOUNT_PAID = 7284;
+    // 7285 :  LLYS- Amount Due 7285
+    public static final int LLYS_AMOUNT_DUE = 7285;
+    // 7286 :  LLYS- Remark 7286
+    public static final int LLYS_REMARK = 7286;
+    // 7288 : LLFP- Name of the Hospital 7315
+    public static final int LLYS_ACCREDITATION_ID = 7315;
+    
     //----------------------------------------------------------------
     // LineListing Cold Chain
     //----------------------------------------------------------------
@@ -302,12 +355,216 @@
     // 1249 : Others 1 month to 1 year
     public static final int LLD_CAUSE_DE83 = 1249;
     // 1250 : Not known 1 month to 1 year
-    public static final int LLD_CAUSE_DE84 = 1250;   
+    public static final int LLD_CAUSE_DE84 = 1250;
+    
+    
+    
+    
+    
+    //for Haryana application cause of death
+    
+    //Pneumonia below 1 day
+    public static final int LLD_CAUSE_DE85 = 6050;
+    //Pneumonia  1 day to 1 week
+    public static final int LLD_CAUSE_DE86 = 6051;
+    //Pneumonia  1 week to 1 month
+    public static final int LLD_CAUSE_DE87 = 6052;
+    
+    
+    //Pneumonia  1 month to 1 year
+        //public static final int LLD_CAUSE_DE88 = 0;
+    //Pneumonia  1 year to 5 year
+        //public static final int LLD_CAUSE_DE89 = 0;
+    
+    
+    
+    //Fever related below 1 day
+    public static final int LLD_CAUSE_DE90 = 6053;
+    //Fever related 1 day to 1 week
+    public static final int LLD_CAUSE_DE91 = 6054;
+    //Fever related 1 week to 1 month
+    public static final int LLD_CAUSE_DE92 = 6055;
+    
+    //Fever related 1 month to 1 year
+        //public static final int LLD_CAUSE_DE93 = 0;
+    //Fever related 1 year to 5 year
+        //public static final int LLD_CAUSE_DE94 = 0;
+    
+    //Meconium aspiration syndrome below 1 day
+    public static final int LLD_CAUSE_DE95 = 6056;
+    //Meconium aspiration syndrome 1 day to 1 week
+    public static final int LLD_CAUSE_DE96 = 6057;
+    //Meconium aspiration syndrome 1 week to 1 month
+    public static final int LLD_CAUSE_DE97 = 6058;
+    //Meconium aspiration syndrome 1 month to 1 year
+    public static final int LLD_CAUSE_DE98 = 6059;
+    //Meconium aspiration syndrome 1 year to 5 year
+    public static final int LLD_CAUSE_DE99 = 6060;
+    
+    
+    //Meningitis below 1 day
+    public static final int LLD_CAUSE_DE100 = 6061;
+    //Meningitis 1 day to 1 week
+    public static final int LLD_CAUSE_DE101 = 6062;
+    //Meningitis 1 week to 1 month
+    public static final int LLD_CAUSE_DE102 = 6063;
+    //Meningitis 1 month to 1 year
+    public static final int LLD_CAUSE_DE103 = 6064;
+    //Meningitis 1 year to 5 year
+    public static final int LLD_CAUSE_DE104 = 6065;
+    
+    
+    //Major Congenital Malformation below 1 day
+    public static final int LLD_CAUSE_DE105 = 6066;
+    //Major Congenital Malformation 1 day to 1 week
+    public static final int LLD_CAUSE_DE106 = 6067;
+    //Major Congenital Malformation 1 week to 1 month
+    public static final int LLD_CAUSE_DE107 = 6068;
+    //Major Congenital Malformation 1 month to 1 year
+    public static final int LLD_CAUSE_DE108 = 6069;
+    //Major Congenital Malformation 1 year to 5 year
+    public static final int LLD_CAUSE_DE109 = 6070;
+    
+    
+    
+    // Prematurity below 1 day
+    public static final int LLD_CAUSE_DE110 = 6071;
+    //Prematurity 1 day to 1 week
+    public static final int LLD_CAUSE_DE111 = 6072;
+    //Prematurity 1 week to 1 month
+    public static final int LLD_CAUSE_DE112 = 6073;
+    //Prematurity1 month to 1 year
+    public static final int LLD_CAUSE_DE113 = 6074;
+    //Prematurity 1 year to 5 year
+    public static final int LLD_CAUSE_DE114 = 6075;
+    
+    
+    
+    //Hypothermia below 1 day
+    public static final int LLD_CAUSE_DE115 = 6076;
+    //Hypothermia 1 day to 1 week
+    public static final int LLD_CAUSE_DE116 = 6077;
+    //Hypothermia 1 week to 1 month
+    public static final int LLD_CAUSE_DE117 = 6078;
+    //Hypothermia 1 month to 1 year
+    public static final int LLD_CAUSE_DE118 = 6079;
+    //Hypothermia 1 year to 5 year
+    public static final int LLD_CAUSE_DE119 = 6080;
+    
+   
+    //Diptheria below 1 day
+    public static final int LLD_CAUSE_DE120 = 6081;
+    //Diptheria 1 day to 1 week
+    public static final int LLD_CAUSE_DE121 = 6082;
+    //Diptheria 1 week to 1 month
+    public static final int LLD_CAUSE_DE122 = 6083;
+    //Diptheria 1 month to 1 year
+    public static final int LLD_CAUSE_DE123 = 6084;
+    //Diptheria 1 year to 5 year
+    public static final int LLD_CAUSE_DE124 = 6085;
+    
+    
+    //Childhood Tuberculosis below 1 day
+    public static final int LLD_CAUSE_DE125 = 6086;
+    //Childhood Tuberculosis 1 day to 1 week
+    public static final int LLD_CAUSE_DE126 = 6087;
+    //Childhood Tuberculosis 1 week to 1 month
+    public static final int LLD_CAUSE_DE127 = 6088;
+    //Childhood Tuberculosis 1 month to 1 year
+    public static final int LLD_CAUSE_DE128 = 6089;
+    //Childhood Tuberculosis 1 year to 5 year
+    public static final int LLD_CAUSE_DE129 = 6090;
+    
+    
+    //Dysentry below 1 day
+    public static final int LLD_CAUSE_DE130 = 6091;
+    //Dysentry 1 day to 1 week
+    public static final int LLD_CAUSE_DE131 = 6092;
+    //Dysentry 1 week to 1 month
+    public static final int LLD_CAUSE_DE132 = 6093;
+    //Dysentry 1 month to 1 year
+    public static final int LLD_CAUSE_DE133 = 6094;
+    //Dysentry 1 year to 5 year
+    public static final int LLD_CAUSE_DE134 = 6095;
+    
+    
+    //Pertusis below 1 day
+    public static final int LLD_CAUSE_DE135 = 6096;
+    //Pertusis 1 day to 1 week
+    public static final int LLD_CAUSE_DE136 = 6097;
+    //Pertusis 1 week to 1 month
+    public static final int LLD_CAUSE_DE137 = 6098;
+    //Pertusis 1 month to 1 year
+    public static final int LLD_CAUSE_DE138 = 6099;
+    //Pertusis 1 year to 5 year
+    public static final int LLD_CAUSE_DE139 = 6100;
+    
+    
+    //Polio below 1 day
+    public static final int LLD_CAUSE_DE140 = 6101;
+    //Polio 1 day to 1 week
+    public static final int LLD_CAUSE_DE141 = 6102;
+    //Polio 1 week to 1 month
+    public static final int LLD_CAUSE_DE142 = 6103;
+    //Polio 1 month to 1 year
+    public static final int LLD_CAUSE_DE143 = 6104;
+    //Polio 1 year to 5 year
+    public static final int LLD_CAUSE_DE144 = 6105;
+    
+    
+    //Tetanus Neonatorum below 1 day
+    public static final int LLD_CAUSE_DE145 = 6106;
+    //Tetanus Neonatorum 1 day to 1 week
+    public static final int LLD_CAUSE_DE146 = 6107;
+    //Tetanus Neonatorum 1 week to 1 month
+    public static final int LLD_CAUSE_DE147 = 6108;
+    //Tetanus Neonatorum 1 month to 1 year
+    public static final int LLD_CAUSE_DE148 = 6109;
+    //Tetanus Neonatorum 1 year to 5 year
+    public static final int LLD_CAUSE_DE149 = 6110;
+    
+    
+    //Tetanus (Others) below 1 day
+    public static final int LLD_CAUSE_DE150 = 6111;
+    //Tetanus (Others) 1 day to 1 week
+    public static final int LLD_CAUSE_DE151 = 6112;
+    //Tetanus (Others) 1 week to 1 month
+    public static final int LLD_CAUSE_DE152 = 6113;
+    //Tetanus (Others) 1 month to 1 year
+    public static final int LLD_CAUSE_DE153 = 6114;
+    //Tetanus (Others) 1 year to 5 year
+    public static final int LLD_CAUSE_DE154 = 6115;
+    
+    
+    //Acute Flaccide paralysis below 1 day
+    public static final int LLD_CAUSE_DE155 = 6116;
+    //Acute Flaccide paralysis 1 day to 1 week
+    public static final int LLD_CAUSE_DE156 = 6117;
+    //Acute Flaccide paralysis 1 week to 1 month
+    public static final int LLD_CAUSE_DE157 = 6118;
+    //Acute Flaccide paralysis 1 month to 1 year
+    public static final int LLD_CAUSE_DE158 = 6119;
+    //Acute Flaccide paralysis 1 year to 5 year
+    public static final int LLD_CAUSE_DE159 = 6120;
+    
+    
+    //Respiratory Infections (other than TB) below 1 day
+    public static final int LLD_CAUSE_DE160 = 6121;
+    //Respiratory Infections (other than TB) 1 day to 1 week
+    public static final int LLD_CAUSE_DE161 = 6122;
+    //Respiratory Infections (other than TB) 1 week to 1 month
+    public static final int LLD_CAUSE_DE162 = 6123;
+    //Respiratory Infections (other than TB) 1 month to 1 year
+    public static final int LLD_CAUSE_DE163 = 6124;
+    //Respiratory Infections (other than TB) 1 year to 5 year
+    public static final int LLD_CAUSE_DE164 = 6125;
+    
+    
+    
     
     public static final int LLD_OPTIONCOMBO_DEFAULT = 1;
     public static final int LLD_CAUSE_OPTIONCOMBO_MALE = 8;
     public static final int LLD_CAUSE_OPTIONCOMBO_FEMALE = 7;
-       
     public static final String LLD_ASPHYXIA = "ASPHYXIA";
     public static final String LLD_SEPSIS = "SEPSIS";
     public static final String LLD_LOW_BIRTH_WEIGH = "LOWBIRTHWEIGH";   
@@ -331,7 +588,47 @@
     public static final String LLD_OKCD = "OKCD";
     public static final String LLD_OTHERS = "OTHERS";                                          
     public static final String LLD_NOT_KNOWN = "NK";
-       
+    
+    // for haryana application
+    
+    
+    // Respiratory Infections (other than TB)
+    public static final String LLD_RI_OTHER_THAN_TB = "RIOTHERTB";
+    // Fever related
+    public static final String LLD_FR = "FEVERRELATED"; 
+    // Meconium aspiration syndrome
+    public static final String LLD_MAS = "MAS";
+    // Meningitis
+    public static final String LLD_MENINGITIS = "MENINGITIS";
+    // Major Congenital Malformation
+    public static final String LLD_MCM = "MCM";
+    // Prematurity
+    public static final String LLD_PREMATURITY = "PREMATURITY";
+    // Hypothermia
+    public static final String LLD_HYPOTHERMIA = "HYPOTHERMIA";
+    // Diptheria
+    public static final String LLD_DIPTHERIA = "DIPTHERIA";
+    // Childhood Tuberculosis
+    public static final String LLD_CHILD_TUBERCULOSIS = "CHILDTUBERCULOSIS";
+    //Dysentry
+    public static final String LLD_DYSENTRY = "DYSENTRY";
+    // Pertusis
+    public static final String LLD_PERTUSIS = "PERTUSIS";
+    // Polio
+    public static final String LLD_POLIO = "POLIO";
+    // Tetanus Neonatorum
+    public static final String LLD_TETANUS_NEONATORUM = "TETANUSNEONATORUM";
+    // Tetanus (Others)
+    public static final String LLD_TETANUS_OTHERS = "TETANUSOTHERS";
+    //Acute Flaccide paralysis
+    public static final String LLD_AFP = "AFP";
+   
+    
+    
+    
+    
+    
+    
     //-------------------------------------------------------------------
     // Line listing Maternal Death
     //-------------------------------------------------------------------
@@ -361,7 +658,8 @@
     public static final int LLMD_AT_PHC = 535;
     public static final int LLMD_AT_CHC = 536;
     public static final int LLMD_AT_MC = 537;
-    public static final int LLMD_AT_PVTINST = 5726; // This data element should be created for state specific for line listing maternal death delivery at PVT INST
+    public static final int LLMD_AT_PVTINST = 5726; // This data element should be created for state specific for line listing maternal death delivery at PVT INST for Punjab Application
+    
     
     public static final int LLMD_BY_UNTRAINED = 538;
     public static final int LLMD_BY_TRAINED = 539;
@@ -378,5 +676,17 @@
     public static final int LLMD_CAUSE_HFBD = 549;
     public static final int LLMD_CAUSE_HFAD = 550;
     public static final int LLMD_CAUSE_NK = 551;
-    public static final int LLMD_CAUSE_MDNK = 5725;// This dataelement should be created for state specific for linelisting maternal death Other Causes (including cause not known)
+    //public static final int LLMD_CAUSE_MDNK = 5725;// This data element should be created for state specific for line listing maternal death Other Causes (including cause not known) for Punjab Application
+    public static final int LLMD_CAUSE_MDNK = 5938;// This data element should be created for state specific for line listing maternal death Other Causes (including cause not known) for Orissa Application
+
+    // for haryana application
+    // Anaemia as cause of Direct/Associated with other Medical Disease
+    public static final int LLMD_CAUSE_ANAEMIA = 6043;
+    // Severe Anaemia (<7gm)
+    public static final int LLMD_CAUSE_SEVERE_ANAEMIA = 6044; 
+    // Moderate Anaemia (>7gm <11gm)
+    public static final int LLMD_CAUSE_MODERATE_ANAEMIA = 6045;
+
+
+
 }

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/autoagg/action/AutoLLDataAggregationAction.java'
--- local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/autoagg/action/AutoLLDataAggregationAction.java	2012-06-30 08:05:32 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/autoagg/action/AutoLLDataAggregationAction.java	2014-07-05 07:44:09 +0000
@@ -167,9 +167,9 @@
         
         List<DataSet> llDataSets = new ArrayList<DataSet>();
         
-        llDataSets.add( dataSetService.getDataSetByName( LLDataSets.LL_BIRTHS ) );
-        llDataSets.add( dataSetService.getDataSetByName( LLDataSets.LL_DEATHS ) );
-        llDataSets.add( dataSetService.getDataSetByName( LLDataSets.LL_MATERNAL_DEATHS ) );
+        llDataSets.addAll( dataSetService.getDataSetByName( LLDataSets.LL_BIRTHS ) );
+        llDataSets.addAll( dataSetService.getDataSetByName( LLDataSets.LL_DEATHS ) );
+        llDataSets.addAll( dataSetService.getDataSetByName( LLDataSets.LL_MATERNAL_DEATHS ) );
         
         System.out.println( "Aggregation Start Time is : \t" + new Date() );
         
@@ -290,14 +290,17 @@
         }
         else
         {
-            DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, period, optionCombo );
+            //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, period, optionCombo );
+            DataValue dataValue = dataValueService.getDataValue( dataElement, period, organisationUnit, optionCombo );
+            
             if ( dataValue == null )
             {
                 if ( value != null )
                 {
-                    dataValue = new DataValue( dataElement, period, organisationUnit, value, storedBy, new Date(),
-                        null, optionCombo );
-
+                    //dataValue = new DataValue( dataElement, period, organisationUnit, value, storedBy, new Date(), null, optionCombo );
+                    
+                    dataValue = new DataValue( dataElement, period, organisationUnit,optionCombo,null , value, storedBy, new Date(), null  );
+                    
                     dataValueService.addDataValue( dataValue );
                     //llValueMap.put( dataElement.getId(), value );
                     //liDEMap.put( dataElement.getId(), optionCombo.getId() );

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/history/DefaultHistoryRetriever.java'
--- local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/history/DefaultHistoryRetriever.java	2010-06-15 11:26:37 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/history/DefaultHistoryRetriever.java	2014-07-05 07:43:20 +0000
@@ -316,7 +316,8 @@
     private Double getValue( DataElement dataElement, DataElementCategoryOptionCombo optionCombo, OrganisationUnit organisationUnit, Period period )
         throws HistoryRetrieverException
     {
-        DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, period, optionCombo );
+        //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, period, optionCombo );
+        DataValue dataValue = dataValueService.getDataValue( dataElement, period, organisationUnit, optionCombo );
 
         if ( dataValue != null )
         {

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/impl/HibernateLLDataValueStore.java'
--- local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/impl/HibernateLLDataValueStore.java	2012-06-30 08:05:32 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/impl/HibernateLLDataValueStore.java	2013-09-19 06:34:31 +0000
@@ -776,7 +776,133 @@
             LLDataSets.LLD_CAUSE_DE77, LLDataSets.LLD_CAUSE_DE78, LLDataSets.LLD_CAUSE_DE78, LLDataSets.LLD_CAUSE_DE79,
             LLDataSets.LLD_CAUSE_DE79, LLDataSets.LLD_CAUSE_DE80, LLDataSets.LLD_CAUSE_DE80, LLDataSets.LLD_CAUSE_DE81,
             LLDataSets.LLD_CAUSE_DE81, LLDataSets.LLD_CAUSE_DE82, LLDataSets.LLD_CAUSE_DE82, LLDataSets.LLD_CAUSE_DE83,
-            LLDataSets.LLD_CAUSE_DE83, LLDataSets.LLD_CAUSE_DE84, LLDataSets.LLD_CAUSE_DE84, };
+            LLDataSets.LLD_CAUSE_DE83, LLDataSets.LLD_CAUSE_DE84, LLDataSets.LLD_CAUSE_DE84,
+            
+            
+            //for haryana
+            
+            
+            //Pneumonia
+            LLDataSets.LLD_CAUSE_DE85, LLDataSets.LLD_CAUSE_DE85,
+            LLDataSets.LLD_CAUSE_DE86, LLDataSets.LLD_CAUSE_DE86,
+            LLDataSets.LLD_CAUSE_DE87, LLDataSets.LLD_CAUSE_DE87,
+            //LLDataSets.LLD_CAUSE_DE88, LLDataSets.LLD_CAUSE_DE88,
+            //LLDataSets.LLD_CAUSE_DE89, LLDataSets.LLD_CAUSE_DE89,
+            
+            //Fever related
+            LLDataSets.LLD_CAUSE_DE90, LLDataSets.LLD_CAUSE_DE90,
+            LLDataSets.LLD_CAUSE_DE91, LLDataSets.LLD_CAUSE_DE91,
+            LLDataSets.LLD_CAUSE_DE92, LLDataSets.LLD_CAUSE_DE92,
+            //LLDataSets.LLD_CAUSE_DE93, LLDataSets.LLD_CAUSE_DE93,
+            //LLDataSets.LLD_CAUSE_DE94, LLDataSets.LLD_CAUSE_DE94,
+        
+            //Meconium aspiration syndrome
+            LLDataSets.LLD_CAUSE_DE95, LLDataSets.LLD_CAUSE_DE95,
+            LLDataSets.LLD_CAUSE_DE96, LLDataSets.LLD_CAUSE_DE96,
+            LLDataSets.LLD_CAUSE_DE97, LLDataSets.LLD_CAUSE_DE97,
+            LLDataSets.LLD_CAUSE_DE98, LLDataSets.LLD_CAUSE_DE98,
+            LLDataSets.LLD_CAUSE_DE99, LLDataSets.LLD_CAUSE_DE99,
+            
+            
+            //Meningitis
+            LLDataSets.LLD_CAUSE_DE100, LLDataSets.LLD_CAUSE_DE100,
+            LLDataSets.LLD_CAUSE_DE101, LLDataSets.LLD_CAUSE_DE101,
+            LLDataSets.LLD_CAUSE_DE102, LLDataSets.LLD_CAUSE_DE102,
+            LLDataSets.LLD_CAUSE_DE103, LLDataSets.LLD_CAUSE_DE103,
+            LLDataSets.LLD_CAUSE_DE104, LLDataSets.LLD_CAUSE_DE104,
+            
+            
+            //Major Congenital Malformation
+            LLDataSets.LLD_CAUSE_DE105, LLDataSets.LLD_CAUSE_DE105,
+            LLDataSets.LLD_CAUSE_DE106, LLDataSets.LLD_CAUSE_DE106,
+            LLDataSets.LLD_CAUSE_DE107, LLDataSets.LLD_CAUSE_DE107,
+            LLDataSets.LLD_CAUSE_DE108, LLDataSets.LLD_CAUSE_DE108,
+            LLDataSets.LLD_CAUSE_DE109, LLDataSets.LLD_CAUSE_DE109,
+            
+            //Prematurity
+            LLDataSets.LLD_CAUSE_DE110, LLDataSets.LLD_CAUSE_DE110,
+            LLDataSets.LLD_CAUSE_DE111, LLDataSets.LLD_CAUSE_DE111,
+            LLDataSets.LLD_CAUSE_DE112, LLDataSets.LLD_CAUSE_DE112,
+            LLDataSets.LLD_CAUSE_DE113, LLDataSets.LLD_CAUSE_DE113,
+            LLDataSets.LLD_CAUSE_DE114, LLDataSets.LLD_CAUSE_DE114,
+        
+            //Hypothermia
+            LLDataSets.LLD_CAUSE_DE115, LLDataSets.LLD_CAUSE_DE115,
+            LLDataSets.LLD_CAUSE_DE116, LLDataSets.LLD_CAUSE_DE116,
+            LLDataSets.LLD_CAUSE_DE117, LLDataSets.LLD_CAUSE_DE117,
+            LLDataSets.LLD_CAUSE_DE118, LLDataSets.LLD_CAUSE_DE118,
+            LLDataSets.LLD_CAUSE_DE119, LLDataSets.LLD_CAUSE_DE119,
+            
+            //Diptheria
+            LLDataSets.LLD_CAUSE_DE120, LLDataSets.LLD_CAUSE_DE120,
+            LLDataSets.LLD_CAUSE_DE121, LLDataSets.LLD_CAUSE_DE121,
+            LLDataSets.LLD_CAUSE_DE122, LLDataSets.LLD_CAUSE_DE122,
+            LLDataSets.LLD_CAUSE_DE123, LLDataSets.LLD_CAUSE_DE123,
+            LLDataSets.LLD_CAUSE_DE124, LLDataSets.LLD_CAUSE_DE124,
+            
+            //Childhood Tuberculosis
+            LLDataSets.LLD_CAUSE_DE125, LLDataSets.LLD_CAUSE_DE125,
+            LLDataSets.LLD_CAUSE_DE126, LLDataSets.LLD_CAUSE_DE126,
+            LLDataSets.LLD_CAUSE_DE127, LLDataSets.LLD_CAUSE_DE127,
+            LLDataSets.LLD_CAUSE_DE128, LLDataSets.LLD_CAUSE_DE128,
+            LLDataSets.LLD_CAUSE_DE129, LLDataSets.LLD_CAUSE_DE129,
+            
+            
+            //Dysentry
+            LLDataSets.LLD_CAUSE_DE130, LLDataSets.LLD_CAUSE_DE130,
+            LLDataSets.LLD_CAUSE_DE131, LLDataSets.LLD_CAUSE_DE131,
+            LLDataSets.LLD_CAUSE_DE132, LLDataSets.LLD_CAUSE_DE132,
+            LLDataSets.LLD_CAUSE_DE133, LLDataSets.LLD_CAUSE_DE133,
+            LLDataSets.LLD_CAUSE_DE134, LLDataSets.LLD_CAUSE_DE134,
+            
+            //Pertusis
+            LLDataSets.LLD_CAUSE_DE135, LLDataSets.LLD_CAUSE_DE135,
+            LLDataSets.LLD_CAUSE_DE136, LLDataSets.LLD_CAUSE_DE136,
+            LLDataSets.LLD_CAUSE_DE137, LLDataSets.LLD_CAUSE_DE137,
+            LLDataSets.LLD_CAUSE_DE138, LLDataSets.LLD_CAUSE_DE138,
+            LLDataSets.LLD_CAUSE_DE139, LLDataSets.LLD_CAUSE_DE139,
+            
+            //Polio
+            LLDataSets.LLD_CAUSE_DE140, LLDataSets.LLD_CAUSE_DE140,
+            LLDataSets.LLD_CAUSE_DE141, LLDataSets.LLD_CAUSE_DE141,
+            LLDataSets.LLD_CAUSE_DE142, LLDataSets.LLD_CAUSE_DE142,
+            LLDataSets.LLD_CAUSE_DE143, LLDataSets.LLD_CAUSE_DE143,
+            LLDataSets.LLD_CAUSE_DE144, LLDataSets.LLD_CAUSE_DE144,
+            
+            //Tetanus Neonatorum
+            LLDataSets.LLD_CAUSE_DE145, LLDataSets.LLD_CAUSE_DE145,
+            LLDataSets.LLD_CAUSE_DE146, LLDataSets.LLD_CAUSE_DE146,
+            LLDataSets.LLD_CAUSE_DE147, LLDataSets.LLD_CAUSE_DE147,
+            LLDataSets.LLD_CAUSE_DE148, LLDataSets.LLD_CAUSE_DE148,
+            LLDataSets.LLD_CAUSE_DE149, LLDataSets.LLD_CAUSE_DE149,
+            
+            //Tetanus (Others)
+            LLDataSets.LLD_CAUSE_DE150, LLDataSets.LLD_CAUSE_DE150,
+            LLDataSets.LLD_CAUSE_DE151, LLDataSets.LLD_CAUSE_DE151,
+            LLDataSets.LLD_CAUSE_DE152, LLDataSets.LLD_CAUSE_DE152,
+            LLDataSets.LLD_CAUSE_DE153, LLDataSets.LLD_CAUSE_DE153,
+            LLDataSets.LLD_CAUSE_DE154, LLDataSets.LLD_CAUSE_DE154,
+            
+            
+            //Acute Flaccide paralysis
+            LLDataSets.LLD_CAUSE_DE155, LLDataSets.LLD_CAUSE_DE155,
+            LLDataSets.LLD_CAUSE_DE156, LLDataSets.LLD_CAUSE_DE156,
+            LLDataSets.LLD_CAUSE_DE157, LLDataSets.LLD_CAUSE_DE157,
+            LLDataSets.LLD_CAUSE_DE158, LLDataSets.LLD_CAUSE_DE158,
+            LLDataSets.LLD_CAUSE_DE159, LLDataSets.LLD_CAUSE_DE159,
+            
+            //Respiratory Infections (other than TB)
+            LLDataSets.LLD_CAUSE_DE160, LLDataSets.LLD_CAUSE_DE160,
+            LLDataSets.LLD_CAUSE_DE161, LLDataSets.LLD_CAUSE_DE161,
+            LLDataSets.LLD_CAUSE_DE162, LLDataSets.LLD_CAUSE_DE162,
+            LLDataSets.LLD_CAUSE_DE163, LLDataSets.LLD_CAUSE_DE163,
+            LLDataSets.LLD_CAUSE_DE164, LLDataSets.LLD_CAUSE_DE164,
+            
+            
+            
+        
+        
+        };
 
         int[] aggDeOptComIds = { LLDataSets.LLD_OPTIONCOMBO_DEFAULT, LLDataSets.LLD_OPTIONCOMBO_DEFAULT,
             LLDataSets.LLD_OPTIONCOMBO_DEFAULT, LLDataSets.LLD_OPTIONCOMBO_DEFAULT, LLDataSets.LLD_OPTIONCOMBO_DEFAULT,
@@ -798,75 +924,198 @@
             LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,
             LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,
             LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, 
+            
+            
+           
+            
+            // for haryana
+            
+            //Pneumonia
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            
+            // Fever/Other Fever related
+            
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            // Meconium aspiration syndrome
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            // Meningitis
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            // Major Congenital Malformation
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            // Prematurity
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            // Hypothermia
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            
+            // Diptheria
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            
+            // Childhood Tuberculosis
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            
+            //Dysentry
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            
+            // Pertusis
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            // Polio
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            
+            // Tetanus Neonatorum
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            // Tetanus (Others)
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+            //Acute Flaccide paralysis
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
 
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE, LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
-            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE };
+            
+            // Respiratory Infections (other than TB)
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            LLDataSets.LLD_CAUSE_OPTIONCOMBO_FEMALE,LLDataSets.LLD_CAUSE_OPTIONCOMBO_MALE,
+            
+        };
 
         String[] queries = new String[aggDeIds.length];
 
@@ -2135,7 +2384,1277 @@
             + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
             + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
             + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
-
+        
+        
+       
+        // for haryana
+        
+       
+        //  : Fever/other Fever  related below 1 day Female
+        queries[177] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_OFR
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Fever/other Fever related below 1 day Male
+        queries[178] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_OFR
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Fever/other Fever related 1 day to 1 week Female
+        queries[179] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_OFR
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Fever/other Fever related 1 day to 1 week Male
+        queries[180] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_OFR
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Fever/other Fever related 1 week to 1 month Female
+        queries[181] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_OFR
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Fever/other Fever related 1 week to 1 month Male
+        queries[182] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_OFR
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        
+        
+        
+        
+        //  : PNEUMONIA Fever  related below 1 day Female
+        queries[183] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PNEUMONIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : PNEUMONIA Fever related below 1 day Male
+        queries[184] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PNEUMONIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : PNEUMONIA Fever related 1 day to 1 week Female
+        queries[185] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PNEUMONIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : PNEUMONIA Fever related 1 day to 1 week Male
+        queries[186] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PNEUMONIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : PNEUMONIA Fever related 1 week to 1 month Female
+        queries[187] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PNEUMONIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : PNEUMONIA Fever related 1 week to 1 month Male
+        queries[188] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PNEUMONIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+
+        
+        
+        
+        
+        
+        
+        //  : Meconium aspiration syndrome below 1 day Female
+        queries[189] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MAS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meconium aspiration syndrome below 1 day Male
+        queries[190] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MAS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meconium aspiration syndrome 1 day to 1 week Female
+        queries[191] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MAS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meconium aspiration syndrome 1 day to 1 week Male
+        queries[192] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MAS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meconium aspiration syndrome 1 week to 1 month Female
+        queries[193] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MAS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meconium aspiration syndrome 1 week to 1 month Male
+        queries[194] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MAS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meconium aspiration syndrome 1 month to 1 year Female
+        queries[195] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MAS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meconium aspiration syndrome 1 month to 1 year Male
+        queries[196] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MAS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        //  : Meconium aspiration syndrome 1 year to 5 year Female
+        queries[197] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MAS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meconium aspiration syndrome 1 year to 5 year Male
+        queries[198] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MAS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";           
+
+        
+       
+        //  :Meningitis below 1 day Female
+        queries[199] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MENINGITIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meningitis below 1 day Male
+        queries[200] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MENINGITIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meningitis 1 day to 1 week Female
+        queries[201] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MENINGITIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meningitis 1 day to 1 week Male
+        queries[202] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MENINGITIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meningitis 1 week to 1 month Female
+        queries[203] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MENINGITIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meningitis 1 week to 1 month Male
+        queries[204] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MENINGITIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meningitis 1 month to 1 year Female
+        queries[205] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MENINGITIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meningitis 1 month to 1 year Male
+        queries[206] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MENINGITIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        //  : Meningitis 1 year to 5 year Female
+        queries[207] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MENINGITIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Meningitis 1 year to 5 year Male
+        queries[208] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MENINGITIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";           
+        
+        
+        
+        
+        //  :Major Congenital Malformation below 1 day Female
+        queries[209] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MCM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Major Congenital Malformation below 1 day Male
+        queries[210] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MCM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Major Congenital Malformation 1 day to 1 week Female
+        queries[211] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MCM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Major Congenital Malformation 1 day to 1 week Male
+        queries[212] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MCM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Major Congenital Malformation 1 week to 1 month Female
+        queries[213] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MCM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Major Congenital Malformation 1 week to 1 month Male
+        queries[214] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MCM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Major Congenital Malformation 1 month to 1 year Female
+        queries[215] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MCM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Major Congenital Malformation 1 month to 1 year Male
+        queries[216] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MCM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        //  : Major Congenital Malformation 1 year to 5 year Female
+        queries[217] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MCM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Major Congenital Malformation 1 year to 5 year Male
+        queries[218] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_MCM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";             
+        
+        
+        //  : Prematurity below 1 day Female
+        queries[219] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PREMATURITY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Prematurity below 1 day Male
+        queries[220] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PREMATURITY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Prematurity 1 day to 1 week Female
+        queries[221] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PREMATURITY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Prematurity 1 day to 1 week Male
+        queries[222] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PREMATURITY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Prematurity 1 week to 1 month Female
+        queries[223] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PREMATURITY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Prematurity 1 week to 1 month Male
+        queries[224] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PREMATURITY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Prematurity 1 month to 1 year Female
+        queries[225] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PREMATURITY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  :Prematurity 1 month to 1 year Male
+        queries[226] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PREMATURITY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        //  : Prematurity 1 year to 5 year Female
+        queries[227] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PREMATURITY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Prematurity 1 year to 5 year Male
+        queries[228] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PREMATURITY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";             
+                
+        
+        //  : Hypothermia below 1 day Female
+        queries[229] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_HYPOTHERMIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Hypothermia below 1 day Male
+        queries[230] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_HYPOTHERMIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Hypothermia 1 day to 1 week Female
+        queries[231] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_HYPOTHERMIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Hypothermia 1 day to 1 week Male
+        queries[232] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_HYPOTHERMIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Hypothermia 1 week to 1 month Female
+        queries[233] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_HYPOTHERMIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Hypothermia 1 week to 1 month Male
+        queries[234] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_HYPOTHERMIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Hypothermia 1 month to 1 year Female
+        queries[235] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_HYPOTHERMIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Hypothermia 1 month to 1 year Male
+        queries[236] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_HYPOTHERMIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        //  : Hypothermia 1 year to 5 year Female
+        queries[237] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_HYPOTHERMIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Hypothermia 1 year to 5 year Male
+        queries[238] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_HYPOTHERMIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";            
+        
+        
+        //  : Diptheria below 1 day Female
+        queries[239] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DIPTHERIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Diptheria below 1 day Male
+        queries[240] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DIPTHERIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Diptheria 1 day to 1 week Female
+        queries[241] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DIPTHERIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Diptheria 1 day to 1 week Male
+        queries[242] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DIPTHERIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Diptheria 1 week to 1 month Female
+        queries[243] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DIPTHERIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Diptheria 1 week to 1 month Male
+        queries[244] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DIPTHERIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Diptheria 1 month to 1 year Female
+        queries[245] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DIPTHERIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Diptheria 1 month to 1 year Male
+        queries[246] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DIPTHERIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        //  : Diptheria 1 year to 5 year Female
+        queries[247] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DIPTHERIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Diptheria 1 year to 5 year Male
+        queries[248] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DIPTHERIA
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";            
+               
+        
+        //  : Childhood Tuberculosis below 1 day Female
+        queries[249] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_CHILD_TUBERCULOSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Childhood Tuberculosis below 1 day Male
+        queries[250] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_CHILD_TUBERCULOSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Childhood Tuberculosis 1 day to 1 week Female
+        queries[251] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_CHILD_TUBERCULOSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Childhood Tuberculosis 1 day to 1 week Male
+        queries[252] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_CHILD_TUBERCULOSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Childhood Tuberculosis 1 week to 1 month Female
+        queries[253] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_CHILD_TUBERCULOSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Childhood Tuberculosis 1 week to 1 month Male
+        queries[254] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_CHILD_TUBERCULOSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Childhood Tuberculosis 1 month to 1 year Female
+        queries[255] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_CHILD_TUBERCULOSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Childhood Tuberculosis 1 month to 1 year Male
+        queries[256] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_CHILD_TUBERCULOSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        //  : Childhood Tuberculosis 1 year to 5 year Female
+        queries[257] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_CHILD_TUBERCULOSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Childhood Tuberculosis 1 year to 5 year Male
+        queries[258] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_CHILD_TUBERCULOSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";            
+                
+        
+        //  : Dysentry below 1 day Female
+        queries[259] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DYSENTRY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Dysentry below 1 day Male
+        queries[260] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DYSENTRY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Dysentry 1 day to 1 week Female
+        queries[261] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DYSENTRY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Dysentry 1 day to 1 week Male
+        queries[262] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DYSENTRY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Dysentry 1 week to 1 month Female
+        queries[263] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DYSENTRY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Dysentry 1 week to 1 month Male
+        queries[264] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DYSENTRY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Dysentry 1 month to 1 year Female
+        queries[265] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DYSENTRY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Dysentry 1 month to 1 year Male
+        queries[266] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DYSENTRY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        //  : Dysentry 1 year to 5 year Female
+        queries[267] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DYSENTRY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Dysentry 1 year to 5 year Male
+        queries[268] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_DYSENTRY
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";          
+        
+        //  : Pertusis below 1 day Female
+        queries[269] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PERTUSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Pertusis below 1 day Male
+        queries[270] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PERTUSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Pertusis 1 day to 1 week Female
+        queries[271] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PERTUSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Pertusis 1 day to 1 week Male
+        queries[272] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PERTUSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Pertusis 1 week to 1 month Female
+        queries[273] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PERTUSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Pertusis 1 week to 1 month Male
+        queries[274] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PERTUSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Pertusis 1 month to 1 year Female
+        queries[275] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PERTUSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Pertusis 1 month to 1 year Male
+        queries[276] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PERTUSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        //  : Pertusis 1 year to 5 year Female
+        queries[277] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PERTUSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Pertusis 1 year to 5 year Male
+        queries[278] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_PERTUSIS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";           
+                
+        //  : Polio below 1 day Female
+        queries[279] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_POLIO
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Polio below 1 day Male
+        queries[280] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_POLIO
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Polio 1 day to 1 week Female
+        queries[281] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_POLIO
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Polio 1 day to 1 week Male
+        queries[282] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_POLIO
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Polio 1 week to 1 month Female
+        queries[283] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_POLIO
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Polio 1 week to 1 month Male
+        queries[284] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_POLIO
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Polio 1 month to 1 year Female
+        queries[285] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_POLIO
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Polio 1 month to 1 year Male
+        queries[286] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_POLIO
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        //  : Polio 1 year to 5 year Female
+        queries[287] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_POLIO
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Polio 1 year to 5 year Male
+        queries[288] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_POLIO
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";   
+        
+        //  : Tetanus Neonatorum below 1 day Female
+        queries[289] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_NEONATORUM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus Neonatorum below 1 day Male
+        queries[290] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_NEONATORUM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus Neonatorum 1 day to 1 week Female
+        queries[291] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_NEONATORUM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus Neonatorum 1 day to 1 week Male
+        queries[292] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_NEONATORUM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus Neonatorum 1 week to 1 month Female
+        queries[293] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_NEONATORUM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus Neonatorum 1 week to 1 month Male
+        queries[294] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_NEONATORUM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus Neonatorum 1 month to 1 year Female
+        queries[295] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_NEONATORUM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus Neonatorum 1 month to 1 year Male
+        queries[296] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_NEONATORUM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus Neonatorum 1 year to 5 year Female
+        queries[297] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_NEONATORUM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus Neonatorum 1 year to 5 year Male
+        queries[298] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_NEONATORUM
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";   
+        
+       
+        
+        
+        
+        //  : Tetanus (Others) below 1 day Female
+        queries[299] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_OTHERS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus (Others) below 1 day Male
+        queries[300] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_OTHERS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus (Others) 1 day to 1 week Female
+        queries[301] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_OTHERS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus (Others) 1 day to 1 week Male
+        queries[302] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_OTHERS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus (Others) 1 week to 1 month Female
+        queries[303] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_OTHERS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus (Others) 1 week to 1 month Male
+        queries[304] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_OTHERS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus (Others) 1 month to 1 year Female
+        queries[305] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_OTHERS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus (Others) 1 month to 1 year Male
+        queries[306] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_OTHERS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        //  : Tetanus (Others) 1 year to 5 year Female
+        queries[307] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_OTHERS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Tetanus (Others) 1 year to 5 year Male
+        queries[308] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_TETANUS_OTHERS
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";           
+        
+        
+        
+       
+        
+        //  : Acute Flaccide paralysis  below 1 day Female
+        queries[309] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_AFP
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Acute Flaccide paralysis  below 1 day Male
+        queries[310] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_AFP
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Acute Flaccide paralysis  1 day to 1 week Female
+        queries[311] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_AFP
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Acute Flaccide paralysis  1 day to 1 week Male
+        queries[312] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_AFP
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Acute Flaccide paralysis  1 week to 1 month Female
+        queries[313] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_AFP
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Acute Flaccide paralysis  1 week to 1 month Male
+        queries[314] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_AFP
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Acute Flaccide paralysis  1 month to 1 year Female
+        queries[315] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_AFP
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Acute Flaccide paralysis  1 month to 1 year Male
+        queries[316] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_AFP
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        //  : Acute Flaccide paralysis  1 year to 5 year Female
+        queries[317] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_AFP
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Acute Flaccide paralysis  1 year to 5 year Male
+        queries[318] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_AFP
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";         
+        
+        
+        
+        
+        //  : Respiratory Infections (other than TB) below 1 day  Female
+        queries[319] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_RI_OTHER_THAN_TB
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Respiratory Infections (other than TB) below 1 day Male
+        queries[320] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_RI_OTHER_THAN_TB
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1DAY') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Respiratory Infections (other than TB) 1 day to 1 week Female
+        queries[321] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_RI_OTHER_THAN_TB
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Respiratory Infections (other than TB)  1 day to 1 week Male
+        queries[322] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_RI_OTHER_THAN_TB
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1WEEK') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Respiratory Infections (other than TB) 1 week to 1 month Female
+        queries[323] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_RI_OTHER_THAN_TB
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Respiratory Infections (other than TB) 1 week to 1 month Male
+        queries[324] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_RI_OTHER_THAN_TB
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1MONTH') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Respiratory Infections (other than TB) 1 month to 1 year Female
+        queries[325] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_RI_OTHER_THAN_TB
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Respiratory Infections (other than TB) 1 month to 1 year Male
+        queries[326] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_RI_OTHER_THAN_TB
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B1YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        
+        //  : Respiratory Infections (other than TB) 1 year to 5 year Female
+        queries[327] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_RI_OTHER_THAN_TB
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'F' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+        
+        //  : Respiratory Infections (other than TB)1 year to 5 year Male
+        queries[328] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLD_DEATH_CAUSE + " AND value LIKE '" + LLDataSets.LLD_RI_OTHER_THAN_TB
+            + "' AND recordno IN ( SELECT recordno FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = "
+            + pId + " AND dataelementid = " + LLDataSets.LLD_AGE_CATEGORY
+            + " AND value IN ('B5YEAR') AND recordno IN (SELECT recordno FROM lldatavalue WHERE dataelementid = "
+            + LLDataSets.LLD_SEX + " AND value = 'M' AND sourceid = " + ouId + " AND periodid = " + pId + "))";
+                
+        
+        
+        
+        
         try
         {
             //Connection con = jdbcTemplate.getDataSource().getConnection();
@@ -2193,7 +3712,9 @@
                 System.out.println( "Exception while closing DB Connections : " + e.getMessage() );
             }
         }
-
+        
+        //System.out.println( aggDeIds.length + " -- "+ aggDeOptComIds.length + " -- " + queries.length );
+        
         return deValueMap;
     }
 
@@ -2217,7 +3738,8 @@
             LLDataSets.LLMD_BY_TRAINED, LLDataSets.LLMD_BY_ANM, LLDataSets.LLMD_BY_NURSE, LLDataSets.LLMD_BY_DOCTOR,
             LLDataSets.LLMD_CAUSE_ABORTION, LLDataSets.LLMD_CAUSE_OPL, LLDataSets.LLMD_CAUSE_FITS,
             LLDataSets.LLMD_CAUSE_SH, LLDataSets.LLMD_CAUSE_BBCD, LLDataSets.LLMD_CAUSE_BACD,
-            LLDataSets.LLMD_CAUSE_HFBD, LLDataSets.LLMD_CAUSE_HFAD, LLDataSets.LLMD_CAUSE_NK, LLDataSets.LLMD_CAUSE_MDNK
+            LLDataSets.LLMD_CAUSE_HFBD, LLDataSets.LLMD_CAUSE_HFAD, LLDataSets.LLMD_CAUSE_NK, LLDataSets.LLMD_CAUSE_MDNK, LLDataSets.LLMD_CAUSE_ANAEMIA,
+            LLDataSets.LLMD_CAUSE_SEVERE_ANAEMIA, LLDataSets.LLMD_CAUSE_MODERATE_ANAEMIA
 
         };
         String[] queries = new String[aggDeIds.length];
@@ -2320,7 +3842,15 @@
         // Metarnal Death Other Causes (including cause not known)
         queries[30] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
             + " AND dataelementid = " + LLDataSets.LLMD_DEATH_CAUSE + "  AND value = 'MDNK'";
-        
+        // Metarnal Death Other Causes (including cause not known)
+        queries[31] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLMD_DEATH_CAUSE + "  AND value = 'ANAEMIA'";
+        // Metarnal Death Other Causes (including cause not known)
+        queries[32] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLMD_DEATH_CAUSE + "  AND value = 'SEVEREANAEMIA'";
+        // Metarnal Death Other Causes (including cause not known)
+        queries[33] = "SELECT COUNT(*) FROM lldatavalue WHERE sourceid = " + ouId + " AND periodid = " + pId
+            + " AND dataelementid = " + LLDataSets.LLMD_DEATH_CAUSE + "  AND value = 'MODERATEANAEMIA'";
         try
         {
             //Connection con = jdbcTemplate.getDataSource().getConnection();

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/state/DefaultStatefulDataValueSaver.java'
--- local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/state/DefaultStatefulDataValueSaver.java	2010-06-15 11:26:37 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/java/org/hisp/dhis/den/state/DefaultStatefulDataValueSaver.java	2014-07-05 07:42:50 +0000
@@ -129,7 +129,8 @@
         // Update DB
         // ---------------------------------------------------------------------
 
-        DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, period, optionCombo );
+        //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, period, optionCombo );
+        DataValue dataValue = dataValueService.getDataValue( dataElement, period, organisationUnit, optionCombo );
 
         if ( dataValue == null )
         {
@@ -137,7 +138,8 @@
             {
                 LOG.debug( "Adding DataValue, value added" );
 
-                dataValue = new DataValue( dataElement, period, organisationUnit, value, storedBy, new Date(), null, optionCombo );
+                //dataValue = new DataValue( dataElement, period, organisationUnit, value, storedBy, new Date(), null, optionCombo );
+                dataValue = new DataValue( dataElement, period, organisationUnit,optionCombo,null , value, storedBy, new Date(), null  );
 
                 dataValueService.addDataValue( dataValue );
             }

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/resources/META-INF/dhis/beans.xml'
--- local/in/dhis-web-dataentry-linelisting/src/main/resources/META-INF/dhis/beans.xml	2012-03-19 06:11:45 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/resources/META-INF/dhis/beans.xml	2013-09-19 06:34:31 +0000
@@ -104,7 +104,7 @@
 	<property name="dataElementCategoryService"
       ref="org.hisp.dhis.dataelement.DataElementCategoryService"/>
 	<!--<property name="dataSetLockService"
-      ref="org.hisp.dhis.datalock.DataSetLockService"/>-->
+      ref="org.hisp.dhis.datalock.DataSetLockService"/>--> 
 	<property name="dataSetService"
       ref="org.hisp.dhis.dataset.DataSetService"/>
     <property name="sectionService" ref="org.hisp.dhis.dataset.SectionService"/>

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/resources/org/hisp/dhis/den/i18n_module.properties'
--- local/in/dhis-web-dataentry-linelisting/src/main/resources/org/hisp/dhis/den/i18n_module.properties	2012-06-30 08:05:32 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/resources/org/hisp/dhis/den/i18n_module.properties	2013-09-19 06:34:31 +0000
@@ -87,4 +87,5 @@
 linelisting                         = Linelisting
 linelisting_dataentry               = Linelisting dataentry
 aggregate                           = Aggregate
-orgUnit                             = OrgUnit
\ No newline at end of file
+orgUnit                             = OrgUnit
+please_fill_name_of_the_hospital    = Please fill name of the hospital 

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/resources/struts.xml'
--- local/in/dhis-web-dataentry-linelisting/src/main/resources/struts.xml	2012-06-30 08:05:32 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/resources/struts.xml	2014-07-05 07:39:23 +0000
@@ -124,7 +124,7 @@
       <param name="page">/dhis-web-dataentry-national/autoLLDataAggForm.vm</param>
       <param name="menu">/dhis-web-dataentry-national/menuAutoLLData.vm</param>
 	  <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,javascript/autolldataagg.js</param>
-		<param name="requiredAuthorities">LINELISTING_AGGREGATION</param>            
+	  <param name="requiredAuthorities">LINELISTING_AGGREGATION</param>		          
     </action>
 
     <action name="autoLLAgg" class="org.hisp.dhis.den.autoagg.action.AutoLLDataAggregationAction">

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/webapp/WEB-INF/web.xml'
--- local/in/dhis-web-dataentry-linelisting/src/main/webapp/WEB-INF/web.xml	2012-04-04 05:46:52 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/webapp/WEB-INF/web.xml	2014-07-05 07:38:33 +0000
@@ -2,7 +2,7 @@
 <!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
   "http://java.sun.com/dtd/web-app_2_3.dtd">
 <web-app>
-  <display-name>DHIS Linelisting</display-name>
+  <display-name>DHIS Linelisting Data Entry Bihar</display-name>
   
   <context-param>
     <param-name>contextConfigLocation</param-name>
@@ -12,7 +12,7 @@
     <param-name>automaticAccessType</param-name>
     <param-value>ghostAdmin</param-value>
   </context-param>
-  
+   
   <filter>
     <filter-name>RedirectFilter</filter-name>
     <filter-class>org.hisp.dhis.servlet.filter.HttpRedirectFilter</filter-class>
@@ -21,6 +21,7 @@
       <param-value>dhis-web-dataentry-national/index.action</param-value>
     </init-param>
   </filter>
+  
   <filter>
     <filter-name>OpenSessionInViewFilter</filter-name>
     <filter-class>org.springframework.orm.hibernate4.support.OpenSessionInViewFilter</filter-class>
@@ -29,9 +30,10 @@
     <filter-name>springSecurityFilterChain</filter-name>
     <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
   </filter>
+  
   <filter>
     <filter-name>Struts</filter-name>
-    <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
+    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
   </filter>
   
   <filter-mapping>
@@ -50,24 +52,6 @@
     <filter-name>Struts</filter-name>
     <url-pattern>*.action</url-pattern>
   </filter-mapping>
-<!--
-  <servlet>
-        <servlet-name>jcaptcha</servlet-name>
-        <servlet-class>org.hisp.dhis.security.action.CaptchaImageServlet</servlet-class>
-  </servlet>
-  <servlet-mapping>
-        <servlet-name>jcaptcha</servlet-name>
-        <url-pattern>/dhis-web-commons/security/jcaptcha.jpg</url-pattern>
-  </servlet-mapping>
-  <servlet>
-        <servlet-name>captchaValidator</servlet-name>
-        <servlet-class>org.hisp.dhis.security.action.CaptchaValidateServlet</servlet-class>
-  </servlet>
-  <servlet-mapping>
-        <servlet-name>captchaValidator</servlet-name>
-        <url-pattern>/dhis-web-commons/security/captchaValidator</url-pattern>
-  </servlet-mapping>
--->
 
   <listener>
     <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/form.vm'
--- local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/form.vm	2011-10-14 13:44:18 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/form.vm	2013-09-18 10:12:26 +0000
@@ -2,7 +2,6 @@
 
 #parse( "/dhis-web-dataentry-national/select.vm" )
 
-
 #if($selDSName.equals($llbirth))
 	#parse( "/dhis-web-dataentry-national/llbirthForm.vm" )
 #elseif($selDSName.equals($lldeath))
@@ -19,6 +18,12 @@
 	#parse( "/dhis-web-dataentry-national/llidspl.vm" )
 #elseif($selDSName.equals($llcoldchain))
     #parse( "/dhis-web-dataentry-national/llcoldchain.vm" )	
+#elseif($selDSName.equals($llFamilyPlaning))
+    #parse( "/dhis-web-dataentry-national/llFamilyPlaning.vm" )
+#elseif($selDSName.equals($llYuktiStatus))
+    #parse( "/dhis-web-dataentry-national/llYuktiStatus.vm" )
+#elseif($selDSName.equals($llUltrasound))
+    #parse( "/dhis-web-dataentry-national/llUltrasound.vm" )	    	    
 	
 #else
   <h3>No Dataentry form available for selected DataSet/DataSet not assign to selected Organisation Unit</h3>

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/javascript/autolldataagg.js'
--- local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/javascript/autolldataagg.js	2012-06-30 08:05:32 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/javascript/autolldataagg.js	2013-09-18 10:12:26 +0000
@@ -37,7 +37,8 @@
 		document.getElementById("selOrgUnitName").value = orgUnitName;	
     }    		
 }
-//form Validation
+
+// form Validation
 
 function formValidationsLLAggregation()
 {
@@ -85,4 +86,3 @@
 			});
 	}
 }	
-

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/javascript/general.js'
--- local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/javascript/general.js	2012-02-17 07:15:15 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/javascript/general.js	2013-12-02 08:07:24 +0000
@@ -73,6 +73,1401 @@
 
 
 //-----------------------------------------------------------------------------
+//Line Listing Ultrasound Related Methods for Validation for Bihar
+//-----------------------------------------------------------------------------
+
+
+function isUltrasoundRenewalDateFieldEntered( )
+{
+    if(lastRecordNo == -1) return true;
+
+    var dataElementId = 7584;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + lastRecordNo + '].value' );
+    var resVal = field.selectedIndex;
+
+    if( resVal <= 0 )
+    {
+        alert("Please enter Renewal Field in Previous Record" );
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+
+
+function validateLLUltraSoundApplicantNameField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if( isUltrasoundRenewalDateFieldEntered( recordNo ) )
+    {
+        if(resVal <= 0 || resVal == "---")
+        {
+            alert("Please Enter Name of Applicant");
+            field.options[0].selected = true;
+
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+        field.options[0].selected = true;
+        return false;
+    }
+}
+
+
+
+function isLLUltraSoundApplicantNameFieldEntered( recordNo )
+{
+    var dataElementId = 7577;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+    	alert("Please Enter Name of Applicant");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+
+
+function validateLLUltraSoundClinicNameField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if( isLLUltraSoundApplicantNameFieldEntered( recordNo ) )
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter Name of USG/MTP Clinics");
+            field.value = "";
+            //field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+        field.value = "";
+
+        return false;
+    }
+}
+
+
+function isLLUltraSoundClinicNameFieldEntered( recordNo )
+{
+    var dataElementId = 7578;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+    	alert("Please enter Name of USG/MTP Clinics");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+
+function validateLLUltraSoundClinicAddressField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if( isLLUltraSoundClinicNameFieldEntered( recordNo ) )
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter Address of USG/MTP Clinics");
+            field.value = "";
+            //field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+        field.value = "";
+
+        return false;
+    }
+}
+
+
+function isLLUltraSoundClinicAddressFieldEntered( recordNo )
+{
+    var dataElementId = 7579;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+    	alert("Please enter Address of USG/MTP Clinics");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+
+function validateLLUltraSoundSonologistNameField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if( isLLUltraSoundClinicAddressFieldEntered( recordNo ) )
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter Name of Concerned Sonologist");
+            field.value = "";
+            //field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+        field.value = "";
+
+        return false;
+    }
+}
+
+function isLLUltraSoundSonologistNameFieldEntered( recordNo )
+{
+    var dataElementId = 7580;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+    	alert("Please enter Name of Concerned Sonologist");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+
+function validateLLUltraSoundSonologistQualificationField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if( isLLUltraSoundSonologistNameFieldEntered( recordNo ) )
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter Qualification of Concern Sonologist");
+            field.value = "";
+            //field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+        field.value = "";
+
+        return false;
+    }
+}
+
+
+function isLLUltraSoundSonologistQualificationFieldEntered( recordNo )
+{
+    var dataElementId = 7581;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+    	alert("Please enter Qualification of Concern Sonologist");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+
+function validateLLUltraSoundRegistrationNoField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if( isLLUltraSoundSonologistQualificationFieldEntered( recordNo ) )
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter Registration No. of USG/MTP Clinics");
+            field.value = "";
+            //field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+        field.value = "";
+
+        return false;
+    }
+}
+
+
+function isLLUltraSoundRegistrationNoFieldEntered( recordNo )
+{
+    var dataElementId = 7582;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+    	alert("Please enter Registration No. of USG/MTP Clinics");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+
+
+
+function validateLLUltraSoundExpireDateField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if( isLLUltraSoundRegistrationNoFieldEntered( recordNo ) )
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please select Expiry Date");
+            field.value = "";
+            //field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+        field.value = "";
+
+        return false;
+    }
+}
+
+
+
+function isLLUltraSoundExpireDateFieldEntered( recordNo )
+{
+    var dataElementId = 7583;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+    	 alert("Please select Expiry Date");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+
+function validateLLUltraSoundRenewalDateField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if( isLLUltraSoundExpireDateFieldEntered( recordNo ) )
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please select Date of Renewal");
+            field.value = "";
+            //field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+        addLLUltrasoundNewRow( resVal, 7577, recordNo );
+    }
+    else
+    {
+        field.value = "";
+
+        return false;
+    }
+}
+
+
+//-----------------------------------------------------------------------------
+//Line Listing Yukti Status Related Methods for Validation
+//-----------------------------------------------------------------------------
+
+function isYuktiStatusRemarksFieldEntered( )
+{
+    if(lastRecordNo == -1) return true;
+
+    var dataElementId = 7286;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + lastRecordNo + '].value' );
+    var resVal = field.selectedIndex;
+
+    if( resVal <= 0 )
+    {
+        alert("Please enter Remarks Field in Previous Record" );
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+
+function isLLYSSiteAccreditationIDFiledEntered( recordNo )
+{
+    var dataElementId = 7315;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter ACCREDITATION ID");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+
+
+function validateLLYSAccreditationIDField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    
+    if(resVal == null || resVal == "" )
+    {
+        alert("Please enter Accreditation ID");
+        field.value = "";
+        // field.focus();
+        setTimeout(function(){
+            field.focus();field.select();
+        },2);
+        return false;
+    }
+    else
+    {
+        saveLLbirthValue( dataElementId, recordNo );
+    }
+    
+    
+    /*
+    if( isYuktiStatusRemarksFieldEntered( ) )
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter site name");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }
+    */	
+ 
+    	
+}
+
+
+function validateLLYSSiteNameField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    
+    if(resVal == null || resVal == "" )
+    {
+        alert("Please enter site name");
+        field.value = "";
+        // field.focus();
+        setTimeout(function(){
+            field.focus();field.select();
+        },2);
+        return false;
+    }
+    else
+    {
+        saveLLbirthValue( dataElementId, recordNo );
+    }
+    
+    
+    if( isLLYSSiteAccreditationIDFiledEntered( recordNo ) )
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter Accreditation ID");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }
+    
+    
+    
+    
+    
+    
+ 
+}
+
+function isLLYSSiteNameFiledEntered( recordNo )
+{
+    var dataElementId = 7280;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter SITE NAME");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+function validateLLYSContactNoField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLYSSiteNameFiledEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter contact no");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+
+function isLLYSContactNoFiledEntered( recordNo )
+{
+    var dataElementId = 7281;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter CONTACT NO");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+
+function validateLLYSMTPPerformedField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLYSContactNoFiledEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter no of MTPs performed");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+
+function isLLYSMTPPerformedFieldEntered( recordNo )
+{
+    var dataElementId = 7282;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter NO OF MTP PERFORMED");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+function validateLLYSAccreditedPaidField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLYSMTPPerformedFieldEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter no of accredited cases paid");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+
+function isLLYSAccreditedPaidFieldEntered( recordNo )
+{
+    var dataElementId = 7283;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter NO OF ACCREDITED CASE PAID");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+function validateLLYSAmountPaidField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLYSAccreditedPaidFieldEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter amount paid");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+
+function isLLYSAmountPaidFieldEntered( recordNo )
+{
+    var dataElementId = 7284;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter AMOUNT PAID");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+function validateLLYSAmountDueField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLYSAmountPaidFieldEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter amount due");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+        addLLYuktiStatusNewRow( resVal, 7315, recordNo );
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+
+
+function isLLYSAmountDueFieldEntered( recordNo )
+{
+    var dataElementId = 7285;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter AMOUNT DUE");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+function validateLLYSRemarkField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLYSAmountDueFieldEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter remark");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+        //addLLYuktiStatusNewRow( resVal, 7280, recordNo );
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+
+
+
+//-----------------------------------------------------------------------------
+//Line Listing Family Planing Related Methods for Validation
+//-----------------------------------------------------------------------------
+
+function isFamilyPlaningRemarksFieldEntered( )
+{
+    if(lastRecordNo == -1) return true;
+
+    var dataElementId = 7279;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + lastRecordNo + '].value' );
+    var resVal = field.selectedIndex;
+
+    if( resVal <= 0 )
+    {
+        alert("Please enter Remarks Field in Previous Record" );
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+
+
+
+
+function validateLLFPAccreditationIDField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+    
+    if(resVal == null || resVal == "" )
+    {
+        alert("Please enter Accreditation ID");
+        field.value = "";
+        // field.focus();
+        setTimeout(function(){
+            field.focus();field.select();
+        },2);
+        return false;
+    }
+    else
+    {
+        saveLLbirthValue( dataElementId, recordNo );
+    }
+    
+    /*
+    
+    if( isFamilyPlaningRemarksFieldEntered( ) )
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter hospital name");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }
+    */
+}
+
+
+function isFamilyPlaningAccreditationIDFieldEntered( recordNo )
+{
+    var dataElementId = 7314;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    
+    //alert( dataElementId  +"---"+ recordNo + " --- " + field );
+    
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter ACCREDITATION ID");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+
+function validateLLFPHospitalNameField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+    
+    if(resVal == null || resVal == "" )
+    {
+        alert("Please enter hospital name");
+        field.value = "";
+        // field.focus();
+        setTimeout(function(){
+            field.focus();field.select();
+        },2);
+        return false;
+    }
+    else
+    {
+        saveLLbirthValue( dataElementId, recordNo );
+    }
+    
+    
+  
+    
+    if( isFamilyPlaningAccreditationIDFieldEntered( recordNo ) )
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter hospital name");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }
+    
+}
+
+
+
+
+function isLLFPHospitalNameFiledEntered( recordNo )
+{
+    var dataElementId = 7271;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter Hospital NAME");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+function validateLLFPContactNoField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLFPHospitalNameFiledEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter contact no");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+
+function isLLFPContactNoFiledEntered( recordNo )
+{
+    var dataElementId = 7272;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter CONTACT NO");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+function validateLLFPSterilisationFemaleField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLFPContactNoFiledEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter sterilisation done for Female");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+
+function isLLFPSterilisationFemaleFieldEntered( recordNo )
+{
+    var dataElementId = 7273;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter STERILISATION DONE FOR FEMALE");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+function validateLLFPSterilisationMaleField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLFPSterilisationFemaleFieldEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter sterilisation done for male");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+
+function isLLFPSterilisationMaleFieldEntered( recordNo )
+{
+    var dataElementId = 7274;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter STERILISATION DONE FOR MALE");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+function validateLLFPNoOfCasesPaidFemaleField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLFPSterilisationMaleFieldEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter No of Cases Paid for Female");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+
+function isLLFPNoOfCasesPaidFemaleFieldEntered( recordNo )
+{
+    var dataElementId = 7275;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter NO OF CASES PAID FOR FEMALE");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+function validateLLFPNoOfCasesPaidMaleField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLFPNoOfCasesPaidFemaleFieldEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter No of Cases Paid for male");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+function isLLFPNoOfCasesPaidMaleFieldEntered( recordNo )
+{
+    var dataElementId = 7276;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter NO OF CASES PAID FOR MALE");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+function validateLLFPAmountPaidField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLFPNoOfCasesPaidMaleFieldEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter amount paid");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+
+function isLLFPAmountPaidFieldEntered( recordNo )
+{
+    var dataElementId = 7277;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter AMOUNT PAID");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+function validateLLFPAmountDueField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLFPAmountPaidFieldEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter amount due");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+        addLLFamilyPlaningNewRow( resVal, 7314, recordNo );
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+
+function isLLFPAmountDueFieldEntered( recordNo )
+{
+    var dataElementId = 7278;
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+
+    if(resVal == null || resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '') == "" )
+    {
+        alert("Please enter AMOUNT DUE");
+        field.focus();field.select();
+        return false;
+    }
+    else
+    {
+        return true;
+    }
+}
+
+function validateLLFPRemarkField( dataElementId, recordNo )
+{
+    var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
+    var resVal = field.value;
+    resVal = resVal.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
+
+    if(isLLFPAmountDueFieldEntered( recordNo ))
+    {
+        if(resVal == null || resVal == "" )
+        {
+            alert("Please enter remark");
+            field.value = "";
+            // field.focus();
+            setTimeout(function(){
+                field.focus();field.select();
+            },2);
+            return false;
+        }
+        else
+        {
+            saveLLbirthValue( dataElementId, recordNo );
+        }
+        //addLLFamilyPlaningNewRow( resVal, 7271, recordNo );
+    }
+    else
+    {
+    	field.value = "";
+        return false;
+    }	
+}
+
+
+//-----------------------------------------------------------------------------
 //Linelisting ColdChain Related Methods for Validation
 //-----------------------------------------------------------------------------
 function isColdChainRemarksFieldEntered( )
@@ -1643,14 +3038,14 @@
     var dataElementId = 1031;
     var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + lastRecordNo + '].value' );
     var resVal = field.selectedIndex;
-  
+  /*
     if(resVal <= 0)
     {
         alert("Please enter CAUSE OF DEATH");
         field.focus();field.select();
         return false
     }
-  
+  */
     return true;
 }
 
@@ -1803,6 +3198,186 @@
     }
 }
 
+function loadDeathCuases( recordNo )
+{
+    var field = document.getElementById( 'value[1031].value:value[' + recordNo + '].value' );
+    
+    clearList( field );
+    
+    //alert("inside Adults");
+    
+    field.options[0] = new Option( "---", "NK" , false, false);
+    field.options[1] = new Option( "A01-DIARRHOEAL DISEASE", "DIADIS" , false, false);
+    field.options[2] = new Option( "A02-TUBERCULOSIS", "TUBER" , false, false);
+    field.options[3] = new Option( "A03-RESPIRATORY DISEASES INCLUDING INFECTION (OTHER THAN TB)", "RID" , false, false);
+    field.options[4] = new Option( "A04-MALARIA", "MALARIA" , false, false);
+    field.options[5] = new Option( "A05-OTHER FEVER RELATED", "OFR" , false, false);
+    field.options[6] = new Option( "A06-HIV/AIDS", "HIVAIDS" , false, false);
+    field.options[7] = new Option( "A07-HEART DISEASE/HYPERTENSION RELATED", "HDH" , false, false);
+    field.options[8] = new Option( "A08-NEUROLOGICAL DISEASE INCLUDING STROKE", "SND" , false, false);
+    field.options[9] = new Option( "A09-TRANUMA/ACCIDENTS/BURN CASES", "AI" , false, false);
+    field.options[10] = new Option( "A10-SUICIDES", "SUICIDES" , false, false);
+    field.options[11] = new Option( "A11-ANIMAL BITES AND STINGS", "ABS" , false, false);
+    field.options[12] = new Option( "A12-KNOWN ACUTE DISEASE", "OKAD" , false, false);
+    field.options[13] = new Option( "A13-KNOWN CHRONIC DISEASE", "OKCD" , false, false);
+    field.options[14] = new Option( "A14-NOT KNOWN", "NK" , false, false);
+    
+    
+    /*
+    field.options[5] = new Option( "Pregnancy Related Death( maternal mortality)", "PRD" , false, false);
+    field.options[6] = new Option( "Sterilisation related deaths", "SRD" , false, false);
+    field.options[10] = new Option( "Respiratory Infections and Disease", "RID" , false, false);
+    field.options[13] = new Option( "Meconium aspiration syndrome", "MAS" , false, false);
+    field.options[14] = new Option( "Meningitis", "MENINGITIS" , false, false);
+    field.options[15] = new Option( "Major Congenital Malformation", "MCM" , false, false);
+    field.options[16] = new Option( "Prematurity", "PREMATURITY" , false, false);
+    field.options[17] = new Option( "Hypothermia", "HYPOTHERMIA" , false, false);
+    field.options[18] = new Option( "Diptheria", "DIPTHERIA" , false, false);
+    field.options[19] = new Option( "Childhood Tuberculosis", "CHILDTUBERCULOSIS" , false, false);
+    field.options[20] = new Option( "Dysentry", "DYSENTRY" , false, false);
+    field.options[21] = new Option( "Pertusis", "PERTUSIS" , false, false);
+    field.options[22] = new Option( "Polio", "POLIO" , false, false);
+    field.options[23] = new Option( "Tetanus Neonatorum", "TETANUSNEONATORUM" , false, false);
+    field.options[24] = new Option( "Tetanus (Others)", "TETANUSOTHERS" , false, false);
+    field.options[25] = new Option( "Acute Flaccide Paralysis", "AFP" , false, false);
+    field.options[26] = new Option( "Respiratory Infections (other than TB)", "RIOTHERTB" , false, false);
+    field.options[29] = new Option( "Others", "OTHERS" , false, false);
+    */
+    
+    /*
+    <option value="TUBER"></option>
+    <option value="MALARIA"></option>
+    <option value="HIVAIDS"></option>
+    <option value="PRD"></option>
+    <option value="SRD"></option>
+    <option value="AI"></option>
+    
+    <option value="SUICIDES"></option>
+    
+    <option value="ABS"></option>
+    
+    <option value="RID"></option>
+    
+    <option value="HDH"></option>
+    
+    <option value="SND"></option>
+    
+    <option value="MAS"></option>
+    <option value="MENINGITIS"></option>
+    <option value="MCM"></option>
+    
+    <option value="PREMATURITY"></option>
+    
+    <option value="HYPOTHERMIA"></option>
+    
+    <option value="DIPTHERIA"></option>
+    
+    <option value="CHILDTUBERCULOSIS"></option>
+    
+    <option value="DYSENTRY"></option>
+    
+    <option value="PERTUSIS"></option>
+    
+    <option value="POLIO"></option>
+    
+    <option value="TETANUSNEONATORUM"></option>
+    
+    <option value="TETANUSOTHERS"></option>
+    
+    <option value="AFP"></option>
+    
+    <option value="RIOTHERTB"></option>
+    <option value="OKAD"></option>
+    <option value="OKCD"></option>
+    
+    <option value="NK"></option>
+	*/
+}
+
+function loadInfantCauses( recordNo )
+{
+    var field = document.getElementById( 'value[1031].value:value[' + recordNo + '].value' );
+    
+    clearList( field );
+    //alert("inside infants");
+    
+    field.options[0] = new Option( "---", "OTHERS" , false, false);
+    field.options[1] = new Option( "C02-SEPSIS", "SEPSIS" , false, false);
+    field.options[2] = new Option( "C03-ASPHYXIA", "ASPHYXIA" , false, false);
+    field.options[3] = new Option( "C04-LOWBIRTHWEIGHT", "LOWBIRTHWEIGH" , false, false);
+    field.options[4] = new Option( "C09-OTHERS", "OTHERS" , false, false);
+    
+    /*
+    $(field).append("<option value='"+ "NONE" +"'>"+ "---" + "</option>");
+    $(field).append("<option value='"+ "SEPSIS" +"'>"+"SEPSIS"+"</option>");
+    $(field).append("<option value='"+ "ASPHYXIA" +"'>"+"ASPHYXIA"+"</option>");
+    $(field).append("<option value='"+ "LOWBIRTHWEIGH" +"'>"+"LOWBIRTHWEIGHT"+"</option>");
+    $(field).append("<option value='"+ "PNEUMONIA" +"'>"+"Pneumonia"+"</option>");
+    $(field).append("<option value='"+ "DIADIS" +"'>"+"Diarrhoeal Disease"+"</option>");
+    $(field).append("<option value='"+ "OFR" +"'>"+"Fever/ Other Fever related"+"</option>");
+    $(field).append("<option value='"+ "MEASLES" +"'>"+"Measles"+"</option>");
+    $(field).append("<option value='"+ "OTHERS" +"'>"+"Others"+"</option>");
+    */
+    
+    /*
+    for( var i=0; i <= field.options.length; i++ )
+    {
+    	
+    }
+    */
+    // Add infant options
+    /*
+    <option value="NONE">---</option>
+    <option value="SEPSIS">C02 SEPSIS</option>
+    <option value="ASPHYXIA">C03 ASPHYXIA</option>    
+    <option value="LOWBIRTHWEIGH">C04 LOWBIRTHWEIGHT</option>    
+    <option value="PNEUMONIA">C05 Pneumonia</option>
+    <option value="DIADIS">C06 Diarrhoeal Disease</option>
+    <option value="OFR">C07 Fever/ Other Fever related</option>
+    <option value="MEASLES">C08 Measles</option>
+    <option value="OTHERS">C09 Others</option>
+    */
+	
+}
+
+
+function loadInfantCausesWithin24Hour( recordNo )
+{
+    var field = document.getElementById( 'value[1031].value:value[' + recordNo + '].value' );
+    
+    clearList( field );
+    //alert("inside infants");
+    
+    field.options[0] = new Option( "---", "OTHERS" , false, false);
+    field.options[1] = new Option( "C01-WITHIN 24 HOURS OF BIRTH", "WITHIN24HOURSOFBIRTH" , false, false);
+}
+
+
+
+
+
+
+
+function loadDeathCauses1YearTo5Year( recordNo )
+{
+    var field = document.getElementById( 'value[1031].value:value[' + recordNo + '].value' );
+    
+    clearList( field );
+   
+    
+    field.options[0] = new Option( "---", "OTHERS" , false, false);
+    field.options[1] = new Option( "C05-PNEUMONIA", "PNEUMONIA" , false, false);
+    field.options[2] = new Option( "C06-DIARRHOEA", "DIADIS" , false, false);
+    field.options[3] = new Option( "C07-FEVER RELATED", "OFR" , false, false);
+    field.options[4] = new Option( "C08-MEASLES", "MEASLES" , false, false);
+    field.options[5] = new Option( "C09-OTHERS", "OTHERS" , false, false);
+    
+}
+
+
+
+
+
 function validateLLDAgeCategoryField( dataElementId, recordNo )
 {
     var field = document.getElementById( 'value[' + dataElementId + '].value:value[' + recordNo + '].value' );
@@ -1823,9 +3398,38 @@
         }
         else
         {
+        	var selVal = field.options[ resVal ].value;
+        	
+        	if( selVal == "B1DAY" )
+        	{
+        		loadInfantCausesWithin24Hour( recordNo );
+        	}
+        	
+        	
+        	else if( selVal == "B1WEEK" || selVal == "B1MONTH" )
+        	{
+        		loadInfantCauses( recordNo );
+        	}
+        	
+        	else if( selVal == "B1YEAR" || selVal == "B5YEAR" )
+        	{
+        		loadDeathCauses1YearTo5Year( recordNo );
+        	}
+        	
+        	
+        	else
+        	{
+        		loadDeathCuases( recordNo )
+        	}
+        	
+            
+
             saveLLbirthValue( dataElementId, recordNo );
-            document.getElementById(recordNo).style.display = 'block';
-            document.getElementById('actions').style.display = 'block';
+            
+            var valueSaver1 = new ValueSaver( "1031:"+recordNo, "NONE", '#ccffcc' );
+            valueSaver1.save();
+            //document.getElementById(recordNo).style.display = 'block';
+            //document.getElementById('actions').style.display = 'block';
         }
     }
     else
@@ -1847,7 +3451,10 @@
         {
             alert("Please enter Cause for Death");
             field.options[0].selected = true;
-      
+			// change for HP Save OTHER or Cause Not Know
+			saveLLbirthValue( dataElementId, recordNo );
+			document.getElementById(recordNo).style.display = 'block';
+            document.getElementById('actions').style.display = 'block';
             //field.focus();
             setTimeout(function(){
                 field.focus();field.select();
@@ -2283,7 +3890,11 @@
         {
             alert("Please Enter Cuase for Death");
             field.options[0].selected = true;
-      
+			// change for HP Save OTHER or Cause Not Know
+			
+			saveLLbirthValue( dataElementId, recordNo );
+            document.getElementById(recordNo).style.display = 'block';
+            document.getElementById('actions').style.display = 'block';
             // field.focus();
             setTimeout(function(){
                 field.focus();field.select();

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/llbirthForm.vm'
--- local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/llbirthForm.vm	2011-10-13 09:13:08 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/llbirthForm.vm	2013-09-18 10:12:26 +0000
@@ -118,6 +118,9 @@
                 ##if( !$locked ) <img src="../images/calendar_icon.gif" width="16" height="16" id="getvalue[$llDataValue.getDataElement().getId()].value:value[$llDataValue.getRecordNo()].value" cursor: pointer;" title="$i18n.getString( "date_selector" )" onmouseover="this.style.background='orange';" onmouseout="this.style.background=''"> #end
 				#if( !$locked ) <script type="text/javascript"> datePicker('value\\[$llDataValue.getDataElement().getId()\\]\\.value\\:value\\[$llDataValue.getRecordNo()\\]\\.value', false); </script> #end	
            </td>
+           
+           
+           
             ##set($calInfo = $calInfo + "Calendar.setup({inputField:'value["+$llDataValue.getDataElement().getId()+"].value:value["+$llDataValue.getRecordNo()+"].value',ifFormat:'$i18n.getString('format.date.label')',button:'getvalue["+$llDataValue.getDataElement().getId()+"].value:value["+$llDataValue.getRecordNo()+"].value'});")
         #elseif($count1 == 1)
             <td align="center"><div id="value[$llDataValue.getDataElement().getId()].value:value[$llDataValue.getRecordNo()].slno" align='center'>$slno</div></td>

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/lldeathForm.vm'
--- local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/lldeathForm.vm	2010-08-31 07:51:06 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/lldeathForm.vm	2013-12-02 07:34:35 +0000
@@ -48,10 +48,10 @@
     	oCell.innerHTML = "<select name='entryfield' id='value[1029].value:value["+nextRecordNo+"].value' onchange='validateLLDSexField(1029,"+nextRecordNo+")' onkeypress='return keyPress(event, this)' style='width:100% text-align:center'><option value='NONE' selected>---</option><option value='M'>Male</option><option value='F'>Female</option></select>";    	
 
     	oCell = newRow.insertCell(4);
-    	oCell.innerHTML = "<select name='entryfield' id='value[1030].value:value["+nextRecordNo+"].value' onchange='validateLLDAgeCategoryField(1030,"+nextRecordNo+")' onkeypress='return keyPress(event, this)' style='width:100% text-align:center'><option value='NONE' selected>---</option><option value='B1DAY'>BELOW 1 DAY</option><option value='B1WEEK'>1 DAY - 1 WEEK</option><option value='B1MONTH'>1 WEEK - 1 MONTH</option><option value='B1YEAR'>1 MONTH - 1 YEAR</option><option value='B5YEAR'>1 YEAR - 5 YEARS</option><option value='O5YEAR'>6 YEARS - 14 YEARS</option><option value='O15YEAR'>15 YEARS - 55 YEARS</option><option value='O55YEAR'>OVER 55 YEARS</option></select>";
+    	oCell.innerHTML = "<select name='entryfield' id='value[1030].value:value["+nextRecordNo+"].value' onchange='validateLLDAgeCategoryField(1030,"+nextRecordNo+")' onkeypress='return keyPress(event, this)' style='width:275px;'><option value='NONE' selected>---</option><option value='B1DAY'>BELOW 1 DAY</option><option value='B1WEEK'>1 DAY - 1 WEEK</option><option value='B1MONTH'>1 WEEK - 1 MONTH</option><option value='B1YEAR'>1 MONTH - 1 YEAR</option><option value='B5YEAR'>1 YEAR - 5 YEARS</option><option value='O5YEAR'>6 YEARS - 14 YEARS</option><option value='O15YEAR'>15 YEARS - 55 YEARS</option><option value='O55YEAR'>OVER 55 YEARS</option></select>";
     		    	        	
     	oCell = newRow.insertCell(5);
-    	oCell.innerHTML = "<select name='entryfield' id='value[1031].value:value["+nextRecordNo+"].value' onchange='validateLLDPCDField(1031,"+nextRecordNo+")' onkeypress='return keyPress(event, this)' style='width:100% text-align:center'><option value='NONE'>---</option><option value='ASPHYXIA'>ASPHYXIA</option><option value='SEPSIS'>SEPSIS</option><option value='LOWBIRTHWEIGH'>LOWBIRTHWEIGHT</option><option value='IMMREAC'>Immunization reactions</option><option value='PNEUMONIA'>Pneumonia</option><option value='DIADIS'>Diarrhoeal Disease</option><option value='MEASLES'>Measles</option><option value='TUBER'>Tuberculosis</option><option value='MALARIA'>Malaria</option><option value='HIVAIDS'>HIV/AIDS</option><option value='OFR'>Other Fever related</option><option value='PRD'>Pregnancy Related Death( maternal mortality)</option><option value='SRD'>Sterilisation related deaths</option><option value='AI'>Accidents or Injuries</option><option value='SUICIDES'>Suicides</option><option value='ABS'>Animal Bites or Stings</option><option value='RID'>Respiratory Infections and Disease</option><option value='HDH'>Heart Disease and hypertension</option><option value='SND'>Stroke and Neurological Disease</option><option value='OKAD'>Other Known Acute Disease</option><option value='OKCD'>Other Known Chronic Disease</option><option value='OTHERS'>Others</option><option value='NK'>NOT KNOWN</option></select>";    	    	
+    	oCell.innerHTML = "<select name='entryfield' id='value[1031].value:value["+nextRecordNo+"].value' onchange='validateLLDPCDField(1031,"+nextRecordNo+")' onkeypress='return keyPress(event, this)' style='width:275px;'><option value='NK'>---</option><option value='WITHIN24HOURSOFBIRTH'>C01-WITHIN 24 HOURS OF BIRTH</option><option value='SEPSIS'>C02-SEPSIS</option><option value='ASPHYXIA'>C03-ASPHYXIA</option><option value='LOWBIRTHWEIGH'>C04-LOWBIRTHWEIGHT</option><option value='PNEUMONIA'>C05-PNEUMONIA</option><option value='DIADIS'>C06-DIARRHOEA</option><option value='OFR'>C07-FEVER RELATED</option><option value='MEASLES'>C08-MEASLES</option><option value='OTHERS'>C09-OTHERS</option><option value='DIADIS'>A01-DIARRHOEAL DISEASE</option><option value='TUBER'>A02-TUBERCULOSIS</option><option value='RID'>A03-RESPIRATORY DISEASES INCLUDING INFECTION (OTHER THAN TB)</option><option value='MALARIA'>A04-MALARIA</option><option value='OFR'>A05-OTHER FEVER RELATED</option><option value='HIVAIDS'>A06-HIV/AIDS</option><option value='HDH'>A07-HEART DISEASE/HYPERTENSION RELATED</option><option value='SND'>A08-NEUROLOGICAL DISEASE INCLUDING STROKE</option><option value='AI'>A09-TRANUMA/ACCIDENTS/BURN CASES</option><option value='SUICIDES'>A10-SUICIDES</option><option value='ABS'>A11-ANIMAL BITES AND STINGS</option><option value='OKAD'>A12-KNOWN ACUTE DISEASE</option><option value='OKCD'>A13-KNOWN CHRONIC DISEASE</option><option value='NK'>A14-NOT KNOWN</option></select>";    	    	
 	
         oCell = newRow.insertCell(6);
         oCell.innerHTML = "<div id='"+nextRecordNo+"' style='display: none;'><a href='javascript:removeLLRecord( "+ nextRecordNo +" )' title='remove'><img src='../images/delete.png' alt='remove'></a></div>";
@@ -67,11 +67,11 @@
 <table id="tblGrid" width="100%">
 	<tr>
 		<th width="3%">Sl. No.</th>
-		<th width="24%">Name of Child<br>(If under 5 month specify Mother/Father Name)</th>
-		<th width="24%">Village</th>
+		<th width="29%">Name of the Person<br>(If reporting death of child below 5 months, please specify Mother/Father's name)</th>
+		<th width="29%">Village</th>
 		<th width="7%">Sex</th>
 		<th width="20%">Age Category</th>
-		<th width="20%">Probable Cause of death</th>
+		<th width="10%">Probable Cause of death</th>
 		<th width="2%">&nbsp;</th>		
 	</tr>
 
@@ -82,7 +82,7 @@
 	<tr>
 	#set($llDataValues = $lldataValueMap.get($mapKey))
 	#set($count1 = 1)
-	
+	#set($ageCategory = "" )
 	#foreach( $llDataValue in $llDataValues)
 		#if($count1 == 3)
 			<td>
@@ -94,7 +94,8 @@
 			</td>			
 		#elseif($count1 == 4)
 			<td>
-				<select name="entryfield" id="value[$llDataValue.getDataElement().getId()].value:value[$llDataValue.getRecordNo()].value" onchange="validateLLDAgeCategoryField($llDataValue.getDataElement().getId(),$llDataValue.getRecordNo())" onkeypress="return keyPress(event, this)" style="width:100% text-align:center" #if( $locked ) disabled="disabled"#end>
+				#set( $ageCategory = $llDataValue.getValue() )
+				<select name="entryfield" id="value[$llDataValue.getDataElement().getId()].value:value[$llDataValue.getRecordNo()].value" onchange="validateLLDAgeCategoryField($llDataValue.getDataElement().getId(),$llDataValue.getRecordNo())" onkeypress="return keyPress(event, this)" style="width:275px;" text-align:center" #if( $locked ) disabled="disabled"#end>
 					<option value="NONE" #if(!$llDataValue.getValue() || $llDataValue.getValue()=="NONE") selected #end>---</option>
 					<option value="B1DAY" #if($llDataValue.getValue() && $llDataValue.getValue()=="B1DAY") selected #end>BELOW 1 DAY</option>
 					<option value="B1WEEK" #if($llDataValue.getValue() && $llDataValue.getValue()=="B1WEEK") selected #end>1 DAY - 1 WEEK</option>
@@ -108,19 +109,96 @@
 			</td>
 		#elseif($count1 == 5)
 			<td>
+				
+				<!-- added for Haryana -->
+				#if( $ageCategory == "B1DAY" )
+					<select name="entryfield" id="value[$llDataValue.getDataElement().getId()].value:value[$llDataValue.getRecordNo()].value" onchange="validateLLDPCDField($llDataValue.getDataElement().getId(),$llDataValue.getRecordNo())" onkeypress="return keyPress(event, this)" style="width:275px;" #if( $locked ) disabled="disabled"#end>
+						<option value="OTHERS" #if(!$llDataValue.getValue() || $llDataValue.getValue()=="OTHERS") selected #end>---</option>
+						<option value="SEPSIS" #if($llDataValue.getValue() && $llDataValue.getValue()=="WITHIN24HOURSOFBIRTH") selected #end>C01-WITHIN 24 HOURS OF BIRTH</option>
+					</select>				
+				<!-- -->
+				
+				#elseif( $ageCategory == "B1WEEK" || $ageCategory == "B1MONTH" )
+					<select name="entryfield" id="value[$llDataValue.getDataElement().getId()].value:value[$llDataValue.getRecordNo()].value" onchange="validateLLDPCDField($llDataValue.getDataElement().getId(),$llDataValue.getRecordNo())" onkeypress="return keyPress(event, this)" style="width:275px;" #if( $locked ) disabled="disabled"#end>
+						<option value="OTHERS" #if(!$llDataValue.getValue() || $llDataValue.getValue()=="OTHERS") selected #end>---</option>
+						<option value="SEPSIS" #if($llDataValue.getValue() && $llDataValue.getValue()=="SEPSIS") selected #end>C02-SEPSIS</option>
+						<option value="ASPHYXIA" #if($llDataValue.getValue() && $llDataValue.getValue()=="ASPHYXIA") selected #end>C03-ASPHYXIA</option>					
+						<option value="LOWBIRTHWEIGH" #if($llDataValue.getValue() && $llDataValue.getValue()=="LOWBIRTHWEIGH") selected #end>C04-LOWBIRTHWEIGHT</option>
+						<option value="OTHERS" #if($llDataValue.getValue() && $llDataValue.getValue()=="OTHERS") selected #end>C09-OTHERS</option>
+					</select>
+				
+				#elseif( $ageCategory == "B1YEAR"  || $ageCategory == "B5YEAR" )
+					<select name="entryfield" id="value[$llDataValue.getDataElement().getId()].value:value[$llDataValue.getRecordNo()].value" onchange="validateLLDPCDField($llDataValue.getDataElement().getId(),$llDataValue.getRecordNo())" onkeypress="return keyPress(event, this)" style="width:275px;" #if( $locked ) disabled="disabled"#end>
+						<option value="OTHERS" #if(!$llDataValue.getValue() || $llDataValue.getValue()=="OTHERS") selected #end>---</option>
+						<option value="PNEUMONIA" #if($llDataValue.getValue() && $llDataValue.getValue()=="PNEUMONIA") selected #end>C05-PNEUMONIA</option>
+						<option value="DIADIS" #if($llDataValue.getValue() && $llDataValue.getValue()=="DIADIS") selected #end>C06-DIARRHOEA</option>
+						<option value="OFR" #if($llDataValue.getValue() && $llDataValue.getValue()=="OFR") selected #end>C07-FEVER RELATED</option>
+						<option value="MEASLES" #if($llDataValue.getValue() && $llDataValue.getValue()=="MEASLES") selected #end>C08-MEASLES</option>
+						<option value="OTHERS" #if($llDataValue.getValue() && $llDataValue.getValue()=="OTHERS") selected #end>C09-OTHERS</option>
+					</select>				
+				
+				#else
+					<select name="entryfield" id="value[$llDataValue.getDataElement().getId()].value:value[$llDataValue.getRecordNo()].value" onchange="validateLLDPCDField($llDataValue.getDataElement().getId(),$llDataValue.getRecordNo())" onkeypress="return keyPress(event, this)" style="width:275px;" #if( $locked ) disabled="disabled"#end>
+						<option value="NK" #if(!$llDataValue.getValue() || $llDataValue.getValue()=="NK") selected #end>---</option>
+						<option value="DIADIS" #if($llDataValue.getValue() && $llDataValue.getValue()=="DIADIS") selected #end>A01-DIARRHOEAL DISEASE</option>
+						<option value="TUBER" #if($llDataValue.getValue() && $llDataValue.getValue()=="TUBER") selected #end>A02-TUBERCULOSIS</option>
+						<option value="RID" #if($llDataValue.getValue() && $llDataValue.getValue()=="RID") selected #end>A03-RESPIRATORY DISEASES INCLUDING INFECTION (OTHER THAN TB)</option>
+						<option value="MALARIA" #if($llDataValue.getValue() && $llDataValue.getValue()=="MALARIA") selected #end>A04-MALARIA</option>
+						<option value="OFR" #if($llDataValue.getValue() && $llDataValue.getValue()=="OFR") selected #end>A05-OTHER FEVER RELATED</option>
+						<option value="HIVAIDS" #if($llDataValue.getValue() && $llDataValue.getValue()=="HIVAIDS") selected #end>A06-HIV/AIDS</option>
+						<option value="HDH" #if($llDataValue.getValue() && $llDataValue.getValue()=="HDH") selected #end>A07-HEART DISEASE/HYPERTENSION RELATED</option>
+						<option value="SND" #if($llDataValue.getValue() && $llDataValue.getValue()=="SND") selected #end>A08-NEUROLOGICAL DISEASE INCLUDING STROKE</option>
+						<option value="AI" #if($llDataValue.getValue() && $llDataValue.getValue()=="AI") selected #end>A09-TRANUMA/ACCIDENTS/BURN CASES</option>
+						<option value="SUICIDES" #if($llDataValue.getValue() && $llDataValue.getValue()=="SUICIDES") selected #end>A10-SUICIDES</option>
+						<option value="ABS" #if($llDataValue.getValue() && $llDataValue.getValue()=="ABS") selected #end>A11-ANIMAL BITES AND STINGS</option>
+						<option value="OKAD" #if($llDataValue.getValue() && $llDataValue.getValue()=="OKAD") selected #end>A12-KNOWN ACUTE DISEASE</option>
+						<option value="OKCD" #if($llDataValue.getValue() && $llDataValue.getValue()=="OKCD") selected #end>A13-KNOWN CHRONIC DISEASE</option>
+						<option value="NK" #if($llDataValue.getValue() && $llDataValue.getValue()=="NK") selected #end>A14-NOT KNOWN</option>
+						
+						<!--
+						<option value="PRD" #if($llDataValue.getValue() && $llDataValue.getValue()=="PRD") selected #end>Pregnancy Related Death( maternal mortality)</option>
+						<option value="SRD" #if($llDataValue.getValue() && $llDataValue.getValue()=="SRD") selected #end>Sterilisation related deaths</option>
+						<option value="RID" #if($llDataValue.getValue() && $llDataValue.getValue()=="RID") selected #end>Respiratory Infections and Disease</option>
+						<option value="MAS" #if($llDataValue.getValue() && $llDataValue.getValue()=="MAS") selected #end>Meconium aspiration syndrome</option> 
+						<option value="MENINGITIS" #if($llDataValue.getValue() && $llDataValue.getValue()=="MENINGITIS") selected #end>Meningitis</option>
+						<option value="MCM" #if($llDataValue.getValue() && $llDataValue.getValue()=="MCM") selected #end>Major Congenital Malformation</option>
+						<option value="PREMATURITY" #if($llDataValue.getValue() && $llDataValue.getValue()=="PREMATURITY") selected #end>Prematurity</option>
+						<option value="HYPOTHERMIA" #if($llDataValue.getValue() && $llDataValue.getValue()=="HYPOTHERMIA") selected #end>Hypothermia</option>
+						<option value="DIPTHERIA" #if($llDataValue.getValue() && $llDataValue.getValue()=="DIPTHERIA") selected #end>Diptheria</option>
+						<option value="CHILDTUBERCULOSIS" #if($llDataValue.getValue() && $llDataValue.getValue()=="CHILDTUBERCULOSIS") selected #end>Childhood Tuberculosis</option>
+						<option value="DYSENTRY" #if($llDataValue.getValue() && $llDataValue.getValue()=="DYSENTRY") selected #end>Dysentry</option>
+						<option value="PERTUSIS" #if($llDataValue.getValue() && $llDataValue.getValue()=="PERTUSIS") selected #end>Pertusis</option>
+						<option value="POLIO" #if($llDataValue.getValue() && $llDataValue.getValue()=="POLIO") selected #end>Polio</option>
+						<option value="TETANUSNEONATORUM" #if($llDataValue.getValue() && $llDataValue.getValue()=="TETANUSNEONATORUM") selected #end>Tetanus Neonatorum</option>
+						<option value="TETANUSOTHERS" #if($llDataValue.getValue() && $llDataValue.getValue()=="TETANUSOTHERS") selected #end>Tetanus (Others)</option>
+						<option value="AFP" #if($llDataValue.getValue() && $llDataValue.getValue()=="AFP") selected #end>Acute Flaccide paralysis</option>
+						<option value="OTHERS" #if($llDataValue.getValue() && $llDataValue.getValue()=="OTHERS") selected #end>Others</option>            					
+						-->						
+					</select>	
+					
+				#end
+				
+				<!--
 				<select name="entryfield" id="value[$llDataValue.getDataElement().getId()].value:value[$llDataValue.getRecordNo()].value" onchange="validateLLDPCDField($llDataValue.getDataElement().getId(),$llDataValue.getRecordNo())" onkeypress="return keyPress(event, this)" style="width:100% text-align:center" #if( $locked ) disabled="disabled"#end>
+					
 					<option value="NONE" #if(!$llDataValue.getValue() || $llDataValue.getValue()=="NONE") selected #end>---</option>
 					<option value="ASPHYXIA" #if($llDataValue.getValue() && $llDataValue.getValue()=="ASPHYXIA") selected #end>ASPHYXIA</option>					
 					<option value="SEPSIS" #if($llDataValue.getValue() && $llDataValue.getValue()=="SEPSIS") selected #end>SEPSIS</option>
-					<option value="LOWBIRTHWEIGH" #if($llDataValue.getValue() && $llDataValue.getValue()=="LOWBIRTHWEIGH") selected #end>LOWBIRTHWEIGHT</option>
-					<option value="IMMREAC" #if($llDataValue.getValue() && $llDataValue.getValue()=="IMMREAC") selected #end>Immunization reactions</option>
+					<option value="LOWBIRTHWEIGH" #if($llDataValue.getValue() && $llDataValue.getValue()=="LOWBIRTHWEIGH") selected #end>LOWBIRTHWEIGHT</option>-->
+					<!--<option value="IMMREAC" #if($llDataValue.getValue() && $llDataValue.getValue()=="IMMREAC") selected #end>Immunization reactions</option>-->
+					
+					<!--
 					<option value="PNEUMONIA" #if($llDataValue.getValue() && $llDataValue.getValue()=="PNEUMONIA") selected #end>Pneumonia</option>
 					<option value="DIADIS" #if($llDataValue.getValue() && $llDataValue.getValue()=="DIADIS") selected #end>Diarrhoeal Disease</option>
 					<option value="MEASLES" #if($llDataValue.getValue() && $llDataValue.getValue()=="MEASLES") selected #end>Measles</option>
+					<option value="OFR" #if($llDataValue.getValue() && $llDataValue.getValue()=="OFR") selected #end>Fever/ Other Fever related</option>
+					
+					-->
+					<!--
 					<option value="TUBER" #if($llDataValue.getValue() && $llDataValue.getValue()=="TUBER") selected #end>Tuberculosis</option>
 					<option value="MALARIA" #if($llDataValue.getValue() && $llDataValue.getValue()=="MALARIA") selected #end>Malaria</option>
 					<option value="HIVAIDS" #if($llDataValue.getValue() && $llDataValue.getValue()=="HIVAIDS") selected #end>HIV/AIDS</option>
-					<option value="OFR" #if($llDataValue.getValue() && $llDataValue.getValue()=="OFR") selected #end>Other Fever related</option>
+					<option value="OFR" #if($llDataValue.getValue() && $llDataValue.getValue()=="OFR") selected #end>Fever/ Other Fever related</option>
 					<option value="PRD" #if($llDataValue.getValue() && $llDataValue.getValue()=="PRD") selected #end>Pregnancy Related Death( maternal mortality)</option>
 					<option value="SRD" #if($llDataValue.getValue() && $llDataValue.getValue()=="SRD") selected #end>Sterilisation related deaths</option>
 					<option value="AI" #if($llDataValue.getValue() && $llDataValue.getValue()=="AI") selected #end>Accidents or Injuries</option>
@@ -129,11 +207,31 @@
 					<option value="RID" #if($llDataValue.getValue() && $llDataValue.getValue()=="RID") selected #end>Respiratory Infections and Disease</option>
 					<option value="HDH" #if($llDataValue.getValue() && $llDataValue.getValue()=="HDH") selected #end>Heart Disease and hypertension</option>
 					<option value="SND" #if($llDataValue.getValue() && $llDataValue.getValue()=="SND") selected #end>Stroke and Neurological Disease</option>
+					-->
+					<!--<option value="FEVERRELATED" #if($llDataValue.getValue() && $llDataValue.getValue()=="FEVERRELATED") selected #end>Fever related</option>-->
+					<!-- add option for Haryana From -->
+					<!--
+					<option value="MAS" #if($llDataValue.getValue() && $llDataValue.getValue()=="MAS") selected #end>Meconium aspiration syndrome</option> 
+					<option value="MENINGITIS" #if($llDataValue.getValue() && $llDataValue.getValue()=="MENINGITIS") selected #end>Meningitis</option>
+					<option value="MCM" #if($llDataValue.getValue() && $llDataValue.getValue()=="MCM") selected #end>Major Congenital Malformation</option>
+					<option value="PREMATURITY" #if($llDataValue.getValue() && $llDataValue.getValue()=="PREMATURITY") selected #end>Prematurity</option>
+					<option value="HYPOTHERMIA" #if($llDataValue.getValue() && $llDataValue.getValue()=="HYPOTHERMIA") selected #end>Hypothermia</option>
+					<option value="DIPTHERIA" #if($llDataValue.getValue() && $llDataValue.getValue()=="DIPTHERIA") selected #end>Diptheria</option>
+					<option value="CHILDTUBERCULOSIS" #if($llDataValue.getValue() && $llDataValue.getValue()=="CHILDTUBERCULOSIS") selected #end>Childhood Tuberculosis</option>
+					<option value="DYSENTRY" #if($llDataValue.getValue() && $llDataValue.getValue()=="DYSENTRY") selected #end>Dysentry</option>
+					<option value="PERTUSIS" #if($llDataValue.getValue() && $llDataValue.getValue()=="PERTUSIS") selected #end>Pertusis</option>
+					<option value="POLIO" #if($llDataValue.getValue() && $llDataValue.getValue()=="POLIO") selected #end>Polio</option>
+					<option value="TETANUSNEONATORUM" #if($llDataValue.getValue() && $llDataValue.getValue()=="TETANUSNEONATORUM") selected #end>Tetanus Neonatorum</option>
+					<option value="TETANUSOTHERS" #if($llDataValue.getValue() && $llDataValue.getValue()=="TETANUSOTHERS") selected #end>Tetanus (Others)</option>
+					<option value="AFP" #if($llDataValue.getValue() && $llDataValue.getValue()=="AFP") selected #end>Acute Flaccide paralysis</option>
+					<option value="RIOTHERTB" #if($llDataValue.getValue() && $llDataValue.getValue()=="RIOTHERTB") selected #end>Respiratory Infections (other than TB)</option>
 					<option value="OKAD" #if($llDataValue.getValue() && $llDataValue.getValue()=="OKAD") selected #end>Other Known Acute Disease</option>
 					<option value="OKCD" #if($llDataValue.getValue() && $llDataValue.getValue()=="OKCD") selected #end>Other Known Chronic Disease</option>
 					<option value="OTHERS" #if($llDataValue.getValue() && $llDataValue.getValue()=="OTHERS") selected #end>Others</option>            					
 					<option value="NK" #if($llDataValue.getValue() && $llDataValue.getValue()=="NK") selected #end>NOT KNOWN</option>
+					
 				</select>
+				-->
 			</td>
             <td #if( $locked ) style="display:none" #end>
                 <a href="javascript:removeLLRecord( '$llDataValue.getRecordNo()' )" title="$i18n.getString( "remove" )"><img src="../images/delete.png" alt="$i18n.getString( "remove" )"></a>
@@ -163,7 +261,7 @@
 		</select>		
 	</td>	
 	<td>
-		<select name="entryfield" id="value[1030].value:value[$recordNo].value" onchange="validateLLDAgeCategoryField(1030,$recordNo)" onkeypress="return keyPress(event, this)" style="width:100% text-align:center">
+		<select name="entryfield" id="value[1030].value:value[$recordNo].value" onchange="validateLLDAgeCategoryField(1030,$recordNo)" onkeypress="return keyPress(event, this)" style="width:275px;" text-align:center">
 			<option value="NONE" selected>---</option>
 			<option value="B1DAY">BELOW 1 DAY</option>
 			<option value="B1WEEK">1 DAY - 1 WEEK</option>
@@ -176,19 +274,43 @@
 		</select>	
 	</td>	
 	<td>
-		<select name="entryfield" id="value[1031].value:value[$recordNo].value" onchange="validateLLDPCDField(1031,$recordNo)" onkeypress="return keyPress(event, this)" style="width:100% text-align:center">
-			<option value="NONE">---</option>
-			<option value="ASPHYXIA">ASPHYXIA</option>			
-			<option value="SEPSIS">SEPSIS</option>
-			<option value="LOWBIRTHWEIGH">LOWBIRTHWEIGHT</option>			
-			<option value="IMMREAC">Immunization reactions</option>
-			<option value="PNEUMONIA">Pneumonia</option>
-			<option value="DIADIS">Diarrhoeal Disease</option>
-			<option value="MEASLES">Measles</option>
+		<select name="entryfield" id="value[1031].value:value[$recordNo].value" onchange="validateLLDPCDField(1031,$recordNo)" onkeypress="return keyPress(event, this)" style="width:275px;">
+			<option value="NK">---</option>
+			
+			<option value="WITHIN24HOURSOFBIRTH">C01-WITHIN 24 HOURS OF BIRTH</option>
+			<option value="SEPSIS">C02-SEPSIS</option>
+			<option value="ASPHYXIA">C03-ASPHYXIA</option>			
+			<option value="LOWBIRTHWEIGH">C04-LOWBIRTHWEIGHT</option>
+			<!--<option value="IMMREAC">Immunization reactions</option>-->
+			<option value="PNEUMONIA">C05-PNEUMONIA</option>
+			<option value="DIADIS">C06-DIARRHOEA</option>
+			<option value="OFR">C07-FEVER RELATED</option>
+			<option value="MEASLES">C08-MEASLES</option>
+			<option value="OTHERS">C09-OTHERS</option>	
+			
+			
+			<option value='DIADIS'>A01-DIARRHOEAL DISEASE</option>
+	    	<option value='TUBER'>A02-TUBERCULOSIS</option>
+	    	<option value='RID'>A03-RESPIRATORY DISEASES INCLUDING INFECTION (OTHER THAN TB)</option>
+	    	<option value='MALARIA'>A04-MALARIA</option>
+	    	<option value='OFR'>A05-OTHER FEVER RELATED</option>
+	    	<option value='HIVAIDS'>A06-HIV/AIDS</option>
+	    	<option value='HDH'>A07-HEART DISEASE/HYPERTENSION RELATED</option>
+	    	<option value='SND'>A08-NEUROLOGICAL DISEASE INCLUDING STROKE</option>
+	    	<option value='AI'>A09-TRANUMA/ACCIDENTS/BURN CASES</option>
+	    	<option value='SUICIDES'>A10-SUICIDES</option>
+	    	<option value='ABS'>A11-ANIMAL BITES AND STINGS</option>
+	    	<option value='OKAD'>A12-KNOWN ACUTE DISEASE</option>
+	    	<option value='OKCD'>A13-KNOWN CHRONIC DISEASE</option>
+	    	<option value='NK'>A14-NOT KNOWN</option>
+			
+			
+			
+			<!--
 			<option value="TUBER">Tuberculosis</option>
 			<option value="MALARIA">Malaria</option>
 			<option value="HIVAIDS">HIV/AIDS</option>
-			<option value="OFR">Other Fever related</option>
+			<option value="OFR">Fever/Other Fever related</option>
 			<option value="PRD">Pregnancy Related Death( maternal mortality)</option>
 			<option value="SRD">Sterilisation related deaths</option>
 			<option value="AI">Accidents or Injuries</option>
@@ -197,10 +319,34 @@
 			<option value="RID">Respiratory Infections and Disease</option>
 			<option value="HDH">Heart Disease and hypertension</option>
 			<option value="SND">Stroke and Neurological Disease</option>
+			<option value="DIADIS">Diarrhoea Disease</option>
+			<option value="FEVERRELATED">Fever related</option>
+			      
+			<option value="MAS">Meconium aspiration syndrome</option>-->     
+			<!-- add option for Haryana From -->
+			<!--
+			<option value="MENINGITIS">Meningitis</option>
+			<option value="MCM">Major Congenital Malformation</option>
+			<option value="PREMATURITY">Prematurity</option>
+			<option value="HYPOTHERMIA">Hypothermia</option>
+			<option value="DIPTHERIA">Diptheria</option>
+			<option value="CHILDTUBERCULOSIS">Childhood Tuberculosis</option>
+			<option value="DYSENTRY">Dysentry</option>
+			<option value="PERTUSIS">Pertusis</option>
+			<option value="POLIO">Polio</option>
+			<option value="TETANUSNEONATORUM">Tetanus Neonatorum</option>
+			<option value="TETANUSOTHERS">Tetanus (Others)</option>
+			<option value="AFP">Acute Flaccide paralysis</option>
+			<option value="RIOTHERTB">Respiratory Infections (other than TB)</option>
+			-->
+			<!-- add option for Haryana To-->
+			
+			<!--
 			<option value="OKAD">Other Known Acute Disease</option>
 			<option value="OKCD">Other Known Chronic Disease</option>
 			<option value="OTHERS">Others</option>						
 			<option value="NK">NOT KNOWN</option>
+			-->
 		</select>	
 	</td>
     <td>

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/llmdeathForm.vm'
--- local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/llmdeathForm.vm	2012-06-30 08:05:32 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/llmdeathForm.vm	2013-10-11 12:31:16 +0000
@@ -50,15 +50,22 @@
     
     	oCell = newRow.insertCell(4);
     	oCell.innerHTML = "<select name='entryfield' id='value[1035].value:value["+nextRecordNo+"].value' onchange='validateLLMDDuringField(1035,"+nextRecordNo+")' onkeypress='return keyPress(event, his)' style='width:100% text-align:center'><option value='NONE' selected>---</option><option value='FTP'>FIRST TRIMESTER PREGNANCY</option><option value='STP'>SECOND TRIMESTER PREGNANCY</option>	<option value='TTP'>THIRD TRIMESTER PREGNANCY</option><option value='DELIVERY'>DELIVERY</option><option value='ADW42D'>AFTER DELIVERY WITHIN 42 DAYS</option></select>";    	
-
+		
+		
     	oCell = newRow.insertCell(5);
     	oCell.innerHTML = "<select name='entryfield' id='value[1036].value:value["+nextRecordNo+"].value' onchange='validateLLMDDeliveryAtField(1036,"+nextRecordNo+")' onkeypress='return keyPress(event, this)' style='width:100% text-align:center'><option value='NONE'>---</option><option value='HOME'>HOME</option><option value='SC'>SUBCENTER</option><option value='PHC'>PHC</option><option value='CHC'>CHC</option><option value='MC'>DH/SDH/MEDICAL COLLEGE</option><option value='PVTINST'>PVT INST</option></select>";
-    		    	        	
+    	
+    	
+    	// hide for orissa PVTINST
+    	/*
+    	oCell = newRow.insertCell(5);
+    	oCell.innerHTML = "<select name='entryfield' id='value[1036].value:value["+nextRecordNo+"].value' onchange='validateLLMDDeliveryAtField(1036,"+nextRecordNo+")' onkeypress='return keyPress(event, this)' style='width:100% text-align:center'><option value='NONE'>---</option><option value='HOME'>HOME</option><option value='SC'>SUBCENTER</option><option value='PHC'>PHC</option><option value='CHC'>CHC</option><option value='MC'>DH/SDH/MEDICAL COLLEGE</option></select>";
+    	*/	    	        	
     	oCell = newRow.insertCell(6);
     	oCell.innerHTML = "<select name='entryfield' id='value[1037].value:value["+nextRecordNo+"].value' onchange='validateLLMDDeliveryByField(1037,"+nextRecordNo+")' onkeypress='return keyPress(event, this)' style='width:100% text-align:center'><option value='NONE' SELECTED>---</option><option value='UNTRAINED'>UNTRAINED</option><option value='TRAINED'>TRAINED</option><option value='ANM'>ANM</option><option value='NURSE'>NURSE</option><option value='DOCTOR'>DOCTOR</option><option value='OTHERS'>OTHERS</option></select>";    	    	
 
     	oCell = newRow.insertCell(7);
-    	oCell.innerHTML = "<select name='entryfield' id='value[1038].value:value["+nextRecordNo+"].value' onchange='validateLLMDCauseField(1038,"+nextRecordNo+")' onkeypress='return keyPress(event, this)' style='width:100% text-align:center'><option value='NONE' SELECTED>---</option><option value='ABORTION'>ABORTION</option><option value='OPL'>OBSTRUCTED/PROLONGED LABOUR</option><option value='FITS'>FITS</option><option value='SH'>SEVERE HYPERTENSION</option><option value='BBCD'>BLEEDING BEFORE CHILD DELIVERY</option><option value='BACD'>BLEEDING AFTER CHILD DELIVERY</option><option value='HFBD'>HIGH FEVER BEFORE DELIVERY</option><option value='HFAD'>HIGH FEVER AFTER DELIVERY</option><option value='OTHERS'>ANY OTHERS</option><option value='NK'>NOT KNOWN</option><option value='MDNK'>Other Causes (including cause not known)</option></select>";    	    	
+    	oCell.innerHTML = "<select name='entryfield' id='value[1038].value:value["+nextRecordNo+"].value' onchange='validateLLMDCauseField(1038,"+nextRecordNo+")' onkeypress='return keyPress(event, this)' style='width:100% text-align:center'><option value='NONE' SELECTED>---</option><option value='ABORTION'>M01-ABORTION</option><option value='OPL'>M02-OBSTRUCTED/PROLONGED LABOUR</option><option value='FITS'>M03-SEVERE HYPERTENSION/FITS</option><option value='BBCD'>M04-BLEEDING</option><option value='HFBD'>M05-HIGH FEVER</option><option value='MDNK'>M06-OTHER CAUSES (INCLUDING CAUSE NOT KNOWN)</option><!--<option value='FITS'>FITS</option><option value='SH'>SEVERE HYPERTENSION</option><option value='BBCD'>BLEEDING BEFORE CHILD DELIVERY</option><option value='BACD'>BLEEDING AFTER CHILD DELIVERY</option><option value='HFBD'>HIGH FEVER BEFORE DELIVERY</option><option value='HFAD'>HIGH FEVER AFTER DELIVERY</option><option value='ANAEMIA'>Anaemia as cause of Direct/Associated with other Medical Disease</option><option value='SEVEREANAEMIA'>Severe Anaemia (<7gm)</option><option value='MODERATEANAEMIA'>Moderate Anaemia (>7gm <11gm)</option><option value='OTHERS'>ANY OTHERS</option><option value='NK'>NOT KNOWN</option><option value='MDNK'>Other Causes (including cause not known)</option>--></select>";    	    	
 
     	oCell = newRow.insertCell(8);
     	oCell.innerHTML = "<select name='entryfield' id='value[1039].value:value["+nextRecordNo+"].value' onchange='validateLLMDAuditedField(1039,"+nextRecordNo+")' onkeypress='return keyPress(event, this)' style='width:100% text-align:center'><option value='NONE' SELECTED>---</option><option value='Y'>YES</option><option value='N'>NO</option><option value='NK'>NOT KNOWN</option></select>";
@@ -128,7 +135,7 @@
 					<option value="PHC" #if($llDataValue.getValue() && $llDataValue.getValue()=="PHC") selected #end>PHC</option>
 					<option value="CHC" #if($llDataValue.getValue() && $llDataValue.getValue()=="CHC") selected #end>CHC</option>
 					<option value="MC" #if($llDataValue.getValue() && $llDataValue.getValue()=="MC") selected #end>DH/SDH/MEDICAL COLLEGE</option>
-					<option value="PVTINST" #if($llDataValue.getValue() && $llDataValue.getValue()=="PVTINST") selected #end>PVT INST</option>
+					<option value="PVTINST" #if($llDataValue.getValue() && $llDataValue.getValue()=="PVTINST") selected #end>PVT INST</option><!-- hide or orissa application -->
 				</select>
 			</td>
 		#elseif($count1 == 6)
@@ -146,7 +153,15 @@
 		#elseif($count1 == 7)
 			<td>
 				<select name="entryfield" id="value[$llDataValue.getDataElement().getId()].value:value[$llDataValue.getRecordNo()].value" onchange="validateLLMDCauseField($llDataValue.getDataElement().getId(),$llDataValue.getRecordNo())" onkeypress="return keyPress(event, this)" style="width:100% text-align:center" #if( $locked ) disabled="disabled"#end>
-					<option value="NONE" #if(!$llDataValue.getValue() || $llDataValue.getValue()=="NONE") selected #end>---</option>
+					<option value="MDNK" #if(!$llDataValue.getValue() || $llDataValue.getValue()=="NONE") selected #end>OTHER CAUSES</option>
+					
+					<option value="ABORTION" #if($llDataValue.getValue() && $llDataValue.getValue()=="ABORTION") selected #end>M01-ABORTION</option>
+					<option value="OPL" #if($llDataValue.getValue() && $llDataValue.getValue()=="OPL") selected #end>M02-OBSTRUCTED/PROLONGED LABOUR</option>
+					<option value="FITS" #if($llDataValue.getValue() && $llDataValue.getValue()=="FITS") selected #end>M03-SEVERE HYPERTENSION/FITS</option>
+					<option value="BBCD" #if($llDataValue.getValue() && $llDataValue.getValue()=="BBCD") selected #end>M04-BLEEDING</option>
+					<option value="HFBD" #if($llDataValue.getValue() && $llDataValue.getValue()=="HFBD") selected #end>M05-HIGH FEVER</option>
+					<option value="MDNK" #if($llDataValue.getValue() && $llDataValue.getValue()=="MDNK") selected #end>M06-OTHER CAUSES (INCLUDING CAUSE NOT KNOWN)</option>
+					<!--
 					<option value="ABORTION" #if($llDataValue.getValue() && $llDataValue.getValue()=="ABORTION") selected #end>ABORTION</option>
 					<option value="OPL" #if($llDataValue.getValue() && $llDataValue.getValue()=="OPL") selected #end>OBSTRUCTED/PROLONGED LABOUR</option>
 					<option value="FITS" #if($llDataValue.getValue() && $llDataValue.getValue()=="FITS") selected #end>FITS</option>
@@ -155,9 +170,15 @@
 					<option value="BACD" #if($llDataValue.getValue() && $llDataValue.getValue()=="BACD") selected #end>BLEEDING AFTER CHILD DELIVERY</option>
 					<option value="HFBD" #if($llDataValue.getValue() && $llDataValue.getValue()=="HFBD") selected #end>HIGH FEVER BEFORE DELIVERY</option>
 					<option value="HFAD" #if($llDataValue.getValue() && $llDataValue.getValue()=="HFAD") selected #end>HIGH FEVER AFTER DELIVERY</option>
+					
+					<option value="ANAEMIA" #if($llDataValue.getValue() && $llDataValue.getValue()=="ANAEMIA") selected #end>Anaemia as cause of Direct/Associated with other Medical Disease</option>
+					<option value="SEVEREANAEMIA" #if($llDataValue.getValue() && $llDataValue.getValue()=="SEVEREANAEMIA") selected #end>Severe Anaemia (<7gm)</option>
+					<option value="MODERATEANAEMIA" #if($llDataValue.getValue() && $llDataValue.getValue()=="MODERATEANAEMIA") selected #end>Moderate Anaemia (>7gm <11gm)</option>
+					
 					<option value="OTHERS" #if($llDataValue.getValue() && $llDataValue.getValue()=="OTHERS") selected #end>ANY OTHERS</option>
 					<option value="NK" #if($llDataValue.getValue() && $llDataValue.getValue()=="NK") selected #end>NOT KNOWN</option>
 					<option value="MDNK" #if($llDataValue.getValue() && $llDataValue.getValue()=="MDNK") selected #end>Other Causes (including cause not known)</option>										
+					-->
 				</select>
 			</td>
 		#elseif($count1 == 1)
@@ -197,7 +218,7 @@
 			<option value="PHC">PHC</option>
 			<option value="CHC">CHC</option>
 			<option value="MC">DH/SDH/MEDICAL COLLEGE</option>
-			<option value="PVTINST">PVT INST</option>
+			<option value="PVTINST">PVT INST</option> <!-- hide or orissa application -->
 		</select>	
 	</td>	
 	<td>
@@ -208,23 +229,39 @@
 			<option value="ANM">ANM</option>
 			<option value="NURSE">NURSE</option>
 			<option value="DOCTOR">DOCTOR</option>
-			<option value="OTHERS">OTHERS</option>		
+			<option value="OTHERS">OTHERS</option>
 		</select>	
 	</td>
 	<td>
 		<select name="entryfield" id="value[1038].value:value[$recordNo].value" onchange="validateLLMDCauseField(1038,$recordNo)" onkeypress="return keyPress(event, this)" style="width:100% text-align:center">
 			<option value="NONE" SELECTED>---</option>
-			<option value="ABORTION">ABORTION</option>
-			<option value="OPL">OBSTRUCTED/PROLONGED LABOUR</option>
+			<option value="ABORTION">M01-ABORTION</option>
+			<option value="OPL">M02-OBSTRUCTED/PROLONGED LABOUR</option>
+			<option value="FITS">M03-SEVERE HYPERTENSION/FITS</option>
+			<option value="BBCD">M04-BLEEDING</option>
+			<option value="HFBD">M05-HIGH FEVER</option>
+			<option value="MDNK">M06-OTHER CAUSES (INCLUDING CAUSE NOT KNOWN)</option>
+			
+			<!--
 			<option value="FITS">FITS</option>
 			<option value="SH">SEVERE HYPERTENSION</option>
 			<option value="BBCD">BLEEDING BEFORE CHILD DELIVERY</option>
 			<option value="BACD">BLEEDING AFTER CHILD DELIVERY</option>
 			<option value="HFBD">HIGH FEVER BEFORE DELIVERY</option>
 			<option value="HFAD">HIGH FEVER AFTER DELIVERY</option>
+			-->
+			<!-- add option for Haryana From-->
+			<!--
+			<option value="ANAEMIA">Anaemia as cause of Direct/Associated with other Medical Disease</option> 
+			<option value="SEVEREANAEMIA">Severe Anaemia (<7gm)</option> 
+			<option value="MODERATEANAEMIA">Moderate Anaemia (>7gm <11gm)</option>
+			-->
+			<!-- add option for Haryana To-->
+			<!--
 			<option value="OTHERS">ANY OTHERS</option>
 			<option value="NK">NOT KNOWN</option>
-			<option value="MDNK">Other Causes (including cause not known)</option>										
+			<option value="MDNK">M06-Other Causes (including cause not known)</option>
+			-->
 		</select>	
 	</td>
 	<td>
@@ -236,7 +273,7 @@
 		</select>	
 	</td>
     <td>
-       <div id='$recordNo' style="display: none;"<a href="#" onclick="javascript:removeLLRecord( '$recordNo' )" title="$i18n.getString( "remove" )"><img src="../images/delete.png" alt="$i18n.getString( "remove" )"></a></div>
+       <div id='$recordNo' style="display: none;"><a href="#" onclick="javascript:removeLLRecord( '$recordNo' )" title="$i18n.getString( "remove" )"><img src="../images/delete.png" alt="$i18n.getString( "remove" )"></a></div>
     </td>		
 </tr>		
 </table>

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/menu.vm'
--- local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/menu.vm	2012-06-30 08:05:32 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/menu.vm	2013-09-18 10:12:26 +0000
@@ -6,7 +6,7 @@
     <br>
     <li><a href="autoLLdataAggForm.action">$i18n.getString( "ll_data_aggregation" )</a></li>
     <!--
-    <li>Data Import</li>	
+    <li>Data Import</li>	
     <ul>
         <li><a href="lldataImport.action?llImportFlag=1">Overwrite Existing Data</a></li>    
         <li><a href="lldataImport.action?llImportFlag=2">Append to Existing Data</a></li>

=== modified file 'local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/select.vm'
--- local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/select.vm	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-dataentry-linelisting/src/main/webapp/dhis-web-dataentry-national/select.vm	2013-09-18 10:12:26 +0000
@@ -27,7 +27,9 @@
 	<span id="currentOptionCombo">Please Fill All Fields.</span>
     <br>
     #set( $dataset = $selectedStateManager.getSelectedDataSet() )
-    #if ($dataset.name == "Line listing Births" ) $i18n.getString("select_DOB_for_selected_month") #end
+    #if ($dataset.name == "Line listing Births" ) $i18n.getString("select_DOB_for_selected_month") 
+    #elseif ($dataset.name == "Line listing Family Planing" ) $i18n.getString("please_fill_name_of_the_hospital")
+    #end
     
 </div>
 
@@ -35,9 +37,7 @@
 
 
 <div id="actions" style="width:200px text-align:right; display : none;">
-
-<br>
-
+	
 <br><br><br><br><br>
 <input type="button" value="SAVE" onclick="saveLineListingAggData()" #if( $isLineListing.equals("no") ) disabled="disabled" #end>
 </div>

=== modified file 'local/in/dhis-web-excelimport/pom.xml'
--- local/in/dhis-web-excelimport/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-web-excelimport/pom.xml	2014-07-04 12:29:46 +0000
@@ -1,94 +1,92 @@
 <project xmlns="http://maven.apache.org/POM/4.0.0"
-	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
-	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
-	<modelVersion>4.0.0</modelVersion>
-	
-	<parent>
-		<groupId>org.hisp.dhis</groupId>
-		<artifactId>dhis-web</artifactId>
-		<version>2.15-SNAPSHOT</version>
-	</parent>
-	
-	<artifactId>dhis-web-excelimport</artifactId>
-	<packaging>war</packaging>
-	<name>DHIS Excel Import Module</name>
-	
-	<dependencies>
-		
-		<!-- DHIS -->
-		
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-api</artifactId>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-in-api</artifactId>
-			<version>${project.version}</version>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-service-core</artifactId>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-in-service-configuration</artifactId>
-			<version>${project.version}</version>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-web-commons</artifactId>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-web-commons-resources</artifactId>
-			<type>war</type>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-service-aggregationengine-default</artifactId>
-			<version>${project.version}</version>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-support-external</artifactId>
-		</dependency>
-		
-		<dependency>
-			<groupId>jexcelapi</groupId>
-			<artifactId>jxl</artifactId>
-			<version>2.6</version>
-		</dependency>
-		<dependency>
-			<groupId>net.sourceforge.jexcelapi</groupId>
-			<artifactId>jxl</artifactId>
-		</dependency>
-		
-		<!-- Web -->
-		
-		<dependency>
-			<groupId>commons-fileupload</groupId>
-			<artifactId>commons-fileupload</artifactId>
-		</dependency>
-        <dependency>
-            <groupId>org.apache.struts.xwork</groupId>
-            <artifactId>xwork-core</artifactId>
-            <version>2.3.3</version>
-        </dependency>
-
-        <!--JAVA-MAIL-->
-        <dependency>
-            <groupId>javax.mail</groupId>
-            <artifactId>mail</artifactId>
-            <version>1.4</version>
-        </dependency>
-
-        <!--Quartz framework-->
-        <dependency>
-            <groupId>org.quartz-scheduler</groupId>
-            <artifactId>quartz</artifactId>
-            <version>1.8.6</version>
-        </dependency>
-
-	</dependencies>
+  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <modelVersion>4.0.0</modelVersion>
+  
+  <parent>
+    <groupId>org.hisp.dhis</groupId>
+    <artifactId>dhis-web</artifactId>
+    <version>2.15</version>
+  </parent>
+  
+  <artifactId>dhis-web-excelimport</artifactId>
+  <packaging>war</packaging>
+  <name>DHIS Excel Import Module</name>
+    
+  <dependencies>
+    
+    <!-- DHIS -->
+    
+     <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-api</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-in-api</artifactId>
+	  <version>${project.version}</version>
+    </dependency>
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-service-core</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-in-service-configuration</artifactId>
+      <version>${project.version}</version>
+    </dependency>       
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-commons</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-commons-resources</artifactId>
+	  <type>war</type>			
+    </dependency>
+
+	<dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-service-aggregationengine-default</artifactId>
+	<version>${project.version}</version>
+    </dependency>
+
+	<dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-support-external</artifactId>
+    </dependency>
+    
+
+    <dependency>
+      <groupId>jexcelapi</groupId>
+ 	  <artifactId>jxl</artifactId>
+	  <version>2.6</version>	 	  
+ 	</dependency>
+   <dependency>
+      <groupId>net.sourceforge.jexcelapi</groupId>
+      <artifactId>jxl</artifactId>
+    </dependency>
+    
+	<!-- Web -->
+    
+	 <dependency>
+      <groupId>commons-fileupload</groupId>
+      <artifactId>commons-fileupload</artifactId>
+    </dependency>
+	
+    
+    <!-- Other -->
+    <!--
+    <dependency>
+      <groupId>org.springframework</groupId>
+      <artifactId>spring-orm</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>mysql</groupId>
+      <artifactId>mysql-connector-java</artifactId>
+    </dependency>
+      
+      -->
+    
+  </dependencies>	  
 </project>

=== modified file 'local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/action/ExcelImportFormAction.java'
--- local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/action/ExcelImportFormAction.java	2012-08-18 11:15:26 +0000
+++ local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/action/ExcelImportFormAction.java	2014-10-16 11:52:32 +0000
@@ -1,15 +1,16 @@
 package org.hisp.dhis.excelimport.action;
 
-import com.opensymphony.xwork2.Action;
+import java.util.ArrayList;
+import java.util.Collection;
+import java.util.Iterator;
+
 import org.hisp.dhis.organisationunit.OrganisationUnit;
 import org.hisp.dhis.organisationunit.OrganisationUnitService;
 import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
 
-import java.util.ArrayList;
-import java.util.Collection;
-import java.util.Iterator;
+import com.opensymphony.xwork2.Action;
 
 public class ExcelImportFormAction
     implements Action
@@ -97,16 +98,16 @@
     public String execute()
         throws Exception
     {
+        //raFolderName = reportService.getRAFolderName();
 
         /* Period Info */
-
         periodTypes = periodService.getAllPeriodTypes();
 
         Iterator<PeriodType> alldeIterator = periodTypes.iterator();
         while ( alldeIterator.hasNext() )
         {
             PeriodType type = alldeIterator.next();
-            if (type.getName().equalsIgnoreCase("Monthly") || type.getName().equalsIgnoreCase("quarterly") || type.getName().equalsIgnoreCase("yearly"))
+            if ( type.getName().equalsIgnoreCase("Weekly") || type.getName().equalsIgnoreCase("Monthly") || type.getName().equalsIgnoreCase("quarterly") || type.getName().equalsIgnoreCase("yearly"))
             {
                 periods.addAll(periodService.getPeriodsByPeriodType(type));
             }
@@ -115,7 +116,7 @@
                alldeIterator.remove();
             }
         }
-
+        
         System.out.println(message);
         return SUCCESS;
     }

=== modified file 'local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/action/ExcelImportResultAction.java'
--- local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/action/ExcelImportResultAction.java	2012-07-24 09:11:33 +0000
+++ local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/action/ExcelImportResultAction.java	2014-11-28 12:23:49 +0000
@@ -135,14 +135,14 @@
     {
         this.currentUserService = currentUserService;
     }
-    /*
+	/*
     private DataSetLockService dataSetLockService;
     
     public void setDataSetLockService( DataSetLockService dataSetLockService )
     {
         this.dataSetLockService = dataSetLockService;
     }
-    */
+	*/
     private SessionFactory sessionFactory;
 
     public void setSessionFactory( SessionFactory sessionFactory )
@@ -361,13 +361,22 @@
         this.orgUnitListCB = orgUnitListCB;
     }
 
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-
+    */
+    
     private File file;
 
     public void setUpload( File file )
@@ -508,8 +517,7 @@
     {
         return lockStatus;
     }
-    
-    
+	
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
@@ -554,7 +562,17 @@
 
         inputStream = new BufferedInputStream( new FileInputStream( file ) );
         
-       
+        DataSet dataSet = dataSetService.getDataSet( dataSetId );
+        
+        System.out.println( " DataSet id is : " + dataSet.getId() + " Data Set member size is " + dataSet.getDataElements().size() );
+        
+        selectedPeriod = periodService.getPeriod( availablePeriods );
+        
+        OrganisationUnit selectedOrgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
+        
+        System.out.println( " selectedPeriod id is : " + selectedPeriod.getId() + " selectedOrgUnit id is " + selectedOrgUnit.getId() );
+        
+        
         String excelTemplatePath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator
             + excelImportFolderName + File.separator + "template" + File.separator + reportFileNameTB;
 
@@ -579,10 +597,8 @@
             return SUCCESS;
         }
         
-        //Workbook excelImportFile = Workbook.getWorkbook( file );
-        
         Workbook excelImportFile = Workbook.getWorkbook( new File( excelFilePath ) );
-        
+       
         Workbook excelTemplateFile = Workbook.getWorkbook( new File( excelTemplatePath ) );
 
         excelValidator = validateReport( deCodesImportXMLFileName, excelImportFile, excelTemplateFile );
@@ -601,26 +617,34 @@
             orgUnitList.add( orgUnit );
         }
         
-        DataSet dataSet = dataSetService.getDataSet( dataSetId );
-        
-        selectedPeriod = periodService.getPeriod( availablePeriods );
+        
+        
+        
+        
+        
+        
 
         sDate = format.parseDate( String.valueOf( selectedPeriod.getStartDate() ) );
 
         eDate = format.parseDate( String.valueOf( selectedPeriod.getEndDate() ) );
 
         //DataSetLock dataSetLock = dataSetLockService.getDataSetLockByDataSetPeriodAndSource( dataSet, selectedPeriod, orgUnit );
-        
-        lockStatus = dataSetService.isLocked( dataSet, selectedPeriod, orgUnit, null );
+        //lockStatus = dataSetService.isLocked( dataSet, selectedPeriod, orgUnit, null );
+        
+        //DataElementCategoryOptionCombo attributeOptionCombo = 
+        
+        lockStatus = dataSetService.isLocked( dataSet, selectedPeriod, orgUnit, null, null );
         
         //if( dataSetLock != null )
-        if( lockStatus )
+        /*
+	if( lockStatus )
         {
             message = "Unable to Import : Corresponding Dataset ( "+dataSet.getName()+" ) for the selected Excel Template is locked.";
             
             return SUCCESS;
         }
-
+        
+        */
         // Getting DataValues
         dataValueList = new ArrayList<String>();
         List<String> deCodesList = new ArrayList<String>();
@@ -645,7 +669,7 @@
 
                 String deCodeString = (String) it1.next();
 
-                String deType = (String) deCodeType.get( count1 );
+		String deType = (String) deCodeType.get( count1 );
                 String sType = (String) serviceType.get( count1 );
                 int tempRowNo = rowList.get( count1 );
                 int tempColNo = colList.get( count1 );
@@ -664,8 +688,6 @@
 
                 String value = "";
 
-                System.out.println( deCodeString );
-                
                 deAndComboMap = getDeAndCombo( deCodeString );
 
                 for ( DataElement de : deAndComboMap.keySet() )
@@ -681,16 +703,19 @@
 
                 dataValue.setPeriod( selectedPeriod );
                 dataValue.setSource( currentOrgUnit );
-                dataValue.setOptionCombo( currentOptionCombo );
+                
+                dataValue.setCategoryOptionCombo( currentOptionCombo );
+                //.setOptionCombo( currentOptionCombo );
+                
                 dataValue.setTimestamp( new Date() );
                 dataValue.setStoredBy( storedBy );
 
                 Sheet sheet = excelImportFile.getSheet( sheetNo );
 
                 String cellContent = sheet.getCell( tempColNo, tempRowNo ).getContents();
-                
-                System.out.println( tempColNo + " : " + tempRowNo + " : " + cellContent );
-                
+
+		System.out.println( sheetNo + " : " + tempColNo + " : " + tempRowNo + " : " + cellContent );
+		
                 value = cellContent;
 
                 if ( cellContent.equalsIgnoreCase( "" ) || cellContent == null || cellContent.equalsIgnoreCase( " " ) )
@@ -704,14 +729,17 @@
 
                 DataValue oldValue = new DataValue();
 
-                oldValue = dataValueService.getDataValue( currentOrgUnit, currentDataElement, selectedPeriod,
-                    currentOptionCombo );
+                //oldValue = dataValueService.getDataValue( currentOrgUnit, currentDataElement, selectedPeriod, currentOptionCombo );
+                oldValue = dataValueService.getDataValue( currentDataElement, selectedPeriod, currentOrgUnit, currentOptionCombo );
 
                 if ( oldValue == null )
                 {
                     try
                     {
                         dataValueService.addDataValue( dataValue );
+                        
+                        //System.out.println( "DE id : " + currentDataElement.getId() + " Period id: " + selectedPeriod.getId()  + " Source id : " + currentOrgUnit.getId() +  " : " + cellContent + " -- Value added in dataValue ");
+                        
                     }
                     catch ( Exception ex )
                     {
@@ -727,6 +755,8 @@
                         oldValue.setStoredBy( storedBy );
 
                         dataValueService.updateDataValue( oldValue );
+                        //System.out.println( "DE id : " + currentDataElement.getId() + " Period id: " + selectedPeriod.getId()  + " Source id : " + currentOrgUnit.getId() +  " : " + cellContent + " -- Value updated in dataValue ");
+                        
                     }
                     catch ( Exception ex )
                     {
@@ -748,21 +778,21 @@
         excelImportFile.close();
 
         statementManager.destroy();
-        
+
         message = "The report has been imported successfully";
 
-        try
-        {
-        }
-        catch( Exception e )
-        {
-        }
-        finally
-        {
-            if( inputStream != null )
-            inputStream.close();             
-        }
-
+		try
+		{
+		}
+		catch( Exception e )
+		{
+		}
+		finally
+		{
+			if( inputStream != null )
+				inputStream.close();		 
+		}
+		
         return SUCCESS;
     }
 
@@ -986,7 +1016,9 @@
 
     public List<String> getCheckerDECodes( String fileName )
     {
-
+        
+        System.out.println( "Inside Checker DECodes : \t" + fileName );
+        
         String excelImportFolderName = "excelimport";
 
         List<String> rangeList = new ArrayList<String>();
@@ -1033,6 +1065,10 @@
                 rowEnd = deCodeElement.getAttribute( "rowEnd" );
                 columnStart = deCodeElement.getAttribute( "columnStart" );
                 columnEnd = deCodeElement.getAttribute( "columnEnd" );
+                                
+                System.out.println( checkerSheetNumber + " : " + rowStart + " : " + rowEnd + " :  " + columnStart + " : " + columnEnd );
+                
+                System.out.println( "File Validation Complete  : \t" + fileName );
 
             }// end of for loop with s var
         }// try block end
@@ -1114,6 +1150,7 @@
 
                     else
                     {
+                        //System.out.println( "** ##### Colm " + c + ": Row " + r + "--- Cell content" + cellContent + " temp content" + templateContent );
                         validator = false;
                         break;
 
@@ -1124,6 +1161,7 @@
         
         else
         {
+            //System.out.println( excelImportFile.getSheet( sheetNumber ).getRows() + " ---- " + excelTemplateFile.getSheet( sheetNumber ).getRows() );
             validator = false;
         }
 
@@ -1160,11 +1198,17 @@
                 String optionComboIdStr = replaceString.substring( replaceString.indexOf( '.' ) + 1, replaceString
                     .length() );
 
+                //System.out.println( "** In side DeAndCombo 1 Replacing String" + replaceString  );
+                
                 replaceString = replaceString.substring( 0, replaceString.indexOf( '.' ) );
-
+                
+                //System.out.println( "** In side DeAndCombo 2 Replacing String" + replaceString  );
+                
                 int dataElementId = Integer.parseInt( replaceString );
                 int optionComboId = Integer.parseInt( optionComboIdStr );
-
+                
+                //System.out.println( "** In side DeAndCombo 1 " + dataElementId + ":" + optionComboId );
+                
                 DataElement dataElement = dataElementService.getDataElement( dataElementId );
                 DataElementCategoryOptionCombo optionCombo = dataElementCategoryService
                     .getDataElementCategoryOptionCombo( optionComboId );
@@ -1176,7 +1220,7 @@
 
                 else
                 {
-
+                    //System.out.println( "** In side DeAndCombo 2 " + dataElement.getId() + ":" + optionCombo.getId() );
                     deAndOptionMap.put( dataElement, optionCombo );
 
                 }
@@ -1256,9 +1300,9 @@
         finally
         {
             if( in != null ) 
-                in.close();
-            if( out != null )                       
-                out.close();
+				in.close();
+			if( out != null )			
+				out.close();
         }
 
         return 1;

=== modified file 'local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/action/GetPeriodsAction.java'
--- local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/action/GetPeriodsAction.java	2010-06-04 11:50:05 +0000
+++ local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/action/GetPeriodsAction.java	2014-10-16 12:16:30 +0000
@@ -47,7 +47,8 @@
  * @version $Id: GetPeriodsAction.java 3272 2007-04-26 22:22:50Z larshelg $
  */
 
-public class GetPeriodsAction    extends ActionSupport
+public class GetPeriodsAction
+    extends ActionSupport
 {
     private final String ALL = "null";
 
@@ -81,16 +82,16 @@
     }
 
     private List<String> periodNameList;
-    
-        public List<String> getPeriodNameList() 
-        {
-                return periodNameList;
-        }
-    
+
+    public List<String> getPeriodNameList()
+    {
+        return periodNameList;
+    }
+
     private SimpleDateFormat simpleDateFormat1;
 
     private SimpleDateFormat simpleDateFormat2;
-    
+
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
@@ -99,7 +100,7 @@
         throws Exception
     {
         periodNameList = new ArrayList<String>();
-        
+
         if ( id.equals( ALL ) )
         {
             Collection<PeriodType> periodTypes = periodService.getAllPeriodTypes();
@@ -110,66 +111,86 @@
             {
                 periods.addAll( periodService.getPeriodsByPeriodType( type ) );
             }
-            Collections.sort(periods, new PeriodComparator() );
+            Collections.sort( periods, new PeriodComparator() );
         }
         else
         {
             PeriodType periodType = periodService.getPeriodTypeByName( id );
 
-            periods = new ArrayList<Period>(periodService.getPeriodsByPeriodType( periodType ));
-            
+            periods = new ArrayList<Period>( periodService.getPeriodsByPeriodType( periodType ) );
+
             Iterator<Period> periodIterator = periods.iterator();
-            while( periodIterator.hasNext() )
+            while ( periodIterator.hasNext() )
             {
                 Period p1 = periodIterator.next();
-                
+
                 if ( p1.getStartDate().compareTo( new Date() ) > 0 )
                 {
-                    periodIterator.remove( );
+                    periodIterator.remove();
                 }
-                
+
             }
             Collections.sort( periods, new PeriodComparator() );
-                       
-            if(periodType.getName().equalsIgnoreCase("monthly"))
+
+            if ( periodType.getName().equalsIgnoreCase( "monthly" ) )
             {
                 simpleDateFormat1 = new SimpleDateFormat( "MMM-yyyy" );
-                for(Period p1 : periods)
+                for ( Period p1 : periods )
                 {
-                        periodNameList.add( simpleDateFormat1.format(p1.getStartDate() ) ); 
+                    periodNameList.add( simpleDateFormat1.format( p1.getStartDate() ) );
                 }
             }
-            else if(periodType.getName().equalsIgnoreCase("quarterly"))
+            else if ( periodType.getName().equalsIgnoreCase( "quarterly" ) )
             {
                 simpleDateFormat1 = new SimpleDateFormat( "MMM" );
                 simpleDateFormat2 = new SimpleDateFormat( "MMM yyyy" );
-                
-                for(Period p1 : periods)
+
+                for ( Period p1 : periods )
                 {
-                        String tempPeriodName = simpleDateFormat1.format( p1.getStartDate() ) + " - " + simpleDateFormat2.format( p1.getEndDate() ); 
-                        periodNameList.add( tempPeriodName ); 
+                    String tempPeriodName = simpleDateFormat1.format( p1.getStartDate() ) + " - "
+                        + simpleDateFormat2.format( p1.getEndDate() );
+                    periodNameList.add( tempPeriodName );
                 }
             }
-            else if(periodType.getName().equalsIgnoreCase("yearly"))
+            else if ( periodType.getName().equalsIgnoreCase( "yearly" ) )
             {
                 simpleDateFormat1 = new SimpleDateFormat( "yyyy" );
-                for(Period p1 : periods)
-                {
-                        periodNameList.add( simpleDateFormat1.format(p1.getStartDate() ) ); 
-                }
-            }
+                for ( Period p1 : periods )
+                {
+                    periodNameList.add( simpleDateFormat1.format( p1.getStartDate() ) );
+                }
+            }
+            
+            else if ( periodType.getName().equalsIgnoreCase( "Weekly" ) )
+            {
+                simpleDateFormat1 = new SimpleDateFormat( "yyyy-MM-dd" );
+                for ( Period p1 : periods )
+                {
+                    String tempPeriodName = simpleDateFormat1.format( p1.getStartDate() ) + " - "
+                        + simpleDateFormat1.format( p1.getEndDate() );
+                    periodNameList.add( tempPeriodName );
+                }
+            }
+            
             else
             {
-                simpleDateFormat1 = new SimpleDateFormat( "yyyy-mm-dd" );
-                for(Period p1 : periods)
+                simpleDateFormat1 = new SimpleDateFormat( "yyyy-MM-dd" );
+                for ( Period p1 : periods )
                 {
-                        String tempPeriodName = simpleDateFormat1.format( p1.getStartDate() ) + " - " + simpleDateFormat1.format( p1.getEndDate() ); 
-                        periodNameList.add( tempPeriodName ); 
+                    String tempPeriodName = simpleDateFormat1.format( p1.getStartDate() ) + " - "
+                        + simpleDateFormat1.format( p1.getEndDate() );
+                    periodNameList.add( tempPeriodName );
                 }
             }
+            
+            /*
+            for( String periodName : periodNameList )
+            {
+                System.out.println( periodType.getName() + " : " + periodName );
+            }
+            */
+            
         }
-
-        
         
         return SUCCESS;
     }

=== modified file 'local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/action/GetReportsAction.java'
--- local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/action/GetReportsAction.java	2011-12-14 11:09:39 +0000
+++ local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/action/GetReportsAction.java	2014-07-15 10:23:14 +0000
@@ -116,7 +116,8 @@
         {
             try
             {
-                orgUnit = organisationUnitService.getOrganisationUnit( Integer.parseInt( ouId ) );
+                //orgUnit = organisationUnitService.getOrganisationUnit( Integer.parseInt( ouId ) );
+                orgUnit = organisationUnitService.getOrganisationUnit( ouId );
 
                 //int ouLevel = organisationUnitService.getLevelOfOrganisationUnit( orgUnit );
                 int ouLevel = organisationUnitService.getLevelOfOrganisationUnit( orgUnit.getId() );

=== modified file 'local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/portal/action/PortalExcelImportFormAction.java'
--- local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/portal/action/PortalExcelImportFormAction.java	2011-04-15 11:42:21 +0000
+++ local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/portal/action/PortalExcelImportFormAction.java	2013-09-19 06:34:31 +0000
@@ -167,7 +167,7 @@
                     PortalImportSheet portalImportSheet = new PortalImportSheet( xmlTemplateName, displayName, periodicity, proforma, checkerTemplateName, checkerRangeForHeader, checkerRangeForData, datasetId, orgunitGroupId, facilityStart );
                     
                     excelImportSheetList.add( count, portalImportSheet );
-
+                    
                     count++;
                 }
             }// end of for loop with s var

=== modified file 'local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/portal/action/PortalExcelImportResultAction.java'
--- local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/portal/action/PortalExcelImportResultAction.java	2012-07-24 09:11:33 +0000
+++ local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/portal/action/PortalExcelImportResultAction.java	2014-07-04 12:33:52 +0000
@@ -217,15 +217,15 @@
     }
 
     private String raFolderName;
-    
+
     private boolean lockStatus;
     
     public boolean isLockStatus()
     {
         return lockStatus;
     }
-	
-	String selectedPeriodicity;
+    
+    String selectedPeriodicity;
     
     public void setSelectedPeriodicity( String selectedPeriodicity )
     {
@@ -438,7 +438,7 @@
         
         String selectedMonth = "";
         
-		String selectedFinancialYear = "";
+        String selectedFinancialYear = "";
         String selectedFormat = "";
         String selectedParentName = "";
         
@@ -479,12 +479,12 @@
             {
                 selectedParentName = cellContent;
             }
-			/*
+            /*
             else if( header.getExpression().equalsIgnoreCase( ExcelImport_Header.HEADER_PERIODICITY ) )
             {
                 selectedPeriodicity = cellContent;
             }
-			*/
+            */
         }
         
         String selStartDate = "";
@@ -593,10 +593,11 @@
                     {
                         System.out.println("--------Importing started for :"+portalOrgUnit.getName() + "-------------" );
                         
-						lockStatus = dataSetService.isLocked( dataSet, selectedPeriod, portalOrgUnit, null );
+                        //lockStatus = dataSetService.isLocked( dataSet, selectedPeriod, portalOrgUnit, null );
+                        lockStatus = dataSetService.isLocked( dataSet, selectedPeriod, portalOrgUnit, null, null );
                         //DataSetLock dataSetLock = dataSetLockService.getDataSetLockByDataSetPeriodAndSource( dataSet, selectedPeriod, portalOrgUnit );
-                        //if( dataSetLock != null )
-                        if( lockStatus )
+                       // if( dataSetLock != null )
+                        if( lockStatus )    
                         {
                             message += "<br><font color=red><strong>Unable to Import : Corresponding Dataset ( "+dataSet.getName()+" ) for " + portalOrgUnit.getName() + " and for period : " + periodFormat.format( selectedPeriod.getStartDate() ) + " is locked.</strong></font>";
                             System.out.println("Unable to Import : Corresponding Dataset ( "+dataSet.getName()+" ) for " + portalOrgUnit.getName() + " and for period : " + periodFormat.format( selectedPeriod.getStartDate() ) + " is locked.");
@@ -612,7 +613,9 @@
                         for( ExcelImport_DeCode deCode : deCodeList )
                         {
                             String deCodeExpression = deCode.getExpression();
-			    System.out.println( deCodeExpression );
+                            
+                            System.out.println( deCodeExpression );
+                            
                             if( deCodeExpression != null && !deCodeExpression.trim().equals( "" ) )
                             {
                                 Integer deId = Integer.parseInt( deCodeExpression.split( "\\." )[0] );
@@ -942,7 +945,7 @@
                 return orgUnitId;
             }
         }
-			
+        
         return null;
     }
 
@@ -1056,6 +1059,7 @@
             }
         }
 
+        System.out.println( "Start Date is : " + startDate );
         Period period = periodType.createPeriod( dateFormat.parse( startDate ) );
         period = reloadPeriodForceAdd( period );
         periodService.addPeriod( period );

=== modified file 'local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/tcs/action/TCSXmlImportResultAction.java'
--- local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/tcs/action/TCSXmlImportResultAction.java	2012-03-19 06:11:45 +0000
+++ local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/tcs/action/TCSXmlImportResultAction.java	2013-09-19 06:34:31 +0000
@@ -80,14 +80,14 @@
     {
         this.currentUserService = currentUserService;
     }
- /*   
+    /*
     private DataSetLockService dataSetLockService;
     
     public void setDataSetLockService( DataSetLockService dataSetLockService )
     {
         this.dataSetLockService = dataSetLockService;
     }
-*/
+    */
     private DataSetService dataSetService;
 
     public void setDataSetService( DataSetService dataSetService )

=== modified file 'local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/util/ReportService.java'
--- local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/util/ReportService.java	2011-04-15 11:42:21 +0000
+++ local/in/dhis-web-excelimport/src/main/java/org/hisp/dhis/excelimport/util/ReportService.java	2014-09-03 11:57:07 +0000
@@ -118,6 +118,46 @@
     // Services
     // -------------------------------------------------------------------------
 
+    public String getDataValueRecordsCount( Integer periodId, Integer sourceId, Integer dataSetId )
+    {
+       
+        String message = "All data are new";
+
+        try
+        {
+            String query = "SELECT count(*) from datavalue where periodid = " + periodId + " AND "
+                + " sourceid = " + sourceId + " AND dataelementid in ( SELECT dataelementid FROM datasetmembers where datasetid = " + dataSetId + " )" ;
+
+
+            SqlRowSet rs = jdbcTemplate.queryForRowSet( query );
+
+            if ( rs.next() )
+            {
+                Integer count = rs.getInt( 1 );
+                
+                if( count != null && count > 0 )
+                {
+                    message = count + " Record Already Exits";
+                    message +=  "\n Are you sure you want to update ?";
+                }
+            }
+
+        }
+        catch ( Exception e )
+        {
+            System.out.println( "Exception : " + e.getMessage() );
+            return "";
+        }
+
+        return message;
+
+    }    
+    
+    
+    
+    
+    
+    
     public List<Period> getMonthlyPeriods( Date start, Date end )
     {
         List<Period> periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates( start, end ) );
@@ -370,8 +410,8 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod, organisationUnit, optionCombo );
 
                     if ( dataValue != null )
                     {
@@ -515,8 +555,8 @@
                         double aggregatedValue = 0.0;
                         for ( Period tempPeriod : periodList )
                         {
-                            DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement,
-                                tempPeriod, optionCombo );
+                            //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                            DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod, organisationUnit, optionCombo );
 
                             if ( dataValue != null )
                             {
@@ -550,8 +590,8 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod, organisationUnit, optionCombo );
 
                     if ( dataValue != null )
                     {
@@ -693,8 +733,8 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod, organisationUnit, optionCombo );
 
                     if ( dataValue != null )
                     {

=== modified file 'local/in/dhis-web-excelimport/src/main/resources/META-INF/dhis/beans.xml'
--- local/in/dhis-web-excelimport/src/main/resources/META-INF/dhis/beans.xml	2012-08-18 11:15:26 +0000
+++ local/in/dhis-web-excelimport/src/main/resources/META-INF/dhis/beans.xml	2014-09-03 09:53:27 +0000
@@ -11,6 +11,7 @@
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
     </bean>
+
     <bean id="org.hisp.dhis.excelimport.action.ExcelImportResultAction"
         class="org.hisp.dhis.excelimport.action.ExcelImportResultAction"
         scope="prototype">
@@ -22,11 +23,23 @@
         <property name="dataSetService" ref="org.hisp.dhis.dataset.DataSetService" />
         <property name="dataValueService" ref="org.hisp.dhis.datavalue.DataValueService" />
         <property name="reportService" ref="org.hisp.dhis.excelimport.util.ReportService" />
-        <!--<property name="dataSetLockService" ref="org.hisp.dhis.datalock.DataSetLockService" />-->
+       <!-- <property name="dataSetLockService" ref="org.hisp.dhis.datalock.DataSetLockService" />-->
         <property name="currentUserService" ref="org.hisp.dhis.user.CurrentUserService" />
         <property name="sessionFactory" ref="sessionFactory"/>
     </bean>
 
+    <bean id="org.hisp.dhis.excelimport.action.ValidateExcelImportUpdateData"
+        class="org.hisp.dhis.excelimport.action.ValidateExcelImportUpdateData"
+        scope="prototype">
+        <property name="dataSetService" ref="org.hisp.dhis.dataset.DataSetService" />
+        <property name="reportService" ref="org.hisp.dhis.excelimport.util.ReportService" />
+        <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
+        <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
+    </bean>
+
+
+
+
     <!-- Portal Data Import -->
     <bean id="org.hisp.dhis.excelimport.portal.action.PortalExcelImportFormAction"
         class="org.hisp.dhis.excelimport.portal.action.PortalExcelImportFormAction"
@@ -43,28 +56,8 @@
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
         <property name="organisationUnitGroupService" ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService" />
         <property name="currentUserService" ref="org.hisp.dhis.user.CurrentUserService" />
-        <property name="dataSetService" ref="org.hisp.dhis.dataset.DataSetService" />
-    </bean>
-
-    <!-- BD Data Import -->
-
-    <bean id="org.hisp.dhis.excelimport.bddataimport.action.BDExcelImportFormAction"
-          class="org.hisp.dhis.excelimport.bddataimport.action.BDExcelImportFormAction"
-          scope="prototype">
-        <property name="reportService" ref="org.hisp.dhis.excelimport.util.ReportService" />
-    </bean>
-
-    <bean id="org.hisp.dhis.excelimport.bddataimport.action.BDExcelImportResultAction"
-          class="org.hisp.dhis.excelimport.bddataimport.action.BDExcelImportResultAction"
-          scope="prototype">
-        <property name="reportService" ref="org.hisp.dhis.excelimport.util.ReportService" />
-        <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
-        <property name="jdbcTemplate" ref="jdbcTemplate" />
-        <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
-        <property name="organisationUnitGroupService" ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService" />
-        <property name="currentUserService" ref="org.hisp.dhis.user.CurrentUserService" />
-        <property name="dataSetService" ref="org.hisp.dhis.dataset.DataSetService" />
-        <property name="databaseInfoProvider" ref="databaseInfoProvider" />
+        <!--<property name="dataSetLockService" ref="org.hisp.dhis.datalock.DataSetLockService" />-->
+        <property name="dataSetService" ref="org.hisp.dhis.dataset.DataSetService" />
     </bean>
     
     <!-- TCS Data Import -->
@@ -81,6 +74,7 @@
         <property name="jdbcTemplate" ref="jdbcTemplate" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
         <property name="currentUserService" ref="org.hisp.dhis.user.CurrentUserService" />
+        <!--<property name="dataSetLockService" ref="org.hisp.dhis.datalock.DataSetLockService" />-->
         <property name="dataSetService" ref="org.hisp.dhis.dataset.DataSetService" />
     </bean>
     
@@ -129,48 +123,6 @@
             <ref bean="org.hisp.dhis.dataset.DataSetService"/>
         </property>
     </bean>
-
-    <bean id="org.hisp.dhis.excelimport.emaildataimport.importEmailAttachmentData"
-          class="org.hisp.dhis.excelimport.emaildataimport.importEmailAttachmentData">
-         <property name="reportService" ref="org.hisp.dhis.excelimport.util.ReportService" />
-         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
-         <property name="jdbcTemplate" ref="jdbcTemplate" />
-         <property name="databaseInfoProvider" ref="databaseInfoProvider" />
-    </bean>
-
-    <!-- Task Scheduling -->
-
-    <bean id="schedulerTask"
-          class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean">
-        <property name="targetObject" ref="org.hisp.dhis.excelimport.emaildataimport.importEmailAttachmentData"/>
-        <property name="targetMethod" value="extractXLSToImport"/>
-    </bean>
-
-
-    <!-- Simple Trigger, run every 60 seconds -->
-
-    <bean id="simpleTrigger"
-          class="org.springframework.scheduling.quartz.SimpleTriggerBean">
-
-        <property name="jobDetail" ref="schedulerTask"/>
-        <property name="repeatInterval" value="60000"/>
-        <property name="startDelay" value="1000"/>
-
-    </bean>
-
-    <bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
-        <property name="jobDetails">
-            <list>
-                <ref bean="schedulerTask"/>
-            </list>
-        </property>
-
-        <property name="triggers">
-            <list>
-                <ref bean="simpleTrigger"/>
-            </list>
-        </property>
-    </bean>
     
     <!-- Report Service -->
     <bean id="org.hisp.dhis.excelimport.util.ReportService"
@@ -202,4 +154,13 @@
         </property>
     </bean>
     
+	
+    <!-- Export Xls File -->
+    <bean id="org.hisp.dhis.exceliexport.action.ExcelExportResultAction"
+        class="org.hisp.dhis.exceliexport.action.ExcelExportResultAction"
+        scope="prototype">
+        <property name="reportService" ref="org.hisp.dhis.excelimport.util.ReportService" />
+    </bean>	
+	
+	
 </beans>

=== modified file 'local/in/dhis-web-excelimport/src/main/resources/struts.xml'
--- local/in/dhis-web-excelimport/src/main/resources/struts.xml	2012-08-18 11:15:26 +0000
+++ local/in/dhis-web-excelimport/src/main/resources/struts.xml	2014-09-03 10:31:57 +0000
@@ -35,6 +35,19 @@
             <interceptor-ref name="fileUploadStack"/>
         </action>
 
+		<action name="validateExcelImportUpdateData" class="org.hisp.dhis.excelimport.action.ValidateExcelImportUpdateData">
+	            <result name="success" type="velocity-xml">/dhis-web-excelimport/validateStatus.vm</result>
+	            <param name="onExceptionReturn">plainTextError</param>                              
+	    </action>
+
+
+
+
+
+
+
+
+
         <action name="rejectImport"
             class="org.hisp.dhis.excelimport.action.RejectAction">
             <result name="success" type="velocity">/main.vm</result>
@@ -64,23 +77,6 @@
         <interceptor-ref name="fileUploadStack"/>
     </action>
 
-    <!-- BDExcel Data Import -->
-        <action name="BDDataImportForm"
-                class="org.hisp.dhis.excelimport.bddataimport.action.BDExcelImportFormAction">
-            <result name="success" type="velocity">/main.vm</result>
-            <param name="page">/dhis-web-excelimport/BDDataImportForm.vm</param>
-            <param name="menu">/dhis-web-excelimport/menu.vm</param>
-            <param name="javascripts">javascript/hashtable.js</param>
-            <param name="stylesheets">css/StylesForTags.css</param>
-        </action>
-
-        <action name="BDExcelImportResult" class="org.hisp.dhis.excelimport.bddataimport.action.BDExcelImportResultAction">
-            <result name="success" type="velocity">/main.vm</result>
-            <param name="page">/dhis-web-excelimport/BDDataImportResult.vm</param>
-            <param name="menu">/dhis-web-excelimport/menu.vm</param>
-            <interceptor-ref name="fileUploadStack"/>
-        </action>
-
     <!-- TCS Data Import -->
     <action name="tcsDataImportForm"
         class="org.hisp.dhis.excelimport.tcs.action.TCSXmlImportFormAction">
@@ -123,5 +119,18 @@
             <param name="onExceptionReturn">plainTextError</param>
         </action>
 
+		<!-- Export Xls File -->
+        <action name="exportExcelFile"
+            class="org.hisp.dhis.exceliexport.action.ExcelExportResultAction">
+            <result name="success" type="stream">
+                <param name="contentType">application/vnd.ms-excel</param>
+                <param name="inputName">inputStream</param>
+                <param name="contentDisposition">filename="${fileName}"</param>
+                <param name="bufferSize">1024</param>
+            </result>
+        </action>		
+		
+		
+		
     </package>
 </struts>

=== modified file 'local/in/dhis-web-excelimport/src/main/webapp/WEB-INF/web.xml'
--- local/in/dhis-web-excelimport/src/main/webapp/WEB-INF/web.xml	2012-04-04 05:46:52 +0000
+++ local/in/dhis-web-excelimport/src/main/webapp/WEB-INF/web.xml	2013-09-19 06:34:31 +0000
@@ -31,7 +31,7 @@
   </filter>
   <filter>
     <filter-name>Struts</filter-name>
-    <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
+    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
   </filter>
   
   <filter-mapping>

=== modified file 'local/in/dhis-web-excelimport/src/main/webapp/dhis-web-excelimport/excelImportForm.vm'
--- local/in/dhis-web-excelimport/src/main/webapp/dhis-web-excelimport/excelImportForm.vm	2011-04-15 11:43:00 +0000
+++ local/in/dhis-web-excelimport/src/main/webapp/dhis-web-excelimport/excelImportForm.vm	2014-09-03 10:31:50 +0000
@@ -24,7 +24,8 @@
         document.reportForm.reportFileNameTB.value = reportFileNames.get(document.reportForm.reportList.options[reportListIndex].value);
         document.reportForm.checkerFileNameTB.value = checkerFileNames.get(document.reportForm.reportList.options[reportListIndex].value);
         document.reportForm.dataSetId.value = reportDatasets.get(document.reportForm.reportList.options[reportListIndex].value);
-
+	
+		
         return true;
     }
 

=== modified file 'local/in/dhis-web-excelimport/src/main/webapp/dhis-web-excelimport/javascript/reports.js'
--- local/in/dhis-web-excelimport/src/main/webapp/dhis-web-excelimport/javascript/reports.js	2012-02-17 07:15:15 +0000
+++ local/in/dhis-web-excelimport/src/main/webapp/dhis-web-excelimport/javascript/reports.js	2014-09-03 11:06:49 +0000
@@ -193,9 +193,62 @@
 
 function submitImportForm()
 {
-	if (formValidations())
+	if ( formValidations() )
 	{
-	    setMessage( "Importing started");
-		document.getElementById( "reportForm" ).submit();
+		//var radioButtonvalue = document.getElementById("riRadio").value;
+		
+		//alert( radioButtonvalue );
+		//alert($("input[type=radio]:checked").val());
+		
+		var radioButtonvalue = $("input[type=radio]:checked").val();
+		
+		if( radioButtonvalue == "overWrite")
+		{
+			var periodIdList = document.getElementById( 'availablePeriods' );
+			var periodId = periodIdList.options[periodIdList.selectedIndex].value;
+			
+			var orgunitIdValue = document.reportForm.ouIDTB.value;
+			
+			var dataSetId = document.reportForm.dataSetId.value;
+			
+			//alert( periodId + "--" + orgunitIdValue + "--" + dataSetId );
+			 
+		    $.post("validateExcelImportUpdateData.action",
+			{
+		    	availablePeriods : periodId,
+		    	ouIDTB : orgunitIdValue,
+		    	dataSetId : dataSetId
+			},
+			function (data)
+			{
+				getDataReceived(data);
+			},'xml');
+		}
+		
+		else
+		{
+			setMessage( "Importing started");
+			document.getElementById( "reportForm" ).submit();
+		}
 	}
 }
+
+function getDataReceived(messageElement) 
+{
+	messageElement = messageElement.getElementsByTagName( "message" )[0];
+	var type = messageElement.getAttribute( "type" );
+	
+	if ( type == 'success') 
+	{
+		var result = window.confirm( messageElement.firstChild.nodeValue );
+		
+		if ( result )
+	    {
+			setMessage( "Importing started");
+			document.getElementById( "reportForm" ).submit();
+	    }
+		
+		//alert( messageElement.firstChild.nodeValue );
+	} 
+	
+}

=== modified file 'local/in/dhis-web-excelimport/src/main/webapp/dhis-web-excelimport/menu.vm'
--- local/in/dhis-web-excelimport/src/main/webapp/dhis-web-excelimport/menu.vm	2012-08-18 11:15:26 +0000
+++ local/in/dhis-web-excelimport/src/main/webapp/dhis-web-excelimport/menu.vm	2015-02-17 06:59:25 +0000
@@ -6,14 +6,53 @@
         <li>
             <a href = "excelImportForm.action">Data Import From Excel</a>
         </li>
-        <li>
+<!--        <li>
             <a href = "portalDataImportForm.action">Data Import From Portal</a>
         </li>
         <li>
             <a href = "tcsDataImportForm.action">Import XML From TNHMIS</a>
         </li>
-        <li>
-            <a href = "BDDataImportForm.action">Bangladesh Data Import Form</a>
-        </li>
-    </ul>
+-->        
+    </ul>        
+ </ul>       
+<ul>
+     <li>Downloads</li>
+     <ul>   
+		<li>
+            <a href = "../dhis-web-reporting/displayViewDocumentForm.action">Download Reporting Format</a>
+			<!--
+			<a href = "exportExcelFile.action?fileType=CBD_SRH_NSRH_FPAN.xls" target="_blank">Format for CBD Reporting</a>
+            <a href = "exportExcelFile.action?fileType=HIVAIDS.xls" target="_blank">Format for SRH-HIV/AIDS Services</a>
+            <a href = "exportExcelFile.action?fileType=Infertility.xls" target="_blank">Format for SRH-Subfertility/Infertility Services</a>
+            <a href = "exportExcelFile.action?fileType=Obstetric.xls" target="_blank">Format for SRH-Obstetric Services</a>
+            <a href = "exportExcelFile.action?fileType=Urology.xls" target="_blank">Format for SRH-Urology Services</a>
+			<a href = "exportExcelFile.action?fileType=STIRTI.xls" target="_blank">Format for SRH-STI/RTI Services</a>
+			<a href = "exportExcelFile.action?fileType=Stocks.xls" target="_blank">Format for SRH-Contraception Stocks.xls Services</a>
+			<a href = "exportExcelFile.action?fileType=Paediartic.xls" target="_blank">Format for SRH-Paediartic Services</a>
+			<a href = "exportExcelFile.action?fileType=Specialised.xls" target="_blank">Format for SRH-Specialised Services</a>
+			<a href = "exportExcelFile.action?fileType=Othersrh.xls" target="_blank">Format for SRH-Other Services</a>
+			-->
+        </li>		
+		
+		
+		<!--
+		<li>
+            <a href = "exportExcelFile.action?fileType=phc" target="_blank">Format for PHC/CHC/DH/SDH</a>
+        </li>
+		<li>
+            <a href = "exportExcelFile.action?fileType=private" target="_blank">Format for Private</a>
+        </li>
+        <li>
+            <a href = "exportExcelFile.action?fileType=sc" target="_blank">Format for SC</a>
+        </li>
+        <li>
+            <a href = "exportExcelFile.action?fileType=sopphc" target="_blank">SOP PHC 22-10-2012</a>
+        </li>
+        <li>
+            <a href = "exportExcelFile.action?fileType=sopsc" target="_blank">SOP SC 22-10-2012</a>
+        </li>
+		-->
+		
+		
+     </ul>   
 </ul>

=== modified file 'local/in/dhis-web-excelimport/src/main/webapp/dhis-web-excelimport/portalDataImportForm.vm'
--- local/in/dhis-web-excelimport/src/main/webapp/dhis-web-excelimport/portalDataImportForm.vm	2012-08-18 11:15:26 +0000
+++ local/in/dhis-web-excelimport/src/main/webapp/dhis-web-excelimport/portalDataImportForm.vm	2013-09-19 06:34:31 +0000
@@ -18,7 +18,7 @@
 </style>
 
 <div id="overlay">
-	<div id="overlayImg"><img  width="50" height="50" src="ima	ges/ajax-loader.gif" /></div>
+	<div id="overlayImg"><img  width="50" height="50" src="images/ajax-loader.gif" /></div>
 </div>
 
 <script>
@@ -36,9 +36,9 @@
 	#foreach ( $excelImportSheet in $excelImportSheetList )
 		var excelImportSheetId = ""+"$excelImportSheet.xmlTemplateName";
 		proformas.put( excelImportSheetId, "$excelImportSheet.proforma" );
-		checkerTemplateNames.put( excelImportSheetId, "$excelImportSheet.checkTemplateName" );
-		checkerRangeForHeaders.put( excelImportSheetId, "$excelImportSheet.checkRangeForHeader" );
-        checkerRangeForData.put( excelImportSheetId, "$excelImportSheet.checkRangeForData" );
+		checkerTemplateNames.put( excelImportSheetId, "$excelImportSheet.checkerTemplateName" );
+		checkerRangeForHeaders.put( excelImportSheetId, "$excelImportSheet.checkerRangeForHeader" );
+        checkerRangeForData.put( excelImportSheetId, "$excelImportSheet.checkerRangeForData" );
         datasetIds.put( excelImportSheetId, "$excelImportSheet.datasetId" );
 		orgunitGroupIds.put( excelImportSheetId, "$excelImportSheet.orgunitGroupId" );
 		facilityStarts.put( excelImportSheetId, "$excelImportSheet.facilityStart" );
@@ -122,9 +122,9 @@
             <td class="NormalB">
                 <input type="submit" name="importReport" value='Import Data' style="width:325px" />
                 <input type="hidden" name="proforma" id="proforma" />
-                <input type="hidden" name="checkTemplateName" id="checkTemplateName" />
-                <input type="hidden" name="checkRangeForHeader" id="checkRangeForHeader" />
-                <input type="hidden" name="checkRangeForData" id="checkRangeForData" />
+                <input type="hidden" name="checkerTemplateName" id="checkerTemplateName" />
+                <input type="hidden" name="checkerRangeForHeader" id="checkerRangeForHeader" />
+                <input type="hidden" name="checkerRangeForData" id="checkerRangeForData" />
                 <input type="hidden" name="datasetId" id="datasetId" />
 				<input type="hidden" name="orgunitGroupId" id="orgunitGroupId" />
 				<input type="hidden" name="facilityStart" id="facilityStart" />

=== modified file 'local/in/dhis-web-ihrissyncmanager/pom.xml'
--- local/in/dhis-web-ihrissyncmanager/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-web-ihrissyncmanager/pom.xml	2014-09-01 12:24:29 +0000
@@ -6,7 +6,7 @@
 	<parent>
 		<groupId>org.hisp.dhis</groupId>
 		<artifactId>dhis-web</artifactId>
-		<version>2.15-SNAPSHOT</version>
+		<version>2.15</version>
 	</parent>
 
     <repositories>
@@ -21,7 +21,7 @@
 	<name>DHIS-IHRIS Synchronisation Management Service</name>
 	
 	<build>
-		<finalName>>dhis-web-ihrissyncmanager</finalName>
+		<finalName>dhis-web-ihrissyncmanager</finalName>
 	</build>
 	
 	<dependencies>
@@ -70,29 +70,16 @@
 			<artifactId>dhis-in-api</artifactId>
 			<version>${project.version}</version>
 		</dependency>
-        <dependency>
-            <groupId>org.hisp.dhis</groupId>
-            <artifactId>dhis-in-service-ihrissyncmanager</artifactId>
-            <version>${project.version}</version>
-        </dependency>
+
 		<!-- Other -->
 		<dependency>
 			<groupId>net.sourceforge.jexcelapi</groupId>
 			<artifactId>jxl</artifactId>
 		</dependency>
 
-        <dependency>
-            <groupId>commons-dbcp</groupId>
-            <artifactId>commons-dbcp</artifactId>
-            <version>1.2.2</version>
-        </dependency>
-
+ 
         <!--Quartz framework-->
-        <dependency>
-            <groupId>org.quartz-scheduler</groupId>
-            <artifactId>quartz</artifactId>
-            <version>2.1.5</version>
-        </dependency>
+ 
 		
 	</dependencies>
 

=== removed file 'local/in/dhis-web-ihrissyncmanager/src/main/java/org/hisp/dhis/ihrissyncmanager/action/DeleteAggDataElementAction.java'
--- local/in/dhis-web-ihrissyncmanager/src/main/java/org/hisp/dhis/ihrissyncmanager/action/DeleteAggDataElementAction.java	2013-03-25 05:08:43 +0000
+++ local/in/dhis-web-ihrissyncmanager/src/main/java/org/hisp/dhis/ihrissyncmanager/action/DeleteAggDataElementAction.java	1970-01-01 00:00:00 +0000
@@ -1,65 +0,0 @@
-package org.hisp.dhis.ihrissyncmanager.action;
-
-import com.opensymphony.xwork2.Action;
-import org.hisp.dhis.ihrissyncmanager.AggDataService;
-import org.hisp.dhis.organisationunit.OrganisationUnit;
-import org.hisp.dhis.organisationunit.OrganisationUnitService;
-import org.hisp.dhis.period.Period;
-import org.hisp.dhis.period.PeriodService;
-import org.hisp.dhis.period.PeriodType;
-
-import java.text.SimpleDateFormat;
-import java.util.ArrayList;
-import java.util.Date;
-import java.util.List;
-
-/**
- * Created with IntelliJ IDEA.
- * User: Mohit
- * Date: 15/9/12
- * Time: 1:18 PM
- * To change this template use File | Settings | File Templates.
- */
-public class DeleteAggDataElementAction implements Action {
-
-
-
-    //------------------------------------------------------------------------------------------------------
-    //                                       Dependencies
-    //------------------------------------------------------------------------------------------------------
-
-    private AggDataService deleteAggDataService;
-
-    public void setDeleteAggDataService(AggDataService deleteAggDataService) {
-        this.deleteAggDataService = deleteAggDataService;
-    }
-
-
-    //------------------------------------------------------------------------------------------------------
-    //                                      Web-Params
-    //------------------------------------------------------------------------------------------------------
-
-    private String dataElementName;
-
-    public void setDataElementName(String dataElementName) {
-        this.dataElementName = dataElementName;
-    }
-
-    //------------------------------------------------------------------------------------------------------
-    //                                       Implementation
-    //------------------------------------------------------------------------------------------------------
-
-    @Override
-    public String execute() throws Exception {
-
-        System.out.println("=======================================================================================================================================================================");
-
-        System.out.println("* TEST Delete-DATAELEMENT ACTION [DataElement Name:"+dataElementName+"]");
-
-        System.out.println("=======================================================================================================================================================================");
-
-        deleteAggDataService.deleteAggDataElement(dataElementName);
-
-        return null;
-    }
-}

=== removed file 'local/in/dhis-web-ihrissyncmanager/src/main/java/org/hisp/dhis/ihrissyncmanager/action/RecordAggDataElementAction.java'
--- local/in/dhis-web-ihrissyncmanager/src/main/java/org/hisp/dhis/ihrissyncmanager/action/RecordAggDataElementAction.java	2013-03-25 05:08:43 +0000
+++ local/in/dhis-web-ihrissyncmanager/src/main/java/org/hisp/dhis/ihrissyncmanager/action/RecordAggDataElementAction.java	1970-01-01 00:00:00 +0000
@@ -1,152 +0,0 @@
-package org.hisp.dhis.ihrissyncmanager.action;
-
-import com.opensymphony.xwork2.Action;
-import org.hisp.dhis.ihrissyncmanager.AggDataService;
-import org.hisp.dhis.organisationunit.OrganisationUnit;
-import org.hisp.dhis.organisationunit.OrganisationUnitService;
-import org.hisp.dhis.period.Period;
-import org.hisp.dhis.period.PeriodService;
-import org.hisp.dhis.period.PeriodType;
-
-import java.text.SimpleDateFormat;
-import java.util.ArrayList;
-import java.util.Date;
-import java.util.List;
-
-/**
- * Gaurav<gaurav08021@gmail.com>, 8/27/12 [5:07 PM]
- */
-public class RecordAggDataElementAction implements Action {
-
-
-    //------------------------------------------------------------------------------------------------------
-    //                                       Dependencies
-    //------------------------------------------------------------------------------------------------------
-
-
-    private PeriodService periodService;
-
-    public void setPeriodService(PeriodService periodService) {
-        this.periodService = periodService;
-    }
-
-    private OrganisationUnitService organisationUnitService;
-
-    public void setOrganisationUnitService(OrganisationUnitService organisationUnitService) {
-        this.organisationUnitService = organisationUnitService;
-    }
-
-    private AggDataService recordAggDataService;
-
-    public void setRecordAggDataService(AggDataService recordAggDataService)
-    {
-        this.recordAggDataService = recordAggDataService;
-    }
-
-    //------------------------------------------------------------------------------------------------------
-    //                                      Web-Params
-    //------------------------------------------------------------------------------------------------------
-
-
-    private String DataElementName;
-
-    private String AggValue;
-
-    private String OrganisationUnitName;
-
-    private String PeriodStart;
-
-    private String PeriodTypeString;
-
-    public void setDataElementName(String dataElementName) {
-        DataElementName = dataElementName;
-    }
-
-    public void setAggValue(String aggValue) {
-        AggValue = aggValue;
-    }
-
-    public void setOrganisationUnitName(String organisationUnitName) {
-        OrganisationUnitName = organisationUnitName;
-    }
-
-    public void setPeriodStart(String periodStart) {
-        PeriodStart = periodStart;
-    }
-
-    public void setPeriodTypeString(String periodTypeString) {
-        PeriodTypeString = periodTypeString;
-    }
-
-    //------------------------------------------------------------------------------------------------------
-    //                                       Implementation
-    //------------------------------------------------------------------------------------------------------
-
-
-    public Period getSelectedPeriod(Date startDate, PeriodType periodType) throws Exception {
-
-
-        List<Period> periods = new ArrayList<Period>(periodService.getPeriodsByPeriodType(periodType));
-        for (Period period : periods) {
-            Date tempDate = period.getStartDate();
-            if (tempDate.equals(startDate)) {
-                return period;
-            }
-        }
-
-        Period period = periodType.createPeriod(startDate);
-        period = reloadPeriodForceAdd(period);
-
-
-        return period;
-    }
-
-    private final Period reloadPeriod(Period period) {
-        return periodService.getPeriod(period.getStartDate(), period.getEndDate(), period.getPeriodType());
-    }
-
-    private final Period reloadPeriodForceAdd(Period period) {
-        Period storedPeriod = reloadPeriod(period);
-
-        if (storedPeriod == null) {
-
-            periodService.addPeriod(period);
-            return period;
-        }
-
-        return storedPeriod;
-    }
-
-    //------------------------------------------------------------------------------------------------------
-    //                                       Action Implementation
-    //------------------------------------------------------------------------------------------------------
-
-    public String execute() throws Exception
-    {
-
-        PeriodType periodType =  PeriodType.getPeriodTypeByName(PeriodTypeString);
-
-        SimpleDateFormat dateFormat = new SimpleDateFormat("MMMM dd,yyyy");
-
-        Date convertedStartDate = dateFormat.parse(PeriodStart);
-
-        Period period = getSelectedPeriod(convertedStartDate,periodType);
-
-        System.out.println("=======================================================================================================================================================================");
-
-        System.out.println("* TEST AGG-DATAELEMENT ACTION [Org. Unit:"+OrganisationUnitName+" ,DataElement Name:"+DataElementName+" ,Aggregate Value:"+AggValue+" ,Start Date:"+convertedStartDate+" ,PeriodType:"+PeriodTypeString+"]");
-
-        System.out.println("=======================================================================================================================================================================");
-
-        OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnitByName(OrganisationUnitName);
-
-        if(orgUnit==null)
-        {
-            orgUnit = organisationUnitService.getOrganisationUnit(1);
-        }
-
-        recordAggDataService.addNewEntries(DataElementName,orgUnit,period,Double.parseDouble(AggValue));
-
-        return null;
-    }
-}

=== removed file 'local/in/dhis-web-ihrissyncmanager/src/main/java/org/hisp/dhis/ihrissyncmanager/action/SynciHRISUserAction.java'
--- local/in/dhis-web-ihrissyncmanager/src/main/java/org/hisp/dhis/ihrissyncmanager/action/SynciHRISUserAction.java	2013-03-25 05:08:43 +0000
+++ local/in/dhis-web-ihrissyncmanager/src/main/java/org/hisp/dhis/ihrissyncmanager/action/SynciHRISUserAction.java	1970-01-01 00:00:00 +0000
@@ -1,77 +0,0 @@
-package org.hisp.dhis.ihrissyncmanager.action;
-
-/**
- * Created with IntelliJ IDEA.
- * User: Mohit
- * Date: 29/8/12
- * Time: 3:01 PM
- * To change this template use File | Settings | File Templates.
- */
-
-import com.opensymphony.xwork2.Action;
-import org.hisp.dhis.ihrissyncmanager.SynciHRISUserService;
-import org.hisp.dhis.organisationunit.OrganisationUnit;
-import org.hisp.dhis.organisationunit.OrganisationUnitService;
-
-public class SynciHRISUserAction implements Action {
-
-    //------------------------------------------------------------------------------------------------------
-    //                                       Dependencies
-    //------------------------------------------------------------------------------------------------------
-
-
-    private SynciHRISUserService synciHRISUserService;
-
-    public void setSynciHRISUserService(SynciHRISUserService synciHRISUserService) {
-        this.synciHRISUserService = synciHRISUserService;
-    }
-
-    //------------------------------------------------------------------------------------------------------
-    //                                      Web-Params
-    //------------------------------------------------------------------------------------------------------
-
-    String ihrisUsername;
-    String firstName;
-
-    public void setIhrisUsername(String ihrisUsername) {
-        this.ihrisUsername = ihrisUsername;
-    }
-
-    public void setFirstName(String firstName) {
-        this.firstName = firstName;
-    }
-
-    public void setLastName(String lastName) {
-        this.lastName = lastName;
-    }
-
-    public void setEmail(String email) {
-        this.email = email;
-    }
-
-    public void setPassword(String password) {
-        this.password = password;
-    }
-
-    String lastName;
-    String email;
-    String password;
-
-    //------------------------------------------------------------------------------------------------------
-    //                                       Action Implementation
-    //------------------------------------------------------------------------------------------------------
-
-    public String execute() throws Exception
-    {
-
-        System.out.println("=====================================================================================================================================");
-
-        System.out.println("* TEST ihris User ACTION [Username:"+ihrisUsername+" ,First Name:"+firstName+" ,Last Name:"+lastName+" , Email: "+email+", Password: "+password+"]");
-
-        System.out.println("======================================================================================================================================");
-
-        synciHRISUserService.createNewiHRISUser(ihrisUsername,firstName,lastName,email,password);
-
-        return null;
-    }
-}

=== modified file 'local/in/dhis-web-ihrissyncmanager/src/main/resources/META-INF/dhis/beans.xml'
--- local/in/dhis-web-ihrissyncmanager/src/main/resources/META-INF/dhis/beans.xml	2013-03-25 05:08:43 +0000
+++ local/in/dhis-web-ihrissyncmanager/src/main/resources/META-INF/dhis/beans.xml	2014-09-01 12:18:56 +0000
@@ -3,26 +3,15 @@
 	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 	xsi:schemaLocation="
 	http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">
-
-    <bean id="org.hisp.dhis.organisationunit.OrganisationUnitService" class="org.hisp.dhis.organisationunit.DefaultOrganisationUnitService">
-        <property name="organisationUnitStore" ref="org.hisp.dhis.organisationunit.OrganisationUnitStore" />
-        <property name="organisationUnitLevelStore" ref="org.hisp.dhis.organisationunit.OrganisationUnitLevelStore" />
-        <property name="currentUserService" ref="org.hisp.dhis.user.CurrentUserService" />
-        <property name="versionService" ref="org.hisp.dhis.version.VersionService" />
-    </bean>
-
-    <bean id="org.hisp.dhis.ihrissyncmanager.action.DeleteAggDataElementAction"
-          class="org.hisp.dhis.ihrissyncmanager.action.DeleteAggDataElementAction"
-          scope="prototype">
-        <property name="deleteAggDataService" ref="org.hisp.dhis.ihrissyncmanager.AggDataService"/>
-    </bean>
-
-    <bean id="org.hisp.dhis.ihrissyncmanager.action.RecordAggDataElementAction"
-          class="org.hisp.dhis.ihrissyncmanager.action.RecordAggDataElementAction"
-          scope="prototype">
-        <property name="recordAggDataService" ref="org.hisp.dhis.ihrissyncmanager.AggDataService"/>
-        <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService"/>
-        <property name="periodService" ref="org.hisp.dhis.period.PeriodService"/>
-    </bean>
+    
+    <bean id="org.hisp.dhis.ihrissyncmanager.action.SyncIHRISMetaDataAction"
+          class="org.hisp.dhis.ihrissyncmanager.action.SyncIHRISMetaDataAction"
+          scope="prototype">
+        <property name="dataElementService" ref="org.hisp.dhis.dataelement.DataElementService"/>
+        <property name="dataElementCategoryService" ref="org.hisp.dhis.dataelement.DataElementCategoryService"/>
+        
+    </bean>    
+    
+    
 
 </beans>
\ No newline at end of file

=== modified file 'local/in/dhis-web-ihrissyncmanager/src/main/resources/struts.xml'
--- local/in/dhis-web-ihrissyncmanager/src/main/resources/struts.xml	2013-03-25 05:08:43 +0000
+++ local/in/dhis-web-ihrissyncmanager/src/main/resources/struts.xml	2014-09-01 12:19:14 +0000
@@ -6,13 +6,12 @@
 <include file="dhis-web-commons.xml"/>
 	
 <package name="dhis-web-ihrissyncmanager" extends="dhis-web-commons" namespace="/dhis-web-ihrissyncmanager">
-
-
-	<action name="recordAggDataElementAction" class="org.hisp.dhis.ihrissyncmanager.action.RecordAggDataElementAction"></action>
-
-    <action name="syncOrgUnitAction" class="org.hisp.dhis.ihrissyncmanager.action.SyncOrgUnitAction"></action>
-
-    <action name="deleteAggDataElementAction" class="org.hisp.dhis.ihrissyncmanager.action.DeleteAggDataElementAction"></action>
+    
+	<action name="syncIHRISMetaDataAction"
+	    class="org.hisp.dhis.ihrissyncmanager.action.SyncIHRISMetaDataAction">
+	    <result name="success" type="velocity-xml">/dhis-web-ihrissyncmanager/responseResult.vm</result>
+	</action>    
+    
 
 </package>
-</struts>
\ No newline at end of file
+</struts>

=== modified file 'local/in/dhis-web-ihrissyncmanager/src/main/webapp/WEB-INF/web.xml'
--- local/in/dhis-web-ihrissyncmanager/src/main/webapp/WEB-INF/web.xml	2013-03-25 05:08:43 +0000
+++ local/in/dhis-web-ihrissyncmanager/src/main/webapp/WEB-INF/web.xml	2014-08-30 10:15:27 +0000
@@ -20,6 +20,7 @@
       <param-value>dhis-web-ihrissyncmanager</param-value>
     </init-param>
   </filter>
+  
   <filter>
     <filter-name>OpenSessionInViewFilter</filter-name>
     <filter-class>org.springframework.orm.hibernate4.support.OpenSessionInViewFilter</filter-class>
@@ -28,10 +29,12 @@
     <filter-name>springSecurityFilterChain</filter-name>
     <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
   </filter>
+  
   <filter>
     <filter-name>Struts</filter-name>
-    <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
+    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
   </filter>
+  
   <filter-mapping>
     <filter-name>RedirectFilter</filter-name>
     <url-pattern>/</url-pattern>
@@ -55,5 +58,4 @@
   <listener>
     <listener-class>org.hisp.dhis.system.startup.StartupListener</listener-class>
   </listener>
-  
 </web-app>

=== modified file 'local/in/dhis-web-maintenance-in/pom.xml'
--- local/in/dhis-web-maintenance-in/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-web-maintenance-in/pom.xml	2014-07-03 10:10:28 +0000
@@ -6,7 +6,7 @@
 	<parent>
 		<groupId>org.hisp.dhis</groupId>
 		<artifactId>dhis-web</artifactId>
-		<version>2.15-SNAPSHOT</version>
+		<version>2.15</version>
 	</parent>
 	
 	<artifactId>dhis-web-maintenance-in</artifactId>

=== modified file 'local/in/dhis-web-maintenance-in/src/main/webapp/WEB-INF/web.xml'
--- local/in/dhis-web-maintenance-in/src/main/webapp/WEB-INF/web.xml	2012-04-04 05:46:52 +0000
+++ local/in/dhis-web-maintenance-in/src/main/webapp/WEB-INF/web.xml	2013-09-19 06:34:31 +0000
@@ -31,7 +31,7 @@
   </filter>
   <filter>
     <filter-name>Struts</filter-name>
-    <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
+    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
   </filter>
   
   <filter-mapping>

=== modified file 'local/in/dhis-web-reports-national/pom.xml'
--- local/in/dhis-web-reports-national/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-web-reports-national/pom.xml	2014-07-04 11:24:43 +0000
@@ -6,7 +6,7 @@
 	<parent>
 		<groupId>org.hisp.dhis</groupId>
 		<artifactId>dhis-web</artifactId>
-		<version>2.15-SNAPSHOT</version>
+		<version>2.15</version>
 	</parent>
 	
 	<artifactId>dhis-web-reports-national</artifactId>
@@ -23,172 +23,155 @@
       <groupId>javax.servlet</groupId>
       <artifactId>servlet-api</artifactId>
 	</dependency>		
-		<!-- DHIS -->
-		
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-api</artifactId>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-in-api</artifactId>
-			<version>${project.version}</version>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-service-core</artifactId>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-in-service-configuration</artifactId>
-			<version>${project.version}</version>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-service-patient</artifactId>
-		</dependency>
-		<!--<dependency>
-		<groupId>org.hisp.dhis</groupId>
-		<artifactId>dhis-service-organisationunit</artifactId>
-		</dependency>       -->
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-web-commons</artifactId>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-web-commons-resources</artifactId>
-			<type>war</type>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-service-reporting</artifactId>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-service-datamart-default</artifactId>
-		</dependency>
-<!--		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-service-core</artifactId>
-		</dependency>-->
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-service-aggregationengine-default</artifactId>
-			<version>${project.version}</version>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-in-service-reports</artifactId>
-			<version>${project.version}</version>
-		</dependency>
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-support-external</artifactId>
-		</dependency>
-		<!--<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-in-api</artifactId>
-			<version>${project.version}</version>
-		</dependency>-->
-		<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-in-service-survey</artifactId>
-			<version>${project.version}</version>
-		</dependency>
-		<!--<dependency>
-			<groupId>org.hisp.dhis</groupId>
-			<artifactId>dhis-service-patient</artifactId>
-		</dependency>-->
-		<dependency>
-		  <groupId>org.hisp.dhis</groupId>
-		  <artifactId>dhis-web-api</artifactId>
-		</dependency>
-		
-		<!-- Web -->
-		
-		<dependency>
-			<groupId>commons-fileupload</groupId>
-			<artifactId>commons-fileupload</artifactId>
-		</dependency>
-		
-		<!-- JasperReports -->
-		<!--
-		<dependency>
-		<groupId>jasperreports</groupId>
-		<artifactId>jasperreports</artifactId>
-		</dependency>
-		<dependency>
-		<groupId>poi</groupId>
-		<artifactId>poi</artifactId>
-		<version>2.5.1</version>
-		</dependency>
-		<dependency>
-		<groupId>jfree</groupId>
-		<artifactId>jfreechart</artifactId>
-		</dependency>
-		<dependency>
-		<groupId>eclipse</groupId>
-		<artifactId>jdtcore</artifactId>
-		<version>3.1.0</version>
-		</dependency>
-		<dependency>
-		<groupId>com.lowagie</groupId>
-		<artifactId>itext</artifactId>
-		</dependency>
-		-->
-		<!-- Other -->
-		<!--  
-		<dependency>
-		<groupId>org.springframework</groupId>
-		<artifactId>spring-orm</artifactId>
-		</dependency>
-		-->
-		<dependency>
-			<groupId>commons-logging</groupId>
-			<artifactId>commons-logging</artifactId>
-		</dependency>
-		<!--    
-		<dependency>
-		<groupId>jasperreports</groupId>
-		<artifactId>jasperreports</artifactId>
-		<version>2.0.2</version>
-		</dependency>
-		<dependency>
-		<groupId>jfree</groupId>
-		<artifactId>jfreechart</artifactId>
-		<version>1.0.11</version>
-		<exclusions>
-		<exclusion>
-		<groupId>gnujaxp</groupId>
-		<artifactId>gnujaxp</artifactId>
-		</exclusion>
-		</exclusions>
-		</dependency>
-		<dependency>
-		<groupId>jfree</groupId>
-		<artifactId>jcommon</artifactId>
-		<version>1.0.14</version>
-		<exclusions>
-		<exclusion>
-		<groupId>gnujaxp</groupId>
-		<artifactId>gnujaxp</artifactId>
-		</exclusion>
-		</exclusions>
-		</dependency>
-		-->
-		<dependency>
-			<groupId>net.sourceforge.jexcelapi</groupId>
-			<artifactId>jxl</artifactId>
-			<version>2.6.12</version>
-		</dependency>
-		<dependency>
-			<groupId>org.amplecode</groupId>
-			<artifactId>cave-process</artifactId>
-		</dependency>
-		
-	</dependencies>
-  <properties>
-    <rootDir>../../</rootDir>
-  </properties>	
+   
+    <!-- DHIS -->
+    
+     <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-api</artifactId>
+    </dependency>
+	<dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-in-api</artifactId>
+	  <version>${project.version}</version>
+    </dependency>
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-service-core</artifactId>
+    </dependency>
+	<dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-in-service-configuration</artifactId>
+      <version>${project.version}</version>
+    </dependency>
+	<dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-in-service-survey</artifactId>
+      <version>${project.version}</version>
+    </dependency>
+	<!--
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-service-patient</artifactId>
+    </dependency>
+	-->
+	<dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-service-reporting</artifactId>
+    </dependency>
+	<dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-service-datamart-default</artifactId>
+    </dependency>
+	
+	<dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-service-aggregationengine-default</artifactId>
+      <version>${project.version}</version>	  
+    </dependency>
+
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-in-service-reports</artifactId>
+      <version>${project.version}</version>
+    </dependency>	
+
+	
+    <dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-commons</artifactId>
+    </dependency>
+	<dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-web-commons-resources</artifactId>
+      <type>war</type>
+    </dependency> 
+	<dependency>
+      <groupId>org.hisp.dhis</groupId>
+      <artifactId>dhis-support-external</artifactId>
+    </dependency>
+    
+	<!-- Web -->
+    
+	 <dependency>
+      <groupId>commons-fileupload</groupId>
+      <artifactId>commons-fileupload</artifactId>
+    </dependency>
+	
+	<!-- JasperReports -->
+<!--
+    <dependency>
+      <groupId>jasperreports</groupId>
+      <artifactId>jasperreports</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>poi</groupId>
+      <artifactId>poi</artifactId>
+      <version>2.5.1</version>
+    </dependency>
+    <dependency>
+      <groupId>jfree</groupId>
+      <artifactId>jfreechart</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>eclipse</groupId>
+      <artifactId>jdtcore</artifactId>
+      <version>3.1.0</version>
+    </dependency>
+	<dependency>
+        <groupId>com.lowagie</groupId>
+        <artifactId>itext</artifactId>
+    </dependency>
+-->    
+    <!-- Other -->
+  <!--  
+    <dependency>
+      <groupId>org.springframework</groupId>
+      <artifactId>spring-orm</artifactId>
+    </dependency>
+    -->
+    <dependency>
+      <groupId>commons-logging</groupId>
+      <artifactId>commons-logging</artifactId>
+    </dependency>
+	<!--    
+    <dependency>
+      <groupId>jasperreports</groupId>
+      <artifactId>jasperreports</artifactId>
+     <version>2.0.2</version>
+    </dependency>
+    <dependency>
+      <groupId>jfree</groupId>
+      <artifactId>jfreechart</artifactId>
+      <version>1.0.11</version>
+      <exclusions>
+        <exclusion>
+          <groupId>gnujaxp</groupId>
+          <artifactId>gnujaxp</artifactId>
+        </exclusion>
+      </exclusions>
+	</dependency>
+    <dependency>
+      <groupId>jfree</groupId>
+      <artifactId>jcommon</artifactId>
+      <version>1.0.14</version>
+      <exclusions>
+        <exclusion>
+          <groupId>gnujaxp</groupId>
+          <artifactId>gnujaxp</artifactId>
+        </exclusion>
+      </exclusions>
+    </dependency>
+	-->
+    <dependency>
+      <groupId>net.sourceforge.jexcelapi</groupId>
+      <artifactId>jxl</artifactId>
+      <version>2.6</version>
+    </dependency>
+    <dependency>
+      <groupId>org.amplecode</groupId>
+      <artifactId>cave-process</artifactId>
+    </dependency>
+  
+  </dependencies>	  
 </project>

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/TwentyPoint/action/GenerateTwentyPointReportsResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/TwentyPoint/action/GenerateTwentyPointReportsResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/TwentyPoint/action/GenerateTwentyPointReportsResultAction.java	2014-07-05 06:28:28 +0000
@@ -56,7 +56,6 @@
 import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
-import org.hisp.dhis.reports.util.OrganisationUnitCommentComparator;
 import org.hisp.dhis.reports.util.ReportService;
 import org.hisp.dhis.system.util.MathUtils;
 import org.w3c.dom.Document;
@@ -330,14 +329,22 @@
     {
         this.orgUnitListCB = orgUnitListCB;
     }
-
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
     private List<Integer> sheetList;
 
     private List<Integer> rowList;
@@ -440,14 +447,14 @@
         {
             orgUnitList = new ArrayList<OrganisationUnit>( selectedOrgUnit.getChildren() );
             Collections.sort( orgUnitList, new IdentifiableObjectNameComparator() );
-            Collections.sort( orgUnitList, new OrganisationUnitCommentComparator() );
+            //Collections.sort( orgUnitList, new OrganisationUnitCommentComparator() );
             orgUnitList.add( selectedOrgUnit );
         }
         else if ( reportModelTB.equals( "dynamicwithoutrootfacility" ) )
         {
             orgUnitList = new ArrayList<OrganisationUnit>( selectedOrgUnit.getChildren() );
             Collections.sort( orgUnitList, new IdentifiableObjectNameComparator() );
-            Collections.sort( orgUnitList, new OrganisationUnitCommentComparator() );
+            //Collections.sort( orgUnitList, new IdentifiableObjectNameComparator() );
         }
         else
         {
@@ -1226,9 +1233,8 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
-
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod,organisationUnit, optionCombo );
                     if ( dataValue != null )
                     {
                         // Works for both text and boolean data types

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/action/GetOrgUnitsAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/action/GetOrgUnitsAction.java	2011-12-14 11:06:08 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/action/GetOrgUnitsAction.java	2014-04-01 09:06:59 +0000
@@ -22,13 +22,22 @@
     // -------------------------------------------------------------------------
     // Getters & Setters
     // -------------------------------------------------------------------------
-
+    
+    /*
     private Integer orgUnitId;
 
     public void setOrgUnitId( Integer orgUnitId )
     {
         this.orgUnitId = orgUnitId;
     }
+    */
+    
+    private String orgUnitId;
+    
+    public void setOrgUnitId( String orgUnitId )
+    {
+        this.orgUnitId = orgUnitId;
+    }
 
     private OrganisationUnit orgUnit;
 

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/action/GetPeriodsAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/action/GetPeriodsAction.java	2011-03-01 08:37:19 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/action/GetPeriodsAction.java	2013-09-19 06:34:31 +0000
@@ -127,7 +127,6 @@
                 {
                     periodIterator.remove( );
                 }
-                
             }
             Collections.sort( periods, new PeriodComparator() );
 
@@ -171,18 +170,48 @@
                     periodNameList.add( simpleDateFormat1.format( p1.getStartDate() ) );
                 }
             }
-            else
-            {
-                simpleDateFormat1 = new SimpleDateFormat( "yyyy-MM-dd" );
-                for ( Period p1 : periods )
-                {
-                    String tempPeriodName = simpleDateFormat1.format( p1.getStartDate() ) + " - "
-                        + simpleDateFormat1.format( p1.getEndDate() );
-                    periodNameList.add( tempPeriodName );
-                }
-            }
-        }
-
+            else if ( periodType.getName().equalsIgnoreCase( "Forteen" ) )
+            {
+                simpleDateFormat1 = new SimpleDateFormat( "yyyy-MM-dd" );
+                for ( Period p1 : periods )
+                {
+                    String tempPeriodName = simpleDateFormat1.format( p1.getStartDate() ) + " - "
+                        + simpleDateFormat1.format( p1.getEndDate() );
+                    periodNameList.add( tempPeriodName );
+                }
+            }
+            
+            else if ( periodType.getName().equalsIgnoreCase( "Weekly" ) )
+            {
+                simpleDateFormat1 = new SimpleDateFormat( "yyyy-MM-dd" );
+                for ( Period p1 : periods )
+                {
+                    String tempPeriodName = simpleDateFormat1.format( p1.getStartDate() ) + " - "
+                        + simpleDateFormat1.format( p1.getEndDate() );
+                    periodNameList.add( tempPeriodName );
+                }
+            }
+            
+            else 
+            {
+                simpleDateFormat1 = new SimpleDateFormat( "yyyy-MM-dd" );
+                for ( Period p1 : periods )
+                {
+                    String tempPeriodName = simpleDateFormat1.format( p1.getStartDate() ) + " - "
+                        + simpleDateFormat1.format( p1.getEndDate() );
+                    periodNameList.add( tempPeriodName );
+                }
+            }
+            
+            
+        }
+        /*
+        for( String periodName : periodNameList )
+        {
+            System.out.println( periodName );
+        }
+        */
+        
         return SUCCESS;
     }
 

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/action/GetReportsAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/action/GetReportsAction.java	2011-04-19 07:43:37 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/action/GetReportsAction.java	2014-04-01 07:32:22 +0000
@@ -80,7 +80,20 @@
     {
         return ouName;
     }
-
+    
+    private Integer ouLavel;
+    
+    public Integer getOuLavel()
+    {
+        return ouLavel;
+    }
+    private int selectedOrgUnitLevel;
+    
+    public int getSelectedOrgUnitLevel()
+    {
+        return selectedOrgUnitLevel;
+    }
+    
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
@@ -92,14 +105,22 @@
         {
             try
             {
-                OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( Integer.parseInt( ouId ) );
-
+                //OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( Integer.parseInt( ouId ) );
+                
+                OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( ouId );
+                
                 ouName = orgUnit.getShortName();
-
+                ouLavel = orgUnit.getLevel();
+                
+                selectedOrgUnitLevel = organisationUnitService.getLevelOfOrganisationUnit( orgUnit.getId() );
+                
+                //selectedOrgUnitLevel = organisationUnitService.getLevelOfOrganisationUnit( Integer.parseInt( ouId ) );
+                
+                //System.out.println( "ouName  : " + orgUnit.getShortName() + "---- ouLavel  : " + orgUnit.getLevel() + "------LAVEL----- " + selectedOrgUnitLevel );
+                
                 PeriodType periodTypeObj = periodService.getPeriodTypeByName( periodType );
                 
-                reportList = new ArrayList<Report_in>( reportService.getReportsByPeriodSourceAndReportType(
-                    periodTypeObj, orgUnit, reportType ) );
+                reportList = new ArrayList<Report_in>( reportService.getReportsByPeriodSourceAndReportType( periodTypeObj, orgUnit, reportType ) );
                 
                 Collections.sort( reportList, new Report_inNameComparator() );
             }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/activeplan/action/ActivePlanReportsFormAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/activeplan/action/ActivePlanReportsFormAction.java	2011-01-13 04:53:40 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/activeplan/action/ActivePlanReportsFormAction.java	2014-07-05 06:41:27 +0000
@@ -1,25 +1,5 @@
 package org.hisp.dhis.reports.activeplan.action;
 
-import java.io.File;
-import java.text.SimpleDateFormat;
-import java.util.ArrayList;
-import java.util.List;
-
-import javax.xml.parsers.DocumentBuilder;
-import javax.xml.parsers.DocumentBuilderFactory;
-
-import org.hisp.dhis.period.MonthlyPeriodType;
-import org.hisp.dhis.period.Period;
-import org.hisp.dhis.period.PeriodService;
-import org.hisp.dhis.reports.ReportService;
-import org.hisp.dhis.reports.util.Report;
-import org.w3c.dom.Document;
-import org.w3c.dom.Element;
-import org.w3c.dom.Node;
-import org.w3c.dom.NodeList;
-import org.xml.sax.SAXException;
-import org.xml.sax.SAXParseException;
-
 import com.opensymphony.xwork2.Action;
 
 public class ActivePlanReportsFormAction
@@ -29,7 +9,7 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-
+    /*
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -43,11 +23,12 @@
     {
         this.periodService = periodService;
     }
-
+    */
+    
     // -------------------------------------------------------------------------
     // Getter & Setter
     // -------------------------------------------------------------------------
-
+    /*
     private List<Report> reportList;
 
     public List<Report> getReportList()
@@ -70,7 +51,8 @@
     }
 
     private String raFolderName;
-
+    */
+    
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
@@ -79,7 +61,7 @@
     public String execute()
         throws Exception
     {
-        raFolderName = reportService.getRAFolderName();
+ /*       raFolderName = reportService.getRAFolderName();
 
         periodList = new ArrayList<Period>( periodService.getPeriodsByPeriodType( new MonthlyPeriodType() ) );
 
@@ -89,14 +71,14 @@
 
         System.out.println( "periodList.size " + periodList.size() );
 
-        getSelectedReportList();
+        getSelectedReportList();*/
 
         return SUCCESS;
     }
 
-    public void getSelectedReportList()
+   /* public void getSelectedReportList()*/
     {
-        String fileName = "NBITSactivePlanFeedBackReportsList.xml";
+        /*String fileName = "NBITSactivePlanFeedBackReportsList.xml";
         String path = System.getProperty( "user.home" ) + File.separator + "dhis" + File.separator + raFolderName
             + File.separator + fileName;
         try
@@ -185,7 +167,7 @@
         catch ( Throwable t )
         {
             t.printStackTrace();
-        }
+        }*/
 
     }// getReportList end
 

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/activeplan/action/ActivePlanReportsResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/activeplan/action/ActivePlanReportsResultAction.java	2012-06-18 09:15:09 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/activeplan/action/ActivePlanReportsResultAction.java	2014-07-05 06:38:59 +0000
@@ -27,76 +27,18 @@
  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */
 
-import java.io.BufferedInputStream;
 import java.io.File;
-import java.io.FileInputStream;
 import java.io.InputStream;
 import java.text.SimpleDateFormat;
 import java.util.ArrayList;
-import java.util.Collection;
 import java.util.Date;
-import java.util.HashMap;
-import java.util.HashSet;
-import java.util.Iterator;
 import java.util.List;
-import java.util.Map;
-import java.util.Set;
-import java.util.UUID;
 
 import javax.xml.parsers.DocumentBuilder;
 import javax.xml.parsers.DocumentBuilderFactory;
 
-import jxl.Workbook;
-import jxl.format.Alignment;
-import jxl.format.Border;
-import jxl.format.BorderLineStyle;
-import jxl.format.VerticalAlignment;
-import jxl.write.Label;
-import jxl.write.WritableCell;
-import jxl.write.WritableCellFormat;
-import jxl.write.WritableSheet;
-import jxl.write.WritableWorkbook;
-
-import org.amplecode.quick.StatementManager;
-import org.hisp.dhis.aggregation.AggregationService;
-import org.hisp.dhis.config.Configuration_IN;
-import org.hisp.dhis.dataelement.DataElement;
-import org.hisp.dhis.dataelement.DataElementCategoryService;
-import org.hisp.dhis.dataelement.DataElementService;
 import org.hisp.dhis.i18n.I18nFormat;
-import org.hisp.dhis.indicator.IndicatorService;
 import org.hisp.dhis.organisationunit.OrganisationUnit;
-import org.hisp.dhis.organisationunit.OrganisationUnitService;
-import org.hisp.dhis.patient.Patient;
-import org.hisp.dhis.patient.PatientAttribute;
-import org.hisp.dhis.patient.PatientAttributeService;
-import org.hisp.dhis.patient.PatientIdentifier;
-import org.hisp.dhis.patient.PatientIdentifierService;
-import org.hisp.dhis.patient.PatientIdentifierType;
-import org.hisp.dhis.patient.PatientIdentifierTypeService;
-import org.hisp.dhis.patient.PatientService;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValue;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValueService;
-import org.hisp.dhis.patientdatavalue.PatientDataValue;
-import org.hisp.dhis.patientdatavalue.PatientDataValueService;
-import org.hisp.dhis.period.PeriodService;
-import org.hisp.dhis.program.Program;
-import org.hisp.dhis.program.ProgramInstance;
-import org.hisp.dhis.program.ProgramInstanceService;
-import org.hisp.dhis.program.ProgramService;
-import org.hisp.dhis.program.ProgramStage;
-import org.hisp.dhis.program.ProgramStageDataElementService;
-import org.hisp.dhis.program.ProgramStageInstance;
-import org.hisp.dhis.program.ProgramStageInstanceService;
-import org.hisp.dhis.program.ProgramStageService;
-import org.hisp.dhis.relationship.Relationship;
-import org.hisp.dhis.relationship.RelationshipService;
-import org.hisp.dhis.relationship.RelationshipTypeService;
-import org.hisp.dhis.reports.ReportService;
-import org.hisp.dhis.reports.util.Report_Decode;
-import org.hisp.dhis.reports.util.Report_Header;
-import org.springframework.jdbc.core.JdbcTemplate;
-import org.springframework.jdbc.support.rowset.SqlRowSet;
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
 import org.w3c.dom.Node;
@@ -118,7 +60,8 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-
+    
+    /*
     private RelationshipService relationshipService;
 
     public void setRelationshipService( RelationshipService relationshipService )
@@ -278,7 +221,8 @@
     {
         this.jdbcTemplate = jdbcTemplate;
     }
-
+    */
+    
     private I18nFormat format;
 
     public void setFormat( I18nFormat format )
@@ -345,14 +289,23 @@
     {
         this.reportList = reportList;
     }
-
+    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
     private String startDate;
 
     public void setStartDate( String startDate )
@@ -397,6 +350,7 @@
     public String execute()
         throws Exception
     {
+        /*
         statementManager.initialise();
 
         raFolderName = reportService.getRAFolderName();
@@ -409,7 +363,8 @@
         sheetList = new ArrayList<Integer>();
         rowList = new ArrayList<Integer>();
         colList = new ArrayList<Integer>();
-
+    */
+        
         /*
         Calendar c = Calendar.getInstance();
         c.setTime( format.parseDate( startDate ) );
@@ -422,9 +377,9 @@
         eDate = format.parseDate( endDate );
         */
         
-        inputTemplatePath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "template" + File.separator + reportFileNameTB;
+        //inputTemplatePath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "template" + File.separator + reportFileNameTB;
         //outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "output" + File.separator + UUID.randomUUID().toString() + ".xls";
-
+        /*
         outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator +  Configuration_IN.DEFAULT_TEMPFOLDER;
         File newdir = new File( outputReportPath );
         if( !newdir.exists() )
@@ -432,15 +387,17 @@
             newdir.mkdirs();
         }
         outputReportPath += File.separator + UUID.randomUUID().toString() + ".xls";
+        */
         
         //generatFeedbackReport();
-        generateActivityPlanReport();
+        //generateActivityPlanReport();
 
-        statementManager.destroy();
+        //statementManager.destroy();
 
         return SUCCESS;
     }
 
+    /*
     public List<Report_Decode> getDataInfo( String fileName )
     {
         List<Report_Decode> deCodeList = new ArrayList<Report_Decode>();
@@ -505,7 +462,8 @@
         return deCodeList;
     }
 
-    
+*/
+    /*
     public List<Report_Header> getHeaderInfo( String fileName )
     {
         List<Report_Header> report_HeaderList = new ArrayList<Report_Header>();
@@ -570,8 +528,11 @@
         return report_HeaderList;
     }
 
+    */
     
+    /*
     public void generateActivityPlanReport() throws Exception
+
     {
         Workbook templateWorkbook = Workbook.getWorkbook( new File( inputTemplatePath ) );
 
@@ -867,7 +828,10 @@
         outputReportFile.deleteOnExit();
 
     }
-    
+ */   
+
+
+/*    
     public void generatFeedbackReport()
         throws Exception
     {
@@ -1033,7 +997,8 @@
 
             Collection<ProgramInstance> programInstances = new ArrayList<ProgramInstance>();
 
-            programInstances = programInstanceService.getProgramInstances( curProgram, false );
+            //programInstances = programInstanceService.getProgramInstances( curProgram, false );
+            programInstances = programInstanceService.getProgramInstances( curProgram.getId() );
 
             if ( programInstances == null || programInstances.isEmpty() )
             {
@@ -1142,21 +1107,21 @@
                         {
                             if ( deCodeString.equalsIgnoreCase( "Name" ) )
                             {
-                                tempStr = patient.getFullName();
+                                tempStr = "";
                             }
                             else if ( deCodeString.equalsIgnoreCase( "DOB" ) )
                             {
-                                Date patientDate = patient.getBirthDate();
+                                //Date patientDate = "";
                                 SimpleDateFormat simpleDateFormat1 = new SimpleDateFormat( "yyyy-MM-dd" );
-                                tempStr = simpleDateFormat1.format( patientDate );
+                                tempStr = "";
                             }
                             else if ( deCodeString.equalsIgnoreCase( "Sex" ) )
                             {
-                                tempStr = patient.getGender();
+                                tempStr = "";
                             }
                             else if ( deCodeString.equalsIgnoreCase( "Age" ) )
                             {
-                                tempStr = patient.getAge();
+                                tempStr = "";
                             }
                         }
                         else if ( sType.equalsIgnoreCase( "caseAttribute" ) )
@@ -1213,7 +1178,7 @@
                                     patient, relationshipTypeService.getRelationshipType( deCodeInt ) );
                                 if ( parentRelationship != null )
                                 {
-                                    tempStr = representative.getFullName();
+                                    tempStr = "";
                                 }
                                 // System.out.println("Gender = "+gender +
                                 // " temStr = "+tempStr);
@@ -1224,7 +1189,7 @@
                             || sType.equalsIgnoreCase( "HusbandName" ) )
                         {
                             int deCodeInt = Integer.parseInt( deCodeString );
-                            tempStr = patient.getMiddleName() + " " + patient.getLastName();
+                            //tempStr = patient.getMiddleName() + " " + patient.getLastName();
                             if ( tempStr == null || tempStr.equals( "" ) )
                             {
                                 PatientAttribute patientAttribute = patientAttributeService
@@ -1469,7 +1434,7 @@
 
         outputReportFile.deleteOnExit();
     }
-
+*/
     /*
      * Returns a list which contains the DataElementCodes
      */

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/advanced/action/GenerateAdvancedReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/advanced/action/GenerateAdvancedReportResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/advanced/action/GenerateAdvancedReportResultAction.java	2014-04-01 09:37:42 +0000
@@ -71,14 +71,14 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-
+/*
     private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -281,14 +281,23 @@
     {
         return selectedPeriod;
     }
-
+    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
     private List<String> serviceType;
 
     private List<String> deCodeType;
@@ -327,7 +336,7 @@
 
         //con = (new DBConnection()).openConnection();
 
-        statementManager.initialise();
+        //statementManager.initialise();
 
         raFolderName = reportService.getRAFolderName();
 
@@ -793,7 +802,7 @@
 
         outputReportFile.deleteOnExit();
 
-        statementManager.destroy();
+        //statementManager.destroy();
 
 //        Date sysEndDate = new Date();
 

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/aggregation/action/GenerateAggregationReportAnalyserFormAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/aggregation/action/GenerateAggregationReportAnalyserFormAction.java	2010-12-29 12:19:53 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/aggregation/action/GenerateAggregationReportAnalyserFormAction.java	2013-09-19 06:34:31 +0000
@@ -51,14 +51,21 @@
         reportTypeName = ReportType.RT_AGGREGATION;
         
         periodTypes = periodService.getAllPeriodTypes();
-
+        
+        /*
+        for( PeriodType periodType : periodTypes )
+        {
+            System.out.println( periodType.getId() + " -- " + periodType.getName()  );
+        }
+        */    
+        
         // Filtering Periodtypes other than Daily, Monthly, Quarterly and Yearly
         Iterator<PeriodType> periodTypeIterator = periodTypes.iterator();
         while ( periodTypeIterator.hasNext() )
         {
             PeriodType type = periodTypeIterator.next();
             if ( type.getName().equalsIgnoreCase( "daily" ) || type.getName().equalsIgnoreCase( "Monthly" ) || type.getName().equalsIgnoreCase( "quarterly" )
-                || type.getName().equalsIgnoreCase( "yearly" ) )
+                || type.getName().equalsIgnoreCase( "yearly" ) || type.getName().equalsIgnoreCase( "Forteen" ) )
             {
             }
             else

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/aggregation/action/GenerateAggregationReportAnalyserResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/aggregation/action/GenerateAggregationReportAnalyserResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/aggregation/action/GenerateAggregationReportAnalyserResultAction.java	2014-04-01 09:37:11 +0000
@@ -33,7 +33,6 @@
 import jxl.write.WritableSheet;
 import jxl.write.WritableWorkbook;
 
-import org.amplecode.quick.StatementManager;
 import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
 import org.hisp.dhis.config.Configuration_IN;
 import org.hisp.dhis.i18n.I18nFormat;
@@ -61,13 +60,13 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-    private StatementManager statementManager;
+    /*private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -120,14 +119,22 @@
     {
         this.reportFileNameTB = reportFileNameTB;
     }
-
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
     private String reportList;
 
     public void setReportList( String reportList )
@@ -181,12 +188,21 @@
 
     private Integer monthCount;
     
+    private int availablePeriods;
+
+    public void setAvailablePeriods( int availablePeriods )
+    {
+        this.availablePeriods = availablePeriods;
+    }
+
+    private Period selectedPeriod;
+    
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
     public String execute() throws Exception
     {
-        statementManager.initialise();
+        //statementManager.initialise();
         
         // Initialization
         raFolderName = reportService.getRAFolderName();
@@ -239,10 +255,28 @@
             parentUnit = orgUnit.getName();
         }
 
+        
+        
+ 
+        
+        periodType = periodService.getPeriodTypeByName( periodTypeId );
+        
+        if ( periodType.getName().equalsIgnoreCase("Forteen" ) )
+        {
+            selectedPeriod = periodService.getPeriod( availablePeriods );
+            sDate = format.parseDate( String.valueOf( selectedPeriod.getStartDate() ) );
+            eDate = format.parseDate( String.valueOf( selectedPeriod.getEndDate() ) );
+        }
+        
+        else
+        {
+            sDate = format.parseDate( startDate );
+            eDate = format.parseDate( endDate );
+        }
+        
+        //System.out.println( dayFormat.format( sDate )+ " : " + dayFormat.format(eDate ) );
+        
         System.out.println( orgUnitList.get( 0 ).getName()+ " : " + selReportObj.getName()+" : Report Generation Start Time is : " + new Date() );
- 
-        sDate = format.parseDate( startDate );
-        eDate = format.parseDate( endDate );
         
         List<Period> periodList = new ArrayList<Period>( periodService.getIntersectingPeriods( sDate, eDate ) );
         Collection<Integer> periodIds = new ArrayList<Integer>( getIdentifiers(Period.class, periodList ) );
@@ -849,7 +883,7 @@
 
         outputReportFile.deleteOnExit();
 
-        statementManager.destroy();
+        //statementManager.destroy();
 
         return SUCCESS;
     }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/auto/action/GenerateAutoReportAnalyserResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/auto/action/GenerateAutoReportAnalyserResultAction.java	2011-11-02 09:54:19 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/auto/action/GenerateAutoReportAnalyserResultAction.java	2014-04-01 09:35:00 +0000
@@ -95,13 +95,14 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-    private StatementManager statementManager;
+    /*
+	private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+	*/
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -154,14 +155,22 @@
     {
         this.reportList = reportList;
     }
-
+    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-
+    */
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
     private int availablePeriods;
 
     public void setAvailablePeriods( int availablePeriods )
@@ -211,7 +220,7 @@
     public String execute()
         throws Exception
     {
-        statementManager.initialise();
+        //statementManager.initialise();
 
         // Initialization
         raFolderName = reportService.getRAFolderName();
@@ -230,6 +239,9 @@
         reportFileNameTB = selReportObj.getExcelTemplateName();
         
 
+        OrganisationUnit selectedOrgUnit = new OrganisationUnit();
+        selectedOrgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
+        
         String inputTemplatePath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "template" + File.separator + reportFileNameTB;
         //String outputReportFolderPath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "output" + File.separator + UUID.randomUUID().toString();
         String outputReportFolderPath = System.getenv( "DHIS2_HOME" ) + File.separator +  Configuration_IN.DEFAULT_TEMPFOLDER + File.separator + UUID.randomUUID().toString();
@@ -241,7 +253,7 @@
 
         if( reportModelTB.equalsIgnoreCase( "STATIC" ) || reportModelTB.equalsIgnoreCase( "STATIC-DATAELEMENTS" ) || reportModelTB.equalsIgnoreCase( "STATIC-FINANCIAL" ) )
         {
-            orgUnitList = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( ouIDTB ) );
+            orgUnitList = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( selectedOrgUnit.getId() ) );
             OrganisationUnitGroup orgUnitGroup = selReportObj.getOrgunitGroup();
             
             orgUnitList.retainAll( orgUnitGroup.getMembers() );
@@ -409,17 +421,78 @@
                         if ( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
                         {
                             tempStr = getAggVal( deCodeString, aggDeMap );
+                            
+                            if ( deCodeString.equalsIgnoreCase( "[1.1]" ) || deCodeString.equalsIgnoreCase( "[2.1]" ) || deCodeString.equalsIgnoreCase( "[153.1]" ) 
+                                || deCodeString.equalsIgnoreCase( "[155.1]" ) || deCodeString.equalsIgnoreCase( "[157.1]" ) || deCodeString.equalsIgnoreCase( "[158.1]" )
+                                || deCodeString.equalsIgnoreCase( "[160.1]" ) )
+                            {
+                                //System.out.println( " USECAPTUREDDATA Before Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                                
+                                if( tempStr.equalsIgnoreCase( "0.0" ) )
+                                {
+                                    tempStr = ""+ 1.0;
+                                }
+                                else if ( tempStr.equalsIgnoreCase( "1.0" ) )
+                                {
+                                    tempStr = ""+ 0.0;
+                                }
+                                else
+                                {
+                                }
+                                //System.out.println( " USECAPTUREDDATA After Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                            }
                             //tempStr = reportService.getIndividualResultDataValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB );
                         } 
                         else if( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
                         {
                             tempStr = getAggVal( deCodeString, aggDeMap );
+                            
+                            if ( deCodeString.equalsIgnoreCase( "[1.1]" ) || deCodeString.equalsIgnoreCase( "[2.1]" ) || deCodeString.equalsIgnoreCase( "[153.1]" ) 
+                                || deCodeString.equalsIgnoreCase( "[155.1]" ) || deCodeString.equalsIgnoreCase( "[157.1]" ) || deCodeString.equalsIgnoreCase( "[158.1]" )
+                                || deCodeString.equalsIgnoreCase( "[160.1]" ) )
+                            {
+                                //System.out.println( " GENERATEAGGDATA Before Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                                
+                                if( tempStr.equalsIgnoreCase( "0.0" ) )
+                                {
+                                    tempStr = ""+ 1.0;
+                                }
+                                else if ( tempStr.equalsIgnoreCase( "1.0" ) )
+                                {
+                                    tempStr = ""+ 0.0;
+                                }
+                                else
+                                {
+                                }
+                                //System.out.println( " GENERATEAGGDATA After Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                            }
                             //tempStr = reportService.getResultDataValue( deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB );
                         }
                         else if( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
                         {
                             
                             tempStr = getAggVal( deCodeString, aggDeMap );
+                            
+                            if ( deCodeString.equalsIgnoreCase( "[1.1]" ) || deCodeString.equalsIgnoreCase( "[2.1]" ) || deCodeString.equalsIgnoreCase( "[153.1]" ) 
+                                || deCodeString.equalsIgnoreCase( "[155.1]" ) || deCodeString.equalsIgnoreCase( "[157.1]" ) || deCodeString.equalsIgnoreCase( "[158.1]" )
+                                || deCodeString.equalsIgnoreCase( "[160.1]" ) )
+                            {
+                                //System.out.println( " USEEXISTINGAGGDATA Before Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                                
+                                if( tempStr.equalsIgnoreCase( "0.0" ) )
+                                {
+                                    tempStr = ""+ 1.0;
+                                }
+                                else if ( tempStr.equalsIgnoreCase( "1.0" ) )
+                                {
+                                    tempStr = ""+ 0.0;
+                                }
+                                else
+                                {
+                                }
+                                //System.out.println( "  USEEXISTINGAGGDATA After Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                            }
+                            
                             /*
                             List<Period> periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates( tempStartDate.getTime(), tempEndDate.getTime() ) );
                             Collection<Integer> periodIds = new ArrayList<Integer>( getIdentifiers(Period.class, periodList ) );
@@ -543,7 +616,7 @@
         }// outer while loop end
 
 
-        statementManager.destroy();
+        //statementManager.destroy();
 
         if( zipDirectory( outputReportFolderPath, outputReportFolderPath+".zip" ) )
         {

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/auto/action/GenerateLLBulkReportAnalyserResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/auto/action/GenerateLLBulkReportAnalyserResultAction.java	2011-11-02 09:54:19 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/auto/action/GenerateLLBulkReportAnalyserResultAction.java	2014-04-01 09:36:29 +0000
@@ -40,7 +40,6 @@
 import jxl.write.WritableSheet;
 import jxl.write.WritableWorkbook;
 
-import org.amplecode.quick.StatementManager;
 import org.hisp.dhis.config.Configuration_IN;
 import org.hisp.dhis.i18n.I18nFormat;
 import org.hisp.dhis.organisationunit.OrganisationUnit;
@@ -59,17 +58,25 @@
 
 public class GenerateLLBulkReportAnalyserResultAction implements Action
 {
+   
+    private final String GENERATEAGGDATA = "generateaggdata";
+
+    private final String USEEXISTINGAGGDATA = "useexistingaggdata";
+
+    private final String USECAPTUREDDATA = "usecaptureddata";
+    
     
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
+	/*
     private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-    
+    */
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -144,13 +151,22 @@
     {
         this.reportList = reportList;
     }
-    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+        
     
     private int availablePeriods;
 
@@ -159,10 +175,15 @@
         this.availablePeriods = availablePeriods;
     }
     
+    private String aggData;
+    
+    public void setAggData( String aggData )
+    {
+        this.aggData = aggData;
+    }
+    
     private List<OrganisationUnit> orgUnitList;
     
-    
-    
     private String raFolderName;
     
     private SimpleDateFormat simpleDateFormat;
@@ -191,7 +212,7 @@
     // -------------------------------------------------------------------------
     public String execute() throws Exception
     {
-        statementManager.initialise();
+        //statementManager.initialise();
 
         // Initialization
         raFolderName = reportService.getRAFolderName();
@@ -222,10 +243,14 @@
             newdir.mkdirs();
         }
         
+        
+        OrganisationUnit selectedOrgUnit = new OrganisationUnit();
+        selectedOrgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
+        
         // Org Unit INFO
         if( reportModelTB.equalsIgnoreCase( "STATIC" ) || reportModelTB.equalsIgnoreCase( "STATIC-DATAELEMENTS" ) || reportModelTB.equalsIgnoreCase( "STATIC-FINANCIAL" ) )
         {
-            orgUnitList = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( ouIDTB ) );
+            orgUnitList = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( selectedOrgUnit.getId() ) );
             OrganisationUnitGroup orgUnitGroup = selReportObj.getOrgunitGroup();
             
             orgUnitList.retainAll( orgUnitGroup.getMembers() );
@@ -261,11 +286,16 @@
         List<Report_inDesign> reportDesignListLLDeath = reportService.getReportDesign( deCodesXMLFileName );
         List<Report_inDesign> reportDesignListLLMaternalDeath = reportService.getReportDesign( deCodesXMLFileName );
         
-     // collect dataElementIDs by commaSepareted
+        // collect dataElementIDs by commaSepareted
         String dataElmentIdsByComma = reportService.getDataelementIds( reportDesignList );
         String dataElmentIdsForLLDeathByComma = reportService.getDataelementIds( reportDesignList );
         String dataElmentIdsForMaternalDeathByComma = reportService.getDataelementIds( reportDesignList );
         
+        List<Integer> selOrgUnitIds = new ArrayList<Integer>( getIdentifiers( OrganisationUnit.class, orgUnitList ) );
+        String orgUnitIdsByComma = getCommaDelimitedString( selOrgUnitIds );
+        Map<String, String> aggDeMapForCaptureData = new HashMap<String, String>();
+        aggDeMapForCaptureData.putAll( reportService.getDataFromDataValueTableByPeriodAgg( orgUnitIdsByComma, dataElmentIdsByComma, periodIdsByComma ) );
+        
         int orgUnitCount = 0;
         
         Iterator<OrganisationUnit> it = orgUnitList.iterator();
@@ -280,14 +310,34 @@
             String outputReportPath = outputReportFolderPath + File.separator + outPutFileName;
             WritableWorkbook outputReportWorkbook = Workbook.createWorkbook( new File( outputReportPath ), templateWorkbook );
             
+            /*
             Map<String, String> aggDeMap = new HashMap<String, String>();
             List<OrganisationUnit> childOrgUnitTree = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( currentOrgUnit.getId() ) );
             List<Integer> childOrgUnitTreeIds = new ArrayList<Integer>( getIdentifiers( OrganisationUnit.class, childOrgUnitTree ) );
             String childOrgUnitsByComma = getCommaDelimitedString( childOrgUnitTreeIds );
 
             aggDeMap.putAll( reportService.getAggDataFromDataValueTable( childOrgUnitsByComma, dataElmentIdsByComma, periodIdsByComma ) );
-            
-            
+            */
+            
+            Map<String, String> aggDeMap = new HashMap<String, String>();
+            
+            if( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
+            {
+                aggDeMap.putAll( reportService.getResultDataValueFromAggregateTable( currentOrgUnit.getId(), dataElmentIdsByComma, periodIdsByComma ) );
+            }
+            else if( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
+            {
+                List<OrganisationUnit> childOrgUnitTree = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( currentOrgUnit.getId() ) );
+                List<Integer> childOrgUnitTreeIds = new ArrayList<Integer>( getIdentifiers( OrganisationUnit.class, childOrgUnitTree ) );
+                String childOrgUnitsByComma = getCommaDelimitedString( childOrgUnitTreeIds );
+
+                aggDeMap.putAll( reportService.getAggDataFromDataValueTable( childOrgUnitsByComma, dataElmentIdsByComma, periodIdsByComma ) );
+            }
+            else if( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
+            {
+                //aggDeMap.putAll( reportService.getAggDataFromDataValueTable( ""+currentOrgUnit.getId(), dataElmentIdsByComma, periodIdsByComma ) );
+            }
+
             int count1 = 0;
             Iterator<Report_inDesign> reportDesignIterator = reportDesignList.iterator();
             while ( reportDesignIterator.hasNext() )
@@ -378,7 +428,81 @@
                 {
                     if( sType.equalsIgnoreCase( "dataelement" ) )
                     {
-                        tempStr = getAggVal( deCodeString, aggDeMap );
+                        if( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
+                        {
+                            tempStr = getAggVal( deCodeString, aggDeMap, currentOrgUnit.getId() );
+                            
+                            if ( deCodeString.equalsIgnoreCase( "[1.1]" ) || deCodeString.equalsIgnoreCase( "[2.1]" ) || deCodeString.equalsIgnoreCase( "[153.1]" ) 
+                                || deCodeString.equalsIgnoreCase( "[155.1]" ) || deCodeString.equalsIgnoreCase( "[157.1]" ) || deCodeString.equalsIgnoreCase( "[158.1]" )
+                                || deCodeString.equalsIgnoreCase( "[160.1]" ) )
+                            {
+                                //System.out.println( " USEEXISTINGAGGDATA Before Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                                
+                                if( tempStr.equalsIgnoreCase( "0.0" ) )
+                                {
+                                    tempStr = ""+ 1.0;
+                                }
+                                else if ( tempStr.equalsIgnoreCase( "1.0" ) )
+                                {
+                                    tempStr = ""+ 0.0;
+                                }
+                                else
+                                {
+                                }
+                                //System.out.println( "  USEEXISTINGAGGDATA After Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                            }
+                        }
+                        else if( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
+                        {
+                            tempStr = getAggVal( deCodeString, aggDeMap, currentOrgUnit.getId() );
+                            
+                            if ( deCodeString.equalsIgnoreCase( "[1.1]" ) || deCodeString.equalsIgnoreCase( "[2.1]" ) || deCodeString.equalsIgnoreCase( "[153.1]" ) 
+                                || deCodeString.equalsIgnoreCase( "[155.1]" ) || deCodeString.equalsIgnoreCase( "[157.1]" ) || deCodeString.equalsIgnoreCase( "[158.1]" )
+                                || deCodeString.equalsIgnoreCase( "[160.1]" ) )
+                            {
+                                //System.out.println( " GENERATEAGGDATA Before Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                                
+                                if( tempStr.equalsIgnoreCase( "0.0" ) )
+                                {
+                                    tempStr = ""+ 1.0;
+                                }
+                                else if ( tempStr.equalsIgnoreCase( "1.0" ) )
+                                {
+                                    tempStr = ""+ 0.0;
+                                }
+                                else
+                                {
+                                }
+                                //System.out.println( " GENERATEAGGDATA After Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                            }
+                        }
+                        
+                        else if( aggData.equalsIgnoreCase( USECAPTUREDDATA ) ) 
+                        {
+                            tempStr = getAggVal( deCodeString, aggDeMapForCaptureData, currentOrgUnit.getId() );
+                            
+                            if ( deCodeString.equalsIgnoreCase( "[1.1]" ) || deCodeString.equalsIgnoreCase( "[2.1]" ) || deCodeString.equalsIgnoreCase( "[153.1]" ) 
+                                || deCodeString.equalsIgnoreCase( "[155.1]" ) || deCodeString.equalsIgnoreCase( "[157.1]" ) || deCodeString.equalsIgnoreCase( "[158.1]" )
+                                || deCodeString.equalsIgnoreCase( "[160.1]" ) )
+                            {
+                                //System.out.println( " USECAPTUREDDATA Before Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                                
+                                if( tempStr.equalsIgnoreCase( "0.0" ) )
+                                {
+                                    tempStr = ""+ 1.0;
+                                }
+                                else if ( tempStr.equalsIgnoreCase( "1.0" ) )
+                                {
+                                    tempStr = ""+ 0.0;
+                                }
+                                else
+                                {
+                                }
+                                //System.out.println( " USECAPTUREDDATA After Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                            }
+                        }
+                  
+                       // tempStr = getAggVal( deCodeString, aggDeMap );
                         //tempStr = reportService.getResultDataValue( deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB );
                     } 
                     else if ( sType.equalsIgnoreCase( "dataelement-boolean" ) )
@@ -503,11 +627,18 @@
                 flag = 0;
                 Iterator<Report_inDesign> reportDesignIterator1 = reportDesignListLLDeath.iterator();
                 int count2 = 0;
+                
+                boolean isBelow1Day = false;
+                
+                boolean isBelow1Year = false;
+                
                 while ( reportDesignIterator1.hasNext() )
                 {
 
                     Report_inDesign report_inDesign = (Report_inDesign) reportDesignIterator1.next();
 
+                    //boolean isBelow1Day = false;
+                    
                     String deType = report_inDesign.getPtype();
                     String sType = report_inDesign.getStype();
                     String deCodeString = report_inDesign.getExpression();
@@ -539,7 +670,7 @@
                     }
                     else
                     {
-                        if ( sType.equalsIgnoreCase( "lldeathdataelement" ) )
+                        if ( sType.equalsIgnoreCase( "lldeathdataelement" ) || sType.equalsIgnoreCase( "lldeathdataelementcause" ) )
                         {
                             tempStr = getLlDeathVal( deCodeString, recordNo, aggDeForLLDeathMap );
                             //tempStr = getLLDataValue( deCodeString, selectedPeriod, currentOrgUnit, recordNo );
@@ -567,6 +698,9 @@
                     else
                     {
                         String tstr1 = resMap.get( tempStr.trim() );
+                        
+                        //String tempAgeCategory = tempStr.trim();
+                        
                         if ( tstr1 != null )
                             tempStr = tstr1;
 
@@ -615,40 +749,129 @@
                             wCellformat.setWrap( true );
                             wCellformat.setAlignment( Alignment.CENTRE );
                             wCellformat.setVerticalAlignment( VerticalAlignment.CENTRE );
+                            
                             if ( sType.equalsIgnoreCase( "lldeathdataelementage" ) )
                             {
-                                String tstr = resMapForDeath.get( tempLLDeathValuStr.trim() );
-                                if ( tstr != null )
-                                {
-                                    tempStr1 = tstr.split( ":" )[0].trim();
-                                    tempStr2 = tstr.split( ":" )[1].trim();
-                                }
-                                try
-                                {
-                                    sheet0.addCell( new Label( tempColNo - 1, tempRowNo, tempStr1, getCellFormat1() ) );
-                                    sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr2, getCellFormat1() ) );
-                                }
-                                catch ( Exception e )
-                                {
-                                    sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr1, getCellFormat1() ) );
-                                }
+                                if ( tempLLDeathValuStr.trim().equalsIgnoreCase( "B1DAY" ) || tempLLDeathValuStr.trim().equalsIgnoreCase( "B1WEEK" ) 
+                                    || tempLLDeathValuStr.trim().equalsIgnoreCase( "B1MONTH" ) || tempLLDeathValuStr.trim().equalsIgnoreCase( "B1YEAR" ) )
+                                {
+                                    isBelow1Day = true;
+                                    
+                                    isBelow1Year = true;
+                                    
+                                    String tstr = resMapForDeath.get( tempLLDeathValuStr.trim() );
+                                    
+                                    if ( tstr != null )
+                                    {
+                                        tempStr1 = tstr.split( ":" )[0].trim();
+                                        tempStr2 = tstr.split( ":" )[1].trim();
+                                    }
+                                    try
+                                    {
+                                        sheet0.addCell( new Label( tempColNo - 1, tempRowNo, tempStr1, getCellFormat1() ) );
+                                        sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr2, getCellFormat1() ) );
+                                        //sheet0.addCell( new Label( tempColNo+1, tempRowNo, "C01-WITHIN 24 HOURS OF BIRTH", getCellFormat1() ) );
+                                    }
+                                    catch ( Exception e )
+                                    {
+                                        sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr1, getCellFormat1() ) );
+                                    }
+                                }
+                                
+                                else
+                                {
+                                    String tstr = resMapForDeath.get( tempLLDeathValuStr.trim() );
+                                    
+                                    if ( tstr != null )
+                                    {
+                                        tempStr1 = tstr.split( ":" )[0].trim();
+                                        tempStr2 = tstr.split( ":" )[1].trim();
+                                    }
+                                    try
+                                    {
+                                        sheet0.addCell( new Label( tempColNo - 1, tempRowNo, tempStr1, getCellFormat1() ) );
+                                        sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr2, getCellFormat1() ) );
+                                    }
+                                    catch ( Exception e )
+                                    {
+                                        sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr1, getCellFormat1() ) );
+                                    }
+                                }
+                                
+                                
                             }
                             else if ( sType.equalsIgnoreCase( "lldeathdataelement" ) )
                             {
-                                try
-                                {
-                                    sheet0.addCell( new Number( tempColNo, tempRowNo, Integer.parseInt( tempStr ),
-                                        getCellFormat1() ) );
-                                }
-                                catch ( Exception e )
-                                {
-                                    sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
-                                }
-                            }
+                                /*
+                                if ( ( tempAgeCategory.equalsIgnoreCase( "B1DAY" ) || tempAgeCategory.equalsIgnoreCase( "B1WEEK" ) || tempAgeCategory.equalsIgnoreCase( "B1MONTH" ) || tempAgeCategory.equalsIgnoreCase( "B1YEAR" ) && ( tempAgeCategory.equalsIgnoreCase( "DIADIS" ) ) ) )
+                                {
+                                    try
+                                    {
+                                        sheet0.addCell( new Number( tempColNo, tempRowNo, Integer.parseInt( tempStr ),
+                                            getCellFormat1() ) );
+                                    }
+                                    catch ( Exception e )
+                                    {
+                                        sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
+                                    }
+                                    
+                                }
+                                */
+                                
+                                try
+                                {
+                                    sheet0.addCell( new Number( tempColNo, tempRowNo, Integer.parseInt( tempStr ), getCellFormat1() ) );
+                                }
+                                catch ( Exception e )
+                                {
+                                    sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
+                                }
+                            }
+                            else if ( sType.equalsIgnoreCase( "lldeathdataelementcause" ) )
+                            {
+                                try
+                                {
+                                    sheet0.addCell( new Number( tempColNo, tempRowNo, Integer.parseInt( tempStr ), getCellFormat1() ) );
+                                }
+                                catch ( Exception e )
+                                {
+                                    //sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
+                                    // done for HP
+                                    if( isBelow1Year && tempStr.equalsIgnoreCase( "A01-Diarrhoeal diseases" ) )
+                                    {
+                                        tempStr = "C06-Diarrhoea";
+                                        
+                                        //sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
+                                    }
+                                    else if( isBelow1Year && tempStr.equalsIgnoreCase( "A05-Other Fever related" ))
+                                    {
+                                        tempStr = "C07-Fever related";
+                                    }
+                                    
+                                    else if( !isBelow1Year && tempStr.equalsIgnoreCase( "C09-Others" ))
+                                    {
+                                        tempStr = "A14-Causes not known";
+                                    }
+                                    
+                                    else
+                                    {
+                                        //sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
+                                    }
+                                    
+                                    sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
+                                }
+                                
+                                //System.out.println( " is Below 1 Year :" + isBelow1Year  + " -- deCodeString is : " + deCodeString +  " -- value is : " + tempStr );
+                            }
+                            
+                           // System.out.println( " is Below 1 Day :" + isBelow1Day  + " -- deCodeString is : " + deCodeString +  " -- value is : " + tempStr );
                         }
 
                     }
                     count2++;
+                    
+                    //System.out.println( " is Below 1 Day :" + isBelow1Day  + " -- s Type is : " + sType );
+                    
                 }// inner while loop end
                 recordCount++;
                
@@ -825,7 +1048,7 @@
 
             orgUnitCount++;
         }
-        statementManager.destroy();
+        //statementManager.destroy();
         
         
         if( zipDirectory( outputReportFolderPath, outputReportFolderPath+".zip" ) )
@@ -908,39 +1131,64 @@
         resMap.put( "F", "Female" );
         resMap.put( "Y", "YES" );
         resMap.put( "N", "NO" );
-        resMap.put( "NK", "A14-Causes not known" );
-        resMap.put( "B1DAY", "C01-WITHIN 24 HOURS OF BIRTH" );
         resMap.put( "B1WEEK", "1 DAY - 1 WEEK" );
         resMap.put( "B1MONTH", "1 WEEK - 1 MONTH" );
         resMap.put( "B1YEAR", "1 MONTH - 1 YEAR" );
         resMap.put( "B5YEAR", "1 YEAR - 5 YEARS" );
         resMap.put( "O5YEAR", "6 YEARS - 14 YEARS" );
-    
         resMap.put( "O15YEAR", "15 YEARS - 55 YEARS" );
         resMap.put( "O55YEAR", "OVER 55 YEARS" );
-    
+        resMap.put( "IMMREAC", "Immunization reactions" );
+        resMap.put( "PRD", "Pregnancy Related Death( maternal mortality)" );
+        resMap.put( "SRD", "Sterilisation related deaths" );
+        //resMap.put( "AI", "Accidents or Injuries" );
+        
+        
+        //infant Death( Up to 1 Year of age )
+        resMap.put( "B1DAY", "C01-WITHIN 24 HOURS OF BIRTH" );
+        resMap.put( "SEPSIS", "C02-SEPSIS" );
         resMap.put( "ASPHYXIA", "C03-ASPHYXIA" );
-        resMap.put( "SEPSIS", "C02-SEPSIS" );
         resMap.put( "LOWBIRTHWEIGH", "C04-Low Birth Wight(LBW) for Children upto 4 weeks of age only" );
-        resMap.put( "IMMREAC", "Immunization reactions" );
         resMap.put( "PNEUMONIA", "C05-Pneumonia" );
-        resMap.put( "DIADIS", "C06-Diarrhoea" );
+        //resMap.put( "DIADIS", "C06-Diarrhoea" );
+        //resMap.put( "OFR",, "C07-Fever related" );
         resMap.put( "MEASLES", "C08-Measles" );
+        resMap.put( "OTHERS", "C09-Others" );
+        
+        
+        //Adolescents and Adults
+        resMap.put( "DIADIS", "A01-Diarrhoeal diseases" );
         resMap.put( "TUBER", "A02-Tuberculosis" );
+        resMap.put( "RID", "A03-Respiratory disease including infections(other than TB)" );
         resMap.put( "MALARIA", "A04-Malaria" );
+        resMap.put( "OFR", "A05-Other Fever related" );
         resMap.put( "HIVAIDS", "A06-HIV/AIDS" );
-        resMap.put( "OFR", "A05-Other Fever related" );
-        resMap.put( "PRD", "Pregnancy Related Death( maternal mortality)" );
-        resMap.put( "SRD", "Sterilisation related deaths" );
-        resMap.put( "AI", "Accidents or Injuries" );
+        resMap.put( "HDH", "A07-Heart disease/Hypertension related" );
+        resMap.put( "SND", "A08-Neurological disease including Strokes" );
+        resMap.put( "AI", "A09-Trauma/Accidents/Burn cases" );
         resMap.put( "SUICIDES", "A10-Suicides" );
         resMap.put( "ABS", "A11-Animal Bites or Stings" );
-        resMap.put( "RID", "A03-Respiratory disease including infections(other than TB)" );
-        resMap.put( "HDH", "A07-Heart disease/Hypertension related" );
-        resMap.put( "SND", "A08-Neurological disease including Strokes" );
+        
+        // Maternal death cause
+        resMap.put( "ABORTION", "M01-Abortion" );
+        resMap.put( "OPL", "M02-OBSTRUCTED/PROLONGED LABOUR" );
+        resMap.put( "SH", "M03-SEVERE HYPERTENSION/FITS" );
+        resMap.put( "FITS", "M03-SEVERE HYPERTENSION/FITS" );
+        resMap.put( "BBCD", "M04-BLEEDING" );
+        resMap.put( "BACD", "M04-BLEEDING" );
+        resMap.put( "HFBD", "M05-HIGH FEVER" );
+        resMap.put( "HFAD", "M05-HIGH FEVER" );
+        resMap.put( "MDNK", "M06-Other Causes (including cause not known)" );
+        
+        
+        
+        
+        //Others Disease
         resMap.put( "OKAD", "A12-Known Acute Disease" );
         resMap.put( "OKCD", "A13-Known Chronic Disease" );
-        resMap.put( "OTHERS", "C09-Others" );
+        resMap.put( "NK", "A14-Causes not known" );
+        
+        
         resMap.put( "FTP", "FIRST TRIMESTER PREGNANCY" );
         resMap.put( "STP", "SECOND TRIMESTER PREGNANCY" );
         resMap.put( "TTP", "THIRD TRIMESTER PREGNANCY" );
@@ -956,14 +1204,17 @@
         resMap.put( "ANM", "ANM" );
         resMap.put( "NURSE", "NURSE" );
         resMap.put( "DOCTOR", "DOCTOR" );
-        resMap.put( "ABORTION", "M01-Abortion" );
-        resMap.put( "OPL", "OBSTRUCTED/PROLONGED LABOUR" );
-        resMap.put( "FITS", "FITS" );
-        resMap.put( "SH", "SEVERE HYPERTENSION" );
-        resMap.put( "BBCD", "BLEEDING BEFORE CHILD DELIVERY" );
-        resMap.put( "BACD", "BLEEDING AFTER CHILD DELIVERY" );
-        resMap.put( "HFBD", "HIGH FEVER BEFORE DELIVERY" );
-        resMap.put( "HFAD", "HIGH FEVER AFTER DELIVERY" );
+        
+
+    
+        
+        //resMap.put( "SH", "M03-SEVERE HYPERTENSION" );
+        //resMap.put( "FITS", "FITS" );
+        
+        //resMap.put( "BBCD", "BLEEDING BEFORE CHILD DELIVERY" );
+        //resMap.put( "BACD", "BLEEDING AFTER CHILD DELIVERY" );
+        //resMap.put( "HFBD", "HIGH FEVER BEFORE DELIVERY" );
+        //resMap.put( "HFAD", "HIGH FEVER AFTER DELIVERY" );
     }
 
     public void initializeLLDeathResultMap()
@@ -1169,8 +1420,9 @@
 
         return recordNosList;
     }
+    
     // getting data value using Map
-    private String getAggVal( String expression, Map<String, String> aggDeMap )
+    private String getAggVal( String expression, Map<String, String> aggDeMap, Integer orgUnitId )
     {
         try
         {
@@ -1187,7 +1439,18 @@
 
                 replaceString = replaceString.replaceAll( "[\\[\\]]", "" );
 
-                replaceString = aggDeMap.get( replaceString );
+                if( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
+                {
+                    replaceString = replaceString.replaceAll( "\\.", ":" );
+                    replaceString = orgUnitId + ":" + replaceString;
+
+                    //System.out.println( replaceString );
+                    replaceString = aggDeMap.get( replaceString );
+                }
+                else
+                {
+                    replaceString = aggDeMap.get( replaceString );
+                }
                 
                 if( replaceString == null )
                 {

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/BenificiaryInfoReportsFormAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/BenificiaryInfoReportsFormAction.java	2011-01-05 05:31:43 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/BenificiaryInfoReportsFormAction.java	2014-07-05 06:47:16 +0000
@@ -1,27 +1,11 @@
 package org.hisp.dhis.reports.benificiaryinfo.action;
 
-import java.io.File;
-import java.util.ArrayList;
-import java.util.List;
-
-import javax.xml.parsers.DocumentBuilder;
-import javax.xml.parsers.DocumentBuilderFactory;
-
-import org.hisp.dhis.reports.ReportService;
-import org.hisp.dhis.reports.util.Report;
-import org.w3c.dom.Document;
-import org.w3c.dom.Element;
-import org.w3c.dom.Node;
-import org.w3c.dom.NodeList;
-import org.xml.sax.SAXException;
-import org.xml.sax.SAXParseException;
-
 import com.opensymphony.xwork2.Action;
 
 public class BenificiaryInfoReportsFormAction
     implements Action
 {
-    // -------------------------------------------------------------------------
+/*    // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
 
@@ -43,7 +27,7 @@
         return reportList;
     }
 
-    private String raFolderName;
+    private String raFolderName;*/
 
     // -------------------------------------------------------------------------
     // Action implementation
@@ -53,15 +37,16 @@
     public String execute()
         throws Exception
     {
-        raFolderName = reportService.getRAFolderName();
+ /*       raFolderName = reportService.getRAFolderName();
 
         reportList = new ArrayList<Report>();
 
         getSelectedReportList();
-
+*/
         return SUCCESS;
     }
 
+    /*
     public void getSelectedReportList()
     {
         String fileName = "NBITSbenificiaryInfoReportsList.xml";
@@ -157,5 +142,5 @@
         }
 
     }// getReportList end
-
+    */
 }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/BenificiaryInfoReportsResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/BenificiaryInfoReportsResultAction.java	2012-06-18 09:15:09 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/BenificiaryInfoReportsResultAction.java	2014-07-05 06:49:50 +0000
@@ -3,71 +3,6 @@
 //@23-06-2010 - Date from and to is solved.
 //Todo merging of cells for same village
 
-import java.io.BufferedInputStream;
-import java.io.File;
-import java.io.FileInputStream;
-import java.io.InputStream;
-import java.text.SimpleDateFormat;
-import java.util.ArrayList;
-import java.util.Calendar;
-import java.util.Collection;
-import java.util.Collections;
-import java.util.Date;
-import java.util.HashMap;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Map;
-import java.util.Set;
-import java.util.UUID;
-
-import javax.xml.parsers.DocumentBuilder;
-import javax.xml.parsers.DocumentBuilderFactory;
-
-import jxl.Workbook;
-import jxl.format.Alignment;
-import jxl.format.Border;
-import jxl.format.BorderLineStyle;
-import jxl.format.Colour;
-import jxl.format.VerticalAlignment;
-import jxl.write.Label;
-import jxl.write.WritableCell;
-import jxl.write.WritableCellFormat;
-import jxl.write.WritableSheet;
-import jxl.write.WritableWorkbook;
-
-import org.amplecode.quick.StatementManager;
-import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
-import org.hisp.dhis.config.Configuration_IN;
-import org.hisp.dhis.i18n.I18nFormat;
-import org.hisp.dhis.organisationunit.OrganisationUnit;
-import org.hisp.dhis.organisationunit.OrganisationUnitService;
-import org.hisp.dhis.patient.Patient;
-import org.hisp.dhis.patient.PatientAttribute;
-import org.hisp.dhis.patient.PatientAttributeService;
-import org.hisp.dhis.patient.PatientIdentifier;
-import org.hisp.dhis.patient.PatientIdentifierService;
-import org.hisp.dhis.patient.PatientIdentifierType;
-import org.hisp.dhis.patient.PatientIdentifierTypeService;
-import org.hisp.dhis.patient.PatientService;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValue;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValueService;
-import org.hisp.dhis.period.Period;
-import org.hisp.dhis.period.PeriodService;
-import org.hisp.dhis.period.PeriodType;
-import org.hisp.dhis.program.Program;
-import org.hisp.dhis.program.ProgramInstance;
-import org.hisp.dhis.program.ProgramInstanceService;
-import org.hisp.dhis.program.ProgramService;
-import org.hisp.dhis.program.ProgramStageInstance;
-import org.hisp.dhis.relationship.RelationshipTypeService;
-import org.hisp.dhis.reports.ReportService;
-import org.w3c.dom.Document;
-import org.w3c.dom.Element;
-import org.w3c.dom.Node;
-import org.w3c.dom.NodeList;
-import org.xml.sax.SAXException;
-import org.xml.sax.SAXParseException;
-
 import com.opensymphony.xwork2.Action;
 
 public class BenificiaryInfoReportsResultAction
@@ -77,7 +12,7 @@
     // Dependencies
     // -------------------------------------------------------------------------
 
-    RelationshipTypeService relationshipTypeService;
+/*    RelationshipTypeService relationshipTypeService;
 
     public void setRelationshipTypeService( RelationshipTypeService relationshipTypeService )
     {
@@ -172,12 +107,12 @@
     {
         this.format = format;
     }
-
+*/
     // -------------------------------------------------------------------------
     // Properties
     // -------------------------------------------------------------------------
 
-    private Map<Patient, Set<ProgramStageInstance>> visitsByPatients = new HashMap<Patient, Set<ProgramStageInstance>>();
+ /*   private Map<Patient, Set<ProgramStageInstance>> visitsByPatients = new HashMap<Patient, Set<ProgramStageInstance>>();
 
     public Map<Patient, Set<ProgramStageInstance>> getVisitsByPatients()
     {
@@ -310,14 +245,14 @@
     private Date eDate;
 
     private int rowCount;
-
+*/
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
     public String execute()
         throws Exception
     {
-        statementManager.initialise();
+ /*       statementManager.initialise();
         raFolderName = reportService.getRAFolderName();
 
         // Initialization
@@ -357,11 +292,12 @@
         outputReportPath += File.separator + UUID.randomUUID().toString() + ".xls";
         
         generatFeedbackReport();
-        statementManager.destroy();
+        statementManager.destroy();*/
 
         return SUCCESS;
     }
 
+    /*
     public void generatFeedbackReport()
         throws Exception
     {
@@ -425,6 +361,7 @@
                 //patientListByOu.addAll( patientService.getPatients( ou ) );
                 patientListByOu.addAll( patientService.getPatients( ou, null, null ) );
                 Iterator<Patient> patientIterator = patientListByOu.iterator();
+                /*
                 while ( patientIterator.hasNext() )
                 {
                     Patient patient = patientIterator.next();
@@ -456,8 +393,9 @@
                         }
                     }
                 }
-
-                if ( patientListByOuProgram.size() > 0 )
+                 */
+                
+ /*               if ( patientListByOuProgram.size() > 0 )
                 {
                     ouList.add( ou );
                     ouPatientList.put( ou.getName(), patientListByOuProgram );
@@ -501,7 +439,7 @@
                         {
                             if ( deCodeString.equalsIgnoreCase( "Name" ) )
                             {
-                                tempStr = patient.getFullName();
+                                tempStr = "";
                             }
                             else if ( deCodeString.equalsIgnoreCase( "IncidentDate" ) )
                             {
@@ -517,16 +455,15 @@
                             }
                             else if ( deCodeString.equalsIgnoreCase( "Age" ) )
                             {
-                                tempStr = patient.getAge();
+                                tempStr = "";
                             }
                             else if ( deCodeString.equalsIgnoreCase( "Sex" ) )
                             {
-                                tempStr = patient.getGender();
+                                tempStr = "";
                             }
                             else if ( deCodeString.equalsIgnoreCase( "Active" ) )
                             {
-                                if ( patientPIList.get( patient ).getEndDate() != null
-                                    || patientPIList.get( patient ).isCompleted() )
+                                if ( patientPIList.get( patient ).getEndDate() != null )
                                 {
                                     tempStr = "NO";
                                 }
@@ -581,7 +518,7 @@
                             int tempColNo = colList.get( count1 );
                             int sheetNo = sheetList.get( count1 );
                             sheet0 = outputReportWorkbook.getSheet( sheetNo );
-                            WritableCell cell = sheet0.getWritableCell( tempColNo, rowNo );
+                            //WritableCell cell = sheet0.getWritableCell( tempColNo, rowNo );
                             sheet0.addCell( new Label( tempColNo, rowNo, tempStr, wCellformat ) );
                             colNo = tempColNo;
                         }
@@ -618,13 +555,14 @@
         inputStream = new BufferedInputStream( new FileInputStream( outputReportFile ) );
 
         outputReportFile.deleteOnExit();
-    }
+    }*/
 
+   
     /*
      * Returns a list which contains the DataElementCodes
      */
 
-    public List<OrganisationUnit> getChildOrgUnitTree( OrganisationUnit orgUnit )
+/*    public List<OrganisationUnit> getChildOrgUnitTree( OrganisationUnit orgUnit )
     {
         List<OrganisationUnit> orgUnitTree = new ArrayList<OrganisationUnit>();
         orgUnitTree.add( orgUnit );
@@ -837,5 +775,5 @@
         calendarList.add( tempEndDate );
 
         return calendarList;
-    }
+    }*/
 }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/GetPatientDetailsAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/GetPatientDetailsAction.java	2012-04-04 11:58:27 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/GetPatientDetailsAction.java	2014-07-05 06:51:59 +0000
@@ -1,19 +1,5 @@
 package org.hisp.dhis.reports.benificiaryinfo.action;
 
-import java.util.Collection;
-import java.util.HashMap;
-import java.util.List;
-import java.util.Map;
-
-import org.hisp.dhis.patient.Patient;
-import org.hisp.dhis.patient.PatientAttribute;
-import org.hisp.dhis.patient.PatientAttributeGroup;
-import org.hisp.dhis.patient.PatientIdentifier;
-import org.hisp.dhis.patient.PatientIdentifierType;
-import org.hisp.dhis.patient.PatientService;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValue;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValueService;
-
 import com.opensymphony.xwork2.Action;
 
 public class GetPatientDetailsAction
@@ -22,7 +8,7 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-
+/*
     private PatientService patientService;
     
     public void setPatientService( PatientService patientService )
@@ -38,7 +24,7 @@
     }
     
     
-/*
+
     private PatientIdentifierService patientIdentifierService;
     
     public void setPatientIdentifierService( PatientIdentifierService patientIdentifierService )
@@ -81,6 +67,7 @@
     // Input/Output and its Getter / Setter
     // -------------------------------------------------------------------------
 
+    /*
     private int id;
     
     public void setId( int id )
@@ -94,28 +81,29 @@
     {
         return patient;
     }
-/*
+
     private Patient representative;
     
     public Patient getRepresentative()
     {
         return representative;
     }
-*/
+
     private PatientIdentifier patientIdentifier;
     
     public PatientIdentifier getPatientIdentifier()
     {
         return patientIdentifier;
     }
-    /*
+   
+    
     private Collection<Program> programs;
     
     public Collection<Program> getPrograms()
     {
         return programs;
     }
-    */
+    
     private Map<Integer, String> patientAttributeValueMap = new HashMap<Integer, String>();
     
     public Map<Integer, String> getPatientAttributeValueMap()
@@ -143,7 +131,7 @@
     {
         return identifierTypes;
     }
-/*
+
     private Map<Integer, String> identiferMap;
     
     public Map<Integer, String> getIdentiferMap()
@@ -164,13 +152,14 @@
     {
         return childContactType;
     }
- */
+
     private String systemIdentifier;
    
     public String getSystemIdentifier()
     {
         return systemIdentifier;
     }
+    */
     
     // -------------------------------------------------------------------------
     // Action implementation
@@ -179,7 +168,7 @@
     public String execute()
         throws Exception
     {
-        patient = patientService.getPatient( id );
+        //patient = patientService.getPatient( id );
 
        // patientIdentifier = patientIdentifierService.getPatientIdentifier( patient );
 
@@ -216,13 +205,14 @@
                 systemIdentifier = identifier.getIdentifier();
             }
         }
-    */
+    
         for ( PatientAttribute patientAttribute : patient.getAttributes() )
         {
             patientAttributeValueMap.put( patientAttribute.getId(), PatientAttributeValue.UNKNOWN );
         }
-
-        Collection<PatientAttributeValue> patientAttributeValues = patientAttributeValueService.getPatientAttributeValues( patient );
+        */
+        
+/*        Collection<PatientAttributeValue> patientAttributeValues = patientAttributeValueService.getPatientAttributeValues( patient );
 
         for ( PatientAttributeValue patientAttributeValue : patientAttributeValues )
         {
@@ -237,7 +227,7 @@
                 patientAttributeValueMap.put( patientAttributeValue.getPatientAttribute().getId(),
                     patientAttributeValue.getValue() );
             }
-        }
+        }*/
         /*
         programs = programService.getAllPrograms();
 

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/GetPatientReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/GetPatientReportResultAction.java	2012-06-22 05:36:42 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/GetPatientReportResultAction.java	2014-07-05 06:55:17 +0000
@@ -1,58 +1,6 @@
 package org.hisp.dhis.reports.benificiaryinfo.action;
 
-import java.io.BufferedInputStream;
-import java.io.File;
-import java.io.FileInputStream;
-import java.io.InputStream;
-import java.text.SimpleDateFormat;
-import java.util.ArrayList;
-import java.util.Calendar;
-import java.util.Collection;
 import java.util.Date;
-import java.util.HashMap;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Map;
-import java.util.UUID;
-
-import javax.xml.parsers.DocumentBuilder;
-import javax.xml.parsers.DocumentBuilderFactory;
-
-import jxl.Workbook;
-import jxl.format.Alignment;
-import jxl.format.Border;
-import jxl.format.BorderLineStyle;
-import jxl.format.VerticalAlignment;
-import jxl.write.Blank;
-import jxl.write.Label;
-import jxl.write.Number;
-import jxl.write.WritableCellFormat;
-import jxl.write.WritableSheet;
-import jxl.write.WritableWorkbook;
-
-import org.hisp.dhis.config.Configuration_IN;
-import org.hisp.dhis.i18n.I18nFormat;
-import org.hisp.dhis.organisationunit.OrganisationUnit;
-import org.hisp.dhis.patient.Patient;
-import org.hisp.dhis.patient.PatientAttribute;
-import org.hisp.dhis.patient.PatientIdentifier;
-import org.hisp.dhis.patient.PatientIdentifierService;
-import org.hisp.dhis.patient.PatientIdentifierType;
-import org.hisp.dhis.patient.PatientService;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValue;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValueService;
-import org.hisp.dhis.program.Program;
-import org.hisp.dhis.program.ProgramService;
-import org.hisp.dhis.reports.ReportService;
-import org.hisp.dhis.reports.Report_inDesign;
-import org.springframework.jdbc.core.JdbcTemplate;
-import org.springframework.jdbc.support.rowset.SqlRowSet;
-import org.w3c.dom.Document;
-import org.w3c.dom.Element;
-import org.w3c.dom.Node;
-import org.w3c.dom.NodeList;
-import org.xml.sax.SAXException;
-import org.xml.sax.SAXParseException;
 
 import com.opensymphony.xwork2.Action;
 
@@ -62,7 +10,7 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-    
+/*    
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -90,14 +38,14 @@
     {
         this.patientIdentifierService = patientIdentifierService;
     }
- /*   
+  
     private PatientAttributeService patientAttributeService;
     
     public void setPatientAttributeService( PatientAttributeService patientAttributeService )
     {
         this.patientAttributeService = patientAttributeService;
     }
- */   
+  
    private PatientAttributeValueService patientAttributeValueService;
     
     public void setPatientAttributeValueService( PatientAttributeValueService patientAttributeValueService )
@@ -118,12 +66,12 @@
     {
         this.format = format;
     }
-    
+    */
     // -------------------------------------------------------------------------
     // Input/Output and its Getter / Setter
     // -------------------------------------------------------------------------
     
- 
+ /*
     private int patientId;
 
     public void setPatientId( int patientId )
@@ -179,8 +127,15 @@
     private List<Integer> colList;
     private List<Integer> progList;
     
+    private Program program;
+    
+    public Program getProgram()
+    {
+        return program;
+    }
+
     private Patient patient;
-    private Program program;
+    
     
     private Map<Integer, String> patientAttributeValueMap = new HashMap<Integer, String>();
     
@@ -196,12 +151,11 @@
         return programStageDataElementValueMap;
     }
     
-    
     private Date executionDate;
     
-    private String systemIdentifier;
+    private String systemIdentifier;*/
     
-    private Map<Integer, String> identiferMap;
+    //private Map<Integer, String> identiferMap;
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
@@ -211,7 +165,7 @@
     public String execute() throws Exception 
     {
         
-        System.out.println( "Report Generation Start Time is : \t" + new Date() );
+/*        System.out.println( "Report Generation Start Time is : \t" + new Date() );
         
         raFolderName = reportService.getRAFolderName();
         
@@ -252,7 +206,7 @@
                 systemIdentifier = identifier.getIdentifier();
             }
         }
-        
+        */
         
         
         /*
@@ -302,7 +256,7 @@
         *
         */
         
-        String query = "SELECT patientdatavalue.programstageinstanceid,programstageinstance.programstageid,dataelementid,value,programstageinstance.executiondate from patientdatavalue " +
+/*        String query = "SELECT patientdatavalue.programstageinstanceid,programstageinstance.programstageid,dataelementid,value,programstageinstance.executiondate from patientdatavalue " +
                        " INNER JOIN programstageinstance on patientdatavalue.programstageinstanceid = programstageinstance.programstageinstanceid " +
                        " INNER JOIN programinstance on programstageinstance.programinstanceid = programinstance.programinstanceid " +
                        " WHERE programinstance.patientid = " + patient.getId() + " ORDER BY executiondate" ;
@@ -318,7 +272,7 @@
             {
                 String programStageDataElement = "";
                 
-                int programStageInstanceId = sqlResultSet.getInt( 1 );
+                //int programStageInstanceId = sqlResultSet.getInt( 1 );
                 int programStageId = sqlResultSet.getInt( 2 );
                 int dataElementId = sqlResultSet.getInt( 3 );
                 String deValue = sqlResultSet.getString( 4 );
@@ -329,14 +283,14 @@
                 programStageDataElementValueMap.put( programStageDataElement, deValue );
                 
             }
-        }
-        
+        }*/
+        /*
         for ( PatientAttribute patientAttribute : patient.getAttributes() )
         {
             patientAttributeValueMap.put( patientAttribute.getId(), PatientAttributeValue.UNKNOWN );
         }
-
-        Collection<PatientAttributeValue> patientAttributeValues = patientAttributeValueService.getPatientAttributeValues( patient );
+        */
+ /*       Collection<PatientAttributeValue> patientAttributeValues = patientAttributeValueService.getPatientAttributeValues( patient );
 
         for ( PatientAttributeValue patientAttributeValue : patientAttributeValues )
         {
@@ -351,18 +305,21 @@
                 patientAttributeValueMap.put( patientAttributeValue.getPatientAttribute().getId(),
                     patientAttributeValue.getValue() );
             }
-        }
-        
-        
-        generateReport();
+        }*/
+        
+        //System.out.println( "Patient Id=" + patientId + "----SelProgram Id= " + selProgramId );
+       // System.out.println( "-----excel Template Name=" + excelTemplateName + "-----xml Template Name=" + xmlTemplateName );
+        
+        //generateReport();
         
         //System.out.println( "PatientId=" + patientId + "----SelProgramId= " + selProgramId );
         //System.out.println( "-----excelTemplateName=" + excelTemplateName + "-----xmlTemplateName=" + xmlTemplateName );
         System.out.println( "Report Generation End Time is : \t" + new Date() );
         
         return SUCCESS;
-    }
+    //}
     
+    /*
     public void generateReport() throws Exception
     {
         Workbook templateWorkbook = Workbook.getWorkbook( new File( inputTemplatePath ) );
@@ -386,7 +343,7 @@
         
         String deCodesXMLFileName = xmlTemplateName;
         
-        List<Report_inDesign> reportDesignList = reportService.getReportDesign( deCodesXMLFileName );
+        List<Report_inDesign> reportDesignList = reportService.getReportDesignForTracker( deCodesXMLFileName );
         
         
       //  List<String> deCodesList = getDECodes( deCodesXMLFileName );
@@ -404,7 +361,7 @@
         if ( sqlResultSet1 != null )
         {
          */
-            int rowNo = 1;
+           // int rowNo = 1;
            // sqlResultSet1.beforeFirst();
             /*
             while ( sqlResultSet1.next() )
@@ -421,17 +378,17 @@
                 ProgramStageInstance prgStageInstance = programStageInstanceService.getProgramStageInstance( programStageInstanceId );
                
                 */
-                List<PatientIdentifier> patientIdentifiers = new ArrayList<PatientIdentifier>( patientIdentifierService.getPatientIdentifiers( patient ) );
-                int count1 = 0;
-                Iterator<Report_inDesign> reportDesignIterator = reportDesignList.iterator();
-                while( reportDesignIterator.hasNext() )
-                {
-                    Report_inDesign report_inDesign = (Report_inDesign) reportDesignIterator.next();
+                //List<PatientIdentifier> patientIdentifiers = new ArrayList<PatientIdentifier>( patientIdentifierService.getPatientIdentifiers( patient ) );
+                //int count1 = 0;
+                //Iterator<Report_inDesign> reportDesignIterator = reportDesignList.iterator();
+                //while( reportDesignIterator.hasNext() )
+                //{
+                   // Report_inDesign report_inDesign = (Report_inDesign) reportDesignIterator.next();
                     
-                    String deType = report_inDesign.getPtype();
-                    String sType = report_inDesign.getStype();
-                    String deCodeString = report_inDesign.getExpression();
-                    String tempStr = "";
+                    //String deType = report_inDesign.getPtype();
+                   // String sType = report_inDesign.getStype();
+                   // String deCodeString = report_inDesign.getExpression();
+                    //String tempStr = "";
                     
                     //int tempColNo = colList.get( count1 );
                    // int sheetNo = sheetList.get( count1 );
@@ -439,16 +396,17 @@
                    // String sType = serviceType.get( count1 );
                    // int tempRowNo = rowList.get( count1 );
                     
-                    if( sType.equalsIgnoreCase("slno") )
-                    {
+                    //if( sType.equalsIgnoreCase("slno") )
+                   /* {
                         tempStr = "" + rowNo;
                     }
                     else if( deCodeString.equalsIgnoreCase("GENDER") )
                     {
-                        tempStr = patient.getGender();
+                        tempStr = "";
                     }
                     else if( deCodeString.equalsIgnoreCase("AGE") )
-                    {
+                    {*/
+                        /*
                         if( patient.getDobType() == 'V' || patient.getDobType() == 'D')
                         {
                             tempStr =  simpleDateFormat.format(patient.getBirthDate());
@@ -459,8 +417,9 @@
                           
                             
                         }
-                    }
-                    
+                        */
+                        
+                    //}
                     /*
                     else if( deCodeString.equalsIgnoreCase("DOB") )
                     {
@@ -468,13 +427,12 @@
                     }
                     */
                     
-                    else if( deCodeString.equalsIgnoreCase("ADMISSION") )
+                   /* else if( deCodeString.equalsIgnoreCase("ADMISSION") )
                     {
                         //tempStr = program.getDateOfEnrollmentDescription();
                         tempStr = simpleDateFormat.format( executionDate );
                     }
                     
-                    
                     else if( deCodeString.equalsIgnoreCase("FACILITY") )
                     {
                         tempStr = patient.getOrganisationUnit().getName();
@@ -494,7 +452,7 @@
                     
                     else if( deCodeString.equalsIgnoreCase("PATIENTNAME") )
                     {
-                        tempStr = patient.getFullName();
+                        tempStr = "";
                     }
 
                     else if( deCodeString.equalsIgnoreCase("SYSTEMIDENTIFIER") )
@@ -506,46 +464,48 @@
                         tempStr = "";
                     }
                     
-                    
                     else if( sType.equalsIgnoreCase("identifier") )
                     {
                         //System.out.println( "Inside pipart0" );
                         tempStr = " ";
                         for( PatientIdentifier patientIdentifier : patientIdentifiers )
                         {
-                                //System.out.println( patientIdentifier.getId() + " : " + deCode );
-                                if( patientIdentifier.getIdentifierType() != null && patientIdentifier.getIdentifierType().getId() == Integer.parseInt(deCodeString) )
-                                {
-                                        try
-                                        {
-                                                tempStr = patientIdentifier.getIdentifier();
-                                        }
-                                        catch( Exception e )
-                                        {
-                                        }
-                                        break;
-                                }
+                            //System.out.println( patientIdentifier.getId() + " : " + deCode );
+                            if( patientIdentifier.getIdentifierType() != null && patientIdentifier.getIdentifierType().getId() == Integer.parseInt(deCodeString) )
+                            {
+                                try
+                                {
+                                        tempStr = patientIdentifier.getIdentifier();
+                                }
+                                catch( Exception e )
+                                {
+                                }
+                                break;
+                            }
                         }
                     }
                     else if( sType.equalsIgnoreCase("attributes") )
                     {
                         tempStr = " ";
+                        
                         for( PatientAttribute patientAttribute : patient.getAttributes() )
                         {
-                                if( patientAttribute.getId() == Integer.parseInt(deCodeString) )
-                                {
-                                        try
-                                        {
-                                                tempStr = patientAttributeValueMap.get( patientAttribute.getId() );
-                                        }
-                                        catch( Exception e )
-                                        {
-                                        }
-                                        break;
-                                }
+                            if( patientAttribute.getId() == Integer.parseInt(deCodeString) )
+                            {
+                                try
+                                {
+                                        tempStr = patientAttributeValueMap.get( patientAttribute.getId() );
+                                }
+                                catch( Exception e )
+                                {
+                                }
+                                break;
+                            }
                         }
+                        
+                        
                     }
-                    /*
+                    
                     else if( sType.equalsIgnoreCase("PI-PART6") )
                     {
                         tempStr = " ";
@@ -584,7 +544,7 @@
                                 tempStr = deCOC.getName();
                         }
                     }
-                    */
+                    
                     else if( sType.equalsIgnoreCase("dataelement") )
                     {
                         tempStr = " ";
@@ -682,13 +642,11 @@
                             tempSDate.add(Calendar.DATE, 14);
                             //tempStr = "" + tempSDate.get(Calendar.YEAR) + "-" + ( tempSDate.get(Calendar.MONTH) + 1) + "-" +tempSDate.get(Calendar.DATE);
                             tempStr =  simpleDateFormat.format( tempSDate.getTime() );
-                            
                         }
                         else
                         {
                             tempStr = " ";
                         }
-                        
                     }
                     else if( sType.equalsIgnoreCase("after15thday") )
                     {
@@ -703,13 +661,11 @@
                             //tempStr = "" + tempSDate.get(Calendar.YEAR) + "-" + ( tempSDate.get(Calendar.MONTH) + 1) + "-" +tempSDate.get(Calendar.DATE);
                             
                             tempStr =  simpleDateFormat.format( tempSDate.getTime() );
-                            
                         }
                         else
                         {
                             tempStr = " ";
                         }
-                        
                     }
                     
                     else if( sType.equalsIgnoreCase("1stmonth") )
@@ -724,13 +680,11 @@
                             tempSDate.add(Calendar.MONTH, 1);
                             //tempStr = "" + tempSDate.get(Calendar.YEAR) + "-" + ( tempSDate.get(Calendar.MONTH) + 1) + "-" +tempSDate.get(Calendar.DATE);
                             tempStr =  simpleDateFormat.format( tempSDate.getTime() );
-                            
                         }
                         else
                         {
                             tempStr = " ";
                         }
-
                     }
                     
                     else if( sType.equalsIgnoreCase("after45thday") )
@@ -745,7 +699,6 @@
                             tempSDate.add(Calendar.DATE, 45);
                             //tempStr = "" + tempSDate.get(Calendar.YEAR) + "-" + ( tempSDate.get(Calendar.MONTH) + 1) + "-" +tempSDate.get(Calendar.DATE);
                             tempStr =  simpleDateFormat.format( tempSDate.getTime() );
-                            
                         }
                         else
                         {
@@ -766,7 +719,6 @@
                            // tempStr = "" + tempSDate.get(Calendar.DATE);
                            // tempStr = "" + tempSDate.get(Calendar.YEAR) + "-" + ( tempSDate.get(Calendar.MONTH) + 1) + "-" +tempSDate.get(Calendar.DATE);
                             tempStr =  simpleDateFormat.format( tempSDate.getTime() );
-                            
                         }
                         else
                         {
@@ -787,7 +739,6 @@
                            // tempStr = "" + tempSDate.get(Calendar.DATE);
                             //tempStr = "" + tempSDate.get(Calendar.YEAR) + "-" + ( tempSDate.get(Calendar.MONTH) + 1) + "-" +tempSDate.get(Calendar.DATE);
                             tempStr =  simpleDateFormat.format( tempSDate.getTime() );
-                            
                         }
                         else
                         {
@@ -808,7 +759,6 @@
                            // tempStr = "" + tempSDate.get(Calendar.DATE);
                             //tempStr = "" + tempSDate.get(Calendar.YEAR) + "-" + ( tempSDate.get(Calendar.MONTH) + 1) + "-" +tempSDate.get(Calendar.DATE);
                             tempStr =  simpleDateFormat.format( tempSDate.getTime() );
-                            
                         }
                         else
                         {
@@ -829,7 +779,6 @@
                             //tempStr = "" + tempSDate.get(Calendar.YEAR) + "-" +tempSDate.get(Calendar.MONTH) + "-" +tempSDate.get(Calendar.DATE);
                             
                             tempStr =  simpleDateFormat.format( tempSDate.getTime() );
-                            
                         }
                         else
                         {
@@ -845,20 +794,17 @@
                     int tempColNo = report_inDesign.getColno();
                     int sheetNo = report_inDesign.getSheetno();
                     WritableSheet sheet0 = outputReportWorkbook.getSheet( sheetNo );
+                    
                     if ( tempStr == null || tempStr.equals( " " ) )
                     {
-                        
-            
                         sheet0.addCell( new Blank( tempColNo, tempRowNo, wCellformat ) );
                     } 
                     else
                     {
-                    
                         if ( deCodeString.equalsIgnoreCase( "PERIOD-FROM" ) || deCodeString.equalsIgnoreCase( "PERIOD-TO" ) || deCodeString.equalsIgnoreCase( "FACILITYPPP" ) || deCodeString.equalsIgnoreCase( "FACILITYPPP" ) )
                         {
                             
                         } 
-                        
                         else
                         {   
                            // System.out.println( sType + " : " + deCode + " : " + tempStr );
@@ -873,7 +819,6 @@
                         }
 
                     }
-                    
                     count1++;
                 }
                 
@@ -886,10 +831,11 @@
         fileName = excelTemplateName;
         File outputReportFile = new File( outputReportPath );
         inputStream = new BufferedInputStream( new FileInputStream( outputReportFile ) );
-        outputReportFile.deleteOnExit();
-        
+        outputReportFile.deleteOnExit();*/
     }
 
+  
+    
 /*    
     public List<String> getDECodes( String fileName )
     {
@@ -941,5 +887,4 @@
     
 */    
     
-    
 }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/GetRegistredPatientInformationAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/GetRegistredPatientInformationAction.java	2012-07-24 09:11:33 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/GetRegistredPatientInformationAction.java	2014-07-05 06:58:06 +0000
@@ -1,41 +1,13 @@
 package org.hisp.dhis.reports.benificiaryinfo.action;
 
-import java.io.File;
-import java.util.ArrayList;
-import java.util.Collection;
-import java.util.HashMap;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Map;
-
-import javax.xml.parsers.DocumentBuilder;
-import javax.xml.parsers.DocumentBuilderFactory;
-
-import org.hisp.dhis.organisationunit.OrganisationUnit;
-import org.hisp.dhis.organisationunit.OrganisationUnitService;
-import org.hisp.dhis.paging.ActionPagingSupport;
-import org.hisp.dhis.patient.Patient;
-import org.hisp.dhis.patient.PatientAttribute;
-import org.hisp.dhis.patient.PatientAttributeService;
-import org.hisp.dhis.patient.PatientService;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValue;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValueService;
-import org.hisp.dhis.reports.ReportService;
-import org.hisp.dhis.reports.util.ProgramDetail;
-import org.w3c.dom.Document;
-import org.w3c.dom.Element;
-import org.w3c.dom.Node;
-import org.w3c.dom.NodeList;
-import org.xml.sax.SAXException;
-import org.xml.sax.SAXParseException;
-
-public class GetRegistredPatientInformationAction extends ActionPagingSupport<Patient>
+
+public class GetRegistredPatientInformationAction 
 {
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
 
-
+/*
     private PatientAttributeValueService patientAttributeValueService;
     
     public void setPatientAttributeValueService( PatientAttributeValueService patientAttributeValueService )
@@ -72,18 +44,25 @@
         this.patientService = patientService;
     }
     
+    private OrganisationUnitSelectionManager selectionManager;
+    
+    public void setSelectionManager( OrganisationUnitSelectionManager selectionManager )
+    {
+        this.selectionManager = selectionManager;
+    }*/
+    
     // -------------------------------------------------------------------------
     // Input
     // -------------------------------------------------------------------------
-    
+    /*
     private List<String> searchText = new ArrayList<String>();
 
     public void setSearchText( List<String> searchText )
     {
         this.searchText = searchText;
     }
-
-    private Boolean listAll;
+    */
+/*    private Boolean listAll;
     
     public void setListAll( Boolean listAll )
     {
@@ -93,14 +72,15 @@
     public Boolean getListAll()
     {
         return listAll;
-    }
-   
+    }*/
+   /*
     private List<Integer> searchingAttributeId = new ArrayList<Integer>();
     
     public void setSearchingAttributeId( List<Integer> searchingAttributeId )
     {
         this.searchingAttributeId = searchingAttributeId;
     }
+    */
     /*
     private List<Program> programs;
     
@@ -115,7 +95,7 @@
 
 
 
-    private Integer total;
+/*    private Integer total;
     
     public Integer getTotal()
     {
@@ -134,7 +114,7 @@
     public Collection<Patient> getPatients()
     {
         return patients;
-    }
+    }*/
     /*
     private Map<Integer, List<Program>> mapPatientPrograms = new HashMap<Integer, List<Program>>();
     
@@ -149,7 +129,7 @@
     // Getters/Setters
     // -------------------------------------------------------------------------
 
-
+/*
     private List<PatientAttribute> patientAttributes = new ArrayList<PatientAttribute>();
     
     public List<PatientAttribute> getPatientAttributes()
@@ -172,32 +152,41 @@
     public List<ProgramDetail> getProgramList()
     {
         return programList;
-    }
-    
+    }*/
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-    
-    private Boolean isSelectedOrg;
+    */
+ /*   private Boolean isSelectedOrg;
     
     public void setIsSelectedOrg( Boolean isSelectedOrg )
     {
         this.isSelectedOrg = isSelectedOrg;
     }
     
-    private OrganisationUnit organisationUnit;
+    private List<String> searchTexts = new ArrayList<String>();
+    
+    public void setSearchTexts( List<String> searchTexts )
+    {
+        this.searchTexts = searchTexts;
+    }*/
+    
+    
+    //private OrganisationUnit organisationUnit;
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
 
-    public String execute()
-        throws Exception
-    {
+   // public String execute()
+        //throws Exception
+    //{
         //OrganisationUnit organisationUnit = selectedStateManager.getSelectedOrganisationUnit();
-        organisationUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
+        //OrganisationUnit organisationUnit = selectionManager.getSelectedOrganisationUnit();
+        //organisationUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
         // ---------------------------------------------------------------------
         // Get all of patients into the selected organisation unit
         // ---------------------------------------------------------------------
@@ -217,10 +206,13 @@
         
         //System.out.println( "OrganisationUnit= "  + ouIDTB + "---,is Selected Org checked = " + isSelectedOrg );
         
-        raFolderName = reportService.getRAFolderName();
-        
-        programList = new ArrayList<ProgramDetail>();
-        
+        //raFolderName = reportService.getRAFolderName();
+        
+        //programList = new ArrayList<ProgramDetail>();
+        
+        
+        
+        /*
         for ( Integer attributeId : searchingAttributeId )
         {
             if ( attributeId != null && attributeId != 0 )
@@ -228,8 +220,8 @@
                 patientAttributes.add( patientAttributeService.getPatientAttribute( attributeId ) );
             }
         }
-        
-        
+        */
+        /*
         if( isSelectedOrg )
         {
             searchPatientByNameAndOrgUnit( searchText , organisationUnit );
@@ -239,13 +231,48 @@
             searchPatientByAttributes( searchingAttributeId, searchText );
             //searchPatientByNameAndOrgUnit( searchText , organisationUnit );
         }
-        
-        
-        getProgramDetailList();
-        
-        return SUCCESS;
-
-    }
+        */
+        //searchPatientByAttributes( searchingAttributeId, searchText );
+       
+        //OrganisationUnit organisationUnit = selectionManager.getSelectedOrganisationUnit();
+
+       // if ( searchTexts.size() > 0 )
+        //{
+            //organisationUnit = ( isSelectedOrg ) ? organisationUnit : null;
+            
+            //System.out.println( "organisationUnit= "  + organisationUnit + "---,searchText= " + searchTexts );
+            /*
+            total = patientService.countSearchPatients( searchTexts, organisationUnit, null );
+            this.paging = createPaging( total );
+            patients = patientService.searchPatients( searchTexts, organisationUnit, null, null, paging.getStartPos(), paging.getPageSize() );
+            */
+ /*           
+            Collection<PatientAttributeValue> attributeValues = patientAttributeValueService.getPatientAttributeValues( patients );
+            
+            for ( Patient patient : patients )
+            {
+                mapPatientOrgunit.put( patient.getId(), getHierarchyOrgunit( patient.getOrganisationUnit() ) );
+        
+                for ( PatientAttributeValue attributeValue : attributeValues )
+                {
+                    mapPatientPatientAttr.put( patient.getId() + "-" + attributeValue.getPatientAttribute().getId(),
+                        attributeValue.getValue() );
+                }
+            }*/
+            
+            /*
+            for ( Patient patient : patients )
+            {
+                mapPatientOrgunit.put( patient.getId(), getHierarchyOrgunit( patient.getOrganisationUnit() ) );
+            }
+            */
+        //}
+        
+        //getProgramDetailList();
+        
+        //return SUCCESS;
+
+    //}
 
     // -------------------------------------------------------------------------
     // Supporting methods
@@ -260,18 +287,15 @@
             .getPageSize() ) );
     }
 */
-    
+    /*
     private void searchPatientByNameAndOrgUnit( List<String> searchText , OrganisationUnit organisationUnit )
     {
-       
+        
         total = patientService.countGetPatientsByOrgUnit( organisationUnit );
         this.paging = createPaging( total );
        
-        //Collection<Patient> tempPatients = new ArrayList<Patient>();
         for( String text : searchText )
         {
-            //tPatients( OrganisationUnit organisationUnit, String searchText, int min, int max )
-            
             List<Patient> tempPatients = new ArrayList<Patient>( patientService.getPatients( organisationUnit, text, paging.getStartPos(), paging.getPageSize() ));
             patients.addAll( tempPatients ); 
         }
@@ -284,8 +308,6 @@
 
         for ( Patient patient : patients )
         {
-            //programs.addAll( patient.getPrograms() );
-            
             mapPatientOrgunit.put( patient.getId(), getHierarchyOrgunit( patient.getOrganisationUnit() ) );
     
             for ( PatientAttributeValue attributeValue : attributeValues )
@@ -293,53 +315,32 @@
                 mapPatientPatientAttr.put( patient.getId() + "-" + attributeValue.getPatientAttribute().getId(),
                     attributeValue.getValue() );
             }
-            
-            //mapPatientPrograms.put( patient.getId(), getProgramsByPatient( patient ) );            
         }
         
     }
-    
-    
+    */
+ 
+    /*
     private void searchPatientByAttributes( List<Integer> searchingAttributeId, List<String> searchText )
     {
-        //total = patientAttributeValueService.countSearchPatients( searchingAttributeId, searchText );
         
-        //OrganisationUnit orgUnit = null;
+        OrganisationUnit organisationUnit = selectionManager.getSelectedOrganisationUnit();
         
         organisationUnit = (isSelectedOrg) ? organisationUnit : null;
-        total = patientService.countSearchPatients( searchText, organisationUnit );
-        //Collection<Patient> getPatients( String searchText, Integer min, Integer max );
+        
+        
+        total = patientService.countSearchPatients( searchText, organisationUnit, null );
         
         this.paging = createPaging( total );
         
-        //patients = patientAttributeValueService.searchPatients( searchingAttributeId, searchText, paging.getStartPos(),paging.getPageSize() );
-        patients = patientService.searchPatients( searchText, organisationUnit, paging.getStartPos(), paging.getPageSize() );
+        patients = patientService.searchPatients( searchText, organisationUnit, null, null, paging.getStartPos(), paging.getPageSize() );
         
-        /*
-        if ( isSelectedOrg )
-        {
-            Iterator<Patient> patientIterator = patients.iterator();
-            while ( patientIterator.hasNext() )
-            {
-                Patient patient = patientIterator.next();
-                
-                OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
-                
-                if ( patient.getOrganisationUnit().getId() != orgUnit.getId() )
-                {
-                    patientIterator.remove();
-                }
-            }
-            total = patients.size();
-            this.paging = createPaging( total );
-        }
-        */
+
         
         Collection<PatientAttributeValue> attributeValues = patientAttributeValueService.getPatientAttributeValues( patients );
 
         for ( Patient patient : patients )
         {
-            //programs.addAll( patient.getPrograms() );
             
             mapPatientOrgunit.put( patient.getId(), getHierarchyOrgunit( patient.getOrganisationUnit() ) );
 
@@ -348,12 +349,13 @@
                 mapPatientPatientAttr.put( patient.getId() + "-" + attributeValue.getPatientAttribute().getId(),
                     attributeValue.getValue() );
             }
-            
-            //mapPatientPrograms.put( patient.getId(), getProgramsByPatient( patient ) );            
         }
     }
-    
-    
+     */
+
+    
+    
+/*    
     private String getHierarchyOrgunit( OrganisationUnit orgunit )
     {
         String hierarchyOrgunit = orgunit.getName();
@@ -366,7 +368,31 @@
         }
 
         return hierarchyOrgunit;
+    }*/
+ 
+    
+    /*
+    if ( isSelectedOrg )
+    {
+        Iterator<Patient> patientIterator = patients.iterator();
+        while ( patientIterator.hasNext() )
+        {
+            Patient patient = patientIterator.next();
+            
+            OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
+            
+            if ( patient.getOrganisationUnit().getId() != orgUnit.getId() )
+            {
+                patientIterator.remove();
+            }
+        }
+        total = patients.size();
+        this.paging = createPaging( total );
     }
+    */    
+    
+    
+    
     
 /*    
     private List<Program> getProgramsByPatient( Patient patient )
@@ -388,7 +414,7 @@
     }
 */    
 
-    public void getProgramDetailList()
+/*    public void getProgramDetailList()
     {
         String fileName = "NBITSProgramList.xml";
         String path = System.getProperty( "user.home" ) + File.separator + "dhis" + File.separator + raFolderName + File.separator + fileName;
@@ -471,7 +497,7 @@
         }
 
     }// getReportList end
-    
+*/    
     
     
 }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/PatientInfoReportsFormAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/PatientInfoReportsFormAction.java	2012-04-04 11:58:27 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/benificiaryinfo/action/PatientInfoReportsFormAction.java	2014-07-05 06:59:15 +0000
@@ -1,10 +1,5 @@
 package org.hisp.dhis.reports.benificiaryinfo.action;
 
-import java.util.Collection;
-
-import org.hisp.dhis.patient.PatientAttribute;
-import org.hisp.dhis.patient.PatientAttributeService;
-
 import com.opensymphony.xwork2.Action;
 
 public class PatientInfoReportsFormAction implements Action
@@ -14,23 +9,23 @@
     // Dependencies
     // -------------------------------------------------------------------------
     
-    private PatientAttributeService patientAttributeService;
+ /*   private PatientAttributeService patientAttributeService;
 
     public void setPatientAttributeService( PatientAttributeService patientAttributeService )
     {
         this.patientAttributeService = patientAttributeService;
-    }
+    }*/
     
     // -------------------------------------------------------------------------
     // Input/output
     // -------------------------------------------------------------------------
 
-    private Collection<PatientAttribute> patientAttributes;
+/*    private Collection<PatientAttribute> patientAttributes;
 
     public Collection<PatientAttribute> getPatientAttributes()
     {
         return patientAttributes;
-    }
+    }*/
 
     
     
@@ -41,7 +36,7 @@
     public String execute() throws Exception
     {
         
-        patientAttributes = patientAttributeService.getAllPatientAttributes();
+        //patientAttributes = patientAttributeService.getAllPatientAttributes();
         /*
         programs = programService.getAllPrograms();
 

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/csreview/action/GenerateCSReviewReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/csreview/action/GenerateCSReviewReportResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/csreview/action/GenerateCSReviewReportResultAction.java	2013-09-19 06:34:31 +0000
@@ -62,14 +62,14 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-
+/*
     private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     private PeriodService periodService;
 
     public void setPeriodService( PeriodService periodService )
@@ -179,7 +179,7 @@
 
         // Intialisation
 
-        statementManager.initialise();
+        //statementManager.initialise();
         orgUnitList = new ArrayList<OrganisationUnit>();
         String deCodesXMLFileName = "";
         raFolderName = reportService.getRAFolderName();
@@ -383,7 +383,7 @@
         System.out.println( "Report Generation End Time is : \t" + new Date() );
 
         outputReportFile.deleteOnExit();
-        statementManager.destroy();
+        //statementManager.destroy();
         return SUCCESS;
     }
 

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/datasetlock/action/GenerateDataSetLockReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/datasetlock/action/GenerateDataSetLockReportResultAction.java	2012-03-19 06:11:45 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/datasetlock/action/GenerateDataSetLockReportResultAction.java	2014-03-04 12:26:56 +0000
@@ -63,14 +63,13 @@
     {
         this.dataSetService = dataSetService;
     }
-/*
-    private DataSetLockService dataSetLockService;
 
-    public void setDataSetLockService( DataSetLockService dataSetLockService )
-    {
-        this.dataSetLockService = dataSetLockService;
-    }
-*/
+    /*
+     * private DataSetLockService dataSetLockService;
+     * 
+     * public void setDataSetLockService( DataSetLockService dataSetLockService
+     * ) { this.dataSetLockService = dataSetLockService; }
+     */
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -144,6 +143,12 @@
 
     private int x;
 
+    /*
+     * private boolean lockStatus;
+     * 
+     * public boolean isLockStatus() { return lockStatus; }
+     */
+
     public String execute()
         throws Exception
     {
@@ -170,11 +175,13 @@
         dataSet = dataSetService.getDataSet( dataSets );
         dSetSource = dataSet.getSources();
 
-        //String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "output" + File.separator + UUID.randomUUID().toString() + ".xls";
-        
-        String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator +  Configuration_IN.DEFAULT_TEMPFOLDER;
+        // String outputReportPath = System.getenv( "DHIS2_HOME" ) +
+        // File.separator + raFolderName + File.separator + "output" +
+        // File.separator + UUID.randomUUID().toString() + ".xls";
+
+        String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator + Configuration_IN.DEFAULT_TEMPFOLDER;
         File newdir = new File( outputReportPath );
-        if( !newdir.exists() )
+        if ( !newdir.exists() )
         {
             newdir.mkdirs();
         }
@@ -314,10 +321,16 @@
                 sheet0.mergeCells( colStart + columnNo, rowStart + rowNo + 1, colStart + columnNo, x + 1 );
                 for ( Period periodElement : periods )
                 {
-                    
-                    boolean lockStatus = dataSetService.isLocked( dataSet, periodElement, organisationUnit, null );
-                    //DataSetLock dataSetLock = dataSetLockService.getDataSetLockByDataSetPeriodAndSource( dataSet, periodElement, organisationUnit );
-                    //if ( dataSetLock != null )
+                    // DataSetLock dataSetLock =
+                    // dataSetLockService.getDataSetLockByDataSetPeriodAndSource(
+                    // dataSet, periodElement, organisationUnit );
+                    
+                    //boolean lockStatus = dataSetService.isLocked( dataSet, periodElement, organisationUnit, null );
+                    boolean lockStatus = dataSetService.isLocked( dataSet, periodElement, organisationUnit, null, null );
+                    
+                    
+                    
+                    // if ( dataSetLock != null )
                     if ( lockStatus )
                     {
                         sheet0.addCell( new Number( colStart
@@ -389,9 +402,12 @@
                 int periodsCounter = 0;
                 for ( Period periodElement : periods )
                 {
-                    //DataSetLock dataSetLock = dataSetLockService.getDataSetLockByDataSetPeriodAndSource( dataSet, periodElement, organisationUnit );
-                    boolean lockStatus = dataSetService.isLocked( dataSet, periodElement, organisationUnit, null );
-                    //if ( dataSetLock != null )
+                    // DataSetLock dataSetLock =
+                    // dataSetLockService.getDataSetLockByDataSetPeriodAndSource(
+                    // dataSet, periodElement, organisationUnit );
+                    //boolean lockStatus = dataSetService.isLocked( dataSet, periodElement, organisationUnit, null );
+                    boolean lockStatus = dataSetService.isLocked( dataSet, periodElement, organisationUnit, null, null );
+                    // if ( dataSetLock != null )
                     if ( lockStatus )
                     {
                         sheet0.addCell( new Number( colStart

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/districtfeedback/action/GenerateAggregationDistrictFeedbackReportAnalyserFormAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/districtfeedback/action/GenerateAggregationDistrictFeedbackReportAnalyserFormAction.java	2012-07-26 09:20:56 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/districtfeedback/action/GenerateAggregationDistrictFeedbackReportAnalyserFormAction.java	2013-09-19 06:34:31 +0000
@@ -14,7 +14,7 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-
+    
     private PeriodService periodService;
 
     public void setPeriodService( PeriodService periodService )
@@ -25,7 +25,7 @@
     // -------------------------------------------------------------------------
     // Input/Output
     // -------------------------------------------------------------------------
-
+    
     private Collection<PeriodType> periodTypes;
 
     public Collection<PeriodType> getPeriodTypes()
@@ -39,24 +39,24 @@
     {
         return reportTypeName;
     }
-
+    
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
-
+    
     public String execute()
         throws Exception
     {
         reportTypeName = ReportType.RT_FEEDBACK_TEMPLATE;
-
+        
         periodTypes = periodService.getAllPeriodTypes();
 
         Iterator<PeriodType> periodTypeIterator = periodTypes.iterator();
         while ( periodTypeIterator.hasNext() )
         {
             PeriodType type = periodTypeIterator.next();
-            if ( type.getName().equalsIgnoreCase( "daily" ) || type.getName().equalsIgnoreCase( "Monthly" )
-                || type.getName().equalsIgnoreCase( "quarterly" ) || type.getName().equalsIgnoreCase( "yearly" ) )
+            if ( type.getName().equalsIgnoreCase( "daily" ) || type.getName().equalsIgnoreCase( "Monthly" ) || type.getName().equalsIgnoreCase( "quarterly" )
+                || type.getName().equalsIgnoreCase( "yearly" ) )
             {
             }
             else

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/districtfeedback/action/GenerateAggregationDistrictFeedbackReportAnalyserResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/districtfeedback/action/GenerateAggregationDistrictFeedbackReportAnalyserResultAction.java	2012-07-26 09:20:56 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/districtfeedback/action/GenerateAggregationDistrictFeedbackReportAnalyserResultAction.java	2013-09-19 06:34:31 +0000
@@ -31,8 +31,7 @@
 import static org.hisp.dhis.system.util.TextUtils.getCommaDelimitedString;
 
 public class GenerateAggregationDistrictFeedbackReportAnalyserResultAction
-    implements Action
-{
+        implements Action {
 
     private final String GENERATEAGGDATA = "generateaggdata";
 
@@ -46,51 +45,43 @@
 
     private ReportOrgSpecificDataService reportOrgSpecificDataService;
 
-    public void setReportOrgSpecificDataService( ReportOrgSpecificDataService reportOrgSpecificDataService )
-    {
+    public void setReportOrgSpecificDataService(ReportOrgSpecificDataService reportOrgSpecificDataService) {
         this.reportOrgSpecificDataService = reportOrgSpecificDataService;
     }
 
     private StateDistrictFeedbackReportService stateDistrictFeedbackReportService;
 
-    public void setStateDistrictFeedbackReportService(
-        StateDistrictFeedbackReportService stateDistrictFeedbackReportService )
-    {
+    public void setStateDistrictFeedbackReportService(StateDistrictFeedbackReportService stateDistrictFeedbackReportService) {
         this.stateDistrictFeedbackReportService = stateDistrictFeedbackReportService;
     }
-
+/*
     private StatementManager statementManager;
 
-    public void setStatementManager( StatementManager statementManager )
-    {
+    public void setStatementManager(StatementManager statementManager) {
         this.statementManager = statementManager;
     }
-
+*/
     private ReportService reportService;
 
-    public void setReportService( ReportService reportService )
-    {
+    public void setReportService(ReportService reportService) {
         this.reportService = reportService;
     }
 
     private PeriodService periodService;
 
-    public void setPeriodService( PeriodService periodService )
-    {
+    public void setPeriodService(PeriodService periodService) {
         this.periodService = periodService;
     }
 
     private OrganisationUnitService organisationUnitService;
 
-    public void setOrganisationUnitService( OrganisationUnitService organisationUnitService )
-    {
+    public void setOrganisationUnitService(OrganisationUnitService organisationUnitService) {
         this.organisationUnitService = organisationUnitService;
     }
 
     private I18nFormat format;
 
-    public void setFormat( I18nFormat format )
-    {
+    public void setFormat(I18nFormat format) {
         this.format = format;
     }
 
@@ -100,64 +91,56 @@
 
     private int availablePeriods;
 
-    public void setAvailablePeriods( int availablePeriods )
-    {
+    public void setAvailablePeriods(int availablePeriods) {
         this.availablePeriods = availablePeriods;
     }
 
     private InputStream inputStream;
 
-    public InputStream getInputStream()
-    {
+    public InputStream getInputStream() {
         return inputStream;
     }
 
     private String fileName;
 
-    public String getFileName()
-    {
+    public String getFileName() {
         return fileName;
     }
 
     private String reportFileNameTB;
 
-    public void setReportFileNameTB( String reportFileNameTB )
+    public void setReportFileNameTB(String reportFileNameTB)
     {
         this.reportFileNameTB = reportFileNameTB;
     }
 
     private int ouIDTB;
 
-    public void setOuIDTB( int ouIDTB )
-    {
+    public void setOuIDTB(int ouIDTB) {
         this.ouIDTB = ouIDTB;
     }
 
     private String reportList;
 
-    public void setReportList( String reportList )
-    {
+    public void setReportList(String reportList) {
         this.reportList = reportList;
     }
 
     private String startDate;
 
-    public void setStartDate( String startDate )
-    {
+    public void setStartDate(String startDate) {
         this.startDate = startDate;
     }
 
     private String endDate;
 
-    public void setEndDate( String endDate )
-    {
+    public void setEndDate(String endDate) {
         this.endDate = endDate;
     }
 
     private String aggData;
 
-    public void setAggData( String aggData )
-    {
+    public void setAggData(String aggData) {
         this.aggData = aggData;
     }
 
@@ -185,28 +168,28 @@
 
     private String periodTypeId;
 
+
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
 
-    public String execute()
-        throws Exception
-    {
-
-        statementManager.initialise();
-
-        // Initialization
+    public String execute() throws Exception {
+
+
+        //statementManager.initialise();
+
+        //Initialization
 
         raFolderName = reportService.getRAFolderName();
         String ReportXMLFileName = "";
-        SimpleDateFormat simpleDateFormat = new SimpleDateFormat( "MMM-yyyy" );
-        SimpleDateFormat dayFormat = new SimpleDateFormat( "yyyy-MM-dd" );
-        SimpleDateFormat monthFormat = new SimpleDateFormat( "MMMM" );
-        SimpleDateFormat simpleMonthFormat = new SimpleDateFormat( "MMM" );
-        SimpleDateFormat yearFormat = new SimpleDateFormat( "yyyy" );
-        SimpleDateFormat simpleYearFormat = new SimpleDateFormat( "yy" );
+        SimpleDateFormat simpleDateFormat = new SimpleDateFormat("MMM-yyyy");
+        SimpleDateFormat dayFormat = new SimpleDateFormat("yyyy-MM-dd");
+        SimpleDateFormat monthFormat = new SimpleDateFormat("MMMM");
+        SimpleDateFormat simpleMonthFormat = new SimpleDateFormat("MMM");
+        SimpleDateFormat yearFormat = new SimpleDateFormat("yyyy");
+        SimpleDateFormat simpleYearFormat = new SimpleDateFormat("yy");
 
-        Report_in selReportObj = reportService.getReport( Integer.parseInt( reportList ) );
+        Report_in selReportObj = reportService.getReport(Integer.parseInt(reportList));
 
         ReportXMLFileName = selReportObj.getXmlTemplateName();
         reportModelTB = selReportObj.getModel();
@@ -215,261 +198,217 @@
 
         String parentUnit = "";
 
-        String inputTemplatePath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator
-            + "template" + File.separator + reportFileNameTB;
-
-        String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator + Configuration_IN.DEFAULT_TEMPFOLDER;
-
-        File newDir = new File( outputReportPath );
-
-        if ( !newDir.exists() )
-        {
+        String inputTemplatePath = System.getenv("DHIS2_HOME") + File.separator + raFolderName + File.separator + "template" + File.separator + reportFileNameTB;
+
+        String outputReportPath = System.getenv("DHIS2_HOME") + File.separator + Configuration_IN.DEFAULT_TEMPFOLDER;
+
+        File newDir = new File(outputReportPath);
+
+        if (!newDir.exists()) {
             newDir.mkdirs();
         }
         outputReportPath += File.separator + UUID.randomUUID().toString() + ".xls";
 
-        if ( reportModelTB.equalsIgnoreCase( "DYNAMIC-ORGUNIT" ) )
-        {
-            OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
-            orgUnitList = new ArrayList<OrganisationUnit>( orgUnit.getChildren() );
-            Collections.sort( orgUnitList, new IdentifiableObjectNameComparator() );
-        }
-        else if ( reportModelTB.equalsIgnoreCase( "STATIC" ) || reportModelTB.equalsIgnoreCase( "STATIC-DATAELEMENTS" )
-            || reportModelTB.equalsIgnoreCase( "STATIC-FINANCIAL" ) )
-        {
+        if (reportModelTB.equalsIgnoreCase("DYNAMIC-ORGUNIT")) {
+            OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit(ouIDTB);
+            orgUnitList = new ArrayList<OrganisationUnit>(orgUnit.getChildren());
+            Collections.sort(orgUnitList, new IdentifiableObjectNameComparator());
+        } else if (reportModelTB.equalsIgnoreCase("STATIC") || reportModelTB.equalsIgnoreCase("STATIC-DATAELEMENTS") || reportModelTB.equalsIgnoreCase("STATIC-FINANCIAL")) {
             orgUnitList = new ArrayList<OrganisationUnit>();
-            OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
-            orgUnitList.add( orgUnit );
-        }
-        else if ( reportModelTB.equalsIgnoreCase( "dynamicwithrootfacility" ) )
-        {
-            OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
-            orgUnitList = new ArrayList<OrganisationUnit>( orgUnit.getChildren() );
-            Collections.sort( orgUnitList, new IdentifiableObjectNameComparator() );
-            orgUnitList.add( orgUnit );
+            OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit(ouIDTB);
+            orgUnitList.add(orgUnit);
+        } else if (reportModelTB.equalsIgnoreCase("dynamicwithrootfacility")) {
+            OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit(ouIDTB);
+            orgUnitList = new ArrayList<OrganisationUnit>(orgUnit.getChildren());
+            Collections.sort(orgUnitList, new IdentifiableObjectNameComparator());
+            orgUnitList.add(orgUnit);
 
             parentUnit = orgUnit.getName();
         }
 
-        OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
-
-        System.out.println( orgUnitList.get( 0 ).getName() + " : " + selReportObj.getName()
-            + " : Report Generation Start Time is : " + new Date() );
-
-        selectedPeriod = periodService.getPeriod( availablePeriods );
-
-        sDate = format.parseDate( String.valueOf( selectedPeriod.getStartDate() ) );
-
-        eDate = format.parseDate( String.valueOf( selectedPeriod.getEndDate() ) );
+        OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit(ouIDTB);
+
+        System.out.println(orgUnitList.get(0).getName() + " : " + selReportObj.getName() + " : Report Generation Start Time is : " + new Date());
+
+        selectedPeriod = periodService.getPeriod(availablePeriods);
+
+        sDate = format.parseDate(String.valueOf(selectedPeriod.getStartDate()));
+
+        eDate = format.parseDate(String.valueOf(selectedPeriod.getEndDate()));
 
         Calendar cal = Calendar.getInstance();
-        cal.setTime( sDate );
-        int month = cal.get( Calendar.MONTH );
+        cal.setTime(sDate);
+        int month = cal.get(Calendar.MONTH);
 
-        if ( month < 4 )
-        {
-            cal.roll( Calendar.YEAR, -1 );
+        if (month < 4) {
+            cal.roll(Calendar.YEAR, -1);
         }
 
-        cal.set( Calendar.MONTH, 3 );
+        cal.set(Calendar.MONTH, 3);
 
         sAggDate = cal.getTime();
 
-        periodType = periodService.getPeriodTypeByName( periodTypeId );
-
-        List<Period> periodList = new ArrayList<Period>( periodService
-            .getPeriodsBetweenDates( periodType, sDate, eDate ) );
-
-        System.out.println( "* Period List Size: [" + periodList.size() + "]" );
-
-        Collection<Integer> periodIds = new ArrayList<Integer>( getIdentifiers( Period.class, periodList ) );
-
-        String periodIdsByComma = getCommaDelimitedString( periodIds );
-
-        List<Period> aggPeriodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates( periodType, sAggDate,
-            eDate ) );
-
-        System.out.println( "* Aggregate Period List Size: [" + aggPeriodList.size() + "]" );
-
-        for ( Period period : aggPeriodList )
+        periodType = periodService.getPeriodTypeByName(periodTypeId);
+
+
+        List<Period> periodList = new ArrayList<Period>(periodService.getPeriodsBetweenDates(periodType,sDate, eDate));
+
+        System.out.println("* Period List Size: [" + periodList.size() + "]");
+
+        Collection<Integer> periodIds = new ArrayList<Integer>(getIdentifiers(Period.class, periodList));
+
+        String periodIdsByComma = getCommaDelimitedString(periodIds);
+
+
+        List<Period> aggPeriodList = new ArrayList<Period>(periodService.getPeriodsBetweenDates(periodType,sAggDate, eDate));
+
+        System.out.println("* Aggregate Period List Size: [" + aggPeriodList.size() + "]");
+
+        for(Period period : aggPeriodList )
         {
-            System.out.println( "* Agg-Month [ " + period.getStartDateString() + " ]" );
+            System.out.println("* Agg-Month [ "+period.getStartDateString()+" ]");
         }
 
-        Collection<Integer> aggPeriodIds = new ArrayList<Integer>( getIdentifiers( Period.class, aggPeriodList ) );
-
-        String aggPeriodIdsByComma = getCommaDelimitedString( aggPeriodIds );
+        Collection<Integer> aggPeriodIds = new ArrayList<Integer>(getIdentifiers(Period.class, aggPeriodList));
+
+        String aggPeriodIdsByComma = getCommaDelimitedString(aggPeriodIds);
+
 
         Calendar tempStartDate = Calendar.getInstance();
         Calendar tempEndDate = Calendar.getInstance();
-        tempStartDate.setTime( sDate );
-        tempEndDate.setTime( eDate );
-
-        Workbook templateWorkbook = Workbook.getWorkbook( new File( inputTemplatePath ) );
-
-        WritableWorkbook outputReportWorkbook = Workbook
-            .createWorkbook( new File( outputReportPath ), templateWorkbook );
-
-        Map<String, String> feedbackTemplateMap;
-
-        Map<String, String> orgSpecificMap;
-
-        feedbackTemplateMap = stateDistrictFeedbackReportService.getDistrictFeedbackData( orgUnit, sDate, eDate,
-            ReportXMLFileName );
-
-        orgSpecificMap = reportOrgSpecificDataService.getOrgSpecificData( orgUnit, sDate, eDate, sAggDate, periodType,
-            ReportXMLFileName );
-
-        WritableSheet writableSheet = outputReportWorkbook.getSheet( 0 );
-
-        // --------------------------------------------------- Write Data
-        // Quality Entries----------------------------------------
-
-        for ( Map.Entry<String, String> element : feedbackTemplateMap.entrySet() )
-        {
-            String cellPosString[] = element.getKey().split( ":" );
-
-            int tempColNo = Integer.parseInt( cellPosString[0].trim() );
-
-            int tempRowNo = Integer.parseInt( cellPosString[1].trim() );
-
-            String tempStr = element.getValue();
-
-            WritableCell cell = writableSheet.getWritableCell( tempColNo, tempRowNo );
-
-            CellFormat cellFormat = cell.getCellFormat();
-            WritableCellFormat writableCellFormat = new WritableCellFormat();
-            writableCellFormat.setBorder( Border.ALL, BorderLineStyle.THIN );
-            writableCellFormat.setWrap( true );
-            writableCellFormat.setAlignment( Alignment.CENTRE );
-
-            if ( cell.getType() == CellType.LABEL )
-            {
-                Label l = (Label) cell;
-                l.setString( tempStr );
-                l.setCellFormat( cellFormat );
-            }
-            else
-            {
-                try
-                {
-                    writableSheet.addCell( new Number( tempColNo, tempRowNo, Double.parseDouble( tempStr ),
-                        writableCellFormat ) );
-                }
-                catch ( Exception e )
-                {
-                    writableSheet.addCell( new Label( tempColNo, tempRowNo, tempStr, writableCellFormat ) );
-                }
-            }
-        }
-
-        // --------------------------------------------------- Write
-        // OrgUnit-Specific Entries----------------------------------------
-
-        for ( Map.Entry<String, String> element : orgSpecificMap.entrySet() )
-        {
-            String cellPosString[] = element.getKey().split( ":" );
-
-            int tempColNo = Integer.parseInt( cellPosString[0].trim() );
-
-            int tempRowNo = Integer.parseInt( cellPosString[1].trim() );
-
-            String tempStr = element.getValue();
-
-            WritableCell cell = writableSheet.getWritableCell( tempColNo, tempRowNo );
-
-            CellFormat cellFormat = cell.getCellFormat();
-            WritableCellFormat writableCellFormat = new WritableCellFormat();
-            writableCellFormat.setBorder( Border.ALL, BorderLineStyle.THIN );
-            writableCellFormat.setWrap( true );
-            writableCellFormat.setAlignment( Alignment.CENTRE );
-
-            if ( cell.getType() == CellType.LABEL )
-            {
-                Label l = (Label) cell;
-                l.setString( tempStr );
-                l.setCellFormat( cellFormat );
-            }
-            else
-            {
-                try
-                {
-                    writableSheet.addCell( new Number( tempColNo, tempRowNo, Double.parseDouble( tempStr ),
-                        writableCellFormat ) );
-                }
-                catch ( Exception e )
-                {
-                    writableSheet.addCell( new Label( tempColNo, tempRowNo, tempStr, writableCellFormat ) );
-                }
-            }
-        }
-
-        List<Report_inDesign> reportDesignList = reportService.getDistrictFeedbackReportDesign( ReportXMLFileName );
-        String dataElementIdsByComma = reportService.getDataelementIds( reportDesignList );
+        tempStartDate.setTime(sDate);
+        tempEndDate.setTime(eDate);
+
+        Workbook templateWorkbook = Workbook.getWorkbook( new File(inputTemplatePath));
+
+        WritableWorkbook outputReportWorkbook = Workbook.createWorkbook(new File(outputReportPath), templateWorkbook);
+
+        Map<String,String> feedbackTemplateMap ;
+
+        Map<String,String> orgSpecificMap ;
+
+        feedbackTemplateMap = stateDistrictFeedbackReportService.getDistrictFeedbackData(orgUnit, sDate, eDate, ReportXMLFileName);
+
+        orgSpecificMap =  reportOrgSpecificDataService.getOrgSpecificData(orgUnit, sDate, eDate,sAggDate,periodType, ReportXMLFileName);
+
+        WritableSheet writableSheet = outputReportWorkbook.getSheet(0);
+
+        //--------------------------------------------------- Write Data Quality Entries----------------------------------------
+
+        for (Map.Entry<String,String> element : feedbackTemplateMap.entrySet())
+        {
+            String cellPosString[] = element.getKey().split(":");
+
+            int tempColNo = Integer.parseInt(cellPosString[0].trim());
+
+            int tempRowNo = Integer.parseInt(cellPosString[1].trim());
+
+            String tempStr = element.getValue();
+
+            WritableCell cell = writableSheet.getWritableCell(tempColNo, tempRowNo);
+
+            CellFormat cellFormat = cell.getCellFormat();
+            WritableCellFormat writableCellFormat = new WritableCellFormat();
+            writableCellFormat.setBorder(Border.ALL, BorderLineStyle.THIN);
+            writableCellFormat.setWrap(true);
+            writableCellFormat.setAlignment(Alignment.CENTRE);
+
+            if (cell.getType() == CellType.LABEL) {
+                Label l = (Label) cell;
+                l.setString(tempStr);
+                l.setCellFormat(cellFormat);
+            } else {
+                try {
+                    writableSheet.addCell(new Number(tempColNo, tempRowNo, Double.parseDouble(tempStr), writableCellFormat));
+                } catch (Exception e) {
+                    writableSheet.addCell(new Label(tempColNo, tempRowNo, tempStr, writableCellFormat));
+                }
+            }
+        }
+
+        //--------------------------------------------------- Write OrgUnit-Specific Entries----------------------------------------
+
+        for (Map.Entry<String,String> element : orgSpecificMap.entrySet())
+        {
+            String cellPosString[] = element.getKey().split(":");
+
+            int tempColNo = Integer.parseInt(cellPosString[0].trim());
+
+            int tempRowNo = Integer.parseInt(cellPosString[1].trim());
+
+            String tempStr = element.getValue();
+
+            WritableCell cell = writableSheet.getWritableCell(tempColNo, tempRowNo);
+
+            CellFormat cellFormat = cell.getCellFormat();
+            WritableCellFormat writableCellFormat = new WritableCellFormat();
+            writableCellFormat.setBorder(Border.ALL, BorderLineStyle.THIN);
+            writableCellFormat.setWrap(true);
+            writableCellFormat.setAlignment(Alignment.CENTRE);
+
+            if (cell.getType() == CellType.LABEL) {
+                Label l = (Label) cell;
+                l.setString(tempStr);
+                l.setCellFormat(cellFormat);
+            } else {
+                try {
+                    writableSheet.addCell(new Number(tempColNo, tempRowNo, Double.parseDouble(tempStr), writableCellFormat));
+                } catch (Exception e) {
+                    writableSheet.addCell(new Label(tempColNo, tempRowNo, tempStr, writableCellFormat));
+                }
+            }
+        }
+
+        List<Report_inDesign> reportDesignList = reportService.getDistrictFeedbackReportDesign(ReportXMLFileName);
+        String dataElementIdsByComma = reportService.getDataelementIds(reportDesignList);
 
         int orgUnitCount = 0;
         Iterator<OrganisationUnit> it = orgUnitList.iterator();
-        while ( it.hasNext() )
+        while (it.hasNext())
         {
             OrganisationUnit currentOrgUnit = (OrganisationUnit) it.next();
 
-            // ---------------------------------------------------- Map for
-            // aggregate Period Data Data
-            // --------------------------------------------------------------------
+            //---------------------------------------------------- Map for aggregate Period Data Data --------------------------------------------------------------------
+
 
             Map<String, String> aggDeMap = new HashMap<String, String>();
-            if ( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
-            {
-                aggDeMap.putAll( reportService.getResultDataValueFromAggregateTable( currentOrgUnit.getId(),
-                    dataElementIdsByComma, aggPeriodIdsByComma ) );
-            }
-            else if ( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
-            {
-                List<OrganisationUnit> childOrgUnitTree = new ArrayList<OrganisationUnit>( organisationUnitService
-                    .getOrganisationUnitWithChildren( currentOrgUnit.getId() ) );
-                List<Integer> childOrgUnitTreeIds = new ArrayList<Integer>( getIdentifiers( OrganisationUnit.class,
-                    childOrgUnitTree ) );
-                String childOrgUnitsByComma = getCommaDelimitedString( childOrgUnitTreeIds );
-
-                aggDeMap.putAll( reportService.getAggDataFromDataValueTable( childOrgUnitsByComma,
-                    dataElementIdsByComma, aggPeriodIdsByComma ) );
-            }
-            else if ( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
-            {
-                aggDeMap.putAll( reportService.getAggDataFromDataValueTable( "" + currentOrgUnit.getId(),
-                    dataElementIdsByComma, aggPeriodIdsByComma ) );
-            }
-
-            // ---------------------------------------------------- Map for only
-            // current month Data
-            // --------------------------------------------------------------------
+            if (aggData.equalsIgnoreCase(USEEXISTINGAGGDATA))
+            {
+                aggDeMap.putAll(reportService.getResultDataValueFromAggregateTable(currentOrgUnit.getId(), dataElementIdsByComma, aggPeriodIdsByComma));
+            }
+            else if (aggData.equalsIgnoreCase(GENERATEAGGDATA)) {
+                List<OrganisationUnit> childOrgUnitTree = new ArrayList<OrganisationUnit>(organisationUnitService.getOrganisationUnitWithChildren(currentOrgUnit.getId()));
+                List<Integer> childOrgUnitTreeIds = new ArrayList<Integer>(getIdentifiers(OrganisationUnit.class, childOrgUnitTree));
+                String childOrgUnitsByComma = getCommaDelimitedString(childOrgUnitTreeIds);
+
+                aggDeMap.putAll(reportService.getAggDataFromDataValueTable(childOrgUnitsByComma, dataElementIdsByComma, aggPeriodIdsByComma));
+            }
+            else if (aggData.equalsIgnoreCase(USECAPTUREDDATA))
+            {
+                aggDeMap.putAll(reportService.getAggDataFromDataValueTable("" + currentOrgUnit.getId(), dataElementIdsByComma, aggPeriodIdsByComma));
+            }
+
+            //---------------------------------------------------- Map for only current month Data --------------------------------------------------------------------
 
             Map<String, String> DeMap = new HashMap<String, String>();
-            if ( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
+            if (aggData.equalsIgnoreCase(USEEXISTINGAGGDATA))
             {
-                DeMap.putAll( reportService.getResultDataValueFromAggregateTable( currentOrgUnit.getId(),
-                    dataElementIdsByComma, periodIdsByComma ) );
+                DeMap.putAll(reportService.getResultDataValueFromAggregateTable(currentOrgUnit.getId(), dataElementIdsByComma, periodIdsByComma));
             }
-            else if ( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
+            else if (aggData.equalsIgnoreCase(GENERATEAGGDATA))
             {
-                List<OrganisationUnit> childOrgUnitTree = new ArrayList<OrganisationUnit>( organisationUnitService
-                    .getOrganisationUnitWithChildren( currentOrgUnit.getId() ) );
-                List<Integer> childOrgUnitTreeIds = new ArrayList<Integer>( getIdentifiers( OrganisationUnit.class,
-                    childOrgUnitTree ) );
-                String childOrgUnitsByComma = getCommaDelimitedString( childOrgUnitTreeIds );
+                List<OrganisationUnit> childOrgUnitTree = new ArrayList<OrganisationUnit>(organisationUnitService.getOrganisationUnitWithChildren(currentOrgUnit.getId()));
+                List<Integer> childOrgUnitTreeIds = new ArrayList<Integer>(getIdentifiers(OrganisationUnit.class, childOrgUnitTree));
+                String childOrgUnitsByComma = getCommaDelimitedString(childOrgUnitTreeIds);
 
-                DeMap.putAll( reportService.getAggDataFromDataValueTable( childOrgUnitsByComma, dataElementIdsByComma,
-                    periodIdsByComma ) );
+                DeMap.putAll(reportService.getAggDataFromDataValueTable(childOrgUnitsByComma, dataElementIdsByComma, periodIdsByComma));
             }
-            else if ( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
-            {
-                DeMap.putAll( reportService.getAggDataFromDataValueTable( "" + currentOrgUnit.getId(),
-                    dataElementIdsByComma, periodIdsByComma ) );
+            else if (aggData.equalsIgnoreCase(USECAPTUREDDATA)) {
+                DeMap.putAll(reportService.getAggDataFromDataValueTable("" + currentOrgUnit.getId(), dataElementIdsByComma, periodIdsByComma));
             }
 
             Iterator<Report_inDesign> reportDesignIterator = reportDesignList.iterator();
-            while ( reportDesignIterator.hasNext() )
-            {
+            while (reportDesignIterator.hasNext()) {
                 Report_inDesign report_inDesign = (Report_inDesign) reportDesignIterator.next();
 
                 String sType = report_inDesign.getStype();
@@ -477,332 +416,208 @@
                 String deCodeString = report_inDesign.getExpression();
                 String tempStr = "";
 
-                if ( deCodeString.equalsIgnoreCase( "FACILITY" ) )
-                {
+                if (deCodeString.equalsIgnoreCase("FACILITY")) {
                     tempStr = currentOrgUnit.getName();
-                }
-                else if ( deCodeString.equalsIgnoreCase( "MONTHCOUNT" ) )
-                {
-                    int endYear = tempEndDate.get( Calendar.YEAR );
-                    int startYear = tempStartDate.get( Calendar.YEAR );
-                    int endMonth = tempEndDate.get( Calendar.MONTH );
-                    int startMonth = tempStartDate.get( Calendar.MONTH );
+                } else if (deCodeString.equalsIgnoreCase("MONTHCOUNT")) {
+                    int endYear = tempEndDate.get(Calendar.YEAR);
+                    int startYear = tempStartDate.get(Calendar.YEAR);
+                    int endMonth = tempEndDate.get(Calendar.MONTH);
+                    int startMonth = tempStartDate.get(Calendar.MONTH);
 
                     monthCount = ((endYear - startYear) * 12) - startMonth + endMonth + 1;
                     tempStr = monthCount.toString();
-                }
-                else if ( deCodeString.equalsIgnoreCase( "FACILITY-NOREPEAT" ) )
-                {
+                } else if (deCodeString.equalsIgnoreCase("FACILITY-NOREPEAT")) {
                     tempStr = parentUnit;
-                }
-                else if ( deCodeString.equalsIgnoreCase( "FACILITYP" ) )
-                {
+                } else if (deCodeString.equalsIgnoreCase("FACILITYP")) {
                     tempStr = currentOrgUnit.getParent().getName();
-                }
-                else if ( deCodeString.equalsIgnoreCase( "FACILITYPP" ) )
-                {
+                } else if (deCodeString.equalsIgnoreCase("FACILITYPP")) {
                     tempStr = currentOrgUnit.getParent().getParent().getName();
-                }
-                else if ( deCodeString.equalsIgnoreCase( "FACILITYPPP" ) )
-                {
+                } else if (deCodeString.equalsIgnoreCase("FACILITYPPP")) {
                     tempStr = currentOrgUnit.getParent().getParent().getParent().getName();
-                }
-                else if ( deCodeString.equalsIgnoreCase( "FACILITYPPPP" ) )
-                {
+                } else if (deCodeString.equalsIgnoreCase("FACILITYPPPP")) {
                     tempStr = currentOrgUnit.getParent().getParent().getParent().getParent().getName();
-                }
-                else if ( deCodeString.equalsIgnoreCase( "PERIOD" )
-                    || deCodeString.equalsIgnoreCase( "PERIOD-NOREPEAT" ) )
-                {
-                    tempStr = simpleDateFormat.format( sDate );
-                }
-                else if ( deCodeString.equalsIgnoreCase( "PERIODSDED" ) )
-                {
-                    tempStr = simpleDateFormat.format( sDate ) + " To " + simpleDateFormat.format( eDate );
-                }
-                else if ( deCodeString.equalsIgnoreCase( "DATE-START-END" ) )
-                {
-                    tempStr = dayFormat.format( sDate ) + " To " + dayFormat.format( eDate );
-                }
-                else if ( deCodeString.equalsIgnoreCase( "PERIOD-MONTH" ) )
-                {
-                    tempStr = monthFormat.format( sDate );
-                }
-                else if ( deCodeString.equalsIgnoreCase( "MONTH-START-SHORT" ) )
-                {
-                    tempStr = simpleMonthFormat.format( sDate );
-                }
-                else if ( deCodeString.equalsIgnoreCase( "MONTH-END-SHORT" ) )
-                {
-                    tempStr = simpleMonthFormat.format( eDate );
-                }
-                else if ( deCodeString.equalsIgnoreCase( "MONTH-START" ) )
-                {
-                    tempStr = monthFormat.format( sDate );
-                }
-                else if ( deCodeString.equalsIgnoreCase( "MONTH-END" ) )
-                {
-                    tempStr = monthFormat.format( eDate );
-                }
-                else if ( deCodeString.equalsIgnoreCase( "PERIOD-WEEK" ) )
-                {
-                    tempStr = String.valueOf( tempStartDate.get( Calendar.WEEK_OF_MONTH ) );
-                }
-                else if ( deCodeString.equalsIgnoreCase( "PERIOD-QUARTER" ) )
-                {
-                    String startMonth = monthFormat.format( sDate );
+                } else if (deCodeString.equalsIgnoreCase("PERIOD") || deCodeString.equalsIgnoreCase("PERIOD-NOREPEAT")) {
+                    tempStr = simpleDateFormat.format(sDate);
+                } else if (deCodeString.equalsIgnoreCase("PERIODSDED")) {
+                    tempStr = simpleDateFormat.format(sDate) + " To " + simpleDateFormat.format(eDate);
+                } else if (deCodeString.equalsIgnoreCase("DATE-START-END")) {
+                    tempStr = dayFormat.format(sDate) + " To " + dayFormat.format(eDate);
+                } else if (deCodeString.equalsIgnoreCase("PERIOD-MONTH")) {
+                    tempStr = monthFormat.format(sDate);
+                } else if (deCodeString.equalsIgnoreCase("MONTH-START-SHORT")) {
+                    tempStr = simpleMonthFormat.format(sDate);
+                } else if (deCodeString.equalsIgnoreCase("MONTH-END-SHORT")) {
+                    tempStr = simpleMonthFormat.format(eDate);
+                } else if (deCodeString.equalsIgnoreCase("MONTH-START")) {
+                    tempStr = monthFormat.format(sDate);
+                } else if (deCodeString.equalsIgnoreCase("MONTH-END")) {
+                    tempStr = monthFormat.format(eDate);
+                } else if (deCodeString.equalsIgnoreCase("PERIOD-WEEK")) {
+                    tempStr = String.valueOf(tempStartDate.get(Calendar.WEEK_OF_MONTH));
+                } else if (deCodeString.equalsIgnoreCase("PERIOD-QUARTER")) {
+                    String startMonth = monthFormat.format(sDate);
 
-                    if ( startMonth.equalsIgnoreCase( "April" ) )
-                    {
+                    if (startMonth.equalsIgnoreCase("April")) {
                         tempStr = "Quarter I";
-                    }
-                    else if ( startMonth.equalsIgnoreCase( "July" ) )
-                    {
+                    } else if (startMonth.equalsIgnoreCase("July")) {
                         tempStr = "Quarter II";
-                    }
-                    else if ( startMonth.equalsIgnoreCase( "October" ) )
-                    {
+                    } else if (startMonth.equalsIgnoreCase("October")) {
                         tempStr = "Quarter III";
-                    }
-                    else
-                    {
+                    } else {
                         tempStr = "Quarter IV";
                     }
-                }
-                else if ( deCodeString.equalsIgnoreCase( "SIMPLE-QUARTER" ) )
-                {
-                    String startMonth = monthFormat.format( sDate );
+                } else if (deCodeString.equalsIgnoreCase("SIMPLE-QUARTER")) {
+                    String startMonth = monthFormat.format(sDate);
 
-                    if ( startMonth.equalsIgnoreCase( "April" ) )
-                    {
+                    if (startMonth.equalsIgnoreCase("April")) {
                         tempStr = "Q1";
-                    }
-                    else if ( startMonth.equalsIgnoreCase( "July" ) )
-                    {
+                    } else if (startMonth.equalsIgnoreCase("July")) {
                         tempStr = "Q2";
-                    }
-                    else if ( startMonth.equalsIgnoreCase( "October" ) )
-                    {
+                    } else if (startMonth.equalsIgnoreCase("October")) {
                         tempStr = "Q3";
-                    }
-                    else
-                    {
+                    } else {
                         tempStr = "Q4";
                     }
-                }
-                else if ( deCodeString.equalsIgnoreCase( "QUARTER-MONTHS-SHORT" ) )
-                {
-                    String startMonth = monthFormat.format( sDate );
+                } else if (deCodeString.equalsIgnoreCase("QUARTER-MONTHS-SHORT")) {
+                    String startMonth = monthFormat.format(sDate);
 
-                    if ( startMonth.equalsIgnoreCase( "April" ) )
-                    {
+                    if (startMonth.equalsIgnoreCase("April")) {
                         tempStr = "Apr - Jun";
-                    }
-                    else if ( startMonth.equalsIgnoreCase( "July" ) )
-                    {
+                    } else if (startMonth.equalsIgnoreCase("July")) {
                         tempStr = "Jul - Sep";
-                    }
-                    else if ( startMonth.equalsIgnoreCase( "October" ) )
-                    {
+                    } else if (startMonth.equalsIgnoreCase("October")) {
                         tempStr = "Oct - Dec";
-                    }
-                    else
-                    {
+                    } else {
                         tempStr = "Jan - Mar";
                     }
-                }
-                else if ( deCodeString.equalsIgnoreCase( "QUARTER-MONTHS" ) )
-                {
-                    String startMonth = monthFormat.format( sDate );
+                } else if (deCodeString.equalsIgnoreCase("QUARTER-MONTHS")) {
+                    String startMonth = monthFormat.format(sDate);
 
-                    if ( startMonth.equalsIgnoreCase( "April" ) )
-                    {
+                    if (startMonth.equalsIgnoreCase("April")) {
                         tempStr = "April - June";
-                    }
-                    else if ( startMonth.equalsIgnoreCase( "July" ) )
-                    {
+                    } else if (startMonth.equalsIgnoreCase("July")) {
                         tempStr = "July - September";
-                    }
-                    else if ( startMonth.equalsIgnoreCase( "October" ) )
-                    {
+                    } else if (startMonth.equalsIgnoreCase("October")) {
                         tempStr = "October - December";
-                    }
-                    else
-                    {
+                    } else {
                         tempStr = "January - March";
                     }
-                }
-                else if ( deCodeString.equalsIgnoreCase( "QUARTER-START-SHORT" ) )
-                {
-                    String startMonth = monthFormat.format( sDate );
+                } else if (deCodeString.equalsIgnoreCase("QUARTER-START-SHORT")) {
+                    String startMonth = monthFormat.format(sDate);
 
-                    if ( startMonth.equalsIgnoreCase( "April" ) )
-                    {
+                    if (startMonth.equalsIgnoreCase("April")) {
                         tempStr = "Apr";
-                    }
-                    else if ( startMonth.equalsIgnoreCase( "July" ) )
-                    {
+                    } else if (startMonth.equalsIgnoreCase("July")) {
                         tempStr = "Jul";
-                    }
-                    else if ( startMonth.equalsIgnoreCase( "October" ) )
-                    {
+                    } else if (startMonth.equalsIgnoreCase("October")) {
                         tempStr = "Oct";
-                    }
-                    else
-                    {
+                    } else {
                         tempStr = "Jan";
                     }
-                }
-                else if ( deCodeString.equalsIgnoreCase( "QUARTER-START" ) )
-                {
-                    String startMonth = monthFormat.format( sDate );
+                } else if (deCodeString.equalsIgnoreCase("QUARTER-START")) {
+                    String startMonth = monthFormat.format(sDate);
 
-                    if ( startMonth.equalsIgnoreCase( "April" ) )
-                    {
+                    if (startMonth.equalsIgnoreCase("April")) {
                         tempStr = "April";
-                    }
-                    else if ( startMonth.equalsIgnoreCase( "July" ) )
-                    {
+                    } else if (startMonth.equalsIgnoreCase("July")) {
                         tempStr = "July";
-                    }
-                    else if ( startMonth.equalsIgnoreCase( "October" ) )
-                    {
+                    } else if (startMonth.equalsIgnoreCase("October")) {
                         tempStr = "October";
-                    }
-                    else
-                    {
+                    } else {
                         tempStr = "January";
                     }
-                }
-                else if ( deCodeString.equalsIgnoreCase( "QUARTER-END-SHORT" ) )
-                {
-                    String endMonth = monthFormat.format( eDate );
+                } else if (deCodeString.equalsIgnoreCase("QUARTER-END-SHORT")) {
+                    String endMonth = monthFormat.format(eDate);
 
-                    if ( endMonth.equalsIgnoreCase( "June" ) )
-                    {
+                    if (endMonth.equalsIgnoreCase("June")) {
                         tempStr = "Jun";
-                    }
-                    else if ( endMonth.equalsIgnoreCase( "September" ) )
-                    {
+                    } else if (endMonth.equalsIgnoreCase("September")) {
                         tempStr = "Sep";
-                    }
-                    else if ( endMonth.equalsIgnoreCase( "December" ) )
-                    {
+                    } else if (endMonth.equalsIgnoreCase("December")) {
                         tempStr = "Dec";
-                    }
-                    else
-                    {
+                    } else {
                         tempStr = "Mar";
                     }
-                }
-                else if ( deCodeString.equalsIgnoreCase( "QUARTER-END" ) )
-                {
-                    String endMonth = monthFormat.format( eDate );
+                } else if (deCodeString.equalsIgnoreCase("QUARTER-END")) {
+                    String endMonth = monthFormat.format(eDate);
 
-                    if ( endMonth.equalsIgnoreCase( "June" ) )
-                    {
+                    if (endMonth.equalsIgnoreCase("June")) {
                         tempStr = "June";
-                    }
-                    else if ( endMonth.equalsIgnoreCase( "September" ) )
-                    {
+                    } else if (endMonth.equalsIgnoreCase("September")) {
                         tempStr = "September";
-                    }
-                    else if ( endMonth.equalsIgnoreCase( "December" ) )
-                    {
+                    } else if (endMonth.equalsIgnoreCase("December")) {
                         tempStr = "December";
-                    }
-                    else
-                    {
+                    } else {
                         tempStr = "March";
                     }
-                }
-                else if ( deCodeString.equalsIgnoreCase( "PERIOD-YEAR" ) )
-                {
+                } else if (deCodeString.equalsIgnoreCase("PERIOD-YEAR")) {
                     sDateTemp = sDate;
 
                     Calendar tempQuarterYear = Calendar.getInstance();
 
-                    tempQuarterYear.setTime( sDateTemp );
-
-                    String startMonth = monthFormat.format( sDateTemp );
-
-                    periodType = periodService.getPeriodTypeByName( periodTypeId );
-
-                    if ( periodType.getName().equalsIgnoreCase( "Yearly" ) )
-                    {
+                    tempQuarterYear.setTime(sDateTemp);
+
+                    String startMonth = monthFormat.format(sDateTemp);
+
+                    periodType = periodService.getPeriodTypeByName(periodTypeId);
+
+                    if (periodType.getName().equalsIgnoreCase("Yearly")) {
                         sDateTemp = sDate;
-                    }
-                    else if ( (startMonth.equalsIgnoreCase( "January" ) || startMonth.equalsIgnoreCase( "February" ) || startMonth
-                        .equalsIgnoreCase( "March" ))
-                        && periodType.getName().equalsIgnoreCase( "Quarterly" ) )
-                    {
-                        tempQuarterYear.roll( Calendar.YEAR, -1 );
+                    } else if ((startMonth.equalsIgnoreCase("January") || startMonth.equalsIgnoreCase("February") || startMonth.equalsIgnoreCase("March")) && periodType.getName().equalsIgnoreCase("Quarterly")) {
+                        tempQuarterYear.roll(Calendar.YEAR, -1);
                         sDateTemp = tempQuarterYear.getTime();
                     }
 
-                    tempStr = yearFormat.format( sDateTemp );
-                }
-                else if ( deCodeString.equalsIgnoreCase( "SIMPLE-YEAR" ) )
-                {
+                    tempStr = yearFormat.format(sDateTemp);
+                } else if (deCodeString.equalsIgnoreCase("SIMPLE-YEAR")) {
                     sDateTemp = sDate;
 
                     Calendar tempQuarterYear = Calendar.getInstance();
 
-                    tempQuarterYear.setTime( sDateTemp );
+                    tempQuarterYear.setTime(sDateTemp);
 
                     String startMonth = "";
 
-                    startMonth = monthFormat.format( sDateTemp );
-
-                    periodType = periodService.getPeriodTypeByName( periodTypeId );
-
-                    if ( periodType.getName().equalsIgnoreCase( "Yearly" ) )
-                    {
+                    startMonth = monthFormat.format(sDateTemp);
+
+                    periodType = periodService.getPeriodTypeByName(periodTypeId);
+
+                    if (periodType.getName().equalsIgnoreCase("Yearly")) {
                         sDateTemp = sDate;
-                    }
-                    else if ( (startMonth.equalsIgnoreCase( "January" ) || startMonth.equalsIgnoreCase( "February" ) || startMonth
-                        .equalsIgnoreCase( "March" ))
-                        && periodType.getName().equalsIgnoreCase( "Quarterly" ) )
-                    {
-                        tempQuarterYear.roll( Calendar.YEAR, -1 );
+                    } else if ((startMonth.equalsIgnoreCase("January") || startMonth.equalsIgnoreCase("February") || startMonth.equalsIgnoreCase("March"))
+                            && periodType.getName().equalsIgnoreCase("Quarterly")) {
+                        tempQuarterYear.roll(Calendar.YEAR, -1);
                         sDateTemp = tempQuarterYear.getTime();
                     }
 
-                    tempStr = simpleYearFormat.format( sDateTemp );
-                }
-                else if ( deCodeString.equalsIgnoreCase( "YEAR-END" ) )
-                {
+                    tempStr = simpleYearFormat.format(sDateTemp);
+                } else if (deCodeString.equalsIgnoreCase("YEAR-END")) {
                     sDateTemp = sDate;
 
                     Calendar tempQuarterYear = Calendar.getInstance();
 
-                    tempQuarterYear.setTime( sDate );
+                    tempQuarterYear.setTime(sDate);
 
                     sDate = tempQuarterYear.getTime();
 
                     String startMonth = "";
 
-                    startMonth = monthFormat.format( sDateTemp );
-
-                    periodType = periodService.getPeriodTypeByName( periodTypeId );
-
-                    if ( periodType.getName().equalsIgnoreCase( "Yearly" ) )
-                    {
-                        tempQuarterYear.roll( Calendar.YEAR, 1 );
-                        sDateTemp = tempQuarterYear.getTime();
-                    }
-
-                    if ( !(startMonth.equalsIgnoreCase( "January" ) || startMonth.equalsIgnoreCase( "February" ) || startMonth
-                        .equalsIgnoreCase( "March" )) )
-                    {
-                        tempQuarterYear.roll( Calendar.YEAR, 1 );
-                        sDateTemp = tempQuarterYear.getTime();
-                    }
-
-                    tempStr = yearFormat.format( sDateTemp );
-                }
-                else if ( deCodeString.equalsIgnoreCase( "YEAR-FROMTO" ) )
-                {
+                    startMonth = monthFormat.format(sDateTemp);
+
+                    periodType = periodService.getPeriodTypeByName(periodTypeId);
+
+                    if (periodType.getName().equalsIgnoreCase("Yearly")) {
+                        tempQuarterYear.roll(Calendar.YEAR, 1);
+                        sDateTemp = tempQuarterYear.getTime();
+                    }
+
+                    if (!(startMonth.equalsIgnoreCase("January") || startMonth.equalsIgnoreCase("February") || startMonth.equalsIgnoreCase("March"))) {
+                        tempQuarterYear.roll(Calendar.YEAR, 1);
+                        sDateTemp = tempQuarterYear.getTime();
+                    }
+
+                    tempStr = yearFormat.format(sDateTemp);
+                } else if (deCodeString.equalsIgnoreCase("YEAR-FROMTO")) {
                     sDateTemp = sDate;
 
                     eDateTemp = eDate;
@@ -813,107 +628,74 @@
 
                     String endYear = "";
 
-                    String startMonth = monthFormat.format( sDateTemp );
-
-                    System.out.println( "The value for periodType is " + periodTypeId );
-
-                    periodType = periodService.getPeriodTypeByName( periodTypeId );
-
-                    tempQuarterYear.setTime( sDateTemp );
-
-                    if ( periodType.getName().equalsIgnoreCase( "Yearly" ) )
-                    {
+                    String startMonth = monthFormat.format(sDateTemp);
+
+                    System.out.println("The value for periodType is " + periodTypeId);
+
+                    periodType = periodService.getPeriodTypeByName(periodTypeId);
+
+                    tempQuarterYear.setTime(sDateTemp);
+
+                    if (periodType.getName().equalsIgnoreCase("Yearly")) {
                         sDateTemp = sDate;
-                    }
-                    else if ( (startMonth.equalsIgnoreCase( "January" ) || startMonth.equalsIgnoreCase( "February" ) || startMonth
-                        .equalsIgnoreCase( "March" )) )
-                    {
-                        tempQuarterYear.roll( Calendar.YEAR, -1 );
+                    } else if ((startMonth.equalsIgnoreCase("January") || startMonth.equalsIgnoreCase("February") || startMonth.equalsIgnoreCase("March"))) {
+                        tempQuarterYear.roll(Calendar.YEAR, -1);
 
                         sDateTemp = tempQuarterYear.getTime();
                     }
 
-                    startYear = yearFormat.format( sDateTemp );
-
-                    tempQuarterYear.setTime( eDateTemp );
-
-                    if ( periodType.getName().equalsIgnoreCase( "Yearly" ) )
-                    {
-                        tempQuarterYear.roll( Calendar.YEAR, 1 );
-
-                        eDateTemp = tempQuarterYear.getTime();
-                    }
-
-                    if ( !(startMonth.equalsIgnoreCase( "January" ) || startMonth.equalsIgnoreCase( "February" ) || startMonth
-                        .equalsIgnoreCase( "March" )) )
-                    {
-                        tempQuarterYear.roll( Calendar.YEAR, 1 );
-
-                        eDateTemp = tempQuarterYear.getTime();
-                    }
-                    endYear = yearFormat.format( eDateTemp );
+                    startYear = yearFormat.format(sDateTemp);
+
+                    tempQuarterYear.setTime(eDateTemp);
+
+                    if (periodType.getName().equalsIgnoreCase("Yearly")) {
+                        tempQuarterYear.roll(Calendar.YEAR, 1);
+
+                        eDateTemp = tempQuarterYear.getTime();
+                    }
+
+                    if (!(startMonth.equalsIgnoreCase("January") || startMonth.equalsIgnoreCase("February") || startMonth.equalsIgnoreCase("March"))) {
+                        tempQuarterYear.roll(Calendar.YEAR, 1);
+
+                        eDateTemp = tempQuarterYear.getTime();
+                    }
+                    endYear = yearFormat.format(eDateTemp);
 
                     tempStr = startYear + " - " + endYear;
-                }
-                else if ( deCodeString.equalsIgnoreCase( "SLNO" ) )
-                {
+                } else if (deCodeString.equalsIgnoreCase("SLNO")) {
                     tempStr = "" + (orgUnitCount + 1);
-                }
-                else if ( deCodeString.equalsIgnoreCase( "NA" ) )
-                {
+                } else if (deCodeString.equalsIgnoreCase("NA")) {
                     tempStr = " ";
-                }
-                else
-                {
-                    if ( sType.equalsIgnoreCase( "dataelement" ) )
-                    {
-                        if ( pType.equalsIgnoreCase( "CCMCY" ) )
-                        {
-                            if ( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
-                            {
-                                tempStr = reportService.getAggVal( deCodeString, aggDeMap );
-                            }
-                            else if ( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
-                            {
-                                tempStr = reportService.getAggVal( deCodeString, aggDeMap );
-                            }
-                            else if ( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
-                            {
-                                tempStr = reportService.getAggVal( deCodeString, aggDeMap );
-                            }
-                        }
-                        else if ( pType.equalsIgnoreCase( "CMCY" ) )
-                        {
-                            if ( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
-                            {
-                                tempStr = reportService.getAggVal( deCodeString, DeMap );
-                            }
-                            else if ( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
-                            {
-                                tempStr = reportService.getAggVal( deCodeString, DeMap );
-                            }
-                            else if ( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
-                            {
-                                tempStr = reportService.getAggVal( deCodeString, DeMap );
-                            }
-                        }
-                    }
-                    else
-                    {
-                        if ( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
-                        {
-                            tempStr = reportService.getIndividualResultIndicatorValue( deCodeString, tempStartDate
-                                .getTime(), tempEndDate.getTime(), currentOrgUnit );
-                        }
-                        else if ( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
-                        {
-                            tempStr = reportService.getResultIndicatorValue( deCodeString, tempStartDate.getTime(),
-                                tempEndDate.getTime(), currentOrgUnit );
-                        }
-                        else if ( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
-                        {
-                            tempStr = reportService.getResultIndicatorValue( deCodeString, tempStartDate.getTime(),
-                                tempEndDate.getTime(), currentOrgUnit );
+                } else {
+                    if (sType.equalsIgnoreCase("dataelement"))
+                    {
+                        if (pType.equalsIgnoreCase("CCMCY"))
+                        {
+                            if (aggData.equalsIgnoreCase(USECAPTUREDDATA)) {
+                                tempStr = reportService.getAggVal(deCodeString, aggDeMap);
+                            } else if (aggData.equalsIgnoreCase(GENERATEAGGDATA)) {
+                                tempStr = reportService.getAggVal(deCodeString, aggDeMap);
+                            } else if (aggData.equalsIgnoreCase(USEEXISTINGAGGDATA)) {
+                                tempStr = reportService.getAggVal(deCodeString, aggDeMap);
+                            }
+                        }
+                        else if(pType.equalsIgnoreCase("CMCY"))
+                        {
+                            if (aggData.equalsIgnoreCase(USECAPTUREDDATA)) {
+                                tempStr = reportService.getAggVal(deCodeString, DeMap);
+                            } else if (aggData.equalsIgnoreCase(GENERATEAGGDATA)) {
+                                tempStr = reportService.getAggVal(deCodeString, DeMap);
+                            } else if (aggData.equalsIgnoreCase(USEEXISTINGAGGDATA)) {
+                                tempStr = reportService.getAggVal(deCodeString, DeMap);
+                            }
+                        }
+                    } else {
+                        if (aggData.equalsIgnoreCase(USECAPTUREDDATA)) {
+                            tempStr = reportService.getIndividualResultIndicatorValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit);
+                        } else if (aggData.equalsIgnoreCase(GENERATEAGGDATA)) {
+                            tempStr = reportService.getResultIndicatorValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit);
+                        } else if (aggData.equalsIgnoreCase(USEEXISTINGAGGDATA)) {
+                            tempStr = reportService.getResultIndicatorValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit);
                         }
                     }
                 }
@@ -922,117 +704,95 @@
                 int tempColNo = report_inDesign.getColno();
                 int sheetNo = report_inDesign.getSheetno();
 
-                if ( tempStr == null || tempStr.trim().equals( "" ) )
-                {
+                if (tempStr == null || tempStr.trim().equals("")) {
                     tempColNo += orgUnitCount;
 
                     WritableCellFormat wCellformat = new WritableCellFormat();
-                    wCellformat.setBorder( Border.ALL, BorderLineStyle.THIN );
-                    wCellformat.setWrap( true );
-                    wCellformat.setAlignment( Alignment.CENTRE );
+                    wCellformat.setBorder(Border.ALL, BorderLineStyle.THIN);
+                    wCellformat.setWrap(true);
+                    wCellformat.setAlignment(Alignment.CENTRE);
 
-                    writableSheet.addCell( new Blank( tempColNo, tempRowNo, wCellformat ) );
-                }
-                else
-                {
-                    if ( reportModelTB.equalsIgnoreCase( "DYNAMIC-ORGUNIT" ) )
-                    {
-                        if ( deCodeString.equalsIgnoreCase( "FACILITYP" )
-                            || deCodeString.equalsIgnoreCase( "FACILITYPP" )
-                            || deCodeString.equalsIgnoreCase( "FACILITYPPP" )
-                            || deCodeString.equalsIgnoreCase( "FACILITYPPPP" ) )
-                        {
-                        }
-                        else if ( deCodeString.equalsIgnoreCase( "PERIOD" )
-                            || deCodeString.equalsIgnoreCase( "PERIOD-NOREPEAT" )
-                            || deCodeString.equalsIgnoreCase( "PERIOD-WEEK" )
-                            || deCodeString.equalsIgnoreCase( "PERIOD-MONTH" )
-                            || deCodeString.equalsIgnoreCase( "PERIOD-QUARTER" )
-                            || deCodeString.equalsIgnoreCase( "PERIOD-YEAR" )
-                            || deCodeString.equalsIgnoreCase( "MONTH-START" )
-                            || deCodeString.equalsIgnoreCase( "MONTH-END" )
-                            || deCodeString.equalsIgnoreCase( "MONTH-START-SHORT" )
-                            || deCodeString.equalsIgnoreCase( "MONTH-END-SHORT" )
-                            || deCodeString.equalsIgnoreCase( "SIMPLE-QUARTER" )
-                            || deCodeString.equalsIgnoreCase( "QUARTER-MONTHS-SHORT" )
-                            || deCodeString.equalsIgnoreCase( "QUARTER-MONTHS" )
-                            || deCodeString.equalsIgnoreCase( "QUARTER-START-SHORT" )
-                            || deCodeString.equalsIgnoreCase( "QUARTER-END-SHORT" )
-                            || deCodeString.equalsIgnoreCase( "QUARTER-START" )
-                            || deCodeString.equalsIgnoreCase( "QUARTER-END" )
-                            || deCodeString.equalsIgnoreCase( "SIMPLE-YEAR" )
-                            || deCodeString.equalsIgnoreCase( "YEAR-END" )
-                            || deCodeString.equalsIgnoreCase( "YEAR-FROMTO" )
-                            || deCodeString.equalsIgnoreCase( "DATE-START-END" ) )
-                        {
-                        }
-                        else
-                        {
+                    writableSheet.addCell(new Blank(tempColNo, tempRowNo, wCellformat));
+                } else {
+                    if (reportModelTB.equalsIgnoreCase("DYNAMIC-ORGUNIT")) {
+                        if (deCodeString.equalsIgnoreCase("FACILITYP")
+                                || deCodeString.equalsIgnoreCase("FACILITYPP")
+                                || deCodeString.equalsIgnoreCase("FACILITYPPP")
+                                || deCodeString.equalsIgnoreCase("FACILITYPPPP")) {
+                        } else if (deCodeString.equalsIgnoreCase("PERIOD")
+                                || deCodeString.equalsIgnoreCase("PERIOD-NOREPEAT")
+                                || deCodeString.equalsIgnoreCase("PERIOD-WEEK")
+                                || deCodeString.equalsIgnoreCase("PERIOD-MONTH")
+                                || deCodeString.equalsIgnoreCase("PERIOD-QUARTER")
+                                || deCodeString.equalsIgnoreCase("PERIOD-YEAR")
+                                || deCodeString.equalsIgnoreCase("MONTH-START")
+                                || deCodeString.equalsIgnoreCase("MONTH-END")
+                                || deCodeString.equalsIgnoreCase("MONTH-START-SHORT")
+                                || deCodeString.equalsIgnoreCase("MONTH-END-SHORT")
+                                || deCodeString.equalsIgnoreCase("SIMPLE-QUARTER")
+                                || deCodeString.equalsIgnoreCase("QUARTER-MONTHS-SHORT")
+                                || deCodeString.equalsIgnoreCase("QUARTER-MONTHS")
+                                || deCodeString.equalsIgnoreCase("QUARTER-START-SHORT")
+                                || deCodeString.equalsIgnoreCase("QUARTER-END-SHORT")
+                                || deCodeString.equalsIgnoreCase("QUARTER-START")
+                                || deCodeString.equalsIgnoreCase("QUARTER-END")
+                                || deCodeString.equalsIgnoreCase("SIMPLE-YEAR")
+                                || deCodeString.equalsIgnoreCase("YEAR-END")
+                                || deCodeString.equalsIgnoreCase("YEAR-FROMTO")
+                                || deCodeString.equalsIgnoreCase("DATE-START-END")
+                                ) {
+                        } else {
                             tempColNo += orgUnitCount;
                         }
-                    }
-                    else if ( reportModelTB.equalsIgnoreCase( "dynamicwithrootfacility" ) )
-                    {
-                        if ( deCodeString.equalsIgnoreCase( "FACILITYP" )
-                            || deCodeString.equalsIgnoreCase( "FACILITY-NOREPEAT" )
-                            || deCodeString.equalsIgnoreCase( "FACILITYPP" )
-                            || deCodeString.equalsIgnoreCase( "FACILITYPPP" )
-                            || deCodeString.equalsIgnoreCase( "FACILITYPPPP" ) )
-                        {
-                        }
-                        else if ( deCodeString.equalsIgnoreCase( "PERIOD" )
-                            || deCodeString.equalsIgnoreCase( "PERIOD-NOREPEAT" )
-                            || deCodeString.equalsIgnoreCase( "PERIOD-WEEK" )
-                            || deCodeString.equalsIgnoreCase( "PERIOD-MONTH" )
-                            || deCodeString.equalsIgnoreCase( "PERIOD-QUARTER" )
-                            || deCodeString.equalsIgnoreCase( "PERIOD-YEAR" )
-                            || deCodeString.equalsIgnoreCase( "MONTH-START" )
-                            || deCodeString.equalsIgnoreCase( "MONTH-END" )
-                            || deCodeString.equalsIgnoreCase( "MONTH-START-SHORT" )
-                            || deCodeString.equalsIgnoreCase( "MONTH-END-SHORT" )
-                            || deCodeString.equalsIgnoreCase( "SIMPLE-QUARTER" )
-                            || deCodeString.equalsIgnoreCase( "QUARTER-MONTHS-SHORT" )
-                            || deCodeString.equalsIgnoreCase( "QUARTER-MONTHS" )
-                            || deCodeString.equalsIgnoreCase( "QUARTER-START-SHORT" )
-                            || deCodeString.equalsIgnoreCase( "QUARTER-END-SHORT" )
-                            || deCodeString.equalsIgnoreCase( "QUARTER-START" )
-                            || deCodeString.equalsIgnoreCase( "QUARTER-END" )
-                            || deCodeString.equalsIgnoreCase( "SIMPLE-YEAR" )
-                            || deCodeString.equalsIgnoreCase( "YEAR-END" )
-                            || deCodeString.equalsIgnoreCase( "YEAR-FROMTO" )
-                            || deCodeString.equalsIgnoreCase( "DATE-START-END" ) )
-                        {
-                        }
-                        else
-                        {
+                    } else if (reportModelTB.equalsIgnoreCase("dynamicwithrootfacility")) {
+                        if (deCodeString.equalsIgnoreCase("FACILITYP")
+                                || deCodeString.equalsIgnoreCase("FACILITY-NOREPEAT")
+                                || deCodeString.equalsIgnoreCase("FACILITYPP")
+                                || deCodeString.equalsIgnoreCase("FACILITYPPP")
+                                || deCodeString.equalsIgnoreCase("FACILITYPPPP")) {
+                        } else if (deCodeString.equalsIgnoreCase("PERIOD")
+                                || deCodeString.equalsIgnoreCase("PERIOD-NOREPEAT")
+                                || deCodeString.equalsIgnoreCase("PERIOD-WEEK")
+                                || deCodeString.equalsIgnoreCase("PERIOD-MONTH")
+                                || deCodeString.equalsIgnoreCase("PERIOD-QUARTER")
+                                || deCodeString.equalsIgnoreCase("PERIOD-YEAR")
+                                || deCodeString.equalsIgnoreCase("MONTH-START")
+                                || deCodeString.equalsIgnoreCase("MONTH-END")
+                                || deCodeString.equalsIgnoreCase("MONTH-START-SHORT")
+                                || deCodeString.equalsIgnoreCase("MONTH-END-SHORT")
+                                || deCodeString.equalsIgnoreCase("SIMPLE-QUARTER")
+                                || deCodeString.equalsIgnoreCase("QUARTER-MONTHS-SHORT")
+                                || deCodeString.equalsIgnoreCase("QUARTER-MONTHS")
+                                || deCodeString.equalsIgnoreCase("QUARTER-START-SHORT")
+                                || deCodeString.equalsIgnoreCase("QUARTER-END-SHORT")
+                                || deCodeString.equalsIgnoreCase("QUARTER-START")
+                                || deCodeString.equalsIgnoreCase("QUARTER-END")
+                                || deCodeString.equalsIgnoreCase("SIMPLE-YEAR")
+                                || deCodeString.equalsIgnoreCase("YEAR-END")
+                                || deCodeString.equalsIgnoreCase("YEAR-FROMTO")
+                                || deCodeString.equalsIgnoreCase("DATE-START-END")) {
+                        } else {
                             tempRowNo += orgUnitCount;
                         }
                     }
 
-                    WritableCell cell = writableSheet.getWritableCell( tempColNo, tempRowNo );
+                    WritableCell cell = writableSheet.getWritableCell(tempColNo, tempRowNo);
 
                     CellFormat cellFormat = cell.getCellFormat();
                     WritableCellFormat wCellformat = new WritableCellFormat();
-                    wCellformat.setBorder( Border.ALL, BorderLineStyle.THIN );
-                    wCellformat.setWrap( true );
-                    wCellformat.setAlignment( Alignment.CENTRE );
+                    wCellformat.setBorder(Border.ALL, BorderLineStyle.THIN);
+                    wCellformat.setWrap(true);
+                    wCellformat.setAlignment(Alignment.CENTRE);
 
-                    if ( cell.getType() == CellType.LABEL )
-                    {
+                    if (cell.getType() == CellType.LABEL) {
                         Label l = (Label) cell;
-                        l.setString( tempStr );
-                        l.setCellFormat( cellFormat );
-                    }
-                    else
-                    {
-                        try
-                        {
-                            writableSheet.addCell( new Number( tempColNo, tempRowNo, Double.parseDouble( tempStr ),
-                                wCellformat ) );
-                        }
-                        catch ( Exception e )
-                        {
-                            writableSheet.addCell( new Label( tempColNo, tempRowNo, tempStr, wCellformat ) );
+                        l.setString(tempStr);
+                        l.setCellFormat(cellFormat);
+                    } else {
+                        try {
+                            writableSheet.addCell(new Number(tempColNo, tempRowNo, Double.parseDouble(tempStr), wCellformat));
+                        } catch (Exception e) {
+                            writableSheet.addCell(new Label(tempColNo, tempRowNo, tempStr, wCellformat));
                         }
                     }
                 }
@@ -1044,19 +804,18 @@
         outputReportWorkbook.write();
         outputReportWorkbook.close();
 
-        fileName = reportFileNameTB.replace( ".xls", "" );
-        fileName += "_" + orgUnitList.get( 0 ).getShortName() + "_";
-        fileName += "_" + simpleDateFormat.format( sDate ) + "_";
-        fileName += "_" + simpleDateFormat.format( eDate ) + ".xls";
-        File outputReportFile = new File( outputReportPath );
-        inputStream = new BufferedInputStream( new FileInputStream( outputReportFile ) );
+        fileName = reportFileNameTB.replace(".xls", "");
+        fileName += "_" + orgUnitList.get(0).getShortName() + "_";
+        fileName += "_" + simpleDateFormat.format(sDate) + "_";
+        fileName += "_" + simpleDateFormat.format(eDate) + ".xls";
+        File outputReportFile = new File(outputReportPath);
+        inputStream = new BufferedInputStream(new FileInputStream(outputReportFile));
 
-        System.out.println( orgUnitList.get( 0 ).getName() + " : " + selReportObj.getName()
-            + " Report Generation End Time is : " + new Date() );
+        System.out.println(orgUnitList.get(0).getName() + " : " + selReportObj.getName() + " Report Generation End Time is : " + new Date());
 
         outputReportFile.deleteOnExit();
 
-        statementManager.destroy();
+        //statementManager.destroy();
 
         return SUCCESS;
     }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ed/action/EDReportFormAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ed/action/EDReportFormAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ed/action/EDReportFormAction.java	2013-09-19 06:34:31 +0000
@@ -8,6 +8,7 @@
 import java.util.List;
 
 import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
+import org.hisp.dhis.indicator.Indicator;
 import org.hisp.dhis.indicator.IndicatorGroup;
 import org.hisp.dhis.indicator.IndicatorService;
 import org.hisp.dhis.period.MonthlyPeriodType;
@@ -63,6 +64,13 @@
         return indicatorGroups;
     }
     
+    private List<Indicator> indicators;
+    
+    public List<Indicator> getIndicators()
+    {
+        return indicators;
+    }
+    
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
@@ -70,10 +78,13 @@
     public String execute()
         throws Exception
     {
-        //Indicator Group
+        
+        /* Indicator and Indicator Group */
+        indicators = new ArrayList<Indicator>( indicatorService.getAllIndicators());
         indicatorGroups = new ArrayList<IndicatorGroup>( indicatorService.getAllIndicatorGroups()) ;
         Collections.sort( indicatorGroups, new IdentifiableObjectNameComparator() );
-        
+        Collections.sort( indicators, new IdentifiableObjectNameComparator() );
+
         //period information
         periods = new ArrayList<Period>( periodService.getPeriodsByPeriodType( new MonthlyPeriodType() ) );
 

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ed/action/EDReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ed/action/EDReportResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ed/action/EDReportResultAction.java	2013-09-19 06:34:31 +0000
@@ -11,7 +11,9 @@
 import java.util.ArrayList;
 import java.util.Collection;
 import java.util.Collections;
+import java.util.Date;
 import java.util.HashMap;
+import java.util.Iterator;
 import java.util.List;
 import java.util.Map;
 import java.util.UUID;
@@ -34,7 +36,6 @@
 import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
 import org.hisp.dhis.config.Configuration_IN;
 import org.hisp.dhis.indicator.Indicator;
-import org.hisp.dhis.indicator.IndicatorGroup;
 import org.hisp.dhis.indicator.IndicatorService;
 import org.hisp.dhis.organisationunit.OrganisationUnit;
 import org.hisp.dhis.organisationunit.OrganisationUnitService;
@@ -57,13 +58,13 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-    private StatementManager statementManager;
+    /*private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     private PeriodService periodService;
 
     public void setPeriodService( PeriodService periodService )
@@ -129,14 +130,14 @@
     {
         this.selectedEndPeriodId = selectedEndPeriodId;
     }
-
+/*
     private Integer indicatorGroupId;
     
     public void setIndicatorGroupId( Integer indicatorGroupId )
     {
         this.indicatorGroupId = indicatorGroupId;
     }
-
+*/
     private String aggData;
     
     public void setAggData( String aggData )
@@ -145,7 +146,16 @@
     }
     
     private List<OrganisationUnit> orgUnitList;
+    
+    
+    private List<String> selectedIndicators;
 
+    public void setSelectedIndicators( List<String> selectedIndicators )
+    {
+        this.selectedIndicators = selectedIndicators;
+    }
+    
+    
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
@@ -153,11 +163,15 @@
     public String execute()
         throws Exception
     {
-        statementManager.initialise();
+        //statementManager.initialise();
         
         orgUnitList = new ArrayList<OrganisationUnit>();
         SimpleDateFormat simpleDateFormat = new SimpleDateFormat( "MMM-yy" );
-
+        
+        
+        //System.out.println( "selected Indicators size : " + selectedIndicators.size() );
+        
+        System.out.println( "Report Generation Start Time is : \t" + new Date() );
         String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator +  Configuration_IN.DEFAULT_TEMPFOLDER;
         File newdir = new File( outputReportPath );
         if( !newdir.exists() )
@@ -185,7 +199,7 @@
             inputStream = new BufferedInputStream( new FileInputStream( outputReportFile ) );
 
             outputReportFile.deleteOnExit();
-            statementManager.destroy();
+            //statementManager.destroy();
             return SUCCESS;
         }
 
@@ -221,14 +235,15 @@
             inputStream = new BufferedInputStream( new FileInputStream( outputReportFile ) );
 
             outputReportFile.deleteOnExit();
-            statementManager.destroy();
+            //statementManager.destroy();
 
             return SUCCESS;
         }
 
-        IndicatorGroup selectedIndicatorGroup = indicatorService.getIndicatorGroup( indicatorGroupId );
+        //IndicatorGroup selectedIndicatorGroup = indicatorService.getIndicatorGroup( indicatorGroupId );
         
-        if ( selectedIndicatorGroup == null )
+        //if ( selectedIndicatorGroup == null )
+        if ( selectedIndicators == null || selectedIndicators.size() == 0 )    
         {
             System.out.println( "There is no IndicatorGroup with that id" );
             sheet0.addCell( new Label( 2, 2, "There is no IndicatorGroup with that id", getCellFormat2() ) );
@@ -241,12 +256,25 @@
 
             outputReportFile.deleteOnExit();
 
-            statementManager.destroy();
+            //statementManager.destroy();
             return SUCCESS;
         }
 
-        List<Indicator> indicators = new ArrayList<Indicator>( selectedIndicatorGroup.getMembers() );
-        String dataElmentIdsByComma = getDataelementIds( indicators );
+        //List<Indicator> indicators = new ArrayList<Indicator>( selectedIndicatorGroup.getMembers() );
+        List<Indicator> indicatorList = new ArrayList<Indicator>();
+        Iterator<String> deIterator = selectedIndicators.iterator();
+        while ( deIterator.hasNext() )
+        {
+            // String indicatorId = (String) deIterator.next();
+            int serviceID = Integer.parseInt( (String) deIterator.next() );
+            Indicator indicator = indicatorService.getIndicator( serviceID );
+           
+            indicatorList.add( indicator );
+
+        }
+        
+        //String dataElmentIdsByComma = getDataelementIds( indicators );
+        String dataElmentIdsByComma = getDataelementIds( indicatorList );
         
         int rowCount = 4;
         int colCount = 0;
@@ -257,7 +285,8 @@
         sheet0.mergeCells( colCount, rowCount, colCount, rowCount + 1 );
         sheet0.addCell( new Label( colCount++, rowCount, "Facility", getCellFormat1() ) );
 
-        for ( Indicator indicator : indicators )
+        //for ( Indicator indicator : indicators )
+        for ( Indicator indicator : indicatorList )
         {
             sheet0.mergeCells( colCount, rowCount, colCount + 2, rowCount );
             sheet0.addCell( new Label( colCount, rowCount, indicator.getName(), getCellFormat1() ) );
@@ -267,8 +296,8 @@
         }
 
         // Printing Main Header Info
-        String mainHeaderInfo = "Indicator Group Name - " + selectedIndicatorGroup.getName() +  " ,OrgUnit Name is "+ orgUnitName + " From : "
-            + simpleDateFormat.format( selectedStartPeriod.getStartDate() ) + " To : "
+        //String mainHeaderInfo = "Indicator Group Name - " + selectedIndicatorGroup.getName() +  " ,OrgUnit Name is "+ orgUnitName + " From : "
+        String mainHeaderInfo = "OrgUnit Name is "+ orgUnitName + " From : " + simpleDateFormat.format( selectedStartPeriod.getStartDate() ) + " To : "
             + simpleDateFormat.format( selectedEndPeriod.getStartDate() );
         sheet0.mergeCells( 0, 1, colCount - 1, 1 );
         sheet0.addCell( new Label( 0, 1, mainHeaderInfo, getCellFormat1() ) );
@@ -306,47 +335,13 @@
             }
             sheet0.addCell( new Label( colCount++, rowCount, ou.getName(), getCellFormat2() ) );
 
-            for ( Indicator indicator : indicators )
+            //for ( Indicator indicator : indicators )
+            for ( Indicator indicator : indicatorList )
             {
                 Double numValue = 0.0;
                 Double denValue = 0.0;
                 Double indValue = 0.0;
                 
-                /*
-                if( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
-                {
-                     numValue = aggregationService.getAggregatedNumeratorValue( indicator, selectedStartPeriod.getStartDate(), selectedEndPeriod.getEndDate(), ou );
-                     denValue = aggregationService.getAggregatedDenominatorValue( indicator, selectedStartPeriod.getStartDate(), selectedEndPeriod.getEndDate(), ou );
-                     indValue = aggregationService.getAggregatedIndicatorValue( indicator, selectedStartPeriod.getStartDate(), selectedEndPeriod.getEndDate(), ou );
-                }
-                
-                if ( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
-                {
-                    indValue = reportService.getIndividualIndicatorValue( indicator, ou, selectedStartPeriod.getStartDate(), selectedEndPeriod.getEndDate() );
-                    
-                    String tempStr = reportService.getIndividualResultDataValue( indicator.getNumerator(), selectedStartPeriod.getStartDate(), selectedEndPeriod.getEndDate(), ou, "" );
-                   
-                     try
-                     {
-                         numValue = Double.parseDouble( tempStr );
-                     }
-                     catch ( Exception e )
-                     {
-                         numValue = 0.0;
-                     }
-
-                     tempStr = reportService.getIndividualResultDataValue( indicator.getDenominator(), selectedStartPeriod.getStartDate(), selectedEndPeriod.getEndDate(), ou, "" );
-
-                     try
-                     {
-                         denValue = Double.parseDouble( tempStr );
-                     }
-                     catch ( Exception e )
-                     {
-                         denValue = 0.0;
-                     }
-                }
-                */
                 try
                 {
                     numValue = Double.parseDouble( reportService.getAggVal( indicator.getNumerator(), aggDeMap ) );
@@ -416,7 +411,8 @@
 
         rowCount++;
 
-        for ( Indicator indicator : indicators )
+        //for ( Indicator indicator : indicators )
+        for ( Indicator indicator : indicatorList )
         {
             colCount = 2;
 
@@ -448,8 +444,8 @@
 
         outputReportFile.deleteOnExit();
 
-        statementManager.destroy();
-
+        //statementManager.destroy();
+        System.out.println( "Report Generation End Time is : \t" + new Date() );
         return SUCCESS;
     }
 

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ed/action/RankingReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ed/action/RankingReportResultAction.java	2012-04-04 11:58:27 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ed/action/RankingReportResultAction.java	2013-09-19 06:34:31 +0000
@@ -58,13 +58,13 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-    private StatementManager statementManager;
+    /*private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     private PeriodService periodService;
 
     public void setPeriodService( PeriodService periodService )
@@ -162,7 +162,7 @@
     public String execute()
         throws Exception
     {
-        statementManager.initialise();
+        //statementManager.initialise();
         
         String[] excelColumns = 
             {   "A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",
@@ -204,7 +204,7 @@
             inputStream = new BufferedInputStream( new FileInputStream( outputReportFile ) );
 
             outputReportFile.deleteOnExit();
-            statementManager.destroy();
+            //statementManager.destroy();
             return SUCCESS;
         }
 
@@ -240,7 +240,7 @@
             inputStream = new BufferedInputStream( new FileInputStream( outputReportFile ) );
 
             outputReportFile.deleteOnExit();
-            statementManager.destroy();
+            //statementManager.destroy();
 
             return SUCCESS;
         }
@@ -261,7 +261,7 @@
 
             outputReportFile.deleteOnExit();
 
-            statementManager.destroy();
+            //statementManager.destroy();
             return SUCCESS;
         }
 
@@ -470,7 +470,7 @@
 
         outputReportFile.deleteOnExit();
 
-        statementManager.destroy();
+        //statementManager.destroy();
         System.out.println( "Report Generation End Time is : \t" + new Date() );
         return SUCCESS;
     }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/feedback/action/GenerateFeedbackReportAnalyserResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/feedback/action/GenerateFeedbackReportAnalyserResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/feedback/action/GenerateFeedbackReportAnalyserResultAction.java	2014-04-01 09:40:40 +0000
@@ -118,14 +118,23 @@
     {
         this.reportList = reportList;
     }
-
+    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
     private int availablePeriods;
 
     public void setAvailablePeriods( int availablePeriods )

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/grading/action/GenerateGradingReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/grading/action/GenerateGradingReportResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/grading/action/GenerateGradingReportResultAction.java	2014-07-05 06:36:24 +0000
@@ -61,7 +61,6 @@
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
 import org.hisp.dhis.period.YearlyPeriodType;
-import org.hisp.dhis.reports.util.DBConnection;
 import org.hisp.dhis.reports.util.ReportService;
 import org.hisp.dhis.system.util.MathUtils;
 import org.w3c.dom.Document;
@@ -324,7 +323,7 @@
     public String execute()
         throws Exception
     {
-        con = (new DBConnection()).openConnection();
+        //con = (new DBConnection()).openConnection();
         
         statementManager.initialise();
 
@@ -1177,9 +1176,8 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
-
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,optionCombo );
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod,organisationUnit, optionCombo );
                     if ( dataValue != null )
                     {
                         // Works for both text and boolean data types

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/grading/action/GenerateImmChildGradingReportAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/grading/action/GenerateImmChildGradingReportAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/grading/action/GenerateImmChildGradingReportAction.java	2014-07-05 06:36:14 +0000
@@ -59,7 +59,6 @@
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
 import org.hisp.dhis.period.YearlyPeriodType;
-import org.hisp.dhis.reports.util.DBConnection;
 import org.hisp.dhis.reports.util.ReportService;
 import org.hisp.dhis.system.util.MathUtils;
 import org.w3c.dom.Document;
@@ -307,7 +306,7 @@
     public String execute()
         throws Exception
     {
-        con = (new DBConnection()).openConnection();
+        //con = (new DBConnection()).openConnection();
         raFolderName = reportService.getRAFolderName();
         
         statementManager.initialise();
@@ -1276,9 +1275,9 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
-
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,optionCombo );
+                    
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod,organisationUnit, optionCombo );
                     if ( dataValue != null )
                     {
                         // Works for both text and boolean data types

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/grading/action/GenerateSelChildGradingReportAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/grading/action/GenerateSelChildGradingReportAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/grading/action/GenerateSelChildGradingReportAction.java	2014-07-05 06:35:59 +0000
@@ -58,7 +58,6 @@
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
 import org.hisp.dhis.period.YearlyPeriodType;
-import org.hisp.dhis.reports.util.DBConnection;
 import org.hisp.dhis.reports.util.ReportService;
 import org.hisp.dhis.system.util.MathUtils;
 import org.w3c.dom.Document;
@@ -305,7 +304,7 @@
     public String execute()
         throws Exception
     {
-        con = (new DBConnection()).openConnection();
+        //con = (new DBConnection()).openConnection();
         
         statementManager.initialise();
 
@@ -1052,8 +1051,8 @@
                         tempPeriod = (Period) periodList.get(0);
                     }
                     
-                    DataValue dataValue= dataValueService.getDataValue(organisationUnit, dataElement, tempPeriod, optionCombo);
-       
+                    //DataValue dataValue= dataValueService.getDataValue(organisationUnit, dataElement, tempPeriod, optionCombo);
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod,organisationUnit, optionCombo );
                     if(dataValue != null) replaceString = dataValue.getValue();
                     else replaceString = "";
 
@@ -1195,9 +1194,8 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
-
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,optionCombo );
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod,organisationUnit, optionCombo );
                     if ( dataValue != null )
                     {
                         // Works for both text and boolean data types

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/grading/action/GradingAbstractionResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/grading/action/GradingAbstractionResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/grading/action/GradingAbstractionResultAction.java	2014-07-05 06:35:45 +0000
@@ -60,7 +60,6 @@
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
 import org.hisp.dhis.period.YearlyPeriodType;
-import org.hisp.dhis.reports.util.DBConnection;
 import org.hisp.dhis.reports.util.ReportService;
 import org.hisp.dhis.system.util.MathUtils;
 import org.w3c.dom.Document;
@@ -333,7 +332,7 @@
         throws Exception
     {
         
-        con = (new DBConnection()).openConnection();
+        //con = (new DBConnection()).openConnection();
         
         statementManager.initialise();
 
@@ -1158,9 +1157,8 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
-
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,optionCombo );
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod,organisationUnit, optionCombo );
                     if ( dataValue != null )
                     {
                         // Works for both text and boolean data types

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/idsp/action/GenerateIDSPReportAnalyserResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/idsp/action/GenerateIDSPReportAnalyserResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/idsp/action/GenerateIDSPReportAnalyserResultAction.java	2014-04-01 09:39:09 +0000
@@ -62,12 +62,13 @@
     // Dependencies
     // -------------------------------------------------------------------------
     
-    private StatementManager statementManager;
+    /*private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
+	*/
 /*
     private OrganisationUnitGroupService organisationUnitGroupService;
 
@@ -150,14 +151,22 @@
     {
         this.reportList = reportList;
     }
-
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
     private int availablePeriods;
 
     public void setAvailablePeriods( int availablePeriods )
@@ -226,7 +235,7 @@
     public String execute()
         throws Exception
     {
-        statementManager.initialise();
+        //statementManager.initialise();
 
         // Initialization
         raFolderName = reportService.getRAFolderName();
@@ -1189,7 +1198,7 @@
 
         outputReportFile.deleteOnExit();
 
-        statementManager.destroy();
+        //statementManager.destroy();
 
         return SUCCESS;
     }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/leprosy/action/LeprosyReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/leprosy/action/LeprosyReportResultAction.java	2012-06-30 10:19:34 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/leprosy/action/LeprosyReportResultAction.java	2014-04-01 09:39:34 +0000
@@ -39,7 +39,10 @@
 import org.hisp.dhis.aggregation.AggregationService;
 import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
 import org.hisp.dhis.config.Configuration_IN;
-import org.hisp.dhis.dataelement.*;
+import org.hisp.dhis.dataelement.DataElement;
+import org.hisp.dhis.dataelement.DataElementCategoryOptionCombo;
+import org.hisp.dhis.dataelement.DataElementCategoryService;
+import org.hisp.dhis.dataelement.DataElementService;
 import org.hisp.dhis.i18n.I18nFormat;
 import org.hisp.dhis.indicator.Indicator;
 import org.hisp.dhis.indicator.IndicatorService;
@@ -70,13 +73,14 @@
     // Dependencies
     // -------------------------------------------------------------------------
 
+	/*
     private StatementManager statementManager;
-    private DefaultDataElementCategoryService dataElementCategoryOptionComboService;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
+	*/
 
     private ReportService reportService;
 
@@ -272,14 +276,22 @@
     {
         return selectedPeriod;
     }
-
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
     private List<String> serviceType;
 
     private List<String> deCodeType;
@@ -318,7 +330,7 @@
 
         //con = (new DBConnection()).openConnection();
 
-        statementManager.initialise();
+        //statementManager.initialise();
 
         raFolderName = reportService.getRAFolderName();
 
@@ -791,7 +803,7 @@
          outputReportFile.deleteOnExit();
         
 
-        statementManager.destroy();
+        //statementManager.destroy();
 
         Date sysEndDate = new Date();
 
@@ -1207,8 +1219,4 @@
             throw new RuntimeException( "Illegal DataElement id", ex );
         }
     }
-
-    public void setDataElementCategoryOptionComboService(DefaultDataElementCategoryService dataElementCategoryOptionComboService) {
-        this.dataElementCategoryOptionComboService = dataElementCategoryOptionComboService;
-    }
 }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/linelisting/action/GenerateLinelistingReportAnalyserResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/linelisting/action/GenerateLinelistingReportAnalyserResultAction.java	2011-07-07 10:56:12 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/linelisting/action/GenerateLinelistingReportAnalyserResultAction.java	2014-04-01 09:01:36 +0000
@@ -4,7 +4,6 @@
 import java.io.File;
 import java.io.FileInputStream;
 import java.io.InputStream;
-import java.sql.Connection;
 import java.sql.ResultSet;
 import java.sql.Statement;
 import java.text.SimpleDateFormat;
@@ -36,7 +35,6 @@
 import jxl.write.WritableSheet;
 import jxl.write.WritableWorkbook;
 
-import org.amplecode.quick.StatementManager;
 import org.apache.velocity.tools.generic.MathTool;
 import org.hisp.dhis.aggregation.AggregationService;
 import org.hisp.dhis.config.Configuration_IN;
@@ -78,13 +76,13 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-    private StatementManager statementManager;
+    /*private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     private DataSetService dataSetService;
 
     public void setDataSetService( DataSetService dataSetService )
@@ -169,13 +167,6 @@
         this.jdbcTemplate = jdbcTemplate;
     }
 
-    /*
-     * private DBConnection dbConnection;
-     * 
-     * public void setDbConnection( DBConnection dbConnection ) {
-     * this.dbConnection = dbConnection; }
-     */
-
     private I18nFormat format;
 
     public void setFormat( I18nFormat format )
@@ -186,14 +177,6 @@
     // -------------------------------------------------------------------------
     // Properties
     // -------------------------------------------------------------------------
-/*   
-    private PeriodStore periodStore;
-
-    public void setPeriodStore( PeriodStore periodStore )
-    {
-        this.periodStore = periodStore;
-    }
-*/
     private InputStream inputStream;
 
     public InputStream getInputStream()
@@ -201,12 +184,6 @@
         return inputStream;
     }
 
-    /*
-     * private String contentType;
-     * 
-     * public String getContentType() { return contentType; }
-     */
-
     private String fileName;
 
     public String getFileName()
@@ -214,12 +191,6 @@
         return fileName;
     }
 
-    /*
-     * private int bufferSize;
-     * 
-     * public int getBufferSize() { return bufferSize; }
-     */
-
     private MathTool mathTool;
 
     public MathTool getMathTool()
@@ -227,13 +198,6 @@
         return mathTool;
     }
 
-    // private OrganisationUnit selectedOrgUnit;
-
-    // public OrganisationUnit getSelectedOrgUnit()
-    // {
-    // return selectedOrgUnit;
-    // }
-
     private List<OrganisationUnit> orgUnitList;
 
     public List<OrganisationUnit> getOrgUnitList()
@@ -296,53 +260,30 @@
 
     private String reportFileNameTB;
     
-/*
-    public void setReportFileNameTB( String reportFileNameTB )
-    {
-        this.reportFileNameTB = reportFileNameTB;
-    }
-*/
     private String reportModelTB;
-/*
-    public void setReportModelTB( String reportModelTB )
-    {
-        this.reportModelTB = reportModelTB;
-    }
-*/
+    
     private String reportList;
 
     public void setReportList( String reportList )
     {
         this.reportList = reportList;
     }
-/*
-    private String startDate;
-
-    public void setStartDate( String startDate )
-    {
-        this.startDate = startDate;
-    }
-
-    private String endDate;
-
-    public void setEndDate( String endDate )
-    {
-        this.endDate = endDate;
-    }
-
-    private List<String> orgUnitListCB;
-
-    public void setOrgUnitListCB( List<String> orgUnitListCB )
-    {
-        this.orgUnitListCB = orgUnitListCB;
-    }
-*/
+    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
 
     private int availablePeriods;
 
@@ -351,7 +292,6 @@
         this.availablePeriods = availablePeriods;
     }
 
-//    private Hashtable<String, String> serviceList;
 
     private List<Integer> sheetList;
 
@@ -362,19 +302,17 @@
     private List<Integer> rowMergeList;
 
     private List<Integer> colMergeList;
+    
+    private List<String> dataTypeList;
 
     private Date sDate;
 
     private Date eDate;
 
-//    private List<Integer> totalOrgUnitsCountList;
-
     private OrganisationUnit currentOrgUnit;
 
     private Map<String, String> resMap;
 
-    Connection con = null;
-
     private String raFolderName;
 
     // -------------------------------------------------------------------------
@@ -385,7 +323,7 @@
         throws Exception
     {
 
-        statementManager.initialise();
+        //statementManager.initialise();
         // con = dbConnection.openConnection();
 
         // Initialization
@@ -419,15 +357,14 @@
         reportModelTB = selReportObj.getModel();
         reportFileNameTB = selReportObj.getExcelTemplateName();
         
-        System.out.println( reportModelTB + " : " + reportFileNameTB + " : " + deCodesXMLFileName + " : " + ouIDTB );
-        System.out.println( "Report Generation Start Time is : \t" + new Date() );
+        System.out.println( selReportObj.getName() + " Report Generation Start Time is : " + new Date() );
 
         sheetList = new ArrayList<Integer>();
         rowList = new ArrayList<Integer>();
         colList = new ArrayList<Integer>();
         rowMergeList = new ArrayList<Integer>();
-        
         colMergeList = new ArrayList<Integer>();
+        dataTypeList = new ArrayList<String>();
 
         String inputTemplatePath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator
             + "template" + File.separator + reportFileNameTB;
@@ -441,12 +378,9 @@
         }
         outputReportPath += File.separator + UUID.randomUUID().toString() + ".xls";
 
-        
-        
         Workbook templateWorkbook = Workbook.getWorkbook( new File( inputTemplatePath ) );
 
-        WritableWorkbook outputReportWorkbook = Workbook
-            .createWorkbook( new File( outputReportPath ), templateWorkbook );
+        WritableWorkbook outputReportWorkbook = Workbook.createWorkbook( new File( outputReportPath ), templateWorkbook );
 
         // Period Info
         selectedPeriod = periodService.getPeriod( availablePeriods );
@@ -484,9 +418,7 @@
 
                 String deType = (String) deCodeType.get( count1 );
                 String sType = (String) serviceType.get( count1 );
-               // int count = 0;
-                //double sum = 0.0;
-              //  int flag1 = 0;
+                String dataType = dataTypeList.get( count1 );
                 String tempStr = "";
 
                 Calendar tempStartDate = Calendar.getInstance();
@@ -524,8 +456,7 @@
                 {
                     tempStr = currentOrgUnit.getParent().getParent().getParent().getParent().getName();
                 }
-                else if ( deCodeString.equalsIgnoreCase( "PERIOD" )
-                    || deCodeString.equalsIgnoreCase( "PERIOD-NOREPEAT" ) )
+                else if ( deCodeString.equalsIgnoreCase( "PERIOD" ) || deCodeString.equalsIgnoreCase( "PERIOD-NOREPEAT" ) )
                 {
                     tempStr = format.formatDate( sDate ) + " - " + format.formatDate( eDate );
                 }
@@ -537,31 +468,6 @@
                 {
                     tempStr = String.valueOf( tempStartDate.get( Calendar.WEEK_OF_MONTH ) );
                 }
-                else if ( deCodeString.equalsIgnoreCase( "PERIOD-QUARTER" ) )
-                {
-                    String startMonth = "";
-
-                    startMonth = monthFormat.format( sDate );
-
-                    if ( startMonth.equalsIgnoreCase( "April" ) )
-                    {
-                        tempStr = "Quarter I";
-                    }
-
-                    else if ( startMonth.equalsIgnoreCase( "July" ) )
-                    {
-                        tempStr = "Quarter II";
-                    }
-                    else if ( startMonth.equalsIgnoreCase( "October" ) )
-                    {
-                        tempStr = "Quarter III";
-                    }
-
-                    else
-                    {
-                        tempStr = "Quarter IV";
-                    }
-                }
                 else if ( deCodeString.equalsIgnoreCase( "PERIOD-YEAR" ) )
                 {
                     tempStr = yearFormat.format( sDate );
@@ -582,20 +488,18 @@
                     }
                     else if ( sType.equalsIgnoreCase( "dataelement-boolean" ) )
                     {
-                        tempStr = getBooleanDataValue( deCodeString, tempStartDate.getTime(), tempEndDate.getTime(),
-                            currentOrgUnit );
+                        tempStr = getBooleanDataValue( deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit );
                     }
                     else if ( sType.equalsIgnoreCase( "lldataelement" ) )
                     {
-                        tempStr = getLLDataValue( deCodeString, selectedPeriod, currentOrgUnit, recordNo );
+                        tempStr = getLLDataValue( deCodeString, selectedPeriod, currentOrgUnit, recordNo, dataType );
                     }
                     else
                     {
-                        tempStr = getResultIndicatorValue( deCodeString, tempStartDate.getTime(),
-                            tempEndDate.getTime(), currentOrgUnit );
-                        System.out.println( tempStr );
+                        tempStr = getResultIndicatorValue( deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit );
                     }
                 }
+                
                 int tempRowNo = rowList.get( count1 );
                 int tempRowNo1 = tempRowNo;
                 int tempColNo = colList.get( count1 );
@@ -604,14 +508,14 @@
                 int tempMergeRow = rowMergeList.get( count1 );
 
                 WritableSheet sheet0 = outputReportWorkbook.getSheet( sheetNo );
-                if ( tempStr == null || tempStr.equals( " " ) )
+                if ( tempStr == null || tempStr.trim().equals( "" ) )
                 {
 
                 }
                 else
                 {
 
-                    System.out.println( deCodeString + " : " + tempStr );
+                    //System.out.println( deCodeString + " : " + tempStr );
 
                     String tstr = resMap.get( tempStr.trim() );
                     if ( tstr != null )
@@ -620,26 +524,16 @@
                     if ( reportModelTB.equalsIgnoreCase( "DYNAMIC-DATAELEMENT" ) )
                     {
                         if ( deCodeString.equalsIgnoreCase( "FACILITYP" )
-                            || deCodeString.equalsIgnoreCase( "FACILITYPP" ) )
-                        {
-
-                        }
-                        else if ( deCodeString.equalsIgnoreCase( "FACILITYPPP" )
+                            || deCodeString.equalsIgnoreCase( "FACILITYPP" ) 
+                            || deCodeString.equalsIgnoreCase( "FACILITYPPP" )
                             || deCodeString.equalsIgnoreCase( "FACILITYPPPP" ) )
                         {
 
                         }
                         else if ( deCodeString.equalsIgnoreCase( "PERIOD-NOREPEAT" )
-                            || deCodeString.equalsIgnoreCase( "PERIOD-WEEK" ) )
-                        {
-
-                        }
-                        else if ( deCodeString.equalsIgnoreCase( "PERIOD-MONTH" )
-                            || deCodeString.equalsIgnoreCase( "PERIOD-QUARTER" ) )
-                        {
-
-                        }
-                        else if ( deCodeString.equalsIgnoreCase( "PERIOD-YEAR" ) )
+                            || deCodeString.equalsIgnoreCase( "PERIOD-WEEK" ) 
+                            || deCodeString.equalsIgnoreCase( "PERIOD-MONTH" )
+                            || deCodeString.equalsIgnoreCase( "PERIOD-YEAR" ) )
                         {
 
                         }
@@ -649,7 +543,6 @@
                         }
                         else
                         {
-
                             tempRowNo += recordCount;
                         }
 
@@ -673,14 +566,12 @@
                             
                             try
                             {
-                                sheet0.addCell( new Number( tempColNo, tempRowNo, Integer.parseInt( tempStr ), cellFormat ) );
+                                sheet0.addCell( new Number( tempColNo, tempRowNo, Double.parseDouble( tempStr ), cellFormat ) );
                             }
                             catch( Exception e )
                             {
                                 sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, cellFormat ) );
                             }
-                            
-                            //System.out.println( "In Pre-Formatted: " + tempStr );
                         }
                         else
                         {
@@ -691,18 +582,14 @@
                             
                             try
                             {
-                                sheet0.addCell( new Number( tempColNo, tempRowNo, Integer.parseInt( tempStr ), getCellFormat1() ) );
+                                sheet0.addCell( new Number( tempColNo, tempRowNo, Double.parseDouble( tempStr ), getCellFormat1() ) );
                             }
                             catch( Exception e )
                             {
                                 sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
                             }
-
-                            //System.out.println( "In Cur-Formatted: " + tempStr );
                         }
                     }
-
-                    // }
                 }
                 count1++;
             }// inner while loop end
@@ -716,19 +603,22 @@
          * 
          * res.setContentType("application/vnd.ms-excel");
          */
-        int noOfRecords = llrecordNos.size();
-
-        WritableSheet sheet0 = outputReportWorkbook.getSheet( 0 );
-
-        sheet0.addCell( new Label( 25, 1, "" + currentOrgUnit.getId(), getCellFormat1() ) );
-        sheet0.addCell( new Label( 25, 2, "" + selectedPeriod.getId(), getCellFormat1() ) );
-        sheet0.addCell( new Label( 25, 3, "" + noOfRecords, getCellFormat1() ) );
-        sheet0.addCell( new Label( 25, 4, "" + reportList, getCellFormat1() ) );
-        System.out.println("Current org unit id : " + currentOrgUnit.getId() + ": Selected Period is : " + selectedPeriod.getId() + ": No of Record :" + noOfRecords + ": Report List : " + reportList);
+        
+        //int noOfRecords = llrecordNos.size();
+
+        //WritableSheet sheet0 = outputReportWorkbook.getSheet( 0 );
+
+        //sheet0.addCell( new Label( 25, 1, "" + currentOrgUnit.getId(), getCellFormat1() ) );
+        //sheet0.addCell( new Label( 25, 2, "" + selectedPeriod.getId(), getCellFormat1() ) );
+        //sheet0.addCell( new Label( 25, 3, "" + noOfRecords, getCellFormat1() ) );
+        //sheet0.addCell( new Label( 25, 4, "" + reportList, getCellFormat1() ) );
+        //System.out.println("Current org unit id : " + currentOrgUnit.getId() + ": Selected Period is : " + selectedPeriod.getId() + ": No of Record :" + noOfRecords + ": Report List : " + reportList);
 
         outputReportWorkbook.write();
         outputReportWorkbook.close();
 
+        System.out.println( selReportObj.getName() + " Report Generation End Time is : " + new Date() );
+
         fileName = reportFileNameTB.replace( ".xls", "" );
         fileName += "_" + currentOrgUnit.getShortName() + "_";
         fileName += "_" + simpleDateFormat.format( selectedPeriod.getStartDate() ) + ".xls";
@@ -737,19 +627,6 @@
 
         outputReportFile.deleteOnExit();
 
-        try
-        {
-
-        }
-        finally
-        {
-            if ( con != null )
-                con.close();
-        }
-
-        statementManager.destroy();
-        System.out.println( "Report Generation End Time is : \t" + new Date() );
-
         return SUCCESS;
     }
 
@@ -1019,6 +896,14 @@
                 colList.add( new Integer( deCodeElement.getAttribute( "colno" ) ) );
                 rowMergeList.add( new Integer( deCodeElement.getAttribute( "rowmerge" ) ) );
                 colMergeList.add( new Integer( deCodeElement.getAttribute( "colmerge" ) ) );
+                try
+                {
+                    dataTypeList.add( deCodeElement.getAttribute( "datatype" ) );
+                }
+                catch( Exception e )
+                {
+                    dataTypeList.add( "text" );
+                }
 
             }// end of for loop with s var
         }// try block end
@@ -1061,7 +946,7 @@
 
     } // getDataElementPeriodType end
 
-    public String getLLDataValue( String formula, Period period, OrganisationUnit organisationUnit, Integer recordNo )
+    public String getLLDataValue( String formula, Period period, OrganisationUnit organisationUnit, Integer recordNo, String dataType )
     {
         Statement st1 = null;
         ResultSet rs1 = null;
@@ -1069,7 +954,6 @@
         String query = "";
         try
         {
-
             //int deFlag1 = 0;
             //int deFlag2 = 0;
             Pattern pattern = Pattern.compile( "(\\[\\d+\\.\\d+\\])" );
@@ -1127,20 +1011,31 @@
             matcher.appendTail( buffer );
 
             String resultValue = "";
-            /*
-             * if ( deFlag1 == 0 ) { double d = 0.0; try { d =
-             * MathUtils.calculateExpression( buffer.toString() ); } catch (
-             * Exception e ) { d = 0.0; } if ( d == -1 ) d = 0.0; else { d =
-             * Math.round( d Math.pow( 10, 1 ) ) / Math.pow( 10, 1 );
-             * resultValue = "" + (int) d; }
-             * 
-             * if ( deFlag2 == 0 ) { resultValue = " "; }
-             * 
-             * } else { resultValue = buffer.toString(); }
-             */
-
-            resultValue = buffer.toString();
-
+            
+            if( dataType.equalsIgnoreCase( "number" ) )
+            {
+                double d = 0.0; 
+                try 
+                { 
+                    d = MathUtils.calculateExpression( buffer.toString() ); 
+                } 
+                catch ( Exception e ) 
+                { 
+                    d = 0.0; 
+                }
+                
+                if ( d == -1 ) d = 0.0; 
+                else 
+                { 
+                    d = Math.round( d * Math.pow( 10, 1 ) ) / Math.pow( 10, 1 );
+                    resultValue = "" + d; 
+                }
+            }
+            else
+            {
+                resultValue = buffer.toString();
+            }
+            
             return resultValue;
         }
         catch ( NumberFormatException ex )
@@ -1212,9 +1107,10 @@
                     continue;
                 }
 
-                DataValue dataValue = dataValueService
-                    .getDataValue( organisationUnit, dataElement, period, optionCombo );
-
+                //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, period, optionCombo );
+                
+                DataValue dataValue = dataValueService.getDataValue( dataElement, period,organisationUnit, optionCombo );
+                
                 if ( dataValue != null )
                 {
                     replaceString = dataValue.getValue();
@@ -1302,8 +1198,8 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod,organisationUnit, optionCombo );
 
                     if ( dataValue != null )
                     {

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/linelisting/action/GenerateLinelistingWebPortalReportAnalyserResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/linelisting/action/GenerateLinelistingWebPortalReportAnalyserResultAction.java	2012-05-10 11:40:01 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/linelisting/action/GenerateLinelistingWebPortalReportAnalyserResultAction.java	2014-04-01 08:45:34 +0000
@@ -1,5 +1,8 @@
 package org.hisp.dhis.reports.linelisting.action;
 
+import static org.hisp.dhis.system.util.ConversionUtils.getIdentifiers;
+import static org.hisp.dhis.system.util.TextUtils.getCommaDelimitedString;
+
 import java.io.BufferedInputStream;
 import java.io.File;
 import java.io.FileInputStream;
@@ -10,6 +13,7 @@
 import java.text.SimpleDateFormat;
 import java.util.ArrayList;
 import java.util.Calendar;
+import java.util.Collection;
 import java.util.Collections;
 import java.util.Date;
 import java.util.HashMap;
@@ -35,7 +39,6 @@
 import jxl.write.WritableSheet;
 import jxl.write.WritableWorkbook;
 
-import org.amplecode.quick.StatementManager;
 import org.apache.velocity.tools.generic.MathTool;
 import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
 import org.hisp.dhis.config.Configuration_IN;
@@ -51,6 +54,7 @@
 import org.hisp.dhis.reports.ReportService;
 import org.hisp.dhis.reports.Report_in;
 import org.hisp.dhis.reports.Report_inDesign;
+import org.hisp.dhis.system.util.MathUtils;
 import org.springframework.jdbc.core.JdbcTemplate;
 import org.springframework.jdbc.support.rowset.SqlRowSet;
 
@@ -61,16 +65,23 @@
 {
     // private static final String NULL_REPLACEMENT = "0";
 
+    private final String GENERATEAGGDATA = "generateaggdata";
+
+    private final String USEEXISTINGAGGDATA = "useexistingaggdata";
+
+    private final String USECAPTUREDDATA = "usecaptureddata";
+    
+    
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-    private StatementManager statementManager;
+    /*private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     /*
      * private DataSetService dataSetService;
      * 
@@ -307,12 +318,22 @@
      * public void setOrgUnitListCB( List<String> orgUnitListCB ) {
      * this.orgUnitListCB = orgUnitListCB; }
      */
+    
+    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
+    */
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
 
     private int availablePeriods;
 
@@ -351,6 +372,16 @@
 
     private SimpleDateFormat simpleMonthFormat;
 
+    
+    private String aggData;
+    
+    public void setAggData( String aggData )
+    {
+        this.aggData = aggData;
+    }
+    
+    
+    
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
@@ -358,9 +389,8 @@
     public String execute()
         throws Exception
     {
-
         System.out.println( "OrgUnit  is : " + ouIDTB );
-        statementManager.initialise();
+        //statementManager.initialise();
         // con = dbConnection.openConnection();
 
         // Initialization
@@ -420,11 +450,11 @@
 
             parentUnit = orgUnit.getName();
         }
-
+        /*
         System.out.println( reportModelTB + " : " + reportFileNameTB + " : " + deCodesXMLFileName + " : " + ouIDTB );
         System.out.println( "Report Generation Start Time is : \t" + new Date() );
         System.out.println( "Size of OrgUnit List is : " + orgUnitList.size() );
-
+         */
         /*
          * sheetList = new ArrayList<Integer>(); rowList = new
          * ArrayList<Integer>(); colList = new ArrayList<Integer>();
@@ -454,6 +484,16 @@
         sDate = format.parseDate( String.valueOf( selectedPeriod.getStartDate() ) );
         eDate = format.parseDate( String.valueOf( selectedPeriod.getEndDate() ) );
         simpleDateFormat = new SimpleDateFormat( "MMM-yyyy" );
+        
+        // collect periodId by commaSepareted
+        List<Period> tempPeriodList = new ArrayList<Period>( periodService.getIntersectingPeriods( sDate, eDate ) );
+        
+        Collection<Integer> tempPeriodIds = new ArrayList<Integer>( getIdentifiers(Period.class, tempPeriodList ) );
+        
+        String periodIdsByComma = getCommaDelimitedString( tempPeriodIds );
+        
+        
+        
 
         // OrgUnit Info
         currentOrgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
@@ -472,13 +512,37 @@
         List<Report_inDesign> reportDesignList = reportService.getReportDesign( deCodesXMLFileName );
         List<Report_inDesign> reportDesignListLLDeath = reportService.getReportDesign( deCodesXMLFileName );
         List<Report_inDesign> reportDesignListLLMaternalDeath = reportService.getReportDesign( deCodesXMLFileName );
+       
+        
+        // collect dataElementIDs by commaSepareted
+        String dataElmentIdsByComma = reportService.getDataelementIds( reportDesignList );
+        
         int orgUnitCount = 0;
-
         Iterator<OrganisationUnit> it = orgUnitList.iterator();
         while ( it.hasNext() )
         {
             OrganisationUnit currentOrgUnit = (OrganisationUnit) it.next();
+            
+            Map<String, String> aggDeMap = new HashMap<String, String>();
+            
+            if( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
+            {
+                aggDeMap.putAll( reportService.getResultDataValueFromAggregateTable( currentOrgUnit.getId(), dataElmentIdsByComma, periodIdsByComma ) );
+            }
+            else if( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
+            {
+                List<OrganisationUnit> childOrgUnitTree = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( currentOrgUnit.getId() ) );
+                List<Integer> childOrgUnitTreeIds = new ArrayList<Integer>( getIdentifiers( OrganisationUnit.class, childOrgUnitTree ) );
+                String childOrgUnitsByComma = getCommaDelimitedString( childOrgUnitTreeIds );
 
+                aggDeMap.putAll( reportService.getAggDataFromDataValueTable( childOrgUnitsByComma, dataElmentIdsByComma, periodIdsByComma ) );
+            }
+            else if( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
+            {
+                aggDeMap.putAll( reportService.getAggDataFromDataValueTable( ""+currentOrgUnit.getId(), dataElmentIdsByComma, periodIdsByComma ) );
+            }
+            
+            
             int count1 = 0;
             Iterator<Report_inDesign> reportDesignIterator = reportDesignList.iterator();
             while ( reportDesignIterator.hasNext() )
@@ -571,18 +635,90 @@
                 {
                     if ( sType.equalsIgnoreCase( "dataelement" ) )
                     {
-                        tempStr = reportService.getResultDataValue( deCodeString, tempStartDate.getTime(), tempEndDate
-                            .getTime(), currentOrgUnit, reportModelTB );
+                        if( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
+                        {
+                            tempStr = getAggVal( deCodeString, aggDeMap );
+                            
+                            if ( deCodeString.equalsIgnoreCase( "[1.1]" ) || deCodeString.equalsIgnoreCase( "[2.1]" ) || deCodeString.equalsIgnoreCase( "[153.1]" ) 
+                                || deCodeString.equalsIgnoreCase( "[155.1]" ) || deCodeString.equalsIgnoreCase( "[157.1]" ) || deCodeString.equalsIgnoreCase( "[158.1]" )
+                                || deCodeString.equalsIgnoreCase( "[160.1]" ) )
+                            {
+                                //System.out.println( " USEEXISTINGAGGDATA Before Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                                
+                                if( tempStr.equalsIgnoreCase( "0.0" ) )
+                                {
+                                    tempStr = ""+ 1.0;
+                                }
+                                else if ( tempStr.equalsIgnoreCase( "1.0" ) )
+                                {
+                                    tempStr = ""+ 0.0;
+                                }
+                                else
+                                {
+                                }
+                                //System.out.println( "  USEEXISTINGAGGDATA After Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                            }
+                        }
+                        else if( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
+                        {
+                            tempStr = getAggVal( deCodeString, aggDeMap );
+                            
+                            if ( deCodeString.equalsIgnoreCase( "[1.1]" ) || deCodeString.equalsIgnoreCase( "[2.1]" ) || deCodeString.equalsIgnoreCase( "[153.1]" ) 
+                                || deCodeString.equalsIgnoreCase( "[155.1]" ) || deCodeString.equalsIgnoreCase( "[157.1]" ) || deCodeString.equalsIgnoreCase( "[158.1]" )
+                                || deCodeString.equalsIgnoreCase( "[160.1]" ) )
+                            {
+                                //System.out.println( " GENERATEAGGDATA Before Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                                
+                                if( tempStr.equalsIgnoreCase( "0.0" ) )
+                                {
+                                    tempStr = ""+ 1.0;
+                                }
+                                else if ( tempStr.equalsIgnoreCase( "1.0" ) )
+                                {
+                                    tempStr = ""+ 0.0;
+                                }
+                                else
+                                {
+                                }
+                                //System.out.println( " GENERATEAGGDATA After Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                            }
+                        }
+                        
+                        else if( aggData.equalsIgnoreCase( USECAPTUREDDATA ) ) 
+                        {
+                            tempStr = getAggVal( deCodeString, aggDeMap );
+                            
+                            if ( deCodeString.equalsIgnoreCase( "[1.1]" ) || deCodeString.equalsIgnoreCase( "[2.1]" ) || deCodeString.equalsIgnoreCase( "[153.1]" ) 
+                                || deCodeString.equalsIgnoreCase( "[155.1]" ) || deCodeString.equalsIgnoreCase( "[157.1]" ) || deCodeString.equalsIgnoreCase( "[158.1]" )
+                                || deCodeString.equalsIgnoreCase( "[160.1]" ) )
+                            {
+                                //System.out.println( " USECAPTUREDDATA Before Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                                
+                                if( tempStr.equalsIgnoreCase( "0.0" ) )
+                                {
+                                    tempStr = ""+ 1.0;
+                                }
+                                else if ( tempStr.equalsIgnoreCase( "1.0" ) )
+                                {
+                                    tempStr = ""+ 0.0;
+                                }
+                                else
+                                {
+                                }
+                                //System.out.println( " USECAPTUREDDATA After Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                            }
+                        }
+                     
+                        //tempStr = reportService.getResultDataValue( deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB );
                     }
+              
                     else if ( sType.equalsIgnoreCase( "dataelement-boolean" ) )
                     {
-                        tempStr = reportService.getBooleanDataValue( deCodeString, tempStartDate.getTime(), tempEndDate
-                            .getTime(), currentOrgUnit, reportModelTB );
+                        tempStr = reportService.getBooleanDataValue( deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB );
                     }
                     else
                     {
-                        tempStr = reportService.getResultIndicatorValue( deCodeString, tempStartDate.getTime(),
-                            tempEndDate.getTime(), currentOrgUnit );
+                        tempStr = reportService.getResultIndicatorValue( deCodeString, tempStartDate.getTime(),tempEndDate.getTime(), currentOrgUnit );
                     }
                 }
 
@@ -736,7 +872,10 @@
                 recordNo = (Integer) itlldeath.next();
             }
             flag = 0;
-
+            
+            boolean isBelow1Day = false;
+            boolean isBelow1Year = false;
+            
             // Iterator<String> it1 = deCodesList.iterator();
             Iterator<Report_inDesign> reportDesignIterator = reportDesignListLLDeath.iterator();
             int count1 = 0;
@@ -786,7 +925,7 @@
                 }
                 else
                 {
-                    if ( sType.equalsIgnoreCase( "lldeathdataelement" ) )
+                    if ( sType.equalsIgnoreCase( "lldeathdataelement" ) || sType.equalsIgnoreCase( "lldeathdataelementcause" ) )
                     {
                         tempStr = getLLDataValue( deCodeString, selectedPeriod, currentOrgUnit, recordNo );
                     }
@@ -885,52 +1024,65 @@
                         wCellformat.setWrap( true );
                         wCellformat.setAlignment( Alignment.CENTRE );
                         wCellformat.setVerticalAlignment( VerticalAlignment.CENTRE );
-                        /*
-                         * if ( cell.getType() == CellType.LABEL ) { Label l =
-                         * (Label) cell; l.setString( tempStr );
-                         * l.setCellFormat( cellFormat ); }
-                         *//*
-                            * if ( cellFormat != null ) { try { sheet0.addCell(
-                            * new Number( tempColNo, tempRowNo,
-                            * Integer.parseInt( tempStr ), cellFormat ) ); }
-                            * catch( Exception e ) { sheet0.addCell( new Label(
-                            * tempColNo, tempRowNo, tempStr, cellFormat ) ); }
-                            * 
-                            * //System.out.println( "In Pre-Formatted: " +
-                            * tempStr ); }
-                            */
-                        // else
-                        // {
+                        
                         if ( sType.equalsIgnoreCase( "lldeathdataelementage" ) )
                         {
-                            // System.out.println(
-                            // "In Side lldeathdataelementage" );
-                            String tstr = resMapForDeath.get( tempLLDeathValuStr.trim() );
-
-                            // System.out.println( ",LL Death Map is : " + tstr
-                            // + ", temp str is : " + tempLLDeathValuStr.trim()
-                            // );
-                            if ( tstr != null )
-                            {
-                                tempStr1 = tstr.split( ":" )[0].trim();
-                                tempStr2 = tstr.split( ":" )[1].trim();
-                                // System.out.println( "tempStr1 is : " +
-                                // tempStr1 + ", tempStr2 is : " + tempStr2 );
-                            }
-                            try
-                            {
-                                sheet0.addCell( new Label( tempColNo - 1, tempRowNo, tempStr1, getCellFormat1() ) );
-                                sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr2, getCellFormat1() ) );
-                            }
-                            catch ( Exception e )
-                            {
-                                // System.out.println(
-                                // "In Side lldeathdataelementage Exception" );
-                                sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr1, getCellFormat1() ) );
-                            }
+                            //System.out.println(  sType + " -- " + deCodeString +  " -- " + tempLLDeathValuStr );
+                            
+                            if ( tempLLDeathValuStr.trim().equalsIgnoreCase( "B1DAY" ) || tempLLDeathValuStr.trim().equalsIgnoreCase( "B1WEEK" ) 
+                                || tempLLDeathValuStr.trim().equalsIgnoreCase( "B1MONTH" ) || tempLLDeathValuStr.trim().equalsIgnoreCase( "B1YEAR" ) 
+                                || tempLLDeathValuStr.trim().equalsIgnoreCase( "B5YEAR" ) )
+                            {
+                                isBelow1Day = true;
+                                
+                                isBelow1Year = true;
+                                
+                                String tstr = resMapForDeath.get( tempLLDeathValuStr.trim() );
+                                
+                                if ( tstr != null )
+                                {
+                                    tempStr1 = tstr.split( ":" )[0].trim();
+                                    tempStr2 = tstr.split( ":" )[1].trim();
+                                }
+                                try
+                                {
+                                    sheet0.addCell( new Label( tempColNo - 1, tempRowNo, tempStr1, getCellFormat1() ) );
+                                    sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr2, getCellFormat1() ) );
+                                    //sheet0.addCell( new Label( tempColNo+1, tempRowNo, "C01-WITHIN 24 HOURS OF BIRTH", getCellFormat1() ) );
+                                }
+                                catch ( Exception e )
+                                {
+                                    sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr1, getCellFormat1() ) );
+                                }
+                            }
+                            
+                            
+                            else
+                            {
+                                String tstr = resMapForDeath.get( tempLLDeathValuStr.trim() );
+                                if ( tstr != null )
+                                {
+                                    tempStr1 = tstr.split( ":" )[0].trim();
+                                    tempStr2 = tstr.split( ":" )[1].trim();
+                                }
+                                try
+                                {
+                                    sheet0.addCell( new Label( tempColNo - 1, tempRowNo, tempStr1, getCellFormat1() ) );
+                                    sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr2, getCellFormat1() ) );
+                                }
+                                catch ( Exception e )
+                                {
+                                    sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr1, getCellFormat1() ) );
+                                }
+                            }
+                            
+                            //System.out.println(  sType + " -- " + deCodeString +  " -- " + tempLLDeathValuStr + " -- " +  isBelow1Year );
+                            
                         }
                         else if ( sType.equalsIgnoreCase( "lldeathdataelement" ) )
                         {
+                            //System.out.println(   sType + " -- " + deCodeString +  " -- " + tempStr + " --"  + isBelow1Year );
+                            
                             try
                             {
                                 sheet0.addCell( new Number( tempColNo, tempRowNo, Integer.parseInt( tempStr ),
@@ -941,18 +1093,71 @@
                                 sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
                             }
                         }
-
-                        // System.out.println( "In Cur-Formatted: " + tempStr );
-                        // }
+                        
+                        else if ( sType.equalsIgnoreCase( "lldeathdataelementcause" ) )
+                        {
+                            //System.out.println(   sType + " -- " + deCodeString +  " -- " + tempStr + " --"  + isBelow1Year );
+                            
+                            try
+                            {
+                                sheet0.addCell( new Number( tempColNo, tempRowNo, Integer.parseInt( tempStr ), getCellFormat1() ) );
+                            }
+                            catch ( Exception e )
+                            {
+                                //sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
+                                
+                                // done for HP
+                                if( isBelow1Year && tempStr.equalsIgnoreCase( "A01-Diarrhoeal diseases" ) )
+                                {
+                                    tempStr = "C06-Diarrhoea";
+                                    
+                                    //sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
+                                }
+                                else if( isBelow1Year && tempStr.equalsIgnoreCase( "A05-Other Fever related" ))
+                                {
+                                    tempStr = "C07-Fever related";
+                                    
+                                }
+                                
+                                else if( !isBelow1Year && tempStr.equalsIgnoreCase( "C09-Others" ))
+                                {
+                                    tempStr = "A14-Causes not known";
+                                }
+                                
+                                else
+                                {
+                                    //sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
+                                }
+                                
+                                sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
+                                
+                                /*
+                                if( isBelow1Day )
+                                {
+                                    tempStr = "C01-WITHIN 24 HOURS OF BIRTH";
+                                    
+                                    sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
+                                }
+                                else
+                                {
+                                    sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
+                                }
+                                */
+                            }
+                            
+                            //System.out.println( "-- S  Type is" + sType + " -- deCodeString is : " + deCodeString +  " -- value is : " + tempStr );
+                        }
                     }
-
-                    // }
                 }
                 count1++;
+                
+                //System.out.println(  " -- deCodeString is : " + deCodeString +  " -- value is : " + tempStr );
+                
+                //System.out.println( " is Below 1 Year :" + isBelow1Year  + " temp Str is  : " + tempStr );
+                //System.out.println( " is Below 1 Day :" + isBelow1Day  + " -- s Type is : " + sType );
             }// inner while loop end
             recordCount++;
-            // System.out.println("End Row no for ll Death Death is  : " +
-            // recordCount );
+            // System.out.println("End Row no for ll Death Death is  : " +  recordCount );
         }// outer while loop end
 
         // int tempRowNollm = currentRowNo+1;
@@ -1192,7 +1397,7 @@
                 con.close();
         }
 
-        statementManager.destroy();
+        //statementManager.destroy();
         System.out.println( "Report Generation End Time is : \t" + new Date() );
 
         return SUCCESS;
@@ -1200,6 +1405,8 @@
 
     public void initializeResultMap()
     {
+        
+        /*
         resMap = new HashMap<String, String>();
 
         resMap.put( "NONE", "---" );
@@ -1231,7 +1438,8 @@
         resMap.put( "OFR", "A05-Other Fever related" );
         resMap.put( "PRD", "Pregnancy Related Death( maternal mortality)" );
         resMap.put( "SRD", "Sterilisation related deaths" );
-        resMap.put( "AI", "Accidents or Injuries" );
+        //resMap.put( "AI", "Accidents or Injuries" );
+        resMap.put( "AI", "A09-Trauma/Accidents/Burn cases" );
         resMap.put( "SUICIDES", "A10-Suicides" );
         resMap.put( "ABS", "A11-Animal Bites or Stings" );
         resMap.put( "RID", "A03-Respiratory disease including infections(other than TB)" );
@@ -1264,6 +1472,117 @@
         resMap.put( "HFBD", "M05-High fever" );
         resMap.put( "HFAD", "M05-High fever" );
         resMap.put( "MDNK", "M06-Other Causes (including cause not known)" );
+        */
+        
+        
+        resMap = new HashMap<String, String>();
+        
+        resMap.put( "NONE", "---" );
+        resMap.put( "M", "Male" );
+        resMap.put( "F", "Female" );
+        resMap.put( "Y", "YES" );
+        resMap.put( "N", "NO" );
+        resMap.put( "B1WEEK", "1 DAY - 1 WEEK" );
+        resMap.put( "B1MONTH", "1 WEEK - 1 MONTH" );
+        resMap.put( "B1YEAR", "1 MONTH - 1 YEAR" );
+        resMap.put( "B5YEAR", "1 YEAR - 5 YEARS" );
+        resMap.put( "O5YEAR", "6 YEARS - 14 YEARS" );
+        resMap.put( "O15YEAR", "15 YEARS - 55 YEARS" );
+        resMap.put( "O55YEAR", "OVER 55 YEARS" );
+        resMap.put( "IMMREAC", "Immunization reactions" );
+        resMap.put( "PRD", "Pregnancy Related Death( maternal mortality)" );
+        resMap.put( "SRD", "Sterilisation related deaths" );
+        //resMap.put( "AI", "Accidents or Injuries" );
+        
+        
+        //infant Death( Up to 1 Year of age )
+        resMap.put( "WITHIN24HOURSOFBIRTH", "C01-WITHIN 24 HOURS OF BIRTH" );
+        resMap.put( "SEPSIS", "C02-SEPSIS" );
+        resMap.put( "ASPHYXIA", "C03-ASPHYXIA" );
+        resMap.put( "LOWBIRTHWEIGH", "C04-Low Birth Wight(LBW) for Children upto 4 weeks of age only" );
+        resMap.put( "PNEUMONIA", "C05-Pneumonia" );
+        //resMap.put( "DIADIS", "C06-Diarrhoea" );
+        //resMap.put( "OFR",, "C07-Fever related" );
+        resMap.put( "MEASLES", "C08-Measles" );
+        resMap.put( "OTHERS", "C09-Others" );
+        
+        
+        //Adolescents and Adults
+        resMap.put( "DIADIS", "A01-Diarrhoeal diseases" );
+        resMap.put( "TUBER", "A02-Tuberculosis" );
+        resMap.put( "RID", "A03-Respiratory disease including infections(other than TB)" );
+        resMap.put( "MALARIA", "A04-Malaria" );
+        resMap.put( "OFR", "A05-Other Fever related" );
+        resMap.put( "HIVAIDS", "A06-HIV/AIDS" );
+        resMap.put( "HDH", "A07-Heart disease/Hypertension related" );
+        resMap.put( "SND", "A08-Neurological disease including Strokes" );
+        resMap.put( "AI", "A09-Trauma/Accidents/Burn cases" );
+        resMap.put( "SUICIDES", "A10-Suicides" );
+        resMap.put( "ABS", "A11-Animal Bites or Stings" );
+        
+        // Maternal death cause
+        resMap.put( "ABORTION", "M01-Abortion" );
+        resMap.put( "OPL", "M02-OBSTRUCTED/PROLONGED LABOUR" );
+        resMap.put( "SH", "M03-SEVERE HYPERTENSION/FITS" );
+        resMap.put( "FITS", "M03-SEVERE HYPERTENSION/FITS" );
+        resMap.put( "BBCD", "M04-BLEEDING" );
+        resMap.put( "BACD", "M04-BLEEDING" );
+        resMap.put( "HFBD", "M05-HIGH FEVER" );
+        resMap.put( "HFAD", "M05-HIGH FEVER" );
+        resMap.put( "MDNK", "M06-Other Causes (including cause not known)" );
+        
+        
+        
+        
+        //Others Disease
+        resMap.put( "OKAD", "A12-Known Acute Disease" );
+        resMap.put( "OKCD", "A13-Known Chronic Disease" );
+        resMap.put( "NK", "A14-Causes not known" );
+        
+        
+        resMap.put( "FTP", "FIRST TRIMESTER PREGNANCY" );
+        resMap.put( "STP", "SECOND TRIMESTER PREGNANCY" );
+        resMap.put( "TTP", "THIRD TRIMESTER PREGNANCY" );
+        resMap.put( "DELIVERY", "DELIVERY" );
+        resMap.put( "ADW42D", "AFTER DELIVERY WITHIN 42 DAYS" );
+        resMap.put( "HOME", "HOME" );
+        resMap.put( "SC", "SUBCENTER" );
+        resMap.put( "PHC", "PHC" );
+        resMap.put( "CHC", "CHC" );
+        resMap.put( "MC", "MEDICAL COLLEGE" );
+        resMap.put( "UNTRAINED", "UNTRAINED" );
+        resMap.put( "TRAINED", "TRAINED" );
+        resMap.put( "ANM", "ANM" );
+        resMap.put( "NURSE", "NURSE" );
+        resMap.put( "DOCTOR", "DOCTOR" );
+        
+
+    
+        
+        //resMap.put( "SH", "M03-SEVERE HYPERTENSION" );
+        //resMap.put( "FITS", "FITS" );
+        
+        //resMap.put( "BBCD", "BLEEDING BEFORE CHILD DELIVERY" );
+        //resMap.put( "BACD", "BLEEDING AFTER CHILD DELIVERY" );
+        //resMap.put( "HFBD", "HIGH FEVER BEFORE DELIVERY" );
+        //resMap.put( "HFAD", "HIGH FEVER AFTER DELIVERY" );
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
         /*resMap.put( "FITS", "FITS" );
         resMap.put( "SH", "SEVERE HYPERTENSION" );
         resMap.put( "BBCD", "BLEEDING BEFORE CHILD DELIVERY" );
@@ -1523,7 +1842,74 @@
         }
 
         return recordNosList;
-    }   
+    }
+    
+    // getting data value using Map
+    private String getAggVal( String expression, Map<String, String> aggDeMap )
+    {
+        try
+        {
+            Pattern pattern = Pattern.compile( "(\\[\\d+\\.\\d+\\])" );
+
+            Matcher matcher = pattern.matcher( expression );
+            StringBuffer buffer = new StringBuffer();
+
+            String resultValue = "";
+
+            while ( matcher.find() )
+            {
+                String replaceString = matcher.group();
+
+                replaceString = replaceString.replaceAll( "[\\[\\]]", "" );
+
+                replaceString = aggDeMap.get( replaceString );
+                
+                if( replaceString == null )
+                {
+                    replaceString = "0";
+                }
+                
+                matcher.appendReplacement( buffer, replaceString );
+
+                resultValue = replaceString;
+            }
+
+            matcher.appendTail( buffer );
+            
+            double d = 0.0;
+            try
+            {
+                d = MathUtils.calculateExpression( buffer.toString() );
+            }
+            catch ( Exception e )
+            {
+                d = 0.0;
+                resultValue = "";
+            }
+            
+            resultValue = "" + (double) d;
+
+            return resultValue;
+        }
+        catch ( NumberFormatException ex )
+        {
+            throw new RuntimeException( "Illegal DataElement id", ex );
+        }
+    }
+    
+    
+    
+    
+    
+    
+    
+    
+    
+    
+    
+    
+    
+    
  /*   
     public List<Integer> getLineListingIDSPLabTestRecordNos( OrganisationUnit organisationUnit, Period period )
     {

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/malarya/action/GenerateMalaryaReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/malarya/action/GenerateMalaryaReportResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/malarya/action/GenerateMalaryaReportResultAction.java	2014-04-01 09:39:58 +0000
@@ -103,13 +103,14 @@
     // Dependencies
     // -------------------------------------------------------------------------
 
-    private StatementManager statementManager;
+    /*
+	private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -305,14 +306,22 @@
     {
         return selectedPeriod;
     }
-
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
     private List<String> serviceType;
 
     private List<String> deCodeType;
@@ -346,7 +355,7 @@
 
         //con = (new DBConnection()).openConnection();
 
-        statementManager.initialise();
+        //statementManager.initialise();
 
         raFolderName = reportService.getRAFolderName();
 
@@ -966,7 +975,7 @@
         inputStream = new BufferedInputStream( new FileInputStream( outputReportFile ) );
     
         outputReportFile.deleteOnExit();
-        statementManager.destroy();
+        //statementManager.destroy();
         Date sysEndDate = new Date();
         return SUCCESS;
     }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/md/action/GenerateMDReportAnalyserResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/md/action/GenerateMDReportAnalyserResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/md/action/GenerateMDReportAnalyserResultAction.java	2014-04-01 09:02:23 +0000
@@ -60,14 +60,14 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-    
+    /*
     private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-    
+    */
     private PeriodService periodService;
 
     public void setPeriodService( PeriodService periodService )
@@ -134,13 +134,22 @@
     {
         this.reportList = reportList;
     }
-
+    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
     
     private String aggData;
     
@@ -181,7 +190,7 @@
     {
         
         // Initialization
-        statementManager.initialise();
+        //statementManager.initialise();
              
         raFolderName = reportService.getRAFolderName();
         String deCodesXMLFileName = "";
@@ -521,7 +530,7 @@
                                            sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, getCellFormat1() ) );
                                        }
                                        
-                                       tempRowNo++;                                       
+                                       tempRowNo++;                                      
                                        
                                        try
                                        {                                           
@@ -597,7 +606,7 @@
         
         System.out.println( selOrgUnit.getName()+ " : " + selReportObj.getName()+" : Report Generation End Time is : " + new Date() );
 
-        statementManager.destroy();
+        //statementManager.destroy();
         return SUCCESS;
     }
     

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/md/action/GetOrgUnitsAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/md/action/GetOrgUnitsAction.java	2012-04-16 08:50:30 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/md/action/GetOrgUnitsAction.java	2014-04-01 09:09:00 +0000
@@ -1,13 +1,13 @@
 package org.hisp.dhis.reports.md.action;
 
 import java.util.ArrayList;
-import java.util.Collection;
 import java.util.HashMap;
 import java.util.Iterator;
 import java.util.List;
 import java.util.Map;
 
 import org.hisp.dhis.organisationunit.OrganisationUnit;
+import org.hisp.dhis.organisationunit.OrganisationUnitLevel;
 import org.hisp.dhis.organisationunit.OrganisationUnitService;
 import org.hisp.dhis.reports.ReportService;
 
@@ -36,14 +36,23 @@
     // -------------------------------------------------------------------------
     // Getters & Setters
     // -------------------------------------------------------------------------
-
+    
+    /*
     private Integer orgUnitId;
 
     public void setOrgUnitId( Integer orgUnitId )
     {
         this.orgUnitId = orgUnitId;
     }
-    
+    */
+    
+    private String orgUnitId;
+    
+    public void setOrgUnitId( String orgUnitId )
+    {
+        this.orgUnitId = orgUnitId;
+    }
+
     private String type;
     
     public void setType( String type )
@@ -72,10 +81,19 @@
         return maxOrgUnitLevel;
     }
     
+    private List<OrganisationUnitLevel> levels;
+
+    public List<OrganisationUnitLevel> getLevels()
+    {
+        return levels;
+    }
+    
+    
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
 
+
     public String execute()
         throws Exception
     {
@@ -84,7 +102,7 @@
             orgUnit = organisationUnitService.getOrganisationUnit( orgUnitId );
         }
         
-        System.out.println(" orgUnit Id is : " + orgUnit.getId() + " , orgUnit Name is : " + orgUnit.getName() );
+       // System.out.println(" orgUnit Id is : " + orgUnit.getId() + " , orgUnit Name is : " + orgUnit.getName() );
         //orgUnitLevel = organisationUnitService.getLevelOfOrganisationUnit( orgUnit );
         orgUnitLevel = organisationUnitService.getLevelOfOrganisationUnit( orgUnit.getId() );
         maxOrgUnitLevel = organisationUnitService.getNumberOfOrganisationalLevels();
@@ -106,7 +124,15 @@
                 maxOrgUnitLevel = level;
             }
         }
-            
+        
+        levels = organisationUnitService.getFilledOrganisationUnitLevels();
+        
+        /*
+        for( OrganisationUnitLevel organisationUnitLevel : levels  )
+        {
+            System.out.println(" Level : " + organisationUnitLevel.getLevel() + " , Level id : " + organisationUnitLevel.getId() + " , Level Name : " + organisationUnitLevel.getName() + " , Level Display Name : " + organisationUnitLevel.getDisplayName() );
+        }
+        */
         return SUCCESS;
     }
 

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/md/action/MDReportFormAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/md/action/MDReportFormAction.java	2012-04-16 08:47:07 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/md/action/MDReportFormAction.java	2013-09-19 06:34:31 +0000
@@ -11,6 +11,8 @@
 import javax.xml.parsers.DocumentBuilder;
 import javax.xml.parsers.DocumentBuilderFactory;
 
+import org.hisp.dhis.organisationunit.OrganisationUnitLevel;
+import org.hisp.dhis.organisationunit.OrganisationUnitService;
 import org.hisp.dhis.period.MonthlyPeriodType;
 import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodService;
@@ -36,9 +38,9 @@
 
     public void setPeriodService( PeriodService periodService )
     {
-    this.periodService = periodService;
+        this.periodService = periodService;
     }
-    
+
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -46,10 +48,24 @@
         this.reportService = reportService;
     }
     
+    private OrganisationUnitService organisationUnitService;
+
+    public void setOrganisationUnitService( OrganisationUnitService organisationUnitService )
+    {
+        this.organisationUnitService = organisationUnitService;
+    }
+
     //--------------------------------------------------------------------------
     //Input/Output
     //--------------------------------------------------------------------------
     
+    private SimpleDateFormat simpleDateFormat;
+    
+    public SimpleDateFormat getSimpleDateFormat()
+    {
+        return simpleDateFormat;
+    }   
+
     private List<Period> periods;
     
     public List<Period> getPeriods()
@@ -71,13 +87,6 @@
         return periodTypeName;
     }
     
-    private SimpleDateFormat simpleDateFormat;
-    
-    public SimpleDateFormat getSimpleDateFormat()
-    {
-        return simpleDateFormat;
-    }   
-    
     private List<ReportOption> reportOptionList;
     
     public List<ReportOption> getReportOptionList()
@@ -85,23 +94,30 @@
         return reportOptionList;
     }
     
+    private List<OrganisationUnitLevel> levels;
+
+    public List<OrganisationUnitLevel> getLevels()
+    {
+        return levels;
+    }
+    
+    
     private String raFolderName;
-    
     //--------------------------------------------------------------------------
     //  Action Implementation
     //--------------------------------------------------------------------------
     
-
     
     public String execute() throws Exception
     {
         reportTypeName = ReportType.RT_MD_REPORT;
         periodTypeName = MonthlyPeriodType.NAME;
-        
         raFolderName = reportService.getRAFolderName();
         
         //period information
         periods = new ArrayList<Period>( periodService.getPeriodsByPeriodType( new MonthlyPeriodType() ) );
+        
+        levels = organisationUnitService.getFilledOrganisationUnitLevels();
        
         Iterator<Period> periodIterator = periods.iterator();
         while ( periodIterator.hasNext() )
@@ -110,17 +126,17 @@
             if ( p1.getStartDate().compareTo( new Date() ) > 0 )
             {
                 periodIterator.remove();
-            }
-            
-            
+            }                        
         }
-        simpleDateFormat = new SimpleDateFormat( "MMM-yy" );
+        simpleDateFormat = new SimpleDateFormat( "MMM-yyyy" );
         Collections.sort( periods, new PeriodComparator() );
+        
         reportOptionList = new ArrayList<ReportOption>( getReportOptions() );
         
         return SUCCESS;
     }
     
+    
     private List<ReportOption> getReportOptions( )
     {
         List<ReportOption> reportOptionList = new ArrayList<ReportOption>();
@@ -184,4 +200,5 @@
         
         return reportOptionList;
     }
+    
 }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/md/action/MDReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/md/action/MDReportResultAction.java	2012-04-16 08:50:30 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/md/action/MDReportResultAction.java	2014-04-01 09:04:16 +0000
@@ -57,14 +57,14 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-    
+    /*
     private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-    
+    */
     private PeriodService periodService;
 
     public void setPeriodService( PeriodService periodService )
@@ -118,12 +118,23 @@
         this.selectedEndPeriodId = selectedEndPeriodId;
     }
     
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
+    
     
     private String aggData;
     
@@ -181,7 +192,7 @@
     public String execute() throws Exception
     {
         // Initialization
-        statementManager.initialise();
+        //statementManager.initialise();
              
         raFolderName = reportService.getRAFolderName();
         simpleDateFormat = new SimpleDateFormat( "MMM-yyyy" );
@@ -201,7 +212,7 @@
             generateData();
         }
         
-        statementManager.destroy();
+        //statementManager.destroy();
         
         System.out.println( " MD Report Generation End Time is : \t" + new Date() );
     

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/meta/action/GenerateMetaDataReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/meta/action/GenerateMetaDataReportResultAction.java	2012-06-27 09:23:24 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/meta/action/GenerateMetaDataReportResultAction.java	2013-09-19 06:34:31 +0000
@@ -86,13 +86,14 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
+    /*
     private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+    */
     private DataElementService dataElementService;
 
     public void setDataElementService( DataElementService dataElementService )
@@ -156,7 +157,6 @@
         this.userService = userService;
     }
     
-
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -211,7 +211,7 @@
     public String execute()
         throws Exception
     {
-        statementManager.initialise();
+        //statementManager.initialise();
 
         raFolderName = reportService.getRAFolderName();
 
@@ -270,7 +270,8 @@
         {
             generateDataSetMemberReport();
         }
-        statementManager.destroy();
+        
+        //statementManager.destroy();
 
         System.out.println( "MetaDataReport Generation End Time is : " + new Date() );
 
@@ -513,7 +514,7 @@
                 {
                     sheet0.addCell( new Number( colStart, rowStart, dataElement.getId(), wCellformat ) );
                     sheet0.addCell( new Label( colStart + 1, rowStart, dataElement.getName(), wCellformat ) );
-                    sheet0.addCell( new Label( colStart + 2, rowStart, dataElement.getAlternativeName(), wCellformat ) );
+                    sheet0.addCell( new Label( colStart + 2, rowStart, dataElement.getName(), wCellformat ) );
                     sheet0.addCell( new Label( colStart + 3, rowStart, dataElement.getAggregationOperator(),
                         wCellformat ) );
                     sheet0.addCell( new Label( colStart + 4, rowStart, dataElement.getDescription(), wCellformat ) );
@@ -682,7 +683,7 @@
                     {
                         sheet0.addCell( new Number( colStart, rowStart, dataElement.getId(), wCellformat ) );
                         sheet0.addCell( new Label( colStart + 1, rowStart, dataElement.getName(), wCellformat ) );
-                        sheet0.addCell( new Label( colStart + 2, rowStart, dataElement.getAlternativeName(),
+                        sheet0.addCell( new Label( colStart + 2, rowStart, dataElement.getName(),
                             wCellformat ) );
                         sheet0.addCell( new Label( colStart + 3, rowStart, dataElement.getAggregationOperator(),
                             wCellformat ) );
@@ -1389,7 +1390,7 @@
                 {
                     sheet0.addCell( new Number( colStart, rowStart, indicator.getId(), wCellformat ) );
                     sheet0.addCell( new Label( colStart + 1, rowStart, indicator.getName(), wCellformat ) );
-                    sheet0.addCell( new Label( colStart + 2, rowStart, indicator.getAlternativeName(), wCellformat ) );
+                    sheet0.addCell( new Label( colStart + 2, rowStart, indicator.getName(), wCellformat ) );
                     sheet0.addCell( new Label( colStart + 3, rowStart, indicator.getCode(), wCellformat ) );
                     sheet0.addCell( new Label( colStart + 4, rowStart, expressionService
                         .getExpressionDescription( indicator.getNumerator() ), wCellformat ) );
@@ -1538,7 +1539,7 @@
                         sheet0.addCell( new Number( colStart, rowStart, indicator.getId(), wCellformat ) );
                         sheet0.addCell( new Label( colStart + 1, rowStart, indicator.getName(), wCellformat ) );
                         sheet0
-                            .addCell( new Label( colStart + 2, rowStart, indicator.getAlternativeName(), wCellformat ) );
+                            .addCell( new Label( colStart + 2, rowStart, indicator.getName(), wCellformat ) );
                         sheet0.addCell( new Label( colStart + 3, rowStart, indicator.getCode(), wCellformat ) );
                         sheet0.addCell( new Label( colStart + 4, rowStart, expressionService
                             .getExpressionDescription( indicator.getNumerator() ), wCellformat ) );
@@ -1653,7 +1654,7 @@
                     sheet0.addCell( new Label( colStart + 1, rowStart, dataSet.getName(), wCellformat ) );
                     sheet0.addCell( new Label( colStart + 2, rowStart, dataSet.getShortName(), wCellformat ) );
                     sheet0.addCell( new Label( colStart + 3, rowStart, dataSet.getCode(), wCellformat ) );
-                    sheet0.addCell( new Label( colStart + 4, rowStart, dataSet.getAlternativeName(), wCellformat ) );
+                    sheet0.addCell( new Label( colStart + 4, rowStart, dataSet.getName(), wCellformat ) );
                     sheet0
                         .addCell( new Label( colStart + 5, rowStart, dataSet.getPeriodType().getName(), wCellformat ) );
                 }
@@ -2168,7 +2169,7 @@
                     {
                         sheet0.addCell( new Number( colStart, rowStart, dataElement.getId(), wCellformat ) );
                         sheet0.addCell( new Label( colStart + 1, rowStart, dataElement.getName(), wCellformat ) );
-                        sheet0.addCell( new Label( colStart + 2, rowStart, dataElement.getAlternativeName(),
+                        sheet0.addCell( new Label( colStart + 2, rowStart, dataElement.getName(),
                             wCellformat ) );
                         sheet0.addCell( new Label( colStart + 3, rowStart, dataElement.getAggregationOperator(),
                             wCellformat ) );

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/nbits/action/NBITSReportFormAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/nbits/action/NBITSReportFormAction.java	2012-06-13 06:35:38 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/nbits/action/NBITSReportFormAction.java	2013-09-19 06:34:31 +0000
@@ -1,7 +1,6 @@
 package org.hisp.dhis.reports.nbits.action;
 
 import java.util.ArrayList;
-import java.util.Iterator;
 import java.util.List;
 
 import org.hisp.dhis.program.Program;
@@ -40,17 +39,6 @@
     {
         programList = new ArrayList<Program>( programService.getAllPrograms() );
         
-        Iterator<Program> iterator = programList.iterator();
-        while( iterator.hasNext() )
-        {
-            Program program = iterator.next();
-            if( program.getOrganisationUnits() == null || program.getOrganisationUnits().size() <= 0 )
-                //|| program.getType() == Program.SINGLE_EVENT_WITHOUT_REGISTRATION )
-            {
-                iterator.remove();
-            }
-        }
-        
         return SUCCESS;
     }
 }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/nbits/action/NBITSReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/nbits/action/NBITSReportResultAction.java	2012-06-13 06:35:38 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/nbits/action/NBITSReportResultAction.java	2014-07-05 06:34:50 +0000
@@ -1,62 +1,18 @@
 package org.hisp.dhis.reports.nbits.action;
 
-import java.io.BufferedInputStream;
-import java.io.File;
-import java.io.FileInputStream;
 import java.io.InputStream;
-import java.text.SimpleDateFormat;
-import java.util.ArrayList;
-import java.util.Collections;
-import java.util.Date;
-import java.util.HashMap;
-import java.util.List;
-import java.util.Map;
-import java.util.UUID;
-
-import jxl.Workbook;
-import jxl.format.Alignment;
-import jxl.format.Border;
-import jxl.format.BorderLineStyle;
-import jxl.format.Colour;
-import jxl.format.VerticalAlignment;
-import jxl.write.Label;
-import jxl.write.WritableCellFormat;
-import jxl.write.WritableFont;
-import jxl.write.WritableSheet;
-import jxl.write.WritableWorkbook;
-
-import org.amplecode.quick.StatementManager;
-import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
-import org.hisp.dhis.config.Configuration_IN;
-import org.hisp.dhis.dataelement.DataElement;
+
 import org.hisp.dhis.i18n.I18nFormat;
-import org.hisp.dhis.organisationunit.OrganisationUnit;
-import org.hisp.dhis.organisationunit.OrganisationUnitService;
-import org.hisp.dhis.patient.Patient;
-import org.hisp.dhis.patient.PatientAttribute;
-import org.hisp.dhis.patient.PatientAttributeService;
-import org.hisp.dhis.patient.PatientIdentifierType;
-import org.hisp.dhis.patient.PatientIdentifierTypeService;
-import org.hisp.dhis.patient.PatientService;
-import org.hisp.dhis.patient.comparator.PatientAttributeComparator;
-import org.hisp.dhis.patient.comparator.PatientIdentifierTypeComparator;
-import org.hisp.dhis.program.Program;
-import org.hisp.dhis.program.ProgramService;
-import org.hisp.dhis.program.ProgramStage;
-import org.hisp.dhis.program.ProgramStageDataElement;
-import org.hisp.dhis.program.comparator.ProgramStageOrderComparator;
-import org.hisp.dhis.reports.util.ReportService;
-import org.springframework.jdbc.core.JdbcTemplate;
-import org.springframework.jdbc.support.rowset.SqlRowSet;
 
 import com.opensymphony.xwork2.Action;
+//import org.hisp.dhis.program.comparator.ProgramStageOrderComparator;
 
 public class NBITSReportResultAction implements Action
 {
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-
+    /*
     private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
@@ -112,7 +68,8 @@
     {
         this.jdbcTemplate = jdbcTemplate;
     }
-
+    */
+    
     private I18nFormat format;
 
     public void setFormat( I18nFormat format )
@@ -178,6 +135,7 @@
     // -------------------------------------------------------------------------
     public String execute() throws Exception 
     {
+        /*
         statementManager.initialise();
 
         Program selProgram = programService.getProgram( programList );
@@ -202,10 +160,12 @@
         System.out.println("NBITS Report_" + selOrgUnit.getName() + "_" + selProgram.getName() + "_EndTime: " + new Date() );
 
         statementManager.destroy();
+        */
         
         return SUCCESS;
     }
     
+  /*  
     public void generateReport( Program selProgram, List<OrganisationUnit> orgUnitList, Date sDate, Date eDate ) throws Exception
     {
         String raFolderName = reportService.getRAFolderName();
@@ -232,13 +192,13 @@
         try
         {
             List<PatientIdentifierType> patientIdentifierTypes = new ArrayList<PatientIdentifierType>( patientIdentifierTypeService.getAllPatientIdentifierTypes() );
-            Collections.sort( patientIdentifierTypes, new PatientIdentifierTypeComparator() );
+            //Collections.sort( patientIdentifierTypes, new PatientIdentifierTypeComparator() );
             
             List<PatientAttribute> patientAttributes = new ArrayList<PatientAttribute>( patientAttributeService.getAllPatientAttributes() );
-            Collections.sort( patientAttributes, new PatientAttributeComparator() );
+            //Collections.sort( patientAttributes, new PatientAttributeComparator() );
             
             List<ProgramStage> programStages = new ArrayList<ProgramStage>( selProgram.getProgramStages() );
-            Collections.sort( programStages, new ProgramStageOrderComparator() );
+            //Collections.sort( programStages, new ProgramStageOrderComparator() );
             
             Map<ProgramStage, List<DataElement>> programStageDataElementMap = new HashMap<ProgramStage, List<DataElement>>();
             for( ProgramStage programStage : programStages )
@@ -410,26 +370,28 @@
                         
                         //Patient Properties
                         
-                        sheet0.addCell( new Label( colCount, rowCount, patient.getId().toString(), getCellFormat2() ) );
-                        colCount++;
-                        sheet0.addCell( new Label( colCount, rowCount, patient.getFullName(), getCellFormat2() ) );
-                        colCount++;
-                        sheet0.addCell( new Label( colCount, rowCount, patient.getTextGender(), getCellFormat2() ) );
-                        colCount++;
-                        sheet0.addCell( new Label( colCount, rowCount, patient.getAge(), getCellFormat2() ) );
-                        colCount++;
-                        sheet0.addCell( new Label( colCount, rowCount, simpleDateFormat.format( patient.getBirthDate() ), getCellFormat2() ) );
+                        sheet0.addCell( new Label( colCount, rowCount, ""+patient.getId(), getCellFormat2() ) );
+                        colCount++;
+                        sheet0.addCell( new Label( colCount, rowCount, patient.getName(), getCellFormat2() ) );
+                        colCount++;
+                        sheet0.addCell( new Label( colCount, rowCount, "", getCellFormat2() ) );
+                        colCount++;
+                        sheet0.addCell( new Label( colCount, rowCount, "", getCellFormat2() ) );
+                        colCount++;
+                        sheet0.addCell( new Label( colCount, rowCount, "", getCellFormat2() ) );
                         colCount++;
                         /**
                          * TODO
                          * BloodGroup is removed from Patient Object, so need to change this accordingly
                          */
-                        sheet0.addCell( new Label( colCount, rowCount, ""/*patient.getBloodGroup()*/, getCellFormat2() ) );
-                        colCount++;
-                        sheet0.addCell( new Label( colCount, rowCount, simpleDateFormat.format( patient.getRegistrationDate() ), getCellFormat2() ) );
-                        colCount++;
+   
+                        //sheet0.addCell( new Label( colCount, rowCount, ""/*patient.getBloodGroup()*/, getCellFormat2() ) );
+                        //colCount++;
+                        //sheet0.addCell( new Label( colCount, rowCount, "", getCellFormat2() ) );
+                        //colCount++;
 
                         //Patient Attribute Values
+/*
                         for( PatientAttribute patientAttribute : patientAttributes )
                         {
                             query = "SELECT value from patientattributevalue WHERE patientid = " + patient.getId() + 
@@ -568,8 +530,9 @@
         outputReportFile.deleteOnExit();
 
     }
-    
-    
+ 
+  */  
+    /*
     public WritableCellFormat getCellFormat1() throws Exception
     {
         WritableFont arialBold = new WritableFont( WritableFont.ARIAL, 10, WritableFont.BOLD );
@@ -622,6 +585,7 @@
 
         return hierarchyOrgunit;
     }
+    */
     
     
 }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/orgunitgroupsetreport/action/GenerateOrgunitGroupsetReportsResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/orgunitgroupsetreport/action/GenerateOrgunitGroupsetReportsResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/orgunitgroupsetreport/action/GenerateOrgunitGroupsetReportsResultAction.java	2014-07-05 06:32:53 +0000
@@ -60,7 +60,6 @@
 import jxl.write.WritableSheet;
 import jxl.write.WritableWorkbook;
 
-import org.amplecode.quick.StatementManager;
 import org.hisp.dhis.aggregation.AggregationService;
 import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
 import org.hisp.dhis.config.Configuration_IN;
@@ -82,7 +81,6 @@
 import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
-import org.hisp.dhis.reports.util.OrganisationUnitCommentComparator;
 import org.hisp.dhis.reports.util.ReportService;
 import org.hisp.dhis.system.util.MathUtils;
 import org.w3c.dom.Document;
@@ -107,14 +105,14 @@
         // ------------------------------------------------------------------------------------------------------------------------------------------
 
         private static final String NULL_REPLACEMENT = "0";
-            
+/*
         private StatementManager statementManager;
 
         public void setStatementManager( StatementManager statementManager )
         {
             this.statementManager = statementManager;
         }
-
+*/
         private ReportService reportService;
 
         public void setReportService( ReportService reportService )
@@ -346,7 +344,7 @@
         public String execute()
             throws Exception
         {
-            statementManager.initialise();
+            //statementManager.initialise();
             raFolderName = reportService.getRAFolderName();
                     
          //--------------------------------------------- Initialization----------------------------------------------------------------------
@@ -423,7 +421,7 @@
                 List<OrganisationUnit> orgUnitList = new ArrayList<OrganisationUnit>( selectedOrgUnitGroup1.getMembers() );                                        
                 
                 Collections.sort( orgUnitList, new IdentifiableObjectNameComparator() );
-                Collections.sort( orgUnitList, new OrganisationUnitCommentComparator() );
+                //Collections.sort( orgUnitList, new OrganisationUnitCommentComparator() );
                 List<String> deCodesList = getDECodes( deCodesXMLFileName );
                 Iterator<OrganisationUnit> it = orgUnitList.iterator();       
                 
@@ -753,7 +751,7 @@
                         
                     }
                 }// finally block end    
-                statementManager.destroy();
+                //statementManager.destroy();
                 return SUCCESS;
         }
 
@@ -1006,7 +1004,10 @@
                         {
                             tempPeriod = (Period) periodList.get( 0 );
                         }
-                        DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,optionCombo );
+                        //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,optionCombo );
+                        
+                        DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod,organisationUnit, optionCombo );
+                        
                         if ( dataValue != null )
                         {
                             replaceString = dataValue.getValue();

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ouwiseprogress/action/GenerateOuWiseProgressReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ouwiseprogress/action/GenerateOuWiseProgressReportResultAction.java	2012-07-24 12:38:31 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ouwiseprogress/action/GenerateOuWiseProgressReportResultAction.java	2014-04-01 09:25:49 +0000
@@ -35,9 +35,10 @@
 import jxl.write.WritableSheet;
 import jxl.write.WritableWorkbook;
 
-import org.amplecode.quick.StatementManager;
 import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
 import org.hisp.dhis.config.Configuration_IN;
+import org.hisp.dhis.dataset.DataSet;
+import org.hisp.dhis.dataset.DataSetService;
 import org.hisp.dhis.i18n.I18nFormat;
 import org.hisp.dhis.organisationunit.OrganisationUnit;
 import org.hisp.dhis.organisationunit.OrganisationUnitGroup;
@@ -66,13 +67,13 @@
 
     private final String USECAPTUREDDATA = "usecaptureddata";
     
-    private StatementManager statementManager;
+    /*private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -100,7 +101,14 @@
     {
         this.organisationUnitGroupService = organisationUnitGroupService;
     }
+    
+    private DataSetService dataSetService;
 
+    public void setDataSetService( DataSetService dataSetService )
+    {
+        this.dataSetService = dataSetService;
+    }
+    
 /*
     private DataSetService dataSetService;
     
@@ -161,14 +169,24 @@
     {
         this.endDate = endDate;
     }
-
+    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
+    
     private String aggData;
     
     public void setAggData( String aggData )
@@ -199,6 +217,10 @@
 
     private String raFolderName;
     
+    private SimpleDateFormat dateTimeFormat;
+    
+    private PeriodType selPeriodType;
+    
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
@@ -206,12 +228,14 @@
     public String execute()
         throws Exception
     {
-        statementManager.initialise();
+        //statementManager.initialise();
 
         // Initialization
         raFolderName = reportService.getRAFolderName();
         simpleDateFormat = new SimpleDateFormat( "MMM-yy" );
         SimpleDateFormat dayFormat = new SimpleDateFormat( "yyyy-MM-dd" );
+        dateTimeFormat = new SimpleDateFormat( "EEEE, dd MMMM yyyy HH:mm:ss zzzz" );
+        //dateTimeFormat = new SimpleDateFormat( "EEEE, dd MMMM yyyy HH:mm:ss" );
 
         String colArray[] = {"A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",
                                 "AA","AB","AC","AD","AE","AF","AG","AH","AI","AJ","AK","AL","AM","AN","AO","AP","AQ","AR","AS","AT","AU","AV","AW","AX","AY","AZ",
@@ -229,15 +253,15 @@
         // OrgUnit Related Info
         selectedOrgUnit = new OrganisationUnit();
         selectedOrgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
-        int selectedOrgUnitLevel = organisationUnitService.getLevelOfOrganisationUnit( ouIDTB );
+        int selectedOrgUnitLevel = organisationUnitService.getLevelOfOrganisationUnit( selectedOrgUnit.getId() );
 
-                System.out.println( selectedOrgUnit.getName()+ " : " + selReportObj.getName()+" : Report Generation Start Time is : " + new Date() );
-                
+	System.out.println( selectedOrgUnit.getName()+ " : " + selReportObj.getName()+" : Report Generation Start Time is : " + new Date() );
+		
         if ( reportModelTB.equalsIgnoreCase( "PROGRESSIVE-ORGUNIT" ) )
         {            
             if( orgUnitGroup != 0 )
             {
-                orgUnitList = getChildOrgUnitTree( selectedOrgUnit );
+		orgUnitList = getChildOrgUnitTree( selectedOrgUnit );
                 OrganisationUnitGroup ouGroup = organisationUnitGroupService.getOrganisationUnitGroup( orgUnitGroup );
             
                 if( ouGroup != null )
@@ -257,7 +281,6 @@
             {
                 orgUnitList.add( selectedOrgUnit );
             }
-            
             /*
             if( orgUnitList == null || orgUnitList.size() == 0 )
             {
@@ -265,9 +288,7 @@
             }
             */
         }
-
         
-
         String inputTemplatePath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "template" + File.separator + reportFileNameTB;
         //String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "output" + File.separator + UUID.randomUUID().toString() + ".xls";
         
@@ -289,18 +310,59 @@
         wCellformat.setVerticalAlignment( VerticalAlignment.CENTRE );
         wCellformat.setWrap( true );
 
-
         // Period Info
         sDate = format.parseDate( startDate );
         eDate = format.parseDate( endDate );
         
-        PeriodType selPeriodType = selReportObj.getPeriodType();
-        List<Period> periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates( selPeriodType, sDate, eDate ) );
+        List<Period> periodList = new ArrayList<Period>();
+
+        //PeriodType selPeriodType = selReportObj.getPeriodType();
+        
+        DataSet dataSet = new DataSet();
+        
+        String dataSetIDs = selReportObj.getDataSetIds();
+        
+       // System.out.println( "-- dataSetIDs outside --" + dataSetIDs );
+        
+        if( dataSetIDs != null && !dataSetIDs.equalsIgnoreCase( "" ))
+        {
+            //System.out.println( "-- dataSetIDs inside --" + dataSetIDs );
+            
+            String[] tempDataSetIDs = dataSetIDs.split( "," );
+            
+            String firstDsId = tempDataSetIDs[0];
+            
+            dataSet = dataSetService.getDataSet( Integer.parseInt( firstDsId ) );
+            
+            //System.out.println( "-- dataSet id is --" + dataSet.getId() + " -- Name is "  + dataSet.getName());
+             
+            if ( dataSet.getPeriodType().getName().equalsIgnoreCase( "Forteen" ) )
+            {
+                selPeriodType = periodService.getPeriodTypeByName( "Forteen" );
+                
+                periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates( selPeriodType, sDate, eDate ) );
+            }
+            
+            else
+            {
+                selPeriodType = selReportObj.getPeriodType();
+                periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates( selPeriodType, sDate, eDate ) ); // 31/10/2012
+            }
+        }
+        
+        else
+        {
+            selPeriodType = selReportObj.getPeriodType();
+            //periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates( selPeriodType, sDate, eDate ) ); // 31/10/2012
+            
+            periodList = new ArrayList<Period>( periodService.getIntersectingPeriods( sDate, eDate ) );
+        }
+        
         //List<Period> periodList = new ArrayList<Period>( periodService.getIntersectingPeriods( sDate, eDate ) );        
         Collection<Integer> periodIds = new ArrayList<Integer>( getIdentifiers(Period.class, periodList ) );        
         String periodIdsByComma = getCommaDelimitedString( periodIds );
         
-        //System.out.println( "periodIdsByComma :"+ periodIdsByComma );
+        //System.out.println(  dataSetIDs + " -- " + selPeriodType.getName() + " -- periodIdsByComma : " + periodIdsByComma );
         
         // Getting DataValues
         List<Report_inDesign> reportDesignList = reportService.getReportDesign( deCodesXMLFileName );
@@ -315,7 +377,10 @@
         while ( it.hasNext() )
         {
             OrganisationUnit currentOrgUnit = (OrganisationUnit) it.next();
-
+            List<OrganisationUnit> childOrgUnitTree = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( currentOrgUnit.getId() ) );
+            List<Integer> childOrgUnitTreeIds = new ArrayList<Integer>( getIdentifiers( OrganisationUnit.class, childOrgUnitTree ) );
+            String childOrgUnitsByComma = getCommaDelimitedString( childOrgUnitTreeIds );
+            
             Map<String, String> aggDeMap = new HashMap<String, String>();
             if( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
             {
@@ -323,9 +388,9 @@
             }
             else if( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
             {
-                List<OrganisationUnit> childOrgUnitTree = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( currentOrgUnit.getId() ) );
-                List<Integer> childOrgUnitTreeIds = new ArrayList<Integer>( getIdentifiers( OrganisationUnit.class, childOrgUnitTree ) );
-                String childOrgUnitsByComma = getCommaDelimitedString( childOrgUnitTreeIds );
+                //List<OrganisationUnit> childOrgUnitTree = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( currentOrgUnit.getId() ) );
+                //List<Integer> childOrgUnitTreeIds = new ArrayList<Integer>( getIdentifiers( OrganisationUnit.class, childOrgUnitTree ) );
+                //String childOrgUnitsByComma = getCommaDelimitedString( childOrgUnitTreeIds );
 
                 aggDeMap.putAll( reportService.getAggDataFromDataValueTable( childOrgUnitsByComma, dataElmentIdsByComma, periodIdsByComma ) );
             }
@@ -385,6 +450,10 @@
                     tempStr = simpleDateFormat.format( eDate );
                     tempStrForSelectedFacility = simpleDateFormat.format( eDate );
                 }
+                else if ( deCodeString.equalsIgnoreCase( "CURRENTDATETIME" ) )
+                {
+                    tempStr = dateTimeFormat.format( new Date() );
+                }
                 else if ( deCodeString.equalsIgnoreCase( "NA" ) )
                 {
                     tempStr = " ";
@@ -412,6 +481,26 @@
                             tempStrForSelectedFacility = getAggVal( deCodeString, aggDeMapForselectedFacility );
                         }
                     }
+                    else if ( sType.equalsIgnoreCase( "dataelement-count" ) )
+                    {
+                        String deIdsByComma = "-1";
+                        
+                        for( int i = 0; i < deCodeString.split( "," ).length; i++ )
+                        {
+                            deIdsByComma += "," + deCodeString.split( "," )[i];
+                        }
+                        
+                        if( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
+                        {
+                            tempStr = ""+reportService.getDataCountFromDataValueTable( ""+currentOrgUnit.getId(), deIdsByComma, periodIdsByComma );
+                        }
+                        else
+                        {
+                            tempStr = ""+reportService.getDataCountFromDataValueTable( childOrgUnitsByComma, deIdsByComma, periodIdsByComma );
+                        }
+                        
+                        //System.out.println( " sType " + sType + " -- tempStr : " + tempStr );
+                    }
                     else if ( sType.equalsIgnoreCase( "formula" ) )
                     {
                         tempStr = deCodeString;
@@ -426,8 +515,7 @@
                 if ( reportModelTB.equalsIgnoreCase( "PROGRESSIVE-ORGUNIT" ) )
                 {
                     if( deCodeString.equalsIgnoreCase( "FACILITY" ) || deCodeString.equalsIgnoreCase( "FACILITYP" ) || deCodeString.equalsIgnoreCase( "FACILITYPP" ) 
-                        || deCodeString.equalsIgnoreCase( "MONTH-FROM" ) || deCodeString.equalsIgnoreCase( "MONTH-TO" ) 
-                        || deCodeString.equalsIgnoreCase( "DATE-FROM" ) || deCodeString.equalsIgnoreCase( "DATE-TO" ) )
+                        || deCodeString.equalsIgnoreCase( "MONTH-FROM" ) || deCodeString.equalsIgnoreCase( "MONTH-TO" ) || deCodeString.equalsIgnoreCase( "DATE-FROM" ) || deCodeString.equalsIgnoreCase( "DATE-TO" ) || deCodeString.equalsIgnoreCase( "CURRENTDATETIME" ) )
                     {
                     }
                     else
@@ -455,9 +543,8 @@
                             if( orgUnitCount == orgUnitList.size()-1 && selectedOrgUnitLevel != 2 )
                             {
                                 //sheet0.addCell( new Number( tempColNo, tempRowNo, Double.parseDouble( tempStrForSelectedFacility ), getCellFormat2() ) );
-                                if( deCodeString.equalsIgnoreCase( "FACILITY" ) || deCodeString.equalsIgnoreCase( "FACILITYP" ) || deCodeString.equalsIgnoreCase( "FACILITYPP" ) 
-                                    || deCodeString.equalsIgnoreCase( "MONTH-FROM" ) || deCodeString.equalsIgnoreCase( "MONTH-TO" ) 
-                                    || deCodeString.equalsIgnoreCase( "DATE-FROM" ) || deCodeString.equalsIgnoreCase( "DATE-TO" ) )
+                                if( deCodeString.equalsIgnoreCase( "FACILITY" ) || deCodeString.equalsIgnoreCase( "FACILITYP" ) || deCodeString.equalsIgnoreCase( "FACILITYPP" ) || deCodeString.equalsIgnoreCase( "MONTH-FROM" ) || deCodeString.equalsIgnoreCase( "MONTH-TO" ) 
+                                    || deCodeString.equalsIgnoreCase( "DATE-FROM" ) || deCodeString.equalsIgnoreCase( "DATE-TO" ) || deCodeString.equalsIgnoreCase( "CURRENTDATETIME" ) )
                                 {
                                     continue;
                                 }
@@ -480,9 +567,8 @@
                         if( orgUnitCount == orgUnitList.size()-1 && selectedOrgUnitLevel != 2 )
                         {
                             //sheet0.addCell( new Label( tempColNo, tempRowNo, tempStrForSelectedFacility, getCellFormat2() ) );
-                            if( deCodeString.equalsIgnoreCase( "FACILITY" ) || deCodeString.equalsIgnoreCase( "FACILITYP" ) || deCodeString.equalsIgnoreCase( "FACILITYPP" ) 
-                                || deCodeString.equalsIgnoreCase( "MONTH-FROM" ) || deCodeString.equalsIgnoreCase( "MONTH-TO" ) 
-                                || deCodeString.equalsIgnoreCase( "DATE-FROM" ) || deCodeString.equalsIgnoreCase( "DATE-TO" ) )
+                            if( deCodeString.equalsIgnoreCase( "FACILITY" ) || deCodeString.equalsIgnoreCase( "FACILITYP" ) || deCodeString.equalsIgnoreCase( "FACILITYPP" ) || deCodeString.equalsIgnoreCase( "MONTH-FROM" ) || deCodeString.equalsIgnoreCase( "MONTH-TO" ) 
+                                || deCodeString.equalsIgnoreCase( "DATE-FROM" ) || deCodeString.equalsIgnoreCase( "DATE-TO" ) || deCodeString.equalsIgnoreCase( "CURRENTDATETIME" ) )
                             {
                                 continue;
                             }
@@ -530,6 +616,7 @@
                     deCodeString.equalsIgnoreCase( "MONTH-FROM" ) || 
                     deCodeString.equalsIgnoreCase( "MONTH-TO" ) ||
                     deCodeString.equalsIgnoreCase( "DATE-FROM" ) ||
+                    deCodeString.equalsIgnoreCase( "CURRENTDATETIME" ) || 
                     deCodeString.equalsIgnoreCase( "DATE-TO" ) )
                 {
                     continue;
@@ -574,7 +661,7 @@
 
         outputReportFile.deleteOnExit();
 
-        statementManager.destroy();
+        //statementManager.destroy();
 
         return SUCCESS;
     }
@@ -680,4 +767,6 @@
     }
     // getChildOrgUnitTree end
     
+    
+    
 }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/periodwiseprogress/action/GeneratePeriodWiseProgressAnalyserResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/periodwiseprogress/action/GeneratePeriodWiseProgressAnalyserResultAction.java	2012-07-24 12:38:31 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/periodwiseprogress/action/GeneratePeriodWiseProgressAnalyserResultAction.java	2014-04-01 09:24:09 +0000
@@ -63,14 +63,14 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-    
+    /*
     private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -137,14 +137,24 @@
     {
         this.reportList = reportList;
     }
-
+    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }    
+    
+    
     private int availablePeriods;
 
     public void setAvailablePeriods( int availablePeriods )
@@ -191,16 +201,19 @@
 
     private int tempRowNo;
     
+    private List<Period> periodList = new ArrayList<Period>();
+    
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
     public String execute()
         throws Exception
     {
-        statementManager.initialise();
+        //statementManager.initialise();
         
         // Initialization
         raFolderName = reportService.getRAFolderName();
+        SimpleDateFormat dateTimeFormat = new SimpleDateFormat( "EEEE, dd MMMM yyyy HH:mm:ss zzzz" );
 
         String colArray[] = {"A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",
             "AA","AB","AC","AD","AE","AF","AG","AH","AI","AJ","AK","AL","AM","AN","AO","AP","AQ","AR","AS","AT","AU","AV","AW","AX","AY","AZ",
@@ -213,7 +226,7 @@
         
         System.out.println( currentOrgUnit.getName()+ " : " + selReportObj.getName()+" : Report Generation Start Time is : " + new Date() );
 
-        List<OrganisationUnit> childOrgUnitTree = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( ouIDTB ) );
+        List<OrganisationUnit> childOrgUnitTree = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( currentOrgUnit.getId() ) );
         List<Integer> childOrgUnitTreeIds = new ArrayList<Integer>( getIdentifiers( OrganisationUnit.class, childOrgUnitTree ) );
         String childOrgUnitsByComma = getCommaDelimitedString( childOrgUnitTreeIds );
 
@@ -248,11 +261,59 @@
 
         sDate = format.parseDate( String.valueOf( selectedPeriod.getStartDate() ) );
         eDate = format.parseDate( String.valueOf( selectedEndPeriod.getEndDate() ) );
-
-        PeriodType periodType = periodService.getPeriodTypeByName( periodTypeId );
-        List<Period> periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates( periodType, sDate, eDate ) );
-        //List<Period> periodList = new ArrayList<Period>( periodService.getIntersectingPeriods( sDate, eDate ) );
-        Collections.sort( periodList, new PeriodStartDateComparator() );
+        
+        Map<String, String> batchDataMap = new HashMap<String, String>();
+        
+        if ( reportModelTB.equalsIgnoreCase( "PROGRESSIVE-BATCH" ) )
+        {
+            String dataElementIds = "";
+            
+            List<Report_inDesign> headerList = reportService.getHeaderInfo( deCodesXMLFileName );
+            
+            Iterator<Report_inDesign> headerIterator = headerList.iterator();
+            while (  headerIterator.hasNext() )
+            {
+                Report_inDesign header =  headerIterator.next();
+                dataElementIds = header.getExpression();
+            }
+                
+            PeriodType periodType = periodService.getPeriodTypeByName( periodTypeId );
+            List<Period> tempperiodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates( periodType, sDate, eDate ) );
+            Collection<Integer> periodIds = new ArrayList<Integer>( getIdentifiers(Period.class, tempperiodList ) );        
+            String periodIdsByComma = getCommaDelimitedString( periodIds );
+     
+            batchDataMap = new HashMap<String, String>( reportService.getBatchDataFromDataValueTable( ""+currentOrgUnit.getId(), dataElementIds, periodIdsByComma ));
+            if( batchDataMap != null )
+            {
+                periodList = new ArrayList<Period>();
+                
+                for( String periodId : batchDataMap.keySet() )
+                {
+                    Period period = periodService.getPeriod( Integer.parseInt( periodId ) );
+                    periodList.add( period );
+                    
+                    //System.out.println( " Key is : " + periodId + " Value is : " + batchDataMap.get( periodId ));
+                }
+                
+                Collections.sort( periodList, new PeriodStartDateComparator() );
+            }
+            else
+            {
+                
+            }
+        }
+        
+        else
+        {
+            PeriodType periodType = periodService.getPeriodTypeByName( periodTypeId );
+            //List<Period> periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates( periodType, sDate, eDate ) );
+            
+            periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates( periodType, sDate, eDate ) );
+            //List<Period> periodList = new ArrayList<Period>( periodService.getIntersectingPeriods( sDate, eDate ) );
+            Collections.sort( periodList, new PeriodStartDateComparator() );
+            
+        }
+        
         
         if( periodTypeId.equalsIgnoreCase( "monthly" ) )
         {
@@ -275,21 +336,24 @@
         String dataElmentIdsByComma = reportService.getDataelementIdsByStype( reportDesignList, Report_inDesign.ST_DATAELEMENT );
         String nonNumberDataElementIdsByComma = reportService.getDataelementIdsByStype( reportDesignList, Report_inDesign.ST_NON_NUMBER_DATAELEMENT );
         
-        //Collection<Integer> periodIds1 = new ArrayList<Integer>( getIdentifiers(Period.class, periodList ) );
-        String periodsByComma = "";
-        //getCommaDelimitedString( periodIds1 );
-                
+        //System.out.println( " Size of Period List is : " + periodList.size() );
+        
+	//Collection<Integer> periodIds1 = new ArrayList<Integer>( getIdentifiers(Period.class, periodList ) );
+	String periodsByComma = "";
+	//getCommaDelimitedString( periodIds1 );
+		
         int colCount = 0;
+        int batchCount = 1;
         for( Period period : periodList )
-        {               
+        {		
             if( periodTypeId.equalsIgnoreCase( "daily" ) )
             {
-                periodsByComma = ""+period.getId();
+		periodsByComma = ""+period.getId();
             }
             else
             {
-                Collection<Integer> periodIds = new ArrayList<Integer>( getIdentifiers(Period.class, periodService.getIntersectingPeriods( period.getStartDate(), period.getEndDate() ) ) );
-                periodsByComma = getCommaDelimitedString( periodIds );
+		Collection<Integer> periodIds = new ArrayList<Integer>( getIdentifiers(Period.class, periodService.getIntersectingPeriods( period.getStartDate(), period.getEndDate() ) ) );
+		periodsByComma = getCommaDelimitedString( periodIds );
             }
 
             Map<String, String> aggDeMap = new HashMap<String, String>();
@@ -301,14 +365,15 @@
             {
                 aggDeMap.putAll( reportService.getAggDataFromDataValueTable( childOrgUnitsByComma, dataElmentIdsByComma, periodsByComma ) );
                 aggDeMap.putAll( reportService.getAggNonNumberDataFromDataValueTable(childOrgUnitsByComma, nonNumberDataElementIdsByComma, periodsByComma ) );
-                System.out.println(childOrgUnitsByComma +" \n " + dataElmentIdsByComma + " \n " + periodsByComma );
+		//System.out.println(childOrgUnitsByComma +" \n " + dataElmentIdsByComma + " \n " + periodsByComma );
             }
             else if( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
             {
                 aggDeMap.putAll( reportService.getAggDataFromDataValueTable( ""+currentOrgUnit.getId(), dataElmentIdsByComma, periodsByComma ) );
                 aggDeMap.putAll( reportService.getAggNonNumberDataFromDataValueTable(""+currentOrgUnit.getId(), nonNumberDataElementIdsByComma, periodsByComma ) );
             }
-            System.out.println( "aggDeMap size : " + aggDeMap.size() );
+            
+            //System.out.println( "aggDeMap size : " + aggDeMap.size() );
 
             Iterator<Report_inDesign> reportDesignIterator = reportDesignList.iterator();
             while (  reportDesignIterator.hasNext() )
@@ -334,7 +399,25 @@
                 else if( deCodeString.equalsIgnoreCase( "PROGRESSIVE-PERIOD" ) )
                 {
                     tempStr = simpleDateFormat.format( period.getStartDate() );
-                } 
+                }
+                
+                else if( deCodeString.equalsIgnoreCase( "PROGRESSIVE-BATCH" ) )
+                {
+                    tempStr =  "Batch - " + batchDataMap.get( ""+period.getId() );
+                    //tempStr = "Batch - " + batchCount; 
+                    
+                } 
+                
+                else if( deCodeString.equalsIgnoreCase( "DISCHARGED" ) )
+                {
+                    tempStr = simpleDateFormat.format( period.getStartDate() );
+                    
+                } 
+                
+                else if ( deCodeString.equalsIgnoreCase( "CURRENTDATETIME" ) )
+                {
+                    tempStr = dateTimeFormat.format( new Date() );
+                }
                 else if( deCodeString.equalsIgnoreCase( "NA" ) )
                 {
                     tempStr = " ";
@@ -358,12 +441,46 @@
                             tempStr = getAggVal( deCodeString, aggDeMap );
                         }
                     }
+                    else if( sType.equalsIgnoreCase( "dataelement-date" ) )
+                    {
+                        String deIdsByComma = "-1";
+                        
+                        for( int i = 0; i < deCodeString.split( "," ).length; i++ )
+                        {
+                            deIdsByComma += "," + deCodeString.split( "," )[i];
+                        }
+                        
+                        tempStr = reportService.getTextDataFromDataValueTable( ""+currentOrgUnit.getId(), deIdsByComma, periodsByComma );
+                        
+                        tempStr = tempStr.replace( tempStr.substring( tempStr.length()-1 ), "");
+                        
+                        //System.out.println( " Temp String  : " + tempStr );
+                        
+                        //tempStr = simpleDateFormat.format( tempStr );
+                        
+                        //System.out.println( " Temp String after : " + tempStr );
+                    }
+                    
+                    else if( sType.equalsIgnoreCase( "month-count" ) )
+                    {
+                        tempStr = simpleDateFormat.format( period.getStartDate() );
+                        
+                        String[] tempString = tempStr.split( "-" );
+                        //String year = tempString[0];
+                        String month = tempString[1];
+                        //String date = tempString[2];
+                        
+                        tempStr = month;
+                        //System.out.println( " Temp String  : " + tempStr );
+                    }
+                    
+                    
                     else if( sType.equalsIgnoreCase( Report_inDesign.ST_DATAELEMENT_NO_REPEAT ) )
                     {
                         deCodeString = deCodeString.replaceAll( ":", "\\." );
                         deCodeString = deCodeString.replaceAll( "[", "" );
                         deCodeString = deCodeString.replaceAll( "]", "" );
-                        System.out.println( "deCodeString : "+ deCodeString );
+                        //System.out.println( "deCodeString : "+ deCodeString );
                         tempStr = aggDeMap.get( deCodeString );
                     }
                 }
@@ -378,9 +495,9 @@
                 } 
                 else
                 {
-                    if( reportModelTB.equalsIgnoreCase( "PROGRESSIVE-PERIOD" ) )
+                    if( reportModelTB.equalsIgnoreCase( "PROGRESSIVE-PERIOD" ) || reportModelTB.equalsIgnoreCase( "PROGRESSIVE-BATCH" ))
                     {
-                        if( deCodeString.equalsIgnoreCase( "FACILITY" ) || deCodeString.equalsIgnoreCase( "PERIOD-RANGE" ) )
+                        if( deCodeString.equalsIgnoreCase( "FACILITY" ) || deCodeString.equalsIgnoreCase( "PERIOD-RANGE" ) || deCodeString.equalsIgnoreCase( "CURRENTDATETIME" ) )
                         {                            
                         } 
                         else
@@ -410,6 +527,7 @@
             }// inner while loop end
 
             colCount++;
+            batchCount++;
         }// outer while loop end
 
         // ---------------------------------------------------------------------
@@ -422,8 +540,10 @@
             Report_inDesign reportDesign =  reportDesignIterator.next();
             
             String deCodeString = reportDesign.getExpression();
+            String sType = reportDesign.getStype();
 
             if( deCodeString.equalsIgnoreCase( "FACILITY" ) || 
+                deCodeString.equalsIgnoreCase( "CURRENTDATETIME" ) ||
                 deCodeString.equalsIgnoreCase( "PERIOD-RANGE" ) )
             {
                 continue;
@@ -446,11 +566,11 @@
             totalCellformat.setVerticalAlignment( VerticalAlignment.CENTRE );
             totalCellformat.setWrap( true );
 
-            if( deCodeString.equalsIgnoreCase( "PROGRESSIVE-PERIOD" ) )
+            if( deCodeString.equalsIgnoreCase( "PROGRESSIVE-PERIOD" ) || deCodeString.equalsIgnoreCase( "PROGRESSIVE-BATCH" ) )
             {
                 totalSheet.addCell( new Label( tempColNo+colCount, tempRowNo, "Total", totalCellformat ) );
             }
-            else if( deCodeString.equalsIgnoreCase( "NA" ) )
+            else if( deCodeString.equalsIgnoreCase( "NA" ) || sType.equalsIgnoreCase( "dataelement-date" ) || sType.equalsIgnoreCase( "month-count" ) || deCodeString.equalsIgnoreCase( "DISCHARGED" ) )
             {
                 totalSheet.addCell( new Label( tempColNo+colCount, tempRowNo, " ", totalCellformat ) );
             }
@@ -473,7 +593,7 @@
 
         outputReportFile.deleteOnExit();
 
-        statementManager.destroy();
+        //statementManager.destroy();
 
         return SUCCESS;
     }
@@ -495,7 +615,7 @@
 
                 replaceString = replaceString.replaceAll( "[\\[\\]]", "" );
 
-                                System.out.println( replaceString + " : " + aggDeMap.get( replaceString ) );
+		//System.out.println( replaceString + " : " + aggDeMap.get( replaceString ) );
                 replaceString = aggDeMap.get( replaceString );
                 
                 if( replaceString == null )

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/periodwiseprogress/action/GeneratePeriodWiseProgressReportAnalyserFormAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/periodwiseprogress/action/GeneratePeriodWiseProgressReportAnalyserFormAction.java	2012-07-24 12:38:31 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/periodwiseprogress/action/GeneratePeriodWiseProgressReportAnalyserFormAction.java	2013-09-19 06:34:31 +0000
@@ -56,7 +56,7 @@
         while ( periodTypeIterator.hasNext() )
         {
             PeriodType type = periodTypeIterator.next();
-            if ( type.getName().equalsIgnoreCase("Daily") || type.getName().equalsIgnoreCase("Monthly") || type.getName().equalsIgnoreCase("quarterly") || type.getName().equalsIgnoreCase("yearly"))
+            if (type.getName().equalsIgnoreCase("Daily") || type.getName().equalsIgnoreCase("Monthly") || type.getName().equalsIgnoreCase("quarterly") || type.getName().equalsIgnoreCase("yearly"))
             {
             }
             else

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/physical/action/GeneratePhysicalReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/physical/action/GeneratePhysicalReportResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/physical/action/GeneratePhysicalReportResultAction.java	2013-09-19 06:34:31 +0000
@@ -53,14 +53,14 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-
+/*
     private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     private PeriodService periodService;
 
     public void setPeriodService( PeriodService periodService )
@@ -148,7 +148,7 @@
     {
         // Intialisation
 
-        statementManager.initialise();
+        //statementManager.initialise();
         orgUnitList = new ArrayList<OrganisationUnit>();
         String deCodesXMLFileName = "";
 
@@ -305,7 +305,7 @@
         System.out.println( selReportObj.getName()+" : Report Generation End Time is : " + new Date() );
 
         outputReportFile.deleteOnExit();
-        statementManager.destroy();
+        //statementManager.destroy();
 
         return SUCCESS;
     }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/portal/action/PortalReportsFormAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/portal/action/PortalReportsFormAction.java	2010-09-29 02:04:14 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/portal/action/PortalReportsFormAction.java	2014-07-05 06:32:07 +0000
@@ -1,27 +1,5 @@
 package org.hisp.dhis.reports.portal.action;
 
-import java.io.File;
-import java.text.SimpleDateFormat;
-import java.util.ArrayList;
-import java.util.Collection;
-import java.util.List;
-
-import javax.xml.parsers.DocumentBuilder;
-import javax.xml.parsers.DocumentBuilderFactory;
-
-import org.hisp.dhis.period.MonthlyPeriodType;
-import org.hisp.dhis.period.Period;
-import org.hisp.dhis.period.PeriodService;
-import org.hisp.dhis.period.PeriodType;
-import org.hisp.dhis.reports.util.Report;
-import org.hisp.dhis.reports.util.ReportService;
-import org.w3c.dom.Document;
-import org.w3c.dom.Element;
-import org.w3c.dom.Node;
-import org.w3c.dom.NodeList;
-import org.xml.sax.SAXException;
-import org.xml.sax.SAXParseException;
-
 import com.opensymphony.xwork2.Action;
 
 public class PortalReportsFormAction
@@ -31,7 +9,7 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-
+    /*
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -45,11 +23,12 @@
     {
         this.periodService = periodService;
     }
-
+    */
+    
     // -------------------------------------------------------------------------
     // Getter & Setter
     // -------------------------------------------------------------------------
-
+/*
     private List<Report> reportList;
 
     public List<Report> getReportList()
@@ -86,7 +65,8 @@
     {
         return periods;
     }
-
+*/
+    
     // -------------------------------------------------------------------------
     // Action implementation
     // -------------------------------------------------------------------------
@@ -95,6 +75,7 @@
     public String execute()
         throws Exception
     {
+       /*
         raFolderName = reportService.getRAFolderName();
 
         periodList = new ArrayList<Period>( periodService.getPeriodsByPeriodType( new MonthlyPeriodType() ) );
@@ -103,10 +84,11 @@
         reportList = new ArrayList<Report>();
 
         getSelectedReportList();
-
+    */
         return SUCCESS;
     }
 
+    /*
     public void getSelectedReportList()
     {
         String fileName = "NBITSPortalReportsList.xml";
@@ -201,5 +183,7 @@
         }
 
     }// getReportList end
+    */
+    
 
 }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/portal/action/PortalReportsResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/portal/action/PortalReportsResultAction.java	2012-06-18 09:15:09 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/portal/action/PortalReportsResultAction.java	2014-07-04 11:45:48 +0000
@@ -4,70 +4,31 @@
 //@23-06-2010 - for doses checking if dose is given before enddate then show it
 //@23-06-2010 - formating done as per eclipse
 //@23-06-2010 - for tt dates checking if execution date is before end date
-import java.io.BufferedInputStream;
 import java.io.File;
-import java.io.FileInputStream;
 import java.io.InputStream;
 import java.text.SimpleDateFormat;
 import java.util.ArrayList;
 import java.util.Calendar;
-import java.util.Collection;
 import java.util.Collections;
 import java.util.Date;
-import java.util.HashMap;
 import java.util.Iterator;
 import java.util.List;
-import java.util.Map;
-import java.util.Set;
 import java.util.UUID;
 
 import javax.xml.parsers.DocumentBuilder;
 import javax.xml.parsers.DocumentBuilderFactory;
 
-import jxl.Workbook;
-import jxl.format.Alignment;
-import jxl.format.Border;
-import jxl.format.BorderLineStyle;
-import jxl.format.VerticalAlignment;
-import jxl.write.Label;
-import jxl.write.WritableCell;
-import jxl.write.WritableCellFormat;
-import jxl.write.WritableSheet;
-import jxl.write.WritableWorkbook;
-
 import org.amplecode.quick.StatementManager;
 import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
 import org.hisp.dhis.config.Configuration_IN;
-import org.hisp.dhis.dataelement.DataElement;
-import org.hisp.dhis.dataelement.DataElementCategoryOptionCombo;
 import org.hisp.dhis.dataelement.DataElementCategoryService;
 import org.hisp.dhis.dataelement.DataElementService;
 import org.hisp.dhis.i18n.I18nFormat;
 import org.hisp.dhis.organisationunit.OrganisationUnit;
 import org.hisp.dhis.organisationunit.OrganisationUnitService;
-import org.hisp.dhis.patient.Patient;
-import org.hisp.dhis.patient.PatientAttribute;
-import org.hisp.dhis.patient.PatientAttributeService;
-import org.hisp.dhis.patient.PatientIdentifier;
-import org.hisp.dhis.patient.PatientIdentifierService;
-import org.hisp.dhis.patient.PatientIdentifierType;
-import org.hisp.dhis.patient.PatientIdentifierTypeService;
-import org.hisp.dhis.patient.PatientService;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValue;
-import org.hisp.dhis.patientattributevalue.PatientAttributeValueService;
-import org.hisp.dhis.patientdatavalue.PatientDataValue;
-import org.hisp.dhis.patientdatavalue.PatientDataValueService;
 import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
-import org.hisp.dhis.program.Program;
-import org.hisp.dhis.program.ProgramInstance;
-import org.hisp.dhis.program.ProgramInstanceService;
-import org.hisp.dhis.program.ProgramService;
-import org.hisp.dhis.program.ProgramStage;
-import org.hisp.dhis.program.ProgramStageInstance;
-import org.hisp.dhis.program.ProgramStageInstanceService;
-import org.hisp.dhis.program.ProgramStageService;
 import org.hisp.dhis.reports.util.ReportService;
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
@@ -126,6 +87,7 @@
         this.periodService = periodService;
     }
     
+    /*
     private PatientService patientService;
 
     public void setPatientService( PatientService patientService )
@@ -133,6 +95,8 @@
         this.patientService = patientService;
     }
     
+    
+    
     private ProgramService programService;
 
     public void setProgramService( ProgramService programService )
@@ -160,7 +124,8 @@
     {
         this.programStageInstanceService = programStageInstanceService;
     }
-
+    
+    /*
     private PatientIdentifierService patientIdentifierService;
 
     public void setPatientIdentifierService( PatientIdentifierService patientIdentifierService )
@@ -195,7 +160,9 @@
     {
         this.patientIdentifierTypeService = patientIdentifierTypeService;
     }
-
+    
+    */
+    
     private I18nFormat format;
 
     public void setFormat( I18nFormat format ) {
@@ -205,12 +172,16 @@
     // -------------------------------------------------------------------------
     // Properties
     // -------------------------------------------------------------------------
+    
+    /*
     private Map<Patient, Set<ProgramStageInstance>> visitsByPatients = new HashMap<Patient, Set<ProgramStageInstance>>();
 
     public Map<Patient, Set<ProgramStageInstance>> getVisitsByPatients()
     {
         return visitsByPatients;
     }
+    */
+    
     private InputStream inputStream;
 
     public InputStream getInputStream()
@@ -430,14 +401,14 @@
 
         System.out.println( inputTemplatePath );
 
-        generatPortalReport();
+        //generatPortalReport();
         
         statementManager.destroy();
 
         return SUCCESS;
     }
 
-    
+    /*
     public void generatPortalReport() throws Exception
     {
         Workbook templateWorkbook = Workbook.getWorkbook( new File( inputTemplatePath ) );
@@ -478,6 +449,8 @@
 
         String tempStr = "";
         String dataelementWithStage = "";
+        
+        
         Collection<ProgramStage> programStagesList = new ArrayList<ProgramStage>();
         if ( programIds.length != 0 )
         {
@@ -592,21 +565,27 @@
                     mFNameMap.put( "Father", "Father's" );
                     mFNameMap.put( "Mother", "Mother's" );
 
-                    programStagesList = curProgram.getProgramStages();
+                    
+                    
+                    //programStagesList = curProgram.getProgramStages();
+                    /*
+                     * 
                     if ( programStagesList == null || programStagesList.isEmpty() )
                     {
                     }
-
+                    */
+                    /*
                     List<Patient> patientList = new ArrayList<Patient>();
                     Map<Patient, ProgramInstance> patientPIList = new HashMap<Patient, ProgramInstance>();
                     Map<ProgramInstance, Collection<ProgramStageInstance>> PIPSIList = new HashMap<ProgramInstance, Collection<ProgramStageInstance>>();
                     Map<ProgramInstance, Collection<ProgramStageInstance>> PIAllPSIList = new HashMap<ProgramInstance, Collection<ProgramStageInstance>>();
                     Map<Patient, OrganisationUnit> patientOuList = new HashMap<Patient, OrganisationUnit>();
-                    
-                    orgUnitList = getChildOrgUnitTree( selectedOrgUnit );
+                    */
+                    //orgUnitList = getChildOrgUnitTree( selectedOrgUnit );
 
-                    for ( OrganisationUnit ou : orgUnitList )
-                    {
+                    //for ( OrganisationUnit ou : orgUnitList )
+                    //{
+                       /*
                         Collection<Patient> patientListByOrgUnit = new ArrayList<Patient>();
                         //patientListByOrgUnit.addAll( patientService.getPatients( ou ) );
                         patientListByOrgUnit.addAll( patientService.getPatients( ou, null, null ) );
@@ -681,11 +660,14 @@
                                 }
                             }
                         }
-                    }
+                        
+                        */
+                    //}
 
-                    int sheetNo = 0;
-                    rowCount = 0;
+                    //int sheetNo = 0;
+                    //rowCount = 0;
                     //running patient loop
+                    /*
                     for ( Patient patient : patientList )
                     {
                         if( includePeriod.equalsIgnoreCase( "uploadingmcts" ) )
@@ -706,7 +688,8 @@
                         }
 
                         ProgramInstance programInstance = patientPIList.get( patient );
-
+                     */
+                    /*
                         String cAPhoneNumberName = "";
                         count1 = 0;
                         int rowNo = rowList.get( 1 ) + rowCount;
@@ -728,6 +711,7 @@
                                     if ( sType.equalsIgnoreCase( "identifiertype" ) )
                                     {
                                         int deCodeInt = Integer.parseInt( deCodeString );
+                                        /*
                                         PatientIdentifierType patientIdentifierType = patientIdentifierTypeService.getPatientIdentifierType( deCodeInt );
                                         if ( patientIdentifierType != null ) {
                                             PatientIdentifier patientIdentifier = patientIdentifierService.getPatientIdentifier( patientIdentifierType, patient );
@@ -737,11 +721,14 @@
                                                 tempStr = " ";
                                             }
                                         }
-                                    } // </editor-fold>
-                                    else if ( sType.equalsIgnoreCase( "caseAttribute" ) )
-                                    {
-                                        int deCodeInt = Integer.parseInt( deCodeString );
-
+                                        */
+                                        
+                                    //} // </editor-fold>
+                
+                                    //else if ( sType.equalsIgnoreCase( "caseAttribute" ) )
+                                    //{
+                                        //int deCodeInt = Integer.parseInt( deCodeString );
+                                        /*
                                         PatientAttribute patientAttribute = patientAttributeService.getPatientAttribute( deCodeInt );
                                         PatientAttributeValue patientAttributeValue = patientAttributeValueService.getPatientAttributeValue( patient, patientAttribute );
                                         if ( patientAttributeValue != null ) {
@@ -752,7 +739,11 @@
                                         } else {
                                             tempStr = " ";
                                         }
+                                        */
+                                        
+                                    /*
                                     } // </editor-fold>
+                                    
                                     else if ( sType.equalsIgnoreCase( "dataelementstage" ) || sType.equalsIgnoreCase( "dataelementstagePODPublic" ) || sType.equalsIgnoreCase( "dataelementstagePODPrivate" ) || sType.equalsIgnoreCase( "dataelementstagePODHome" ) )
                                     {
                                         dataelementWithStage = deCodeString;
@@ -761,6 +752,7 @@
                                         int deId = Integer.parseInt( deAndPs[1] );
                                         DataElement d1e = dataElementService.getDataElement( deId );
                                         ProgramStageInstance pStageInstance = programStageInstanceService.getProgramStageInstance( programInstance, programStageService.getProgramStage( psId ) );
+                                        
                                         if ( pStageInstance != null && ( PIPSIList.get( programInstance ).contains( pStageInstance ) || programInstance.isCompleted() == false ) ) {
                                             if ( pStageInstance.getExecutionDate() != null ) {
                                                 if ( includePeriod.equalsIgnoreCase( "periodincluding" ) ) {
@@ -838,6 +830,7 @@
                                         }
                                     } // </editor-fold>
                                     // <editor-fold defaultstate="collapsed" desc="sType = dataelement">
+                                    /*
                                     else if ( sType.equalsIgnoreCase( "dataelement" ) )
                                     {
                                         if ( deCodeString.equalsIgnoreCase( "FACILITY" ) )
@@ -919,8 +912,10 @@
                                             }
                                         }
                                         //
-                                    } // </editor-fold>
+                                    }
+                                    */ // </editor-fold>
                                     // <editor-fold defaultstate="collapsed" desc="sType = caseProperty">
+                                    /*
                                     else if ( sType.equalsIgnoreCase( "caseProperty" ) )
                                     {
                                         if ( deCodeString.equalsIgnoreCase( "Name" ) )
@@ -977,6 +972,7 @@
                                              * TODO
                                              * BloodGroup is removed from Patient Object, so need to change this accordingly
                                              */
+                                    /*
                                             String bloodGroup = ""; 
                                                 //patient.getBloodGroup();
                                             if ( !bloodGroup.trim().equalsIgnoreCase( "" ) )
@@ -1679,7 +1675,7 @@
                                              * TODO
                                              * BloodGroup is removed from Patient Object, so need to change this accordingly
                                              */
-
+                                        /*
                                             String bloodGroup = ""; 
                                                 //patient.getBloodGroup();
                                             if ( !bloodGroup.trim().equalsIgnoreCase( "" ) )

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/portal/action/PortalReportsResult_ACS.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/portal/action/PortalReportsResult_ACS.java	2012-04-04 11:58:27 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/portal/action/PortalReportsResult_ACS.java	2014-07-05 06:30:48 +0000
@@ -1,50 +1,18 @@
 package org.hisp.dhis.reports.portal.action;
 
-import java.io.BufferedInputStream;
 import java.io.File;
-import java.io.FileInputStream;
 import java.io.InputStream;
-import java.text.SimpleDateFormat;
 import java.util.ArrayList;
 import java.util.Calendar;
 import java.util.Date;
-import java.util.Iterator;
 import java.util.List;
 import java.util.UUID;
 
 import javax.xml.parsers.DocumentBuilder;
 import javax.xml.parsers.DocumentBuilderFactory;
 
-import jxl.Workbook;
-import jxl.format.Alignment;
-import jxl.format.Border;
-import jxl.format.BorderLineStyle;
-import jxl.format.VerticalAlignment;
-import jxl.write.Label;
-import jxl.write.Number;
-import jxl.write.WritableCellFormat;
-import jxl.write.WritableSheet;
-import jxl.write.WritableWorkbook;
-
 import org.hisp.dhis.config.Configuration_IN;
-import org.hisp.dhis.dataelement.DataElement;
-import org.hisp.dhis.dataelement.DataElementCategoryOptionCombo;
-import org.hisp.dhis.dataelement.DataElementCategoryService;
-import org.hisp.dhis.dataelement.DataElementService;
 import org.hisp.dhis.i18n.I18nFormat;
-import org.hisp.dhis.organisationunit.OrganisationUnit;
-import org.hisp.dhis.organisationunit.OrganisationUnitService;
-import org.hisp.dhis.patient.Patient;
-import org.hisp.dhis.patient.PatientIdentifier;
-import org.hisp.dhis.patient.PatientIdentifierService;
-import org.hisp.dhis.patient.PatientService;
-import org.hisp.dhis.patientdatavalue.PatientDataValue;
-import org.hisp.dhis.patientdatavalue.PatientDataValueService;
-import org.hisp.dhis.program.ProgramStageInstance;
-import org.hisp.dhis.program.ProgramStageInstanceService;
-import org.hisp.dhis.reports.util.ReportService;
-import org.springframework.jdbc.core.JdbcTemplate;
-import org.springframework.jdbc.support.rowset.SqlRowSet;
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
 import org.w3c.dom.Node;
@@ -59,7 +27,7 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-
+    /*
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -74,6 +42,7 @@
         this.organisationUnitService = organisationUnitService;
     }
 
+    
     private PatientService patientService;
 
     public void setPatientService( PatientService patientService )
@@ -123,6 +92,7 @@
     {
         this.jdbcTemplate = jdbcTemplate;
     }
+    */
     
     private I18nFormat format;
 
@@ -166,12 +136,23 @@
     {
         this.reportList = reportList;
     }
+   
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
     private String startDate;
 
     public void setStartDate( String startDate )
@@ -209,7 +190,7 @@
         colList = new ArrayList<Integer>();
         progList = new ArrayList<Integer>();
 
-        raFolderName = reportService.getRAFolderName();
+        //raFolderName = reportService.getRAFolderName();
         
         inputTemplatePath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "template" + File.separator + reportFileNameTB;
         outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator +  Configuration_IN.DEFAULT_TEMPFOLDER;
@@ -227,21 +208,21 @@
         
         if( reportLevelTB.trim().equalsIgnoreCase( "1" ) )
         {
-            generateCVDReport();
+            //generateCVDReport();
         }
         
         //String queryCVD = "SELECT  programstageinstanceid, programstageid,executiondate FROM programstageinstance WHERE programstageid IN ("+ reportLevelTB +")AND executiondate between '"+startDate+"' AND '"+endDate+"' ";
         
         else
         {
-            generateReport();
+            //generateReport();
         }
         
         System.out.println( "Report Generation End Time is : \t" + new Date() );
         
         return SUCCESS;
     }
-    
+ /*   
     public void generateReport() throws Exception
     {
         Workbook templateWorkbook = Workbook.getWorkbook( new File( inputTemplatePath ) );
@@ -741,8 +722,9 @@
         inputStream = new BufferedInputStream( new FileInputStream( outputReportFile ) );
         outputReportFile.deleteOnExit();
     }
-    
+ */   
 
+    /*
     public void generateCVDReport() throws Exception
     {
         Workbook templateWorkbook = Workbook.getWorkbook( new File( inputTemplatePath ) );
@@ -877,7 +859,7 @@
         outputReportFile.deleteOnExit();
     }
 
-    
+ */   
     
     public String getAge( Date birthDate )
     {

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/portal/action/PortalReportsResult_Action.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/portal/action/PortalReportsResult_Action.java	2012-04-04 11:58:27 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/portal/action/PortalReportsResult_Action.java	2014-07-04 11:47:30 +0000
@@ -1,49 +1,20 @@
 package org.hisp.dhis.reports.portal.action;
 
-import java.io.BufferedInputStream;
 import java.io.File;
-import java.io.FileInputStream;
 import java.io.InputStream;
-import java.text.SimpleDateFormat;
 import java.util.ArrayList;
 import java.util.Calendar;
 import java.util.Date;
-import java.util.Iterator;
 import java.util.List;
 import java.util.UUID;
 
 import javax.xml.parsers.DocumentBuilder;
 import javax.xml.parsers.DocumentBuilderFactory;
 
-import jxl.Workbook;
-import jxl.format.Alignment;
-import jxl.format.Border;
-import jxl.format.BorderLineStyle;
-import jxl.format.VerticalAlignment;
-import jxl.write.Label;
-import jxl.write.Number;
-import jxl.write.WritableCellFormat;
-import jxl.write.WritableSheet;
-import jxl.write.WritableWorkbook;
-
 import org.hisp.dhis.config.Configuration_IN;
-import org.hisp.dhis.dataelement.DataElement;
-import org.hisp.dhis.dataelement.DataElementCategoryOptionCombo;
-import org.hisp.dhis.dataelement.DataElementCategoryService;
-import org.hisp.dhis.dataelement.DataElementService;
-import org.hisp.dhis.organisationunit.OrganisationUnit;
 import org.hisp.dhis.organisationunit.OrganisationUnitService;
-import org.hisp.dhis.patient.Patient;
-import org.hisp.dhis.patient.PatientIdentifier;
-import org.hisp.dhis.patient.PatientIdentifierService;
-import org.hisp.dhis.patient.PatientService;
-import org.hisp.dhis.patientdatavalue.PatientDataValue;
-import org.hisp.dhis.patientdatavalue.PatientDataValueService;
-import org.hisp.dhis.program.ProgramStageInstance;
-import org.hisp.dhis.program.ProgramStageInstanceService;
 import org.hisp.dhis.reports.util.ReportService;
 import org.springframework.jdbc.core.JdbcTemplate;
-import org.springframework.jdbc.support.rowset.SqlRowSet;
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
 import org.w3c.dom.Node;
@@ -73,6 +44,7 @@
         this.organisationUnitService = organisationUnitService;
     }
 
+    /*
     private PatientService patientService;
 
     public void setPatientService( PatientService patientService )
@@ -115,6 +87,7 @@
     {
         this.dataElementCategoryOptionComboService = dataElementCategoryOptionComboService;
     }
+    */
     
     private JdbcTemplate jdbcTemplate;
 
@@ -213,11 +186,11 @@
         }
         outputReportPath += File.separator + UUID.randomUUID().toString() + ".xls";
 
-        generateReport();
+        //generateReport();
         
         return SUCCESS;
     }
-    
+    /*
     public void generateReport() throws Exception
     {
         Workbook templateWorkbook = Workbook.getWorkbook( new File( inputTemplatePath ) );
@@ -495,7 +468,7 @@
         inputStream = new BufferedInputStream( new FileInputStream( outputReportFile ) );
         outputReportFile.deleteOnExit();
     }
-    
+    */
     
     public String getAge( Date birthDate )
     {

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ranking/action/GenerateRankingReportResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ranking/action/GenerateRankingReportResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ranking/action/GenerateRankingReportResultAction.java	2014-04-01 09:31:50 +0000
@@ -66,14 +66,14 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-
+/*
     private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     private PeriodService periodService;
 
     public void setPeriodService( PeriodService periodService )
@@ -166,13 +166,21 @@
     */
 
     
-    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
 
     private int selectedPeriodId;
     
@@ -207,7 +215,7 @@
         throws Exception
     {        
         // Initialization
-        statementManager.initialise();
+        //statementManager.initialise();
         
         raFolderName = reportService.getRAFolderName();        
         deCodeType = new ArrayList<String>();
@@ -366,7 +374,7 @@
 
         outputReportFile.deleteOnExit();
         
-        statementManager.destroy();
+        //statementManager.destroy();
         
         return SUCCESS;
     }
@@ -539,9 +547,10 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
-
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                    
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod,organisationUnit, optionCombo );
+                    
                     if ( dataValue != null )
                     {
                         // Works for both text and boolean data types

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ranking2/action/GenerateRanking2ReportAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ranking2/action/GenerateRanking2ReportAction.java	2012-07-24 12:38:31 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ranking2/action/GenerateRanking2ReportAction.java	2014-04-01 09:30:29 +0000
@@ -61,13 +61,14 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
+	/*
     private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     private ReportService reportService;
 
     public void setReportService( ReportService reportService )
@@ -126,13 +127,21 @@
     {
         this.reportList = reportList;
     }
-
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
 
     private int availablePeriods;
 
@@ -192,10 +201,10 @@
     public String execute()
         throws Exception
     {
-        System.out.println( ouIDTB + "-" + availablePeriods + "" + aggData );
-
-
-        statementManager.initialise();
+        //System.out.println( ouIDTB + "-" + availablePeriods + "" + aggData );
+
+
+        //statementManager.initialise();
         // Initialization
         simpleDateFormat = new SimpleDateFormat( "MMM-yyyy" );
         defaultDateFromat = new SimpleDateFormat( "yyyy-MM-dd" );
@@ -213,7 +222,7 @@
         selectedOrgUnit = new OrganisationUnit();
         selectedOrgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
 
-        orgUnitList = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( ouIDTB ) );
+        orgUnitList = new ArrayList<OrganisationUnit>( organisationUnitService.getOrganisationUnitWithChildren( selectedOrgUnit.getId() ) );
 
         if ( orgUnitGroup != 0 )
         {
@@ -356,7 +365,7 @@
                 {
                     tempStr = "" + Double.parseDouble( tempStr ) * monthDays[ month ];
                 }
-                System.out.println( tempStr + " : " + month + " : " + year );
+                //System.out.println( tempStr + " : " + month + " : " + year );
             }            
             else if ( sType.equalsIgnoreCase( "dataelement" ) )
             {
@@ -400,7 +409,7 @@
 
         outputReportFile.deleteOnExit();
 
-        statementManager.destroy();
+        //statementManager.destroy();
 
 
         return SUCCESS;

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ranking2/action/Ranking2ReportFormAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ranking2/action/Ranking2ReportFormAction.java	2012-07-24 12:38:31 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/ranking2/action/Ranking2ReportFormAction.java	2013-09-19 06:34:31 +0000
@@ -3,19 +3,21 @@
 
 import java.text.SimpleDateFormat;
 import java.util.ArrayList;
-import java.util.Collection;
+import java.util.Iterator;
 import java.util.List;
 
-import org.hisp.dhis.organisationunit.OrganisationUnitGroup;
-import org.hisp.dhis.organisationunit.OrganisationUnitGroupService;
 import org.hisp.dhis.period.MonthlyPeriodType;
 import org.hisp.dhis.period.Period;
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
+
+import com.opensymphony.xwork2.Action;
+import java.util.Collection;
+import org.hisp.dhis.organisationunit.OrganisationUnitGroup;
+import org.hisp.dhis.organisationunit.OrganisationUnitGroupService;
+import org.hisp.dhis.report.Report;
 import org.hisp.dhis.reports.ReportType;
 
-import com.opensymphony.xwork2.Action;
-
 public class Ranking2ReportFormAction implements Action
 {
     // -------------------------------------------------------------------------

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/reportmanagement/action/GetReportsAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/reportmanagement/action/GetReportsAction.java	2010-08-19 10:40:50 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/reportmanagement/action/GetReportsAction.java	2014-04-01 11:43:55 +0000
@@ -94,8 +94,8 @@
         {
             try
             {
-                OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( Integer.parseInt( ouId ) );
-
+                //OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( Integer.parseInt( ouId ) );
+                OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( ouId );
                 ouName = orgUnit.getShortName();
 
                 reportList = new ArrayList<Report_in>( reportService.getReportsByPeriodSourceAndReportType(

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/routine/action/GenerateColdChainReportAnalyserResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/routine/action/GenerateColdChainReportAnalyserResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/routine/action/GenerateColdChainReportAnalyserResultAction.java	2014-04-01 09:29:31 +0000
@@ -154,13 +154,23 @@
     {
         this.reportList = reportList;
     }
-
+    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
 
     private int availablePeriods;
 

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/routine/action/GenerateColdChainRoutineReportAnalyserFormAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/routine/action/GenerateColdChainRoutineReportAnalyserFormAction.java	2011-11-02 09:54:19 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/routine/action/GenerateColdChainRoutineReportAnalyserFormAction.java	2014-03-04 12:22:12 +0000
@@ -8,7 +8,6 @@
 import org.hisp.dhis.organisationunit.OrganisationUnitGroup;
 import org.hisp.dhis.organisationunit.OrganisationUnitGroupService;
 import org.hisp.dhis.organisationunit.OrganisationUnitGroupSet;
-import org.hisp.dhis.organisationunit.OrganisationUnitGroupSetPopulator;
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
 import org.hisp.dhis.reports.ReportType;
@@ -86,12 +85,16 @@
             }
         }
         
-        OrganisationUnitGroupSet organisationUnitGroupSet1 = organisationUnitGroupService.getOrganisationUnitGroupSetByName( OrganisationUnitGroupSetPopulator.NAME_TYPE );
+		List<OrganisationUnitGroupSet> organisationUnitGroupSet1List = new ArrayList<OrganisationUnitGroupSet>( organisationUnitGroupService.getOrganisationUnitGroupSetByName( "Type" ) );
+        OrganisationUnitGroupSet organisationUnitGroupSet1 = organisationUnitGroupSet1List.get( 0 );
+		//organisationUnitGroupService.getOrganisationUnitGroupSetByName( OrganisationUnitGroupSetPopulator.NAME_TYPE );
         
         orgUnitGroupMembers = new ArrayList<OrganisationUnitGroup>( organisationUnitGroupSet1.getOrganisationUnitGroups() );
         
-        OrganisationUnitGroupSet organisationUnitGroupSet2 = organisationUnitGroupService.getOrganisationUnitGroupSetByName( OrganisationUnitGroupSetPopulator.NAME_OWNERSHIP );
-        
+		List<OrganisationUnitGroupSet> organisationUnitGroupSet2List = new ArrayList<OrganisationUnitGroupSet>( organisationUnitGroupService.getOrganisationUnitGroupSetByName( "Ownership" ) );
+        //OrganisationUnitGroupSet organisationUnitGroupSet2 = organisationUnitGroupService.getOrganisationUnitGroupSetByName( OrganisationUnitGroupSetPopulator.NAME_OWNERSHIP );
+        OrganisationUnitGroupSet organisationUnitGroupSet2 = organisationUnitGroupSet2List.get( 0 );
+		
         orgUnitGroupMembers.addAll( new ArrayList<OrganisationUnitGroup>( organisationUnitGroupSet2.getOrganisationUnitGroups() ) );
         
         return SUCCESS;

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/routine/action/GenerateRoutineReportAnalyserFormAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/routine/action/GenerateRoutineReportAnalyserFormAction.java	2011-01-11 07:55:01 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/routine/action/GenerateRoutineReportAnalyserFormAction.java	2014-03-04 12:22:49 +0000
@@ -8,7 +8,6 @@
 import org.hisp.dhis.organisationunit.OrganisationUnitGroup;
 import org.hisp.dhis.organisationunit.OrganisationUnitGroupService;
 import org.hisp.dhis.organisationunit.OrganisationUnitGroupSet;
-import org.hisp.dhis.organisationunit.OrganisationUnitGroupSetPopulator;
 import org.hisp.dhis.period.PeriodService;
 import org.hisp.dhis.period.PeriodType;
 import org.hisp.dhis.reports.ReportType;
@@ -77,7 +76,7 @@
         {
             PeriodType type = periodTypeIterator.next();
             
-            if( type.getName().equalsIgnoreCase("Monthly") || type.getName().equalsIgnoreCase("quarterly") || type.getName().equalsIgnoreCase("yearly") || type.getName().equalsIgnoreCase("weekly") || type.getName().equalsIgnoreCase("Daily") )
+            if( type.getName().equalsIgnoreCase("Monthly") || type.getName().equalsIgnoreCase("quarterly") || type.getName().equalsIgnoreCase("yearly") || type.getName().equalsIgnoreCase("weekly") || type.getName().equalsIgnoreCase("Daily") || type.getName().equalsIgnoreCase( "Forteen" ) )
             {
             }
             else
@@ -86,11 +85,13 @@
             }
         }
         
-        OrganisationUnitGroupSet organisationUnitGroupSet1 = organisationUnitGroupService.getOrganisationUnitGroupSetByName( OrganisationUnitGroupSetPopulator.NAME_TYPE );
+	List<OrganisationUnitGroupSet> organisationUnitGroupSet1List = new ArrayList<OrganisationUnitGroupSet>( organisationUnitGroupService.getOrganisationUnitGroupSetByName( "Type" ) );
+        OrganisationUnitGroupSet organisationUnitGroupSet1 = organisationUnitGroupSet1List.get( 0 );
         
         orgUnitGroupMembers = new ArrayList<OrganisationUnitGroup>( organisationUnitGroupSet1.getOrganisationUnitGroups() );
         
-        OrganisationUnitGroupSet organisationUnitGroupSet2 = organisationUnitGroupService.getOrganisationUnitGroupSetByName( OrganisationUnitGroupSetPopulator.NAME_OWNERSHIP );
+        List<OrganisationUnitGroupSet> organisationUnitGroupSet2List = new ArrayList<OrganisationUnitGroupSet>( organisationUnitGroupService.getOrganisationUnitGroupSetByName( "Ownership" ) );
+		OrganisationUnitGroupSet organisationUnitGroupSet2 = organisationUnitGroupSet2List.get( 0 );
         
         orgUnitGroupMembers.addAll( new ArrayList<OrganisationUnitGroup>( organisationUnitGroupSet2.getOrganisationUnitGroups() ) );
         

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/routine/action/GenerateRoutineReportAnalyserResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/routine/action/GenerateRoutineReportAnalyserResultAction.java	2012-02-02 09:56:51 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/routine/action/GenerateRoutineReportAnalyserResultAction.java	2014-04-01 09:28:52 +0000
@@ -31,7 +31,6 @@
 import jxl.write.WritableSheet;
 import jxl.write.WritableWorkbook;
 
-import org.amplecode.quick.StatementManager;
 import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
 import org.hisp.dhis.config.Configuration_IN;
 import org.hisp.dhis.i18n.I18nFormat;
@@ -55,14 +54,14 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-    
+    /*
     private StatementManager statementManager;
 
     public void setStatementManager( StatementManager statementManager )
     {
         this.statementManager = statementManager;
     }
-
+*/
     private OrganisationUnitGroupService organisationUnitGroupService;
 
     public void setOrganisationUnitGroupService( OrganisationUnitGroupService organisationUnitGroupService )
@@ -122,14 +121,23 @@
     {
         this.reportList = reportList;
     }
-
+    
+    /*
     private int ouIDTB;
 
     public void setOuIDTB( int ouIDTB )
     {
         this.ouIDTB = ouIDTB;
     }
-
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
     private int availablePeriods;
 
     public void setAvailablePeriods( int availablePeriods )
@@ -192,7 +200,7 @@
     public String execute()
         throws Exception
     {
-        statementManager.initialise();
+        //statementManager.initialise();
 
         // Initialization
         raFolderName = reportService.getRAFolderName();
@@ -203,6 +211,7 @@
         simpleYearFormat = new SimpleDateFormat( "yy" );
         dailyFormat = new SimpleDateFormat( "yyyy-MM-dd" );
         dateFormat = new SimpleDateFormat( "dd-MM-yyyy" );
+        SimpleDateFormat dateTimeFormat = new SimpleDateFormat( "EEEE, dd MMMM yyyy HH:mm:ss zzzz" );
         String deCodesXMLFileName = "";
         String parentUnit = "";
 
@@ -350,7 +359,7 @@
                 else if ( deCodeString.equalsIgnoreCase( "PERIOD" ) || deCodeString.equalsIgnoreCase( "PERIOD-NOREPEAT" ) )
                 {
                     tempStr = simpleDateFormat.format( sDate );
-                }
+                }                
                 else if ( deCodeString.equalsIgnoreCase( "PERIOD-MONTH" ) )
                 {
                     tempStr = monthFormat.format( sDate );
@@ -771,6 +780,10 @@
                 {
                     tempStr = " ";
                 }
+                else if ( deCodeString.equalsIgnoreCase( "CURRENTDATETIME" ) )
+                {
+                    tempStr = dateTimeFormat.format( new Date() );
+                }
                 else
                 {
                     if ( sType.equalsIgnoreCase( "dataelement" ) )
@@ -1251,7 +1264,7 @@
 
         outputReportFile.deleteOnExit();
 
-        statementManager.destroy();
+        //statementManager.destroy();
 
         return SUCCESS;
     }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/upward/action/GenerateUpwardReportAnalyserResultAction.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/upward/action/GenerateUpwardReportAnalyserResultAction.java	2012-07-02 11:52:26 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/upward/action/GenerateUpwardReportAnalyserResultAction.java	2014-04-01 08:50:05 +0000
@@ -1,16 +1,36 @@
 package org.hisp.dhis.reports.upward.action;
 
 
-import com.opensymphony.xwork2.Action;
+import static org.hisp.dhis.system.util.ConversionUtils.getIdentifiers;
+
+import java.io.BufferedInputStream;
+import java.io.File;
+import java.io.FileInputStream;
+import java.io.InputStream;
+import java.text.SimpleDateFormat;
+import java.util.ArrayList;
+import java.util.Calendar;
+import java.util.Collection;
+import java.util.Collections;
+import java.util.Date;
+import java.util.Iterator;
+import java.util.List;
+import java.util.UUID;
+
 import jxl.CellType;
 import jxl.Workbook;
 import jxl.format.Alignment;
 import jxl.format.Border;
 import jxl.format.BorderLineStyle;
 import jxl.format.CellFormat;
-import jxl.write.*;
+import jxl.write.Blank;
+import jxl.write.Label;
 import jxl.write.Number;
-import org.amplecode.quick.StatementManager;
+import jxl.write.WritableCell;
+import jxl.write.WritableCellFormat;
+import jxl.write.WritableSheet;
+import jxl.write.WritableWorkbook;
+
 import org.hisp.dhis.common.comparator.IdentifiableObjectNameComparator;
 import org.hisp.dhis.config.Configuration_IN;
 import org.hisp.dhis.i18n.I18nFormat;
@@ -22,17 +42,11 @@
 import org.hisp.dhis.reports.Report_in;
 import org.hisp.dhis.reports.Report_inDesign;
 
-import java.io.BufferedInputStream;
-import java.io.File;
-import java.io.FileInputStream;
-import java.io.InputStream;
-import java.text.SimpleDateFormat;
-import java.util.*;
-
-import static org.hisp.dhis.system.util.ConversionUtils.getIdentifiers;
+import com.opensymphony.xwork2.Action;
 
 public class GenerateUpwardReportAnalyserResultAction
-        implements Action {
+    implements Action
+{
 
     private final String GENERATEAGGDATA = "generateaggdata";
 
@@ -42,33 +56,39 @@
     // -------------------------------------------------------------------------
     // Dependencies
     // -------------------------------------------------------------------------
-    private StatementManager statementManager;
+    /*private StatementManager statementManager;
 
-    public void setStatementManager(StatementManager statementManager) {
+    public void setStatementManager( StatementManager statementManager )
+    {
         this.statementManager = statementManager;
     }
+	*/
 
     private ReportService reportService;
 
-    public void setReportService(ReportService reportService) {
+    public void setReportService( ReportService reportService )
+    {
         this.reportService = reportService;
     }
 
     private PeriodService periodService;
 
-    public void setPeriodService(PeriodService periodService) {
+    public void setPeriodService( PeriodService periodService )
+    {
         this.periodService = periodService;
     }
 
     private OrganisationUnitService organisationUnitService;
 
-    public void setOrganisationUnitService(OrganisationUnitService organisationUnitService) {
+    public void setOrganisationUnitService( OrganisationUnitService organisationUnitService )
+    {
         this.organisationUnitService = organisationUnitService;
     }
 
     private I18nFormat format;
 
-    public void setFormat(I18nFormat format) {
+    public void setFormat( I18nFormat format )
+    {
         this.format = format;
     }
 
@@ -78,42 +98,55 @@
 
     private InputStream inputStream;
 
-    public InputStream getInputStream() {
+    public InputStream getInputStream()
+    {
         return inputStream;
     }
 
     private String fileName;
 
-    public String getFileName() {
+    public String getFileName()
+    {
         return fileName;
     }
 
     private String reportList;
 
-    public void setReportList(String reportList) {
+    public void setReportList( String reportList )
+    {
         this.reportList = reportList;
     }
-
+    
+    /*
     private int ouIDTB;
 
-    public void setOuIDTB(int ouIDTB) {
-        this.ouIDTB = ouIDTB;
-    }
-
+    public void setOuIDTB( int ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    */
+    
+    private String ouIDTB;
+    
+    public void setOuIDTB( String ouIDTB )
+    {
+        this.ouIDTB = ouIDTB;
+    }
+    
     private int availablePeriods;
 
-    public void setAvailablePeriods(int availablePeriods) {
+    public void setAvailablePeriods( int availablePeriods )
+    {
         this.availablePeriods = availablePeriods;
     }
-
-    /*
-        private String aggCB;
-
-        public void setAggCB( String aggCB )
-        {
-            this.aggCB = aggCB;
-        }
-    */
+/*
+    private String aggCB;
+
+    public void setAggCB( String aggCB )
+    {
+        this.aggCB = aggCB;
+    }
+*/
     private String reportFileNameTB;
 
     private String reportModelTB;
@@ -133,10 +166,11 @@
     private Date eDate;
 
     private String raFolderName;
-
+    
     private String aggData;
-
-    public void setAggData(String aggData) {
+    
+    public void setAggData( String aggData )
+    {
         this.aggData = aggData;
     }
 
@@ -144,77 +178,85 @@
     // Action Implementation
     // -------------------------------------------------------------------------
     public String execute()
-            throws Exception {
-        statementManager.initialise();
+        throws Exception
+    {
+        //statementManager.initialise();
 
         // Initialization
         raFolderName = reportService.getRAFolderName();
         String deCodesXMLFileName = "";
-        simpleDateFormat = new SimpleDateFormat("MMM-yyyy");
-        monthFormat = new SimpleDateFormat("MMMM");
-        simpleMonthFormat = new SimpleDateFormat("MMM");
+        simpleDateFormat = new SimpleDateFormat( "MMM-yyyy" );
+        monthFormat = new SimpleDateFormat( "MMMM" );
+        simpleMonthFormat = new SimpleDateFormat( "MMM" );
         String parentUnit = "";
-
-        Report_in selReportObj = reportService.getReport(Integer.parseInt(reportList));
-
+        
+        Report_in selReportObj =  reportService.getReport( Integer.parseInt( reportList ) );
+        
         deCodesXMLFileName = selReportObj.getXmlTemplateName();
 
         reportModelTB = selReportObj.getModel();
         reportFileNameTB = selReportObj.getExcelTemplateName();
-
-
-        String inputTemplatePath = System.getenv("DHIS2_HOME") + File.separator + raFolderName + File.separator + "template" + File.separator + reportFileNameTB;
-
-        String outputReportPath = System.getenv("DHIS2_HOME") + File.separator + Configuration_IN.DEFAULT_TEMPFOLDER;
-
-        File newdir=new File(outputReportPath);
-
-        if (!newdir.exists()) {
+        
+
+        String inputTemplatePath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "template" + File.separator + reportFileNameTB;
+        //String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator + raFolderName + File.separator + "output" + File.separator + UUID.randomUUID().toString() + ".xls";
+        
+        String outputReportPath = System.getenv( "DHIS2_HOME" ) + File.separator +  Configuration_IN.DEFAULT_TEMPFOLDER;
+        File newdir = new File( outputReportPath );
+        if( !newdir.exists() )
+        {
             newdir.mkdirs();
         }
         outputReportPath += File.separator + UUID.randomUUID().toString() + ".xls";
-
-        if (reportModelTB.equalsIgnoreCase("DYNAMIC-ORGUNIT")) {
-            OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit(ouIDTB);
-            orgUnitList = new ArrayList<OrganisationUnit>(orgUnit.getChildren());
-            Collections.sort(orgUnitList, new IdentifiableObjectNameComparator());
-        } else if (reportModelTB.equalsIgnoreCase("STATIC") || reportModelTB.equalsIgnoreCase("STATIC-DATAELEMENTS") || reportModelTB.equalsIgnoreCase("STATIC-FINANCIAL")) {
+        
+        if ( reportModelTB.equalsIgnoreCase( "DYNAMIC-ORGUNIT" ) )
+        {
+            OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
+            orgUnitList = new ArrayList<OrganisationUnit>( orgUnit.getChildren() );
+            Collections.sort( orgUnitList, new IdentifiableObjectNameComparator() );
+        }
+        else if ( reportModelTB.equalsIgnoreCase( "STATIC" ) || reportModelTB.equalsIgnoreCase( "STATIC-DATAELEMENTS" ) || reportModelTB.equalsIgnoreCase( "STATIC-FINANCIAL" ) )
+        {
             orgUnitList = new ArrayList<OrganisationUnit>();
-            OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit(ouIDTB);
-            orgUnitList.add(orgUnit);
-        } else if (reportModelTB.equalsIgnoreCase("dynamicwithrootfacility")) {
-            OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit(ouIDTB);
-            orgUnitList = new ArrayList<OrganisationUnit>(orgUnit.getChildren());
-            Collections.sort(orgUnitList, new IdentifiableObjectNameComparator());
-            orgUnitList.add(orgUnit);
+            OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
+            orgUnitList.add( orgUnit );
+        }
+        else if ( reportModelTB.equalsIgnoreCase( "dynamicwithrootfacility" ) )
+        {
+            OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( ouIDTB );
+            orgUnitList = new ArrayList<OrganisationUnit>( orgUnit.getChildren() );
+            Collections.sort( orgUnitList, new IdentifiableObjectNameComparator() );
+            orgUnitList.add( orgUnit );
 
             parentUnit = orgUnit.getName();
         }
 
-        System.out.println(orgUnitList.get(0).getName() + " : " + selReportObj.getName() + " : Report Generation Start Time is : " + new Date());
-
-        selectedPeriod = periodService.getPeriod(availablePeriods);
-
-        sDate = format.parseDate(String.valueOf(selectedPeriod.getStartDate()));
-
-        eDate = format.parseDate(String.valueOf(selectedPeriod.getEndDate()));
-
-        Workbook templateWorkbook = Workbook.getWorkbook(new File(inputTemplatePath));
-
-        WritableWorkbook outputReportWorkbook = Workbook.createWorkbook(new File(outputReportPath), templateWorkbook);
+        System.out.println( orgUnitList.get( 0 ).getName()+ " : " + selReportObj.getName()+" : Report Generation Start Time is : " + new Date() );
+        
+        selectedPeriod = periodService.getPeriod( availablePeriods );
+
+        sDate = format.parseDate( String.valueOf( selectedPeriod.getStartDate() ) );
+
+        eDate = format.parseDate( String.valueOf( selectedPeriod.getEndDate() ) );
+
+        Workbook templateWorkbook = Workbook.getWorkbook( new File( inputTemplatePath ) );
+
+        WritableWorkbook outputReportWorkbook = Workbook.createWorkbook( new File( outputReportPath ), templateWorkbook );
 
         // Getting DataValues
-        List<Report_inDesign> reportDesignList = reportService.getReportDesign(deCodesXMLFileName);
+        List<Report_inDesign> reportDesignList = reportService.getReportDesign( deCodesXMLFileName );
         int orgUnitCount = 0;
 
         Iterator<OrganisationUnit> it = orgUnitList.iterator();
-        while (it.hasNext()) {
+        while ( it.hasNext() )
+        {
             OrganisationUnit currentOrgUnit = (OrganisationUnit) it.next();
 
             int count1 = 0;
             Iterator<Report_inDesign> reportDesignIterator = reportDesignList.iterator();
-            while (reportDesignIterator.hasNext()) {
-                Report_inDesign report_inDesign = reportDesignIterator.next();
+            while ( reportDesignIterator.hasNext() )
+            {
+                Report_inDesign report_inDesign = (Report_inDesign) reportDesignIterator.next();
 
                 String deType = report_inDesign.getPtype();
                 String sType = report_inDesign.getStype();
@@ -223,128 +265,263 @@
 
                 Calendar tempStartDate = Calendar.getInstance();
                 Calendar tempEndDate = Calendar.getInstance();
-                List<Calendar> calendarList = new ArrayList<Calendar>(reportService.getStartingEndingPeriods(deType, selectedPeriod));
-                if (calendarList == null || calendarList.isEmpty()) {
-                    tempStartDate.setTime(selectedPeriod.getStartDate());
-                    tempEndDate.setTime(selectedPeriod.getEndDate());
+                List<Calendar> calendarList = new ArrayList<Calendar>( reportService.getStartingEndingPeriods( deType, selectedPeriod ) );
+                if( calendarList == null || calendarList.isEmpty() )
+                {
+                    tempStartDate.setTime( selectedPeriod.getStartDate() );
+                    tempEndDate.setTime( selectedPeriod.getEndDate() );
                     return SUCCESS;
-                } else {
-                    tempStartDate = calendarList.get(0);
-                    tempEndDate = calendarList.get(1);
+                } 
+                else
+                {
+                    tempStartDate = calendarList.get( 0 );
+                    tempEndDate = calendarList.get( 1 );
                 }
 
-                if (deCodeString.equalsIgnoreCase("FACILITY")) {
+                if( deCodeString.equalsIgnoreCase( "FACILITY" ) )
+                {
                     tempStr = currentOrgUnit.getName();
-                } else if (deCodeString.equalsIgnoreCase("FACILITY-NOREPEAT")) {
+                } 
+                else if( deCodeString.equalsIgnoreCase( "FACILITY-NOREPEAT" ) )
+                {
                     tempStr = parentUnit;
-                } else if (deCodeString.equalsIgnoreCase("FACILITYP")) {
+                } 
+                else if( deCodeString.equalsIgnoreCase( "FACILITYP" ) )
+                {
                     tempStr = currentOrgUnit.getParent().getName();
-                } else if (deCodeString.equalsIgnoreCase("FACILITYPP")) {
+                } 
+                else if( deCodeString.equalsIgnoreCase( "FACILITYPP" ) )
+                {
                     tempStr = currentOrgUnit.getParent().getParent().getName();
-                } else if (deCodeString.equalsIgnoreCase("FACILITYPPP")) {
+                } 
+                else if( deCodeString.equalsIgnoreCase( "FACILITYPPP" ) )
+                {
                     tempStr = currentOrgUnit.getParent().getParent().getParent().getName();
-                } else if (deCodeString.equalsIgnoreCase("FACILITYPPPP")) {
+                } 
+                else if( deCodeString.equalsIgnoreCase( "FACILITYPPPP" ) )
+                {
                     tempStr = currentOrgUnit.getParent().getParent().getParent().getParent().getName();
-                } else if (deCodeString.equalsIgnoreCase("PERIOD") || deCodeString.equalsIgnoreCase("PERIOD-NOREPEAT")) {
-                    tempStr = simpleDateFormat.format(sDate);
-                } else if (deCodeString.equalsIgnoreCase("PERIOD-MONTH")) {
-                    tempStr = monthFormat.format(sDate);
-                } else if (deCodeString.equalsIgnoreCase("MONTH-START-SHORT")) {
-                    tempStr = simpleMonthFormat.format(sDate);
-                } else if (deCodeString.equalsIgnoreCase("MONTH-END-SHORT")) {
-                    tempStr = simpleMonthFormat.format(eDate);
-                } else if (deCodeString.equalsIgnoreCase("MONTH-START")) {
-                    tempStr = monthFormat.format(sDate);
-                } else if (deCodeString.equalsIgnoreCase("MONTH-END")) {
-                    tempStr = monthFormat.format(eDate);
-                } else if (deCodeString.equalsIgnoreCase("SLNO")) {
-                    tempStr = "" + (orgUnitCount + 1);
-                } else if (deCodeString.equalsIgnoreCase("NA")) {
+                } 
+                else if( deCodeString.equalsIgnoreCase( "PERIOD" ) || deCodeString.equalsIgnoreCase( "PERIOD-NOREPEAT" ) )
+                {
+                    tempStr = simpleDateFormat.format( sDate );
+                } 
+                else if( deCodeString.equalsIgnoreCase( "PERIOD-MONTH" ) )
+                {
+                    tempStr = monthFormat.format( sDate );
+                } 
+                else if( deCodeString.equalsIgnoreCase( "MONTH-START-SHORT" ) )
+                {
+                    tempStr = simpleMonthFormat.format( sDate );
+                } 
+                else if( deCodeString.equalsIgnoreCase( "MONTH-END-SHORT" ) )
+                {
+                    tempStr = simpleMonthFormat.format( eDate );
+                } 
+                else if( deCodeString.equalsIgnoreCase( "MONTH-START" ) )
+                {
+                    tempStr = monthFormat.format( sDate );
+                } 
+                else if( deCodeString.equalsIgnoreCase( "MONTH-END" ) )
+                {
+                    tempStr = monthFormat.format( eDate );
+                } 
+                else if( deCodeString.equalsIgnoreCase( "SLNO" ) )
+                {
+                    tempStr = "" + ( orgUnitCount + 1 );
+                } 
+                else if( deCodeString.equalsIgnoreCase( "NA" ) )
+                {
                     tempStr = " ";
-                } else {
-                    if (sType.equalsIgnoreCase("dataelement")) {
-                        if (aggData.equalsIgnoreCase(USECAPTUREDDATA)) {
-                            tempStr = reportService.getIndividualResultDataValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB);
-                        } else if (aggData.equalsIgnoreCase(GENERATEAGGDATA)) {
-                            tempStr = reportService.getResultDataValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB);
-                        } else if (aggData.equalsIgnoreCase(USEEXISTINGAGGDATA)) {
-                            List<Period> periodList = new ArrayList<Period>(periodService.getPeriodsBetweenDates(tempStartDate.getTime(), tempEndDate.getTime()));
-                            Collection<Integer> periodIds = new ArrayList<Integer>(getIdentifiers(Period.class, periodList));
-                            tempStr = reportService.getResultDataValueFromAggregateTable(deCodeString, periodIds, currentOrgUnit, reportModelTB);
-                        }
-                    } else if (sType.equalsIgnoreCase("dataelement-boolean")) {
-                        if (aggData.equalsIgnoreCase(USECAPTUREDDATA)) {
-                            tempStr = reportService.getBooleanDataValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB);
-                        } else if (aggData.equalsIgnoreCase(GENERATEAGGDATA)) {
-                            tempStr = reportService.getBooleanDataValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB);
-                        } else if (aggData.equalsIgnoreCase(USEEXISTINGAGGDATA)) {
-                            tempStr = reportService.getBooleanDataValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB);
-                        }
-
-                    } else {
-                        if (aggData.equalsIgnoreCase(USECAPTUREDDATA)) {
-                            tempStr = reportService.getIndividualResultIndicatorValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit);
-                        } else if (aggData.equalsIgnoreCase(GENERATEAGGDATA)) {
-                            tempStr = reportService.getResultIndicatorValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit);
-                        } else if (aggData.equalsIgnoreCase(USEEXISTINGAGGDATA)) {
-                            List<Period> periodList = new ArrayList<Period>(periodService.getPeriodsBetweenDates(tempStartDate.getTime(), tempEndDate.getTime()));
-                            Collection<Integer> periodIds = new ArrayList<Integer>(getIdentifiers(Period.class, periodList));
-                            tempStr = reportService.getResultDataValueFromAggregateTable(deCodeString, periodIds, currentOrgUnit, reportModelTB);
+                } 
+                else
+                {
+                    if( sType.equalsIgnoreCase( "dataelement" ) )
+                    {
+                        if ( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
+                        {
+                            tempStr = reportService.getIndividualResultDataValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB );
+                           
+                            if ( deCodeString.equalsIgnoreCase( "[1.1]" ) || deCodeString.equalsIgnoreCase( "[2.1]" ) || deCodeString.equalsIgnoreCase( "[153.1]" ) 
+                                || deCodeString.equalsIgnoreCase( "[155.1]" ) || deCodeString.equalsIgnoreCase( "[157.1]" ) || deCodeString.equalsIgnoreCase( "[158.1]" )
+                                || deCodeString.equalsIgnoreCase( "[160.1]" ) )
+                            {
+                                //System.out.println( " USECAPTUREDDATA Before Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                                
+                                if( tempStr.equalsIgnoreCase( "0.0" ) )
+                                {
+                                    tempStr = ""+ 1.0;
+                                }
+                                else if ( tempStr.equalsIgnoreCase( "1.0" ) )
+                                {
+                                    tempStr = ""+ 0.0;
+                                }
+                                else
+                                {
+                                }
+                                //System.out.println( " USECAPTUREDDATA After Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                            }
+                        
+                        } 
+                        else if( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
+                        {
+                            tempStr = reportService.getResultDataValue( deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB );
+                            
+                            if ( deCodeString.equalsIgnoreCase( "[1.1]" ) || deCodeString.equalsIgnoreCase( "[2.1]" ) || deCodeString.equalsIgnoreCase( "[153.1]" ) 
+                                || deCodeString.equalsIgnoreCase( "[155.1]" ) || deCodeString.equalsIgnoreCase( "[157.1]" ) || deCodeString.equalsIgnoreCase( "[158.1]" )
+                                || deCodeString.equalsIgnoreCase( "[160.1]" ) )
+                            {
+                                //System.out.println( " GENERATEAGGDATA Before Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                                
+                                if( tempStr.equalsIgnoreCase( "0.0" ) )
+                                {
+                                    tempStr = ""+ 1.0;
+                                }
+                                else if ( tempStr.equalsIgnoreCase( "1.0" ) )
+                                {
+                                    tempStr = ""+ 0.0;
+                                }
+                                else
+                                {
+                                }
+                                //System.out.println( " GENERATEAGGDATA After Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                            }
+                            
+                        }
+                        else if( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
+                        {
+                            List<Period> periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates( tempStartDate.getTime(), tempEndDate.getTime() ) );
+                            Collection<Integer> periodIds = new ArrayList<Integer>( getIdentifiers(Period.class, periodList ) );
+                            tempStr = reportService.getResultDataValueFromAggregateTable( deCodeString, periodIds, currentOrgUnit, reportModelTB );
+                            
+                            if ( deCodeString.equalsIgnoreCase( "[1.1]" ) || deCodeString.equalsIgnoreCase( "[2.1]" ) || deCodeString.equalsIgnoreCase( "[153.1]" ) 
+                                || deCodeString.equalsIgnoreCase( "[155.1]" ) || deCodeString.equalsIgnoreCase( "[157.1]" ) || deCodeString.equalsIgnoreCase( "[158.1]" )
+                                || deCodeString.equalsIgnoreCase( "[160.1]" ) )
+                            {
+                                //System.out.println( " USEEXISTINGAGGDATA Before Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                                
+                                if( tempStr.equalsIgnoreCase( "0.0" ) )
+                                {
+                                    tempStr = ""+ 1.0;
+                                }
+                                else if ( tempStr.equalsIgnoreCase( "1.0" ) )
+                                {
+                                    tempStr = ""+ 0.0;
+                                }
+                                else
+                                {
+                                }
+                                //System.out.println( "  USEEXISTINGAGGDATA After Converting : SType : " + sType + " DECode : " + deCodeString + "   TempStr : " + tempStr );
+                            }
+                        }
+                    } 
+                    else if ( sType.equalsIgnoreCase( "dataelement-boolean" ) )
+                    {
+                        if ( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
+                        {
+                            tempStr = reportService.getBooleanDataValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB);
+                        } 
+                        else if( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
+                        {
+                            tempStr = reportService.getBooleanDataValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB);
+                        }
+                        else if( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
+                        {
+                            tempStr = reportService.getBooleanDataValue(deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit, reportModelTB);
+                        }
+                        
+                    }
+                    else
+                    {
+                        if ( aggData.equalsIgnoreCase( USECAPTUREDDATA ) )
+                        {
+                            tempStr = reportService.getIndividualResultIndicatorValue( deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit );
+                        } 
+                        else if( aggData.equalsIgnoreCase( GENERATEAGGDATA ) )
+                        {
+                            tempStr = reportService.getResultIndicatorValue( deCodeString, tempStartDate.getTime(), tempEndDate.getTime(), currentOrgUnit );
+                        }     
+                        else if( aggData.equalsIgnoreCase( USEEXISTINGAGGDATA ) )
+                        {
+                            List<Period> periodList = new ArrayList<Period>( periodService.getPeriodsBetweenDates( tempStartDate.getTime(), tempEndDate.getTime() ) );
+                            Collection<Integer> periodIds = new ArrayList<Integer>( getIdentifiers(Period.class, periodList ) );
+                            tempStr = reportService.getResultDataValueFromAggregateTable( deCodeString, periodIds, currentOrgUnit, reportModelTB );
                         }
                     }
                 }
-
+        
                 int tempRowNo = report_inDesign.getRowno();
                 int tempColNo = report_inDesign.getColno();
                 int sheetNo = report_inDesign.getSheetno();
-                WritableSheet sheet0 = outputReportWorkbook.getSheet(sheetNo);
-
-                if (tempStr == null || tempStr.equals(" ")) {
+                WritableSheet sheet0 = outputReportWorkbook.getSheet( sheetNo );
+                
+                if ( tempStr == null || tempStr.equals( " " ) )
+                {
                     tempColNo += orgUnitCount;
-
+        
                     WritableCellFormat wCellformat = new WritableCellFormat();
-                    wCellformat.setBorder(Border.ALL, BorderLineStyle.THIN);
-                    wCellformat.setWrap(true);
-                    wCellformat.setAlignment(Alignment.CENTRE);
-
-                    sheet0.addCell(new Blank(tempColNo, tempRowNo, wCellformat));
-                }
-                else {
-                    if (reportModelTB.equalsIgnoreCase("DYNAMIC-ORGUNIT")) {
-                        if (deCodeString.equalsIgnoreCase("FACILITYP") || deCodeString.equalsIgnoreCase("FACILITYPP") || deCodeString.equalsIgnoreCase("FACILITYPPP") || deCodeString.equalsIgnoreCase("FACILITYPPPP")) {
-                        } else if (deCodeString.equalsIgnoreCase("PERIOD") || deCodeString.equalsIgnoreCase("PERIOD-NOREPEAT") || deCodeString.equalsIgnoreCase("PERIOD-WEEK") || deCodeString.equalsIgnoreCase("PERIOD-MONTH") || deCodeString.equalsIgnoreCase("PERIOD-QUARTER") || deCodeString.equalsIgnoreCase("PERIOD-YEAR") || deCodeString.equalsIgnoreCase("MONTH-START") || deCodeString.equalsIgnoreCase("MONTH-END") || deCodeString.equalsIgnoreCase("MONTH-START-SHORT") || deCodeString.equalsIgnoreCase("MONTH-END-SHORT") || deCodeString.equalsIgnoreCase("SIMPLE-QUARTER") || deCodeString.equalsIgnoreCase("QUARTER-MONTHS-SHORT") || deCodeString.equalsIgnoreCase("QUARTER-MONTHS") || deCodeString.equalsIgnoreCase("QUARTER-START-SHORT") || deCodeString.equalsIgnoreCase("QUARTER-END-SHORT") || deCodeString.equalsIgnoreCase("QUARTER-START") || deCodeString.equalsIgnoreCase("QUARTER-END") || deCodeString.equalsIgnoreCase("SIMPLE-YEAR") || deCodeString.equalsIgnoreCase("YEAR-END") || deCodeString.equalsIgnoreCase("YEAR-FROMTO")) {
-                        } else {
+                    wCellformat.setBorder( Border.ALL, BorderLineStyle.THIN );
+                    wCellformat.setWrap( true );
+                    wCellformat.setAlignment( Alignment.CENTRE );
+        
+                    sheet0.addCell( new Blank( tempColNo, tempRowNo, wCellformat ) );
+                } 
+                else
+                {
+                    if ( reportModelTB.equalsIgnoreCase( "DYNAMIC-ORGUNIT" ) )
+                    {
+                        if ( deCodeString.equalsIgnoreCase( "FACILITYP" ) || deCodeString.equalsIgnoreCase( "FACILITYPP" ) || deCodeString.equalsIgnoreCase( "FACILITYPPP" ) || deCodeString.equalsIgnoreCase( "FACILITYPPPP" ) )
+                        {
+                        } 
+                        else if ( deCodeString.equalsIgnoreCase( "PERIOD" ) || deCodeString.equalsIgnoreCase( "PERIOD-NOREPEAT" ) || deCodeString.equalsIgnoreCase( "PERIOD-WEEK" ) || deCodeString.equalsIgnoreCase( "PERIOD-MONTH" ) || deCodeString.equalsIgnoreCase( "PERIOD-QUARTER" ) || deCodeString.equalsIgnoreCase( "PERIOD-YEAR" ) || deCodeString.equalsIgnoreCase( "MONTH-START" ) || deCodeString.equalsIgnoreCase( "MONTH-END" ) || deCodeString.equalsIgnoreCase( "MONTH-START-SHORT" ) || deCodeString.equalsIgnoreCase( "MONTH-END-SHORT" ) || deCodeString.equalsIgnoreCase( "SIMPLE-QUARTER" ) || deCodeString.equalsIgnoreCase( "QUARTER-MONTHS-SHORT" ) || deCodeString.equalsIgnoreCase( "QUARTER-MONTHS" ) || deCodeString.equalsIgnoreCase( "QUARTER-START-SHORT" ) || deCodeString.equalsIgnoreCase( "QUARTER-END-SHORT" ) || deCodeString.equalsIgnoreCase( "QUARTER-START" ) || deCodeString.equalsIgnoreCase( "QUARTER-END" ) || deCodeString.equalsIgnoreCase( "SIMPLE-YEAR" ) || deCodeString.equalsIgnoreCase( "YEAR-END" ) || deCodeString.equalsIgnoreCase( "YEAR-FROMTO" ) )
+                        {
+                        }
+                        else
+                        {
                             tempColNo += orgUnitCount;
                         }
-                    } else if (reportModelTB.equalsIgnoreCase("dynamicwithrootfacility")) {
-                        if (deCodeString.equalsIgnoreCase("FACILITYP") || deCodeString.equalsIgnoreCase("FACILITY-NOREPEAT") || deCodeString.equalsIgnoreCase("FACILITYPP") || deCodeString.equalsIgnoreCase("FACILITYPPP") || deCodeString.equalsIgnoreCase("FACILITYPPPP")) {
-                        } else if (deCodeString.equalsIgnoreCase("PERIOD") || deCodeString.equalsIgnoreCase("PERIOD-NOREPEAT") || deCodeString.equalsIgnoreCase("PERIOD-WEEK") || deCodeString.equalsIgnoreCase("PERIOD-MONTH") || deCodeString.equalsIgnoreCase("PERIOD-QUARTER") || deCodeString.equalsIgnoreCase("PERIOD-YEAR") || deCodeString.equalsIgnoreCase("MONTH-START") || deCodeString.equalsIgnoreCase("MONTH-END") || deCodeString.equalsIgnoreCase("MONTH-START-SHORT") || deCodeString.equalsIgnoreCase("MONTH-END-SHORT") || deCodeString.equalsIgnoreCase("SIMPLE-QUARTER") || deCodeString.equalsIgnoreCase("QUARTER-MONTHS-SHORT") || deCodeString.equalsIgnoreCase("QUARTER-MONTHS") || deCodeString.equalsIgnoreCase("QUARTER-START-SHORT") || deCodeString.equalsIgnoreCase("QUARTER-END-SHORT") || deCodeString.equalsIgnoreCase("QUARTER-START") || deCodeString.equalsIgnoreCase("QUARTER-END") || deCodeString.equalsIgnoreCase("SIMPLE-YEAR") || deCodeString.equalsIgnoreCase("YEAR-END") || deCodeString.equalsIgnoreCase("YEAR-FROMTO")) {
-                        } else {
+                    }
+                    else if ( reportModelTB.equalsIgnoreCase( "dynamicwithrootfacility" ) )
+                    {
+                        if ( deCodeString.equalsIgnoreCase( "FACILITYP" ) || deCodeString.equalsIgnoreCase( "FACILITY-NOREPEAT" ) ||  deCodeString.equalsIgnoreCase( "FACILITYPP" ) || deCodeString.equalsIgnoreCase( "FACILITYPPP" ) || deCodeString.equalsIgnoreCase( "FACILITYPPPP" ) )
+                        {
+                        } 
+                        else if ( deCodeString.equalsIgnoreCase( "PERIOD" ) || deCodeString.equalsIgnoreCase( "PERIOD-NOREPEAT" ) || deCodeString.equalsIgnoreCase( "PERIOD-WEEK" ) || deCodeString.equalsIgnoreCase( "PERIOD-MONTH" ) || deCodeString.equalsIgnoreCase( "PERIOD-QUARTER" ) || deCodeString.equalsIgnoreCase( "PERIOD-YEAR" ) || deCodeString.equalsIgnoreCase( "MONTH-START" ) || deCodeString.equalsIgnoreCase( "MONTH-END" ) || deCodeString.equalsIgnoreCase( "MONTH-START-SHORT" ) || deCodeString.equalsIgnoreCase( "MONTH-END-SHORT" ) || deCodeString.equalsIgnoreCase( "SIMPLE-QUARTER" ) || deCodeString.equalsIgnoreCase( "QUARTER-MONTHS-SHORT" ) || deCodeString.equalsIgnoreCase( "QUARTER-MONTHS" ) || deCodeString.equalsIgnoreCase( "QUARTER-START-SHORT" ) || deCodeString.equalsIgnoreCase( "QUARTER-END-SHORT" ) || deCodeString.equalsIgnoreCase( "QUARTER-START" ) || deCodeString.equalsIgnoreCase( "QUARTER-END" ) || deCodeString.equalsIgnoreCase( "SIMPLE-YEAR" ) || deCodeString.equalsIgnoreCase( "YEAR-END" ) || deCodeString.equalsIgnoreCase( "YEAR-FROMTO" ) )
+                        {
+                        } 
+                        else
+                        {
                             tempRowNo += orgUnitCount;
                         }
                     }
-
-                    WritableCell cell = sheet0.getWritableCell(tempColNo, tempRowNo);
-
+    
+                    WritableCell cell = sheet0.getWritableCell( tempColNo, tempRowNo );
+    
                     CellFormat cellFormat = cell.getCellFormat();
                     WritableCellFormat wCellformat = new WritableCellFormat();
-                    wCellformat.setBorder(Border.ALL, BorderLineStyle.THIN);
-                    wCellformat.setWrap(true);
-                    wCellformat.setAlignment(Alignment.CENTRE);
-
-                    if (cell.getType() == CellType.LABEL) {
+                    wCellformat.setBorder( Border.ALL, BorderLineStyle.THIN );
+                    wCellformat.setWrap( true );
+                    wCellformat.setAlignment( Alignment.CENTRE );
+    
+                    if ( cell.getType() == CellType.LABEL )
+                    {
                         Label l = (Label) cell;
-                        l.setString(tempStr);
-                        l.setCellFormat(cellFormat);
-                    } else {
-                        try {
-                            sheet0.addCell(new Number(tempColNo, tempRowNo, Double.parseDouble(tempStr), wCellformat));
-                        } catch (Exception e) {
-                            sheet0.addCell(new Label(tempColNo, tempRowNo, tempStr, wCellformat));
+                        l.setString( tempStr );
+                        l.setCellFormat( cellFormat );
+                    } 
+                    else
+                    {
+                        try
+                        {
+                            sheet0.addCell( new Number( tempColNo, tempRowNo, Double.parseDouble( tempStr ), wCellformat ) );
+                        }
+                        catch( Exception e )
+                        {
+                            sheet0.addCell( new Label( tempColNo, tempRowNo, tempStr, wCellformat ) );
                         }
                     }
                 }
-
+                
                 count1++;
             }// inner while loop end
             orgUnitCount++;
@@ -353,17 +530,17 @@
         outputReportWorkbook.write();
         outputReportWorkbook.close();
 
-        fileName = reportFileNameTB.replace(".xls", "");
-        fileName += "_" + orgUnitList.get(0).getShortName() + "_";
-        fileName += "_" + simpleDateFormat.format(selectedPeriod.getStartDate()) + ".xls";
-        File outputReportFile = new File(outputReportPath);
-        inputStream = new BufferedInputStream(new FileInputStream(outputReportFile));
+        fileName = reportFileNameTB.replace( ".xls", "" );
+        fileName += "_" + orgUnitList.get( 0 ).getShortName() + "_";
+        fileName += "_" + simpleDateFormat.format( selectedPeriod.getStartDate() ) + ".xls";
+        File outputReportFile = new File( outputReportPath );
+        inputStream = new BufferedInputStream( new FileInputStream( outputReportFile ) );
 
-        System.out.println(orgUnitList.get(0).getName() + " : " + selReportObj.getName() + " Report Generation End Time is : " + new Date());
+        System.out.println( orgUnitList.get( 0 ).getName()+ " : " + selReportObj.getName()+" Report Generation End Time is : " + new Date() );
 
         outputReportFile.deleteOnExit();
 
-        statementManager.destroy();
+        //statementManager.destroy();
 
         return SUCCESS;
     }

=== modified file 'local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/util/ReportService.java'
--- local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/util/ReportService.java	2010-12-29 16:17:28 +0000
+++ local/in/dhis-web-reports-national/src/main/java/org/hisp/dhis/reports/util/ReportService.java	2014-03-04 12:24:52 +0000
@@ -382,9 +382,9 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
-
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                    
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod,organisationUnit, optionCombo );
                     if ( dataValue != null )
                     {
                         // Works for both text and boolean data types
@@ -527,8 +527,8 @@
                         double aggregatedValue = 0.0;
                         for ( Period tempPeriod : periodList )
                         {
-                            DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement,
-                                tempPeriod, optionCombo );
+                            //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                            DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod,organisationUnit, optionCombo );
 
                             if ( dataValue != null )
                             {
@@ -562,9 +562,9 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
-
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                    
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod,organisationUnit, optionCombo );
                     if ( dataValue != null )
                     {
                         // Works for both text and boolean data types
@@ -705,9 +705,8 @@
                         tempPeriod = (Period) periodList.get( 0 );
                     }
 
-                    DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod,
-                        optionCombo );
-
+                    //DataValue dataValue = dataValueService.getDataValue( organisationUnit, dataElement, tempPeriod, optionCombo );
+                    DataValue dataValue = dataValueService.getDataValue( dataElement, tempPeriod,organisationUnit, optionCombo );
                     if ( dataValue != null )
                     {
                         // Works for both text and boolean data types

=== modified file 'local/in/dhis-web-reports-national/src/main/resources/META-INF/dhis/beans.xml'
--- local/in/dhis-web-reports-national/src/main/resources/META-INF/dhis/beans.xml	2012-07-26 09:20:56 +0000
+++ local/in/dhis-web-reports-national/src/main/resources/META-INF/dhis/beans.xml	2014-07-05 06:58:35 +0000
@@ -3,24 +3,6 @@
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="
 http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">
-
-
-    <!--Global Config Settings -->
-
-    <bean id="org.hisp.dhis.reports.reportmanagement.action.GenerateGlobalConfigAction"
-          class="org.hisp.dhis.reports.reportmanagement.action.GenerateGlobalConfigAction"
-          scope="prototype">
-        <property name="globalConfigService" ref="org.hisp.dhis.reports.GlobalConfigService">
-        </property>
-    </bean>
-
-
-    <bean id="org.hisp.dhis.reports.reportmanagement.action.DownloadRAFolderAction"
-          class="org.hisp.dhis.reports.reportmanagement.action.DownloadRAFolderAction"
-          scope="prototype">
-        <property name="configurationService" ref="org.hisp.dhis.config.ConfigurationService">
-        </property>
-    </bean>
     
     <!-- Reports -->
     <bean id="org.hisp.dhis.reports.action.ReportsHomePageAction"
@@ -178,7 +160,7 @@
         id="org.hisp.dhis.reports.routine.action.GenerateRoutineReportAnalyserResultAction"
         class="org.hisp.dhis.reports.routine.action.GenerateRoutineReportAnalyserResultAction"
         scope="prototype">
-        <property name="statementManager" ref="statementManager"/>      
+        <!--<property name="statementManager" ref="statementManager"/>-->
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
@@ -196,7 +178,7 @@
         id="org.hisp.dhis.reports.idsp.action.GenerateIDSPReportAnalyserResultAction"
         class="org.hisp.dhis.reports.idsp.action.GenerateIDSPReportAnalyserResultAction"
         scope="prototype">
-        <property name="statementManager" ref="statementManager"/>      
+        <!--<property name="statementManager" ref="statementManager"/>-->
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
@@ -218,7 +200,7 @@
         class="org.hisp.dhis.reports.ed.action.EDReportResultAction"
         scope="prototype">
         
-        <property name="statementManager" ref="statementManager"/>
+        <!--<property name="statementManager" ref="statementManager"/>-->
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
         <property name="indicatorService" ref="org.hisp.dhis.indicator.IndicatorService" />
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
@@ -237,7 +219,7 @@
     <bean id="org.hisp.dhis.reports.ed.action.RankingReportResultAction"
         class="org.hisp.dhis.reports.ed.action.RankingReportResultAction"
         scope="prototype">
-        <property name="statementManager" ref="statementManager"/>
+        <!--<property name="statementManager" ref="statementManager"/>-->
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
         <property name="indicatorService" ref="org.hisp.dhis.indicator.IndicatorService" />
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
@@ -251,32 +233,31 @@
         scope="prototype">
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
 		<property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
+		<property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
     </bean>
-	
+    <bean id="org.hisp.dhis.reports.md.action.GenerateMDReportAnalyserResultAction"
+        class="org.hisp.dhis.reports.md.action.GenerateMDReportAnalyserResultAction"
+        scope="prototype">
+		<!--<property name="statementManager" ref="statementManager"/>-->
+		<property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
+		<property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
+		<property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
+	</bean>
     <bean id="org.hisp.dhis.reports.md.action.GetOrgUnitsAction"
         class="org.hisp.dhis.reports.md.action.GetOrgUnitsAction"
         scope="prototype">
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
-    </bean>	
-
+    </bean>
     <bean id="org.hisp.dhis.reports.md.action.MDReportResultAction"
         class="org.hisp.dhis.reports.md.action.MDReportResultAction"
         scope="prototype">
-        <property name="statementManager" ref="statementManager"/>
+        <!--<property name="statementManager" ref="statementManager"/>-->
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
-    </bean>	
-		
-    <bean id="org.hisp.dhis.reports.md.action.GenerateMDReportAnalyserResultAction"
-        class="org.hisp.dhis.reports.md.action.GenerateMDReportAnalyserResultAction"
-        scope="prototype">
-		<property name="statementManager" ref="statementManager"/>
-		<property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
-		<property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
-		<property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
-	</bean>
+    </bean>
+
 	    
     <!-- Auto Reports -->
     <bean
@@ -290,7 +271,7 @@
         id="org.hisp.dhis.reports.auto.action.GenerateAutoReportAnalyserResultAction"
         class="org.hisp.dhis.reports.auto.action.GenerateAutoReportAnalyserResultAction"
         scope="prototype">
-        <property name="statementManager" ref="statementManager"/>
+        <!--<property name="statementManager" ref="statementManager"/>-->
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
@@ -308,7 +289,7 @@
         id="org.hisp.dhis.reports.auto.action.GenerateLLBulkReportAnalyserResultAction"
         class="org.hisp.dhis.reports.auto.action.GenerateLLBulkReportAnalyserResultAction"
         scope="prototype">
-        <property name="statementManager" ref="statementManager"/>
+        <!--<property name="statementManager" ref="statementManager"/>-->
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
@@ -330,7 +311,7 @@
         class="org.hisp.dhis.reports.aggregation.action.GenerateAggregationReportAnalyserResultAction"
         scope="prototype">
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
-        <property name="statementManager" ref="statementManager" />
+        <!--<property name="statementManager" ref="statementManager" />-->
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
     </bean>
@@ -353,28 +334,27 @@
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
     </bean>
 
-	
     <!--District Feedback Reports -->
 
     <bean
-		id="org.hisp.dhis.reports.districtfeedback.action.GenerateAggregationDistrictFeedbackReportAnalyserFormAction"
-		class="org.hisp.dhis.reports.districtfeedback.action.GenerateAggregationDistrictFeedbackReportAnalyserFormAction"
-		scope="prototype">
+            id="org.hisp.dhis.reports.districtfeedback.action.GenerateAggregationDistrictFeedbackReportAnalyserFormAction"
+            class="org.hisp.dhis.reports.districtfeedback.action.GenerateAggregationDistrictFeedbackReportAnalyserFormAction"
+            scope="prototype">
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
     </bean>
 
     <bean
-		id="org.hisp.dhis.reports.districtfeedback.action.GenerateAggregationDistrictFeedbackReportAnalyserResultAction"
-		class="org.hisp.dhis.reports.districtfeedback.action.GenerateAggregationDistrictFeedbackReportAnalyserResultAction"
-		scope="prototype">
+            id="org.hisp.dhis.reports.districtfeedback.action.GenerateAggregationDistrictFeedbackReportAnalyserResultAction"
+            class="org.hisp.dhis.reports.districtfeedback.action.GenerateAggregationDistrictFeedbackReportAnalyserResultAction"
+            scope="prototype">
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
-        <property name="statementManager" ref="statementManager" />
+        <!--<property name="statementManager" ref="statementManager" />-->
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
         <property name="stateDistrictFeedbackReportService" ref="org.hisp.dhis.reports.StateDistrictFeedbackReportService"/>
         <property name="reportOrgSpecificDataService" ref="org.hisp.dhis.reports.ReportOrgSpecificDataService"/>
-    </bean>	
-		    
+    </bean>
+    
     <!-- Upward / GOI Reports -->
     <bean
         id="org.hisp.dhis.reports.upward.action.GenerateUpwardReportAnalyserFormAction"
@@ -387,11 +367,50 @@
         id="org.hisp.dhis.reports.upward.action.GenerateUpwardReportAnalyserResultAction"
         class="org.hisp.dhis.reports.upward.action.GenerateUpwardReportAnalyserResultAction"
         scope="prototype">
-        <property name="statementManager" ref="statementManager"/>
-        <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
-        <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
-        <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
-    </bean>
+        <!--<property name="statementManager" ref="statementManager"/>-->
+        <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
+        <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
+        <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
+    </bean>
+	
+    <!-- Upward / GOI Reports Monthly -->
+    <bean
+        id="org.hisp.dhis.reports.goimonthly.action.GenerateGOIMonthlyReportAnalyserFormAction"
+        class="org.hisp.dhis.reports.goimonthly.action.GenerateGOIMonthlyReportAnalyserFormAction"
+        scope="prototype">
+        <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
+    </bean>
+    
+    <bean
+        id="org.hisp.dhis.reports.goimonthly.action.GenerateGOIMonthlyReportAnalyserResultAction"
+        class="org.hisp.dhis.reports.goimonthly.action.GenerateGOIMonthlyReportAnalyserResultAction"
+        scope="prototype">
+         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
+         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
+        <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
+    </bean>	
+	
+	<!-- ProgramWise OrgUnitProgress Reports -->	
+	
+    <bean
+        id="org.hisp.dhis.reports.programWiseOrgUnitProgress.action.GenerateProgramWiseOrgUnitProgressReportAnalyserFormAction"
+        class="org.hisp.dhis.reports.programWiseOrgUnitProgress.action.GenerateProgramWiseOrgUnitProgressReportAnalyserFormAction"
+        scope="prototype">
+        <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
+		<property name="organisationUnitGroupService" ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService" />
+    </bean>	
+
+    <bean
+        id="org.hisp.dhis.reports.programWiseOrgUnitProgress.action.GenerateProgramWiseOrgUnitProgressReportAnalyserResultAction"
+        class="org.hisp.dhis.reports.programWiseOrgUnitProgress.action.GenerateProgramWiseOrgUnitProgressReportAnalyserResultAction"
+        scope="prototype">
+        <!--<property name="statementManager" ref="statementManager"/>-->
+        <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
+        <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
+        <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
+		<property name="organisationUnitGroupService" ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService" />
+    </bean>		
+	
     
     <!-- DataSet Lock Reports -->
     <bean
@@ -464,7 +483,7 @@
         class="org.hisp.dhis.reports.linelisting.action.GenerateLinelistingReportAnalyserResultAction"
         scope="prototype">
         
-        <property name="statementManager" ref="statementManager"/>
+        <!--<property name="statementManager" ref="statementManager"/>-->
         
         <property name="dataElementCategoryOptionComboService">
             <ref bean="org.hisp.dhis.dataelement.DataElementCategoryService"/>
@@ -509,7 +528,7 @@
         id="org.hisp.dhis.reports.periodwiseprogress.action.GeneratePeriodWiseProgressAnalyserResultAction"
         class="org.hisp.dhis.reports.periodwiseprogress.action.GeneratePeriodWiseProgressAnalyserResultAction"
         scope="prototype">      
-        <property name="statementManager" ref="statementManager"/>      
+        <!--<property name="statementManager" ref="statementManager"/>-->
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
@@ -530,15 +549,43 @@
         id="org.hisp.dhis.reports.ouwiseprogress.action.GenerateOuWiseProgressReportResultAction"
         class="org.hisp.dhis.reports.ouwiseprogress.action.GenerateOuWiseProgressReportResultAction"
         scope="prototype">
-        <property name="statementManager" ref="statementManager" />
+        <!--<property name="statementManager" ref="statementManager" />-->
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
 		<property name="organisationUnitGroupService" ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService" />
-<!--    <property name="dataSetService" ref="org.hisp.dhis.dataset.DataSetService" />
-        <property name="dataElementService" ref="org.hisp.dhis.dataelement.DataElementService" />-->
+		<property name="dataSetService" ref="org.hisp.dhis.dataset.DataSetService" />
+        <!--<property name="dataElementService" ref="org.hisp.dhis.dataelement.DataElementService" />-->
     </bean>
     
+	
+	
+	
+    <bean
+        id="org.hisp.dhis.reports.periodorgunitserviceprogressreport.action.GeneratePeriodOrgUnitServiseProgressReportAnalyserFormAction"
+        class="org.hisp.dhis.reports.periodorgunitserviceprogressreport.action.GeneratePeriodOrgUnitServiseProgressReportAnalyserFormAction"
+        scope="prototype">
+        <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
+		<property name="organisationUnitGroupService" ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService" />
+    </bean>
+
+    <bean
+        id="org.hisp.dhis.reports.periodorgunitserviceprogressreport.action.GeneratePeriodOrgUnitServiseProgressAnalyserResultAction"
+        class="org.hisp.dhis.reports.periodorgunitserviceprogressreport.action.GeneratePeriodOrgUnitServiseProgressAnalyserResultAction"
+        scope="prototype">      
+        <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
+        <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
+        <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
+		<property name="organisationUnitGroupService" ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService" />
+    </bean>	
+	
+	
+	
+	
+	
+	
+	
+	
     <!-- Meta Data Reports -->
     <bean
         id="org.hisp.dhis.reports.meta.action.GenerateMetaDataReportAnalyserFormAction"
@@ -551,7 +598,7 @@
         id="org.hisp.dhis.reports.meta.action.GenerateMetaDataReportResultAction"
         class="org.hisp.dhis.reports.meta.action.GenerateMetaDataReportResultAction"
         scope="prototype">
-        <property name="statementManager" ref="statementManager" />
+        <!--<property name="statementManager" ref="statementManager" />-->
         <property name="dataElementService" ref="org.hisp.dhis.dataelement.DataElementService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService"/>
         <property name="organisationUnitgroupService" ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService" />
@@ -559,7 +606,7 @@
         <property name="indicatorService" ref="org.hisp.dhis.indicator.IndicatorService" />
         <property name="validationRuleService" ref="org.hisp.dhis.validation.ValidationRuleService" />
         <!--<property name="userStore" ref="org.hisp.dhis.user.UserStore" />-->
-		<property name="userService" ref="org.hisp.dhis.user.UserService" />
+        <property name="userService" ref="org.hisp.dhis.user.UserService" />
         <property name="expressionService" ref="org.hisp.dhis.expression.ExpressionService" />
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService"/>
         <property name="jdbcTemplate" ref="jdbcTemplate"/>
@@ -580,7 +627,7 @@
         class="org.hisp.dhis.reports.advanced.action.GenerateAdvancedReportResultAction"
         scope="prototype">
         
-        <property name="statementManager" ref="statementManager"/>
+        <!--<property name="statementManager" ref="statementManager"/>-->
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService">
         </property>
         <property name="organisationUnitService">
@@ -620,7 +667,7 @@
         class="org.hisp.dhis.reports.leprosy.action.LeprosyReportResultAction"
         scope="prototype">
         
-        <property name="statementManager" ref="statementManager"/>
+        <!--<property name="statementManager" ref="statementManager"/>-->
         <property name="reportService">
             <ref bean="org.hisp.dhis.reports.util.ReportService"/>
         </property>
@@ -663,7 +710,7 @@
         class="org.hisp.dhis.reports.malarya.action.GenerateMalaryaReportResultAction"
         scope="prototype">
         
-        <property name="statementManager" ref="statementManager"/>
+        <!--<property name="statementManager" ref="statementManager"/>-->
         <property name="reportService">
             <ref bean="org.hisp.dhis.reports.util.ReportService"/>
         </property>
@@ -943,7 +990,7 @@
         class="org.hisp.dhis.reports.ranking.action.GenerateRankingReportResultAction"
         scope="prototype">
         
-        <property name="statementManager" ref="statementManager"/>
+        <!--<property name="statementManager" ref="statementManager"/>-->
         <property name="reportService">
             <ref bean="org.hisp.dhis.reports.util.ReportService"/>
         </property>
@@ -1023,7 +1070,7 @@
         <property name="reportService">
             <ref bean="org.hisp.dhis.reports.util.ReportService"/>
         </property>
-        <property name="statementManager" ref="statementManager"/>
+        <!--<property name="statementManager" ref="statementManager"/>-->
         <property name="organisationUnitGroupService">
             <ref
                 bean="org.hisp.dhis.organisationunit.OrganisationUnitGroupService"/>
@@ -1100,12 +1147,9 @@
     <bean id="org.hisp.dhis.reports.action.AddUserAction"
         class="org.hisp.dhis.reports.action.AddUserAction" scope="prototype">
         
-        <property name="userService">
-            <ref bean="org.hisp.dhis.user.UserService"/>
-        </property>
-<!--	<property name="userStore">
+        <property name="userStore">
             <ref bean="org.hisp.dhis.user.UserStore"/>
-        </property>-->	
+        </property>
         <property name="passwordManager">
             <ref bean="org.hisp.dhis.security.PasswordManager"/>
         </property>
@@ -1122,12 +1166,9 @@
     <bean id="org.hisp.dhis.reports.action.AddMultipleUserAction"
         class="org.hisp.dhis.reports.action.AddMultipleUserAction" scope="prototype">
         
-<!--    <property name="userStore">
+        <property name="userStore">
             <ref bean="org.hisp.dhis.user.UserStore"/>
-        </property>-->
-        <property name="userService">
-            <ref bean="org.hisp.dhis.user.UserService"/>
-        </property>		
+        </property>
         <property name="passwordManager">
             <ref bean="org.hisp.dhis.security.PasswordManager"/>
         </property>
@@ -1165,7 +1206,24 @@
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService">
         </property>
     </bean>
-    <bean id="org.hisp.dhis.reports.action.GetProgressReportsAction"
+    
+	
+	<!-- get Program List -->	
+    <bean id="org.hisp.dhis.reports.action.GetProgramListAction"
+        class="org.hisp.dhis.reports.action.GetProgramListAction" scope="prototype">
+        <property name="organisationUnitService">
+            <ref bean="org.hisp.dhis.organisationunit.OrganisationUnitService"/>
+        </property>
+		<property name="reportService">
+            <ref bean="org.hisp.dhis.reports.ReportService"/>
+        </property>
+    </bean>		
+	
+	
+	
+	
+	
+	<bean id="org.hisp.dhis.reports.action.GetProgressReportsAction"
         class="org.hisp.dhis.reports.action.GetProgressReportsAction"
         scope="prototype">
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService">
@@ -1202,7 +1260,7 @@
     
     <bean id="org.hisp.dhis.reports.physical.action.GeneratePhysicalReportResultAction"
         class="org.hisp.dhis.reports.physical.action.GeneratePhysicalReportResultAction" scope="prototype">
-        <property name="statementManager" ref="statementManager" />
+        <!--<property name="statementManager" ref="statementManager" />-->
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
         <property name="currentUserService" ref="org.hisp.dhis.user.CurrentUserService" />
@@ -1220,7 +1278,7 @@
         id="org.hisp.dhis.reports.csreview.action.GenerateCSReviewReportResultAction"
         class="org.hisp.dhis.reports.csreview.action.GenerateCSReviewReportResultAction"
         scope="prototype">
-        <property name="statementManager" ref="statementManager" />
+        <!--<property name="statementManager" ref="statementManager" />-->
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
         <property name="currentUserService" ref="org.hisp.dhis.user.CurrentUserService" />
@@ -1229,7 +1287,7 @@
 
 <!-- NBITS Reports Section -->  
     <!-- NBITS : Activity Plan Report -->
-    
+    <!--
     <bean
         id="org.hisp.dhis.reports.activeplan.action.ActivePlanReportsFormAction"
         class="org.hisp.dhis.reports.activeplan.action.ActivePlanReportsFormAction"
@@ -1241,6 +1299,7 @@
         </property>
     </bean>
     
+	
     <bean
         id="org.hisp.dhis.reports.activeplan.action.ActivePlanReportsResultAction"
         class="org.hisp.dhis.reports.activeplan.action.ActivePlanReportsResultAction"
@@ -1309,21 +1368,22 @@
         </property>
         <property name="jdbcTemplate" ref="jdbcTemplate"/>
     </bean>
-    
+    -->
+	
     <!-- NBITS : BenificiaryInfo Report -->
     
     <bean
         id="org.hisp.dhis.reports.benificiaryinfo.action.BenificiaryInfoReportsFormAction"
         class="org.hisp.dhis.reports.benificiaryinfo.action.BenificiaryInfoReportsFormAction"
         scope="prototype">
-        <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
+        <!-- <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />-->
     </bean>
     
     <bean
         id="org.hisp.dhis.reports.benificiaryinfo.action.BenificiaryInfoReportsResultAction"
         class="org.hisp.dhis.reports.benificiaryinfo.action.BenificiaryInfoReportsResultAction"
         scope="prototype">
-        
+        <!-- 
         <property name="statementManager" ref="statementManager"/>
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService">
         </property>
@@ -1358,6 +1418,7 @@
         <property name="relationshipTypeService">
             <ref bean="org.hisp.dhis.relationship.RelationshipTypeService"/>
         </property>
+        -->
     </bean>
 
 <!-- Patient Information Reports 20/03/2012 -->	
@@ -1375,23 +1436,26 @@
         id="org.hisp.dhis.reports.benificiaryinfo.action.GetRegistredPatientInformationAction"
         class="org.hisp.dhis.reports.benificiaryinfo.action.GetRegistredPatientInformationAction"
         scope="prototype">
+        <!-- 
 		<property name="patientAttributeValueService" ref="org.hisp.dhis.patientattributevalue.PatientAttributeValueService" />
 		<property name="patientAttributeService"
 			ref="org.hisp.dhis.patient.PatientAttributeService" />
 		<property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
 		<property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
 		<property name="patientService" ref="org.hisp.dhis.patient.PatientService" />
+		<property name="selectionManager" ref="org.hisp.dhis.ouwt.manager.OrganisationUnitSelectionManager" />
+		-->
     </bean>	
 
 	<bean id="org.hisp.dhis.reports.benificiaryinfo.action.GetPatientDetailsAction"
 		class="org.hisp.dhis.reports.benificiaryinfo.action.GetPatientDetailsAction" scope="prototype">
 		<property name="patientService" ref="org.hisp.dhis.patient.PatientService" />
 		<!--<property name="patientIdentifierService"
-			ref="org.hisp.dhis.patient.PatientIdentifierService" />-->
-		<!--<property name="programService" ref="org.hisp.dhis.program.ProgramService" />-->
+			ref="org.hisp.dhis.patient.PatientIdentifierService" />
+		<property name="programService" ref="org.hisp.dhis.program.ProgramService" />
 		<property name="patientAttributeValueService"
 			ref="org.hisp.dhis.patientattributevalue.PatientAttributeValueService" />
-		<!--<property name="patientAttributeService">
+		<property name="patientAttributeService">
 			<ref bean="org.hisp.dhis.patient.PatientAttributeService" />
 		</property>
 		<property name="patientAttributeGroupService"
@@ -1417,7 +1481,7 @@
 	
 			
     <!-- NBITS : Portal Reports -->
-    
+    <!--
     <bean id="org.hisp.dhis.reports.portal.action.PortalReportsFormAction"
         class="org.hisp.dhis.reports.portal.action.PortalReportsFormAction"
         scope="prototype">
@@ -1494,10 +1558,11 @@
 		<property name="dataElementCategoryOptionComboService" ref="org.hisp.dhis.dataelement.DataElementCategoryService" />
         <property name="jdbcTemplate" ref="jdbcTemplate"/>        
     </bean>
-
+-->
     <bean id="org.hisp.dhis.reports.portal.action.PortalReportsResult_ACS"
         class="org.hisp.dhis.reports.portal.action.PortalReportsResult_ACS"
         scope="prototype">
+        <!-- 
         <property name="reportService" ref="org.hisp.dhis.reports.util.ReportService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
         <property name="patientService" ref="org.hisp.dhis.patient.PatientService" />
@@ -1506,7 +1571,8 @@
         <property name="patientDataValueService" ref="org.hisp.dhis.patientdatavalue.PatientDataValueService" />
 		<property name="dataElementService" ref="org.hisp.dhis.dataelement.DataElementService" />
 		<property name="dataElementCategoryOptionComboService" ref="org.hisp.dhis.dataelement.DataElementCategoryService" />
-        <property name="jdbcTemplate" ref="jdbcTemplate"/>        
+        <property name="jdbcTemplate" ref="jdbcTemplate"/>
+        -->        
     </bean>	
 
     <!-- NBITS Reports -->
@@ -1518,6 +1584,7 @@
     <bean id="org.hisp.dhis.reports.nbits.action.NBITSReportResultAction"
         class="org.hisp.dhis.reports.nbits.action.NBITSReportResultAction"
         scope="prototype">
+        <!-- 
         <property name="statementManager" ref="statementManager" />
         <property name="reportService" ref="org.hisp.dhis.reports.util.ReportService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
@@ -1526,7 +1593,34 @@
         <property name="patientAttributeService" ref="org.hisp.dhis.patient.PatientAttributeService" />
         <property name="programService" ref="org.hisp.dhis.program.ProgramService" />
         <property name="jdbcTemplate" ref="jdbcTemplate"/>
-    </bean>
+        -->
+    </bean>
+
+
+    <!-- Due Date Reports -->
+    <bean id="org.hisp.dhis.reports.activeplan.action.ActivePlanDueDatesReportFormAction"
+        class="org.hisp.dhis.reports.activeplan.action.ActivePlanDueDatesReportFormAction"
+        scope="prototype">
+        <!--<property name="programService" ref="org.hisp.dhis.program.ProgramService" />-->
+		<property name="selectionTreeManager" ref="org.hisp.dhis.oust.manager.SelectionTreeManager" />
+		<property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
+    </bean>
+
+    <bean id="org.hisp.dhis.reports.activeplan.action.ActivePlanDueDatesReportResultAction"
+        class="org.hisp.dhis.reports.activeplan.action.ActivePlanDueDatesReportResultAction"
+        scope="prototype">
+        <!-- 
+		<property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
+		<property name="programService" ref="org.hisp.dhis.program.ProgramService" />
+		<property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
+		<property name="patientAttributeValueService" ref="org.hisp.dhis.patientattributevalue.PatientAttributeValueService" />
+		<property name="jdbcTemplate" ref="jdbcTemplate"/>
+		-->
+    </bean>		
+
+
+
+
     
 	
 	<!-- Linelisting web-Portal Reports -->
@@ -1545,7 +1639,7 @@
 		class="org.hisp.dhis.reports.linelisting.action.GenerateLinelistingWebPortalReportAnalyserResultAction"
 		scope="prototype">
 		
-		<property name="statementManager" ref="statementManager"/>
+		<!--<property name="statementManager" ref="statementManager"/>-->
 		
 		<property name="dataElementCategoryOptionComboService">
 			<ref bean="org.hisp.dhis.dataelement.DataElementCategoryService"/>
@@ -1576,6 +1670,8 @@
 		</property>
 		<property name="jdbcTemplate" ref="jdbcTemplate"/>
 	</bean>	
+	
+	
 		<!-- Cold-Chain Reports -->
 	
     <bean
@@ -1613,11 +1709,23 @@
         id="org.hisp.dhis.reports.ranking2.action.GenerateRanking2ReportAction"
         class="org.hisp.dhis.reports.ranking2.action.GenerateRanking2ReportAction"
         scope="prototype">
+        <!--<property name="statementManager" ref="statementManager"/>-->
+        <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
+        <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
+        <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
+		<property name="organisationUnitGroupService" ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService" />
+    </bean>
+	
+   <!-- ranking2 Reports for STATE -->
+   <bean
+        id="org.hisp.dhis.reports.ranking2.action.GenerateStateRanking2ReportAction"
+        class="org.hisp.dhis.reports.ranking2.action.GenerateStateRanking2ReportAction"
+        scope="prototype">
         <property name="statementManager" ref="statementManager"/>
         <property name="reportService" ref="org.hisp.dhis.reports.ReportService" />
         <property name="organisationUnitService" ref="org.hisp.dhis.organisationunit.OrganisationUnitService" />
         <property name="periodService" ref="org.hisp.dhis.period.PeriodService" />
 		<property name="organisationUnitGroupService" ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService" />
-    </bean>
-			
+    </bean>	
+	
 </beans>

=== modified file 'local/in/dhis-web-reports-national/src/main/resources/org/hisp/dhis/reports/i18n_module.properties'
--- local/in/dhis-web-reports-national/src/main/resources/org/hisp/dhis/reports/i18n_module.properties	2012-08-18 05:34:21 +0000
+++ local/in/dhis-web-reports-national/src/main/resources/org/hisp/dhis/reports/i18n_module.properties	2013-09-19 06:34:31 +0000
@@ -320,7 +320,7 @@
 search_result_matching_the_search_criteria = Result matches the search criteria
 full_name = Full Name
 gender = Gender
-date_of_birth = Date of Birth
+date_of_birth=Date of birth
 age = Age
 hierachy_orgunit = Hierarchy Organisation Unit
 enrolled_in_program = Enrolled in Programs
@@ -336,12 +336,11 @@
 in_selected_orgU = In Selected Organisation Unit
 available_delist = Available dataelements
 selected_delist = Selected dataelements
-generate_globalXML = Generate Global Config XML
-message = This may take a few seconds
-generate = Generate
-download = Download New RA-Folder
-selected_delist = Selected dataelements
+generate_report_individual = Generate Individual Report
+generate_report_facility_wise = Generate Facility wise Report
+
+programwise_OrgUnitProgress = ProgramWise OrgUnitProgress Reports
+programwise_OrgUnitProgress_ra = ProgramWise OrgUnitProgress Report Analyser
+period_orgUnit_service_progress_ra = Period OrgUnit Progress Report Analyser
 discharge = Discharge
-followup = Followup
-output_type=Output Type
-report_date=Report Date
\ No newline at end of file
+followup = Followup
\ No newline at end of file

=== modified file 'local/in/dhis-web-reports-national/src/main/resources/struts.xml'
--- local/in/dhis-web-reports-national/src/main/resources/struts.xml	2012-08-18 05:34:21 +0000
+++ local/in/dhis-web-reports-national/src/main/resources/struts.xml	2014-07-05 06:23:19 +0000
@@ -15,35 +15,8 @@
             <param name="page">/dhis-web-reports/welcome.vm</param>
             <param name="menu">/dhis-web-reports/menu.vm</param>
         </action>
-
-        <action name="globalconfig"
-                class="org.hisp.dhis.reports.reportmanagement.action.GenerateGlobalConfigAction">
-            <result name="success" type="velocity">/main.vm</result>
-            <param name="page">/dhis-web-reports/showGlobalConfigForm.vm</param>
-            <param name="menu">/dhis-web-reports/menu.vm</param>
-        </action>
-
-        <action name="showglobalconfig"
-                class="org.hisp.dhis.reports.reportmanagement.action.ShowGlobalConfigForm">
-            <result name="success" type="velocity">/main.vm</result>
-            <param name="page">/dhis-web-reports/showGlobalConfigForm.vm</param>
-            <param name="menu">/dhis-web-reports/menu.vm</param>
-        </action>
-
-        <action name="downloadnewra"
-                class="org.hisp.dhis.reports.reportmanagement.action.DownloadRAFolderAction">
-            <result name="success" type="redirect">index.action</result>
-            <result name="download" type="stream">
-                <param name="contentType">application/zip</param>
-                <param name="inputName">inputStream</param>
-                <param name="contentDisposition">filename="${fileName}"</param>
-                <param name="bufferSize">1024</param>
-            </result>
-            <param name="menu">/dhis-web-reports/menu.vm</param>
-        </action>
-
+        
         <!-- Reports Management -->
-
         <action name="reportManagement"
             class="org.hisp.dhis.reports.reportmanagement.action.ReportsListAction">
             <result name="success" type="velocity">/main.vm</result>
@@ -169,7 +142,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/routineReportAnalysisFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForRoutineReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_ROUTINE</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -190,7 +163,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/idspReportAnalysisFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForIDSPReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_IDSP</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -251,12 +224,12 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/mdReportForm.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForMDReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/mdReport.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/mdReport.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_MDREPORT_GENERATE</param>
 			<interceptor-ref name="organisationUnitTreeStack"/>
         </action>
-		<!--	
+		<!--
         <action name="generateMDReport"
             class="org.hisp.dhis.reports.md.action.GenerateMDReportAnalyserResultAction">
             <result name="success" type="stream">
@@ -276,20 +249,22 @@
                 <param name="bufferSize">1024</param>
             </result>
         </action>
-		
+
         <action name="getOrgUnitDetailsForMDReport"
             class="org.hisp.dhis.reports.md.action.GetOrgUnitsAction">
             <result name="success" type="velocity-xml">/dhis-web-reports/responseOrgunit_md.vm</result>
             <param name="onExceptionReturn">plainTextError</param>
-        </action>		
-		     
+        </action>
+
+
+		       
         <!-- Auto Reports -->
         <action name="autoReportAnalyser"
             class="org.hisp.dhis.reports.auto.action.GenerateAutoReportAnalyserFormAction">
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/autoReportAnalysisFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForAutoReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_BULK</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -314,7 +289,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/llBulkReportAnalysisFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForLLBulkReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_BULK</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -351,7 +326,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/aggregationReportAnalysisFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForAggregationReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js,../dhis-web-commons/util/validate/jquery.validate.js,../dhis-web-commons/util/jquery.metadata.js,../dhis-web-commons/util/validate/additional-methods.js,../dhis-web-commons/util/validate/messages_locale.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js,../dhis-web-commons/util/validate/jquery.validate.js,../dhis-web-commons/util/jquery.metadata.js,../dhis-web-commons/util/validate/additional-methods.js,../dhis-web-commons/util/validate/messages_locale.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_AGGREGATION</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -372,7 +347,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/feedbackReportAnalysisFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForFeedback.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_FEEDBACK</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -393,7 +368,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/upwardReportAnalysisFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForGOIReports.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_GOI</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -407,7 +382,52 @@
                 <param name="bufferSize">1024</param>
             </result>
         </action>
-        
+
+       <!-- GOI Monthly Reports -->
+        <action name="goiMonthlyReportAnalyser"
+            class="org.hisp.dhis.reports.goimonthly.action.GenerateGOIMonthlyReportAnalyserFormAction">
+            <result name="success" type="velocity">/main.vm</result>
+            <param name="page">/dhis-web-reports/goiMonthlyReportAnalysisFront.vm</param>
+            <param name="menu">/dhis-web-reports/menuWithTreeForGOIMonthlyReport.vm</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="stylesheets">css/StylesForTags.css</param>
+            <param name="requiredAuthorities">F_REPORT_GOI</param>
+            <interceptor-ref name="organisationUnitTreeStack"/>
+        </action>
+        <action name="generateGOIMonthlyReport"
+            class="org.hisp.dhis.reports.goimonthly.action.GenerateGOIMonthlyReportAnalyserResultAction">
+            <result name="success" type="stream">
+                <param name="contentType">application/vnd.ms-excel</param>
+                <param name="inputName">inputStream</param>
+                <param name="contentDisposition">filename="${fileName}"</param>
+                <param name="bufferSize">1024</param>
+            </result>
+        </action>		
+		
+        <!-- ProgramWise OrgUnitProgress Reports -->
+        <action name="programWiseOrgUnitProgressReportAnalyser"
+            class="org.hisp.dhis.reports.programWiseOrgUnitProgress.action.GenerateProgramWiseOrgUnitProgressReportAnalyserFormAction">
+            <result name="success" type="velocity">/main.vm</result>
+            <param name="page">/dhis-web-reports/programWiseOrgUnitProgressReportAnalysisFront.vm</param>
+            <param name="menu">/dhis-web-reports/menuWithTreeForProgramWiseOrgUnitProgressReports.vm</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="stylesheets">css/StylesForTags.css</param>
+            <param name="requiredAuthorities">F_REPORT_ORGUNITWISE_PROGRESS</param>
+            <interceptor-ref name="organisationUnitTreeStack"/>
+        </action>
+        <action name="generateProgramWiseOrgUnitProgressReport"
+            class="org.hisp.dhis.reports.programWiseOrgUnitProgress.action.GenerateProgramWiseOrgUnitProgressReportAnalyserResultAction">
+            <result name="success" type="stream">
+                <param name="contentType">application/vnd.ms-excel</param>
+                <param name="inputName">inputStream</param>
+                <param name="contentDisposition">filename="${fileName}"</param>
+                <param name="bufferSize">1024</param>
+            </result>
+        </action>		
+		
+		
+		
+		        
         <!-- DataSet Lock Reports -->
         <action name="dataSetLockReportAnalyser"
             class="org.hisp.dhis.reports.datasetlock.action.GenerateDataSetLockReportAnalyserFormAction">
@@ -449,7 +469,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/linelstingReportAnalyserFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForLineListingReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_LINELIST</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -470,7 +490,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/periodWiseprogressReportAnalysisFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForPeriodWiseProgressReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js,javascript/date.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js,javascript/date.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_PERIODWISE_PROGRESS</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -491,7 +511,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/ouWiseProgressReportFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForOuWiseProgress.vm</param>
-            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/util/lists.js,javascript/reportManagement.js,javascript/hashtable.js,../dhis-web-commons/util/validate/jquery.validate.js,../dhis-web-commons/util/jquery.metadata.js,../dhis-web-commons/util/validate/additional-methods.js,../dhis-web-commons/util/validate/messages_locale.js</param>
+            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js,../dhis-web-commons/util/validate/jquery.validate.js,../dhis-web-commons/util/jquery.metadata.js,../dhis-web-commons/util/validate/additional-methods.js,../dhis-web-commons/util/validate/messages_locale.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_ORGUNITWISE_PROGRESS</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -506,12 +526,43 @@
             </result>
         </action>
         
+		
+		<!-- Period OrgUnit and Service Progress Reports --> 	
+		
+		
+        <action name="periodOrgUnitServiceProgressReportAnalyser"
+            class="org.hisp.dhis.reports.periodorgunitserviceprogressreport.action.GeneratePeriodOrgUnitServiseProgressReportAnalyserFormAction">
+            <result name="success" type="velocity">/main.vm</result>
+            <param name="page">/dhis-web-reports/periodOrgUnitServiceProgressReportAnalysisFront.vm</param>
+            <param name="menu">/dhis-web-reports/menuWithTreeForPeriodOrgUnitServiseProgressReport.vm</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js,javascript/date.js</param>
+            <param name="stylesheets">css/StylesForTags.css</param>
+            <param name="requiredAuthorities">F_REPORT_PERIODWISE_PROGRESS</param>
+            <interceptor-ref name="organisationUnitTreeStack"/>
+        </action>		
+		
+
+		
+        <action name="generatePeriodOrgUnitServiceProgressReport"
+            class="org.hisp.dhis.reports.periodorgunitserviceprogressreport.action.GeneratePeriodOrgUnitServiseProgressAnalyserResultAction">
+            <result name="success" type="stream">
+                <param name="contentType">application/vnd.ms-excel</param>
+                <param name="inputName">inputStream</param>
+                <param name="contentDisposition">filename="${fileName}"</param>
+                <param name="bufferSize">1024</param>
+            </result>
+        </action>		
+		
+				
+		
+		
+		
         <!-- Meta Data Reports -->
         <action name="metaDataReportAnalyser" class="org.hisp.dhis.reports.meta.action.GenerateMetaDataReportAnalyserFormAction">
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/metaDataReportAnalysisFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithmetaDataReports.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reports.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reports.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_METADATA_REPORTS</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -533,7 +584,7 @@
             <param name="page">/dhis-web-reports/advancedReportsForm.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForAdvanced.vm</param>
             <param name="javascripts">
-                ../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js
+                ../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js
                 ,../dhis-web-commons/util/validate/jquery.validate.js,../dhis-web-commons/util/jquery.metadata.js
                 ,../dhis-web-commons/util/validate/additional-methods.js,../dhis-web-commons/util/validate/messages_locale.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
@@ -555,7 +606,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/leprosyReportsForm.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForNLEPReports.vm</param>
-            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
         </action>
@@ -575,7 +626,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/MalaryaReportsForm.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForMalaryaReports.vm</param>
-            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
         </action>
@@ -595,7 +646,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/gradingReportForm.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForGradingReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/hashtable.js,javascript/grading.js</param>
+            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/hashtable.js,javascript/grading.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
         </action>
@@ -631,7 +682,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/gradingAbstractionForm.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForGradingAbstReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
         </action>
@@ -654,7 +705,7 @@
             <param name="menu">
                 /dhis-web-reports/menuWithTreeForTwentyPoint.vm</param>
             <param name="javascripts">
-                ../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+                ../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
         </action>
@@ -676,7 +727,7 @@
             <param name="page">/dhis-web-reports/OrgunitGroupsetReportForm.vm</param>
             <param name="menu">/dhis-web-reports/menu.vm</param>
             <param name="javascripts">
-                ../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+                ../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
         </action>
@@ -697,7 +748,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/rankingReportForm.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForRankingReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
         </action>
@@ -717,7 +768,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/welcome.vm</param>
             <param name="menu">/dhis-web-reports/menu.vm</param>
-            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_POPULATE_USERS</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -728,7 +779,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/welcome.vm</param>
             <param name="menu">/dhis-web-reports/menu.vm</param>
-            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_POPULATE_USERS</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -740,7 +791,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/physicalReportform.vm</param>
             <param name="menu">/dhis-web-reports/menuWithphysicaOutputReports.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_PHYSICALOP</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -761,7 +812,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/mobileReportAnalysisFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForMobileReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/datasetLockReport.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/datasetLockReport.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
         </action>
@@ -781,7 +832,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/csReviewReportFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForCSReviewReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/util/lists.js,javascript/reportManagement.js,javascript/hashtable.js,../dhis-web-commons/util/validate/jquery.validate.js,../dhis-web-commons/util/jquery.metadata.js,../dhis-web-commons/util/validate/additional-methods.js,../dhis-web-commons/util/validate/messages_locale.js</param>
+            <param name="javascripts">../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js,../dhis-web-commons/util/validate/jquery.validate.js,../dhis-web-commons/util/jquery.metadata.js,../dhis-web-commons/util/validate/additional-methods.js,../dhis-web-commons/util/validate/messages_locale.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_CSREVIEW</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -801,7 +852,7 @@
 			<result name="success" type="velocity">/main.vm</result>
 			<param name="page">/dhis-web-reports/linelstingWebPortalReportAnalyserFront.vm</param>
 			<param name="menu">/dhis-web-reports/menuWithTreeForLineListingWebPortalReport.vm</param>
-			<param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+			<param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
 			<param name="stylesheets">css/StylesForTags.css</param>
 			<param name="requiredAuthorities">F_REPORT_LINELIST_PORTAL</param>
 			<interceptor-ref name="organisationUnitTreeStack"/>
@@ -823,7 +874,7 @@
 			<result name="success" type="velocity">/main.vm</result>
 			<param name="page">/dhis-web-reports/coldChainRoutineReportAnalyserFront.vm</param>
 			<param name="menu">/dhis-web-reports/menuWithTreeForColdChainRoutineReport.vm</param>
-			<param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+			<param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
 			<param name="stylesheets">css/StylesForTags.css</param>
 			<param name="requiredAuthorities">F_REPORT_LINELIST_COLDCHAIN</param>
 			<interceptor-ref name="organisationUnitTreeStack"/>
@@ -845,7 +896,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/activePlanReportsForm.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForActivePlan.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/lists/lists.js,javascript/reports.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/javascripts/lists.js,javascript/reports.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_ACTIVITYPLAN</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -864,7 +915,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/activePlanFeedBackForm.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForActivePlan.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reports.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reports.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
         </action>
@@ -884,7 +935,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/benificiaryInfoReportsForm.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForBenificiaryInfo.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/lists/lists.js,javascript/reports.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/javascripts/lists.js,javascript/reports.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_BENIFICIARY_INFO</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -946,7 +997,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/portalReportForm.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForPortalReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/lists/lists.js,javascript/reports.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/javascripts/lists.js,javascript/reports.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_NBITS_PORTAL</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -990,7 +1041,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/nbitsReportsForm.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForPortalReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/lists/lists.js,javascript/reports.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/javascripts/lists.js,javascript/reports.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_NBITS_REPORTS</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -1005,6 +1056,33 @@
             </result>
         </action>
 
+		
+        <!-- Due Date Reports -->
+        <action name="activePlanDueDatesReportAnalyserForm"
+            class="org.hisp.dhis.reports.activeplan.action.ActivePlanDueDatesReportFormAction">
+            <result name="success" type="velocity">/main.vm</result>
+				<param name="page">/dhis-web-reports/activePlanDueDateForm.vm</param>
+			    <param name="menu">/dhis-web-reports/menuWithTreeForActivePlanDueDate.vm</param>
+				<param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,javascript/reports.js,javascript/hashtable.js</param>
+				<param name="stylesheets">css/StylesForTags.css</param>
+				<!--<param name="requiredAuthorities">F_REPORT_NBITS_REPORTS</param>-->
+            <interceptor-ref name="organisationUnitTreeStack"/>
+        </action>		
+		
+        <action name="generateActivePlanDueDateReportResult"
+            class="org.hisp.dhis.reports.activeplan.action.ActivePlanDueDatesReportResultAction">
+            <result name="success" type="stream">
+                <param name="contentType">application/vnd.ms-excel</param>
+                <param name="inputName">inputStream</param>
+                <param name="contentDisposition">filename="${fileName}"</param>
+                <param name="bufferSize">1024</param>
+            </result>
+        </action>		
+		
+		
+		
+		
+		
         <!--District Feedback-->
 
         <action name="districtFeedbackReportAnalyser"
@@ -1012,7 +1090,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/districtFeedbackReportAnalysisFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForDistrictFeedbackReport.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js,../dhis-web-commons/util/validate/jquery.validate.js,../dhis-web-commons/util/jquery.metadata.js,../dhis-web-commons/util/validate/additional-methods.js,../dhis-web-commons/util/validate/messages_locale.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/calendar/calendar.js,../dhis-web-commons/calendar/calendar-lang.js,../dhis-web-commons/calendar/calendar-setup.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js,../dhis-web-commons/util/validate/jquery.validate.js,../dhis-web-commons/util/jquery.metadata.js,../dhis-web-commons/util/validate/additional-methods.js,../dhis-web-commons/util/validate/messages_locale.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
             <param name="requiredAuthorities">F_REPORT_DISTRICTFEEDBACK</param>
             <interceptor-ref name="organisationUnitTreeStack"/>
@@ -1025,7 +1103,7 @@
                 <param name="contentDisposition">filename="${fileName}"</param>
                 <param name="bufferSize">1024</param>
             </result>
-        </action>		
+        </action>
 		
         <!-- ranking2 Reports -->
         <action name="ranking2ReportForm"
@@ -1033,7 +1111,7 @@
             <result name="success" type="velocity">/main.vm</result>
             <param name="page">/dhis-web-reports/ranking2ReportFront.vm</param>
             <param name="menu">/dhis-web-reports/menuWithTreeForRanking2Reports.vm</param>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="stylesheets">css/StylesForTags.css</param>
              <param name="requiredAuthorities">F_REPORT_RANKING</param>
              <interceptor-ref name="organisationUnitTreeStack"/>
@@ -1046,8 +1124,19 @@
                 <param name="inputName">inputStream</param>
                 <param name="contentDisposition">filename="${fileName}"</param>
                 <param name="bufferSize">1024</param></result>            
+        </action>
+		
+	   <!-- ranking2 Reports for STATE -->
+       <action name="generateStateRanking2Report"
+            class="org.hisp.dhis.reports.ranking2.action.GenerateStateRanking2ReportAction">
+             <result name="success" type="stream">
+                <param name="contentType">application/vnd.ms-excel</param>
+                <param name="inputName">inputStream</param>
+                <param name="contentDisposition">filename="${fileName}"</param>
+                <param name="bufferSize">1024</param></result>            
         </action>		
-		
+		     
+
         <!-- AJAX Requests -->
         <action name="getDataElements"
             class="org.hisp.dhis.reports.action.GetDataElementsAction">
@@ -1064,14 +1153,24 @@
         <action name="getReports"
             class="org.hisp.dhis.reports.action.GetReportsAction">
             <result name="success" type="velocity-xml">/dhis-web-reports/responseReport.vm</result>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reportManagement.js,javascript/hashtable.js</param>
             <param name="onExceptionReturn">plainTextError</param>
         </action>
-        
+       
+		
+		<!-- get Program List -->		
+       <action name="getProgramList"
+            class="org.hisp.dhis.reports.action.GetProgramListAction">
+            <result name="success" type="velocity-xml">/dhis-web-reports/responseProgramList.vm</result>
+				<param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reports,javascript/reportManagement.js,javascript/hashtable.js</param>
+				<param name="onExceptionReturn">plainTextError</param>
+        </action>				
+		
+		
         <action name="getProgressReports"
             class="org.hisp.dhis.reports.action.GetProgressReportsAction">
             <result name="success" type="velocity-xml">/dhis-web-reports/responseReport.vm</result>
-            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reports.js,javascript/hashtable.js</param>
+            <param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/javascripts/lists.js,javascript/reports.js,javascript/hashtable.js</param>
             <param name="onExceptionReturn">plainTextError</param>
         </action>
 
@@ -1087,18 +1186,5 @@
             <param name="onExceptionReturn">plainTextError</param>
         </action>
 
-		<!-- Daily Food Situation Reports -->
-    <action name="dailyFoodReportAnalyser" class="org.hisp.dhis.reports.action.NoAction">
-        <result name="success" type="velocity">/main.vm</result>
-        <param name="menu">/dhis-web-reports/menu.vm</param>
-        <param name="page">/dhis-web-reports/dailyFoodSituationForm.vm</param>        
-    </action>
-		
-	<action name="generateDailyFoodReport" class="org.hisp.dhis.reports.dailyfood.action.GenerateDailyFoodReportAction">
-        <result name="success" type="velocity">/main.vm</result>
-        <param name="menu">/dhis-web-reports/menu.vm</param>
-        <param name="page">/dhis-web-reports/welcome.vm</param>        
-    </action>
-		
     </package>
 </struts>

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/WEB-INF/web.xml'
--- local/in/dhis-web-reports-national/src/main/webapp/WEB-INF/web.xml	2012-04-04 11:58:27 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/WEB-INF/web.xml	2014-07-05 06:22:43 +0000
@@ -2,7 +2,7 @@
 <!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
   "http://java.sun.com/dtd/web-app_2_3.dtd">
 <web-app>
-  <display-name>DHIS Reports India</display-name>
+  <display-name>DHIS Reports National Haryana</display-name>
   
   <context-param>
     <param-name>contextConfigLocation</param-name>
@@ -31,7 +31,7 @@
   </filter>
   <filter>
     <filter-name>Struts</filter-name>
-    <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
+    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
   </filter>
   
   <filter-mapping>
@@ -50,24 +50,6 @@
     <filter-name>Struts</filter-name>
     <url-pattern>*.action</url-pattern>
   </filter-mapping>
-<!--
-  <servlet>
-        <servlet-name>jcaptcha</servlet-name>
-        <servlet-class>org.hisp.dhis.security.action.CaptchaImageServlet</servlet-class>
-  </servlet>
-  <servlet-mapping>
-        <servlet-name>jcaptcha</servlet-name>
-        <url-pattern>/dhis-web-commons/security/jcaptcha.jpg</url-pattern>
-  </servlet-mapping>
-  <servlet>
-        <servlet-name>captchaValidator</servlet-name>
-        <servlet-class>org.hisp.dhis.security.action.CaptchaValidateServlet</servlet-class>
-  </servlet>
-  <servlet-mapping>
-        <servlet-name>captchaValidator</servlet-name>
-        <url-pattern>/dhis-web-commons/security/captchaValidator</url-pattern>
-  </servlet-mapping>
--->
 
   <listener>
     <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/activePlanReportsForm.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/activePlanReportsForm.vm	2011-04-29 13:45:23 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/activePlanReportsForm.vm	2013-09-19 06:34:31 +0000
@@ -36,13 +36,13 @@
 
 </script>
 
-<h3>Activity Plan</h3><hr /><br />
+<h3>Activity Plan Report</h3><hr /><br />
 
 <form id="reportForm" name="reportForm" action="generateActivePlanReport.action" method="post" onsubmit="return formValidations()" target="_blank">
     <table align="center" style=" border-collapse: collapse; margin-top: 0;" cellpadding="0" cellspacing="0" width="550" border=0>
         <tr>
             <td class="NormalB">
-                1. ActivityPlan Reports :<br />
+                1. Activity Plan Reports :<br />
                 <select id="reportList" name="reportList" style="width:200px">
                 #foreach($report in $reportList)
                     <option value="$report.id">$report.name</option>

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/aggregationReportAnalysisFront.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/aggregationReportAnalysisFront.vm	2011-04-15 11:40:14 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/aggregationReportAnalysisFront.vm	2013-09-19 06:34:31 +0000
@@ -15,12 +15,43 @@
         if( periodType.options[periodTypeIndex].text == null || periodType.options[periodTypeIndex].text== "" || periodType.options[periodTypeIndex].text== "[ Select PeriodType ]") { alert("Please Select A Period Type"); return false; }
         else if( orgunitIdValue == null || orgunitIdValue=="" || orgunitIdValue==" " ) { alert("Please Select OrganisationUnit"); return false; }    
         else if( reportListIndex < 0 || document.reportForm.reportList.options[reportListIndex].text == null ) { alert("Please Select a Report"); return false; }               
+        
+        else if( periodType.options[periodTypeIndex].value != "Forteen" )
+        {
+        	if( startDateValue == null || startDateValue== "" || endDateValue == null || endDateValue=="" ) { alert("Please Select Start Date And End Date"); return false; }
+        	else if( startDateValue > endDateValue ) { alert("Start Date Is Greater Than End Date"); return false; }
+        	
+        }
+        
+        else if( periodType.options[periodTypeIndex].value == "Forteen" )
+        {
+        	var periodList = document.getElementById("availablePeriods");
+        	var periodIndex = periodList.selectedIndex;
+
+        	if( periodList.options[periodIndex].text == null || periodList.options[periodIndex].text == "" ) 
+        	{
+            	alert("Please Select Period");
+            	return false;
+        	}                       
+		}
+        
+        
+        
+        /*
         else if( startDateValue == null || startDateValue== "" || endDateValue == null || endDateValue=="" ) { alert("Please Select Start Date And End Date"); return false; }
         else if( startDateValue > endDateValue ) { alert("Start Date Is Greater Than End Date"); return false; }        
+       	*/
+       	
+       
+
+        
                                     
-        document.forms['reportForm'].submit();
+        //document.forms['reportForm'].submit();
+        return true;
     }
 
+
+/*
     jQuery(document).ready(
             function()
             {
@@ -35,13 +66,13 @@
                 jQuery("#name").focus();
             }
     );
-    
+*/    
 </script>
        
 <h1>$i18n.getString( "aggregation_ra" )</h1>
 <hr /><br />
 
-<form id="reportForm" name="reportForm" action="generateAggregationReport.action" method="post" target="_blank">
+<form id="reportForm" name="reportForm" action="generateAggregationReport.action" method="post" onsubmit="return formValidations()" target="_blank">
 
     <table align="center" style=" border-collapse: collapse; margin-top: 0;" cellpadding="0" cellspacing="0" width="730" border=0>                      
         <tr>
@@ -67,7 +98,7 @@
             <td>&nbsp;</td>
             <td>&nbsp;</td>
         </tr> 
-        <tr>
+        <tr id='dateSelectTR'>
             <td class="NormalB">
                 <label for="startDate">3. $i18n.getString( 'start_date' ) ($i18n.getString( "format.date.label" ))</label><br/>
                 <input type="text" id="startDate" name="startDate" onChange="if(!isDate( this.value )) this.value='';" style="width:175px" class="{validate:{required:true,dateISO:true}}">                            
@@ -77,6 +108,13 @@
                 <input type="text" id="endDate" name="endDate" onChange="if(!isDate( this.value )) this.value='';" style="width:180px" class="{validate:{required:true,dateISO:true}}">                            
             </td>
         </tr>
+        <tr id='forteenPeriodTR' style='display:none'>
+            <td class="NormalB">
+            	3. $i18n.getString( "periods" ) : <br />
+                <select id="availablePeriods" name="availablePeriods" style="width:200px"></select>            	
+            </td>
+            <td>&nbsp;</td>
+        </tr>
         <tr>
             <td>&nbsp;</td>
             <td>&nbsp;</td>

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/benificiaryInfoReportsForm.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/benificiaryInfoReportsForm.vm	2011-01-10 07:58:36 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/benificiaryInfoReportsForm.vm	2013-09-19 06:34:31 +0000
@@ -68,7 +68,7 @@
 
 </script>
 
-<h1>NBITS Report Analyser</h1>
+<h1>Benificiary Information Report Analyser</h1>
 <hr /><br />
 
 <form id="reportForm" name="reportForm" action="generateBenificiaryInfoReport.action" method="post" onsubmit="return formValidations()" target="_blank">

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/css/StylesForTags.css'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/css/StylesForTags.css	2010-06-04 11:50:05 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/css/StylesForTags.css	2013-09-19 06:34:31 +0000
@@ -51,6 +51,4 @@
     font-size: 13px;    
     white-space: nowrap;
     cursor: default;         
-}
-
-
+}
\ No newline at end of file

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/edReportForm.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/edReportForm.vm	2011-05-18 11:56:37 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/edReportForm.vm	2013-09-19 06:34:31 +0000
@@ -5,58 +5,112 @@
 <form id="reportForm" name="reportForm" action="generateEDReport.action" method="post" onsubmit="return formValidationsForEDReport()" target="_blank">
     <table align="center" style=" border-collapse: collapse; margin-top: 0;" cellpadding="0" cellspacing="0" width="70%" border=0>
         <tr>
-            <td class="NormalB">
+            <td width="40%" class="NormalB">
                 1.$i18n.getString( "indicator_group" ) :<br />
-                <select id="indicatorGroupId" name="indicatorGroupId" style="width:200px">
-                    <option value="ALL">[ Select IndicatorGroup / All ]</option>
+                <select id="indicatorGroupId" name="indicatorGroupId" style="width:300px" onChange="getIndicators()">
+                    <option value="0">[ Select IndicatorGroup / All ]</option>
                     #foreach ( $group in $indicatorGroups )
                     <option value="$group.id" title="$group.name">$group.name</option>
                     #end
                 </select>
             </td>
-            <td class="NormalB">
+			<td width="15%">&nbsp;</td>
+            <td width="45%" class="NormalB">
                 3.From Date : <br />
-                <select id="selectedStartPeriodId" name="selectedStartPeriodId" style="width:200px">
-                    #foreach ( $mperiod in $periods )
-                        <option value="$mperiod.id">$simpleDateFormat.format( $mperiod.startDate )</option>
-                    #end
-                </select>
-            </td>
-        </tr>
-        <tr>
-            <td>&nbsp;</td><td>&nbsp;</td>
-        </tr>
-        <tr>
-            <td>&nbsp;</td><td>&nbsp;</td>
-        </tr>
+                <select id="selectedStartPeriodId" name="selectedStartPeriodId" style="width:300px">
+                    #foreach ( $mperiod in $periods )
+                        <option value="$mperiod.id">$simpleDateFormat.format( $mperiod.startDate )</option>
+                    #end
+                </select>
+            </td>
+        </tr>
+        <tr>
+            <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
+        </tr>
+        <tr>
+            <td class="NormalB">$i18n.getString( "filter" ):&nbsp;<br /><input type="text" id="availableIndicatorsFilter" onkeyup="filterAvailableIndicators()" style="width:300px"></td>
+            <td>&nbsp;</td>
+            <td class="NormalB">
+                4.To Date : <br />
+                <select id="selectedEndPeriodId" name="selectedEndPeriodId" style="width:300px">
+                    #foreach ( $mperiod in $periods )
+                        <option value="$mperiod.id">$simpleDateFormat.format( $mperiod.startDate )</option>
+                    #end
+                </select>
+            </td>
+        </tr>
+        <tr>
+            <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
+        </tr>
+    <tr>
+		<td class="NormalB">$i18n.getString( "available_indicatorList" )<br>
+			<select multiple size="7" id="availableIndicators" name="availableIndicators"  style="width:300px; height:100px" ondblclick="moveSelectedById( 'availableIndicators', 'selectedIndicators' )">
+				#foreach ( $element in $indicators )
+					<option value="$element.id" title="$element.name">$element.name</option>
+				#end
+			</select>
+		</td>
+		<td class="NormalB" align="center">
+			<input type="button" value="&gt;" style="width:40px" onClick="moveSelectedById( 'availableIndicators', 'selectedIndicators' )"><br>
+			<input type="button" value="&lt;" style="width:40px" onClick="moveSelectedById( 'selectedIndicators', 'availableIndicators' )"><br>
+			<input type="button" value="&gt;&gt;" style="width:40px" onClick="moveAllById( 'availableIndicators', 'selectedIndicators' )"><br>
+			<input type="button" value="&lt;&lt;" style="width:40px" onClick="moveAllById( 'selectedIndicators', 'availableIndicators' )">
+		</td>
+		<td class="NormalB"> $i18n.getString( "selected_IndicatorList" )<br />
+			<select multiple size="7" id="selectedIndicators" name="selectedIndicators"  style="width:300px; height:100px" ondblclick="moveSelectedById( 'selectedIndicators', 'availableIndicators' )">
+			</select>
+		</td>		
+        <tr>
+            <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
+        </tr>				
         <tr>
             <td class="NormalB">
                 2.$i18n.getString( "generated_data_type" ) :<br />
-                <select id="aggData" name="aggData" style="width:200px">
+                <select id="aggData" name="aggData" style="width:300px">
                     <option value="generateaggdata">$i18n.getString( "generate_agg_data" )</option>
                     <option value="useexistingaggdata">$i18n.getString( "use_existing_agg_data" )</option>
                     <option value="usecaptureddata">$i18n.getString( "use_captured_data" )</option>
                 </select>
             </td>
-            <td class="NormalB">
-                4.To Date : <br />
-                <select id="selectedEndPeriodId" name="selectedEndPeriodId" style="width:200px">
-                    #foreach ( $mperiod in $periods )
-                        <option value="$mperiod.id">$simpleDateFormat.format( $mperiod.startDate )</option>
-                    #end
-                </select>
-            </td>
-        </tr>
-        <tr>
-            <td>&nbsp;</td><td>&nbsp;</td>
-        </tr>
-        <tr>
-            <td>&nbsp;</td><td>&nbsp;</td>
+			<td>&nbsp;</td>
+            <td>&nbsp;</td>
+        </tr>		
+        <tr>
+            <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
         </tr>
         <tr>   
-            <td class="NormalB">
-                <input type="submit" name="generate" value='Generate Report' style="width:200px" />
-            </td>
+            <td class="NormalB"><input type="button" name="generate" value='Generate Indicator Report' style="width:300px" onclick="callAction('INDICATOR')" /></td>
+			<td>&nbsp;</td>            
+			<td class="NormalB"><input type="button" name="generate" value='Generate Ranking Report' style="width:300px" onclick="callAction('RANKING')" /></td>
+            
         </tr>
     </table>  
- </form>
\ No newline at end of file
+ </form>
+
+<script type="text/javascript">
+
+	var availableIndicators = new Object();	
+    #foreach ( $availableIndicator in $indicators )
+    	availableIndicators['$availableIndicator.id'] = '$encoder.jsEscape( $availableIndicator.name, "'" )';
+    #end
+
+</script>
+
+<script>	
+function callAction( actionName )
+{
+	if( formValidationsForEDReport() )
+	{        
+		if( actionName == "INDICATOR" )
+		{
+			document.reportForm.action = "generateEDReport.action";
+			document.reportForm.submit();
+		}
+		else
+		{
+			document.reportForm.action = "generateEDRankingReport.action";
+			document.reportForm.submit();
+		}
+	}
+}	
+</script>
\ No newline at end of file

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/javascript/mdReport.js'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/javascript/mdReport.js	2012-04-16 08:50:30 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/javascript/mdReport.js	2013-09-19 06:34:31 +0000
@@ -1,4 +1,6 @@
  
+
+
 // form validation for MD report
 function formValidationsForMDReport()
 {
@@ -59,6 +61,7 @@
     
     return true;
 }
+
 //filter available data elements list
 function filterAvailableDataElements()
 {
@@ -157,11 +160,13 @@
 
 	for( i= i+1; i <= maxOULevel; i++ )
 	{
-		ouLevelId.options[j] = new Option("Level - "+i,i,false,false);
+		
+		//ouLevelId.options[j] = new Option("Level - "+i,i,false,false);
+		ouLevelId.options[j] = new Option( orgUnitLevelNames.get( i ),i,false,false);
 		
 		j++;
 	}
-
+	
 	if( j == 0 )
 	{
 		document.getElementById( "ViewReport" ).disabled = true;

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/javascript/patient.js'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/javascript/patient.js	2012-06-22 05:36:42 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/javascript/patient.js	2013-09-19 06:34:31 +0000
@@ -32,10 +32,44 @@
 			showWarningMessage( i18n_specify_search_criteria );
 			flag = false;
 		}
+		
 	});
 	
-	if(!flag) return;
-	
+	//if(!flag) return;
+	
+	var params = '';
+	if(flag){
+		
+		jQuery( searchTextFields ).each( function( i, item )
+				{
+					params += "&searchTexts=" + "iden";
+					if( item.name == 'searchText' )
+					{
+						params += "_";
+						params += htmlEncode( item.value.toLowerCase().replace(/^\s*/, "").replace(/\s*$/, "") );
+					}
+					
+				});
+		params += '&isSelectedOrg=' + byId('isSelectedOrg').checked;
+		
+		contentDiv = 'listPatientDiv';
+		jQuery( "#loaderDiv" ).show();
+		$.ajax({
+			url: 'searchRegistredPatient.action',
+			type:"POST",
+			//data: getParamsForDiv('searchPatientDiv'),
+			data: params,
+			success: function( html ){
+					statusSearching = 1;
+					setInnerHTML( 'listPatientDiv', html );
+					showById('listPatientDiv');
+					jQuery( "#loaderDiv" ).hide();
+				}
+			});
+	}
+	
+	
+	/*
 	contentDiv = 'listPatientDiv';
 	jQuery( "#loaderDiv" ).show();
 	$.ajax({
@@ -49,6 +83,7 @@
 				jQuery( "#loaderDiv" ).hide();
 			}
 		});
+		*/
 }
 
 function getParamsForDiv( patientDiv )
@@ -226,15 +261,39 @@
 	var tempPatientId = "";
 	var tempProgramId = "";
 	
+	var excelTemplateName = "";
+	var xmlTemplateName = "";
+	
 	var programDropDown = document.getElementById("programId_"+patientId);
 	var selProgramId = programDropDown.options[ programDropDown.selectedIndex ].value;
 	
-	var excelTemplateName = "SNCUFollowUpSheet.xls";
-	var xmlTemplateName = "SNCUFollowUpSheet.xml";
-	
-	tempPatientId = patientId;
-	tempProgramId = selProgramId;
-
+	if ( selProgramId == 1 )
+	{
+		excelTemplateName = "NRCFollowUpSheet.xls";
+		xmlTemplateName = "NRCFollowUpSheet.xml";
+		
+		tempPatientId = patientId;
+		tempProgramId = selProgramId;
+	}
+	
+	if ( selProgramId == 2 )
+	{
+		excelTemplateName = "SNCUFollowUpSheet.xls";
+		xmlTemplateName = "SNCUFollowUpSheet.xml";
+		
+		tempPatientId = patientId;
+		tempProgramId = selProgramId;
+		
+	}
+	
+	//var excelTemplateName = "SNCUFollowUpSheet.xls";
+	//var xmlTemplateName = "SNCUFollowUpSheet.xml";
+	
+	//tempPatientId = patientId;
+	//tempProgramId = selProgramId;
+	
+	//alert( tempPatientId + " --- " + tempProgramId );
+	//alert( excelTemplateName + " --- " + xmlTemplateName );
 
 
     //event.target.href = "generatePatientReport.action?patientId=" + patientId + "&selProgramId=" + selProgramId + "&excelTemplateName=" + excelTemplateName + "&xmlTemplateName=" + xmlTemplateName;
@@ -249,6 +308,4 @@
     document.patientForm.action = "generatePatientReport.action";
     document.patientForm.submit();
 	    
-   
-	
 }

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/javascript/reportManagement.js'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/javascript/reportManagement.js	2011-12-05 05:56:00 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/javascript/reportManagement.js	2014-07-08 08:39:23 +0000
@@ -273,19 +273,54 @@
     {
         var ouId = document.reportForm.ouIDTB.value;
         var reportTypeName = document.reportForm.reportTypeNameTB.value;
-  
-        getReports(ouId, reportTypeName);
+        
+        if ( periodTypeId == "Forteen" )
+        {
+        	getPeriods();
+        	getReports(ouId, reportTypeName);
+            document.reportForm.generate.disabled=false;
+            
+            jQuery("#startDate").val("");
+            jQuery("#endDate").val("");
+        	hideById('dateSelectTR');
+        	showById('forteenPeriodTR');
+        }
+        
+       else
+       {
+    	   getReports(ouId, reportTypeName);
+           document.reportForm.generate.disabled=false;
+           
+           showById('dateSelectTR');
+           hideById('forteenPeriodTR');
+       }
+        
+    }
+   
+   /*
+    else if ( periodTypeId == "Forteen" )
+    {
+    	alert( periodTypeId );
+    	getPeriods();
+    	getReports(ouId, reportTypeName);
         document.reportForm.generate.disabled=false;
+        
+    	hideById('startDateTD');
+    	hideById('endDateTD');
+    	showById('forteenPeriodTR');
     }
+    */
     else
     {
-    
         document.reportForm.generate.disabled=true;
         clearList( reportsList );
         jQuery("#startDate").val("");
         jQuery("#endDate").val("");
         document.reportForm.startDate = "";
         document.reportForm.endDate = " ";
+        
+        showById('dateSelectTR');
+        hideById('forteenPeriodTR');
     }
 
 	var ouId = document.getElementById('ouIDTB').value;
@@ -322,7 +357,8 @@
 {
 	var reportsList = document.getElementById("reportList");
 	var orgUnitName = document.getElementById("ouNameTB");
-
+	var ouLavel = "";
+	
 	clearList(reportsList);
 
 	var reports = xmlObject.getElementsByTagName("report");
@@ -331,11 +367,31 @@
 		var id = reports[i].getElementsByTagName("id")[0].firstChild.nodeValue;
 		var name = reports[i].getElementsByTagName("name")[0].firstChild.nodeValue;
 		var ouName = reports[i].getElementsByTagName("ouName")[0].firstChild.nodeValue;
-
+		ouLavel = reports[i].getElementsByTagName("ouLavel")[0].firstChild.nodeValue;
+		
 		orgUnitName.value = ouName;
 		
 		$("#reportList").append("<option value='"+ id +"'>" + name + "</option>");
 	}
+	
+	document.reportForm.generate.disabled=false;
+	
+	if ( ouLavel == 2 )
+	{
+		document.reportForm.generate1.disabled=false;
+		document.reportForm.generate.disabled=true;
+	}
+	else if ( ouLavel == 3 )
+	{
+		document.reportForm.generate1.disabled=true;
+		document.reportForm.generate.disabled=false;
+	}
+	else
+	{
+		document.reportForm.generate1.disabled=true;
+		document.reportForm.generate.disabled=true;
+	}
+	//alert( ouLavel );
 }
 
 //----------------------------------------------------------------------
@@ -395,4 +451,4 @@
 		$("#availablePeriods").append("<option value='"+ id +"'>" + periodName + "</option>");
 		$("#availablePeriodsto").append("<option value='"+ id +"'>" + periodName + "</option>");
 	}
-}
+}
\ No newline at end of file

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/javascript/reports.js'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/javascript/reports.js	2012-02-17 07:09:28 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/javascript/reports.js	2013-09-19 06:34:31 +0000
@@ -134,7 +134,7 @@
         
     if ( dataElementGroupId != null )
     {
-        /* //var url = "getDataElements.action?id=" + dataElementGroupId;
+    /* //var url = "getDataElements.action?id=" + dataElementGroupId;
         var request = new Request();
         request.setResponseTypeXML('dataElement');
         request.setCallbackSuccess(getDataElementsReceived);
@@ -340,6 +340,58 @@
     }
 }
 
+//get Program List By OrgUnit 
+function getProgramListByOrgUnit( orgUnitIds )
+{ 
+          
+    if ( orgUnitIds != null && orgUnitIds != "" )
+    {
+    	
+		$.post("getProgramList.action",
+		{
+			orgUnitId : orgUnitIds[0]
+		},
+		function (data)
+		{
+			getProgramsReceived(data);
+		},'xml');
+    }
+}
+
+function getProgramsReceived( xmlObject )
+{	
+    var programList = document.getElementById( "programList" );
+    var orgUnitName = document.getElementById( "ouNameTB" );
+    
+    clearList( programList );
+    
+    var programs = xmlObject.getElementsByTagName( "program" );
+    for ( var i = 0; i < programs.length; i++)
+    {
+        var id = programs[ i ].getElementsByTagName( "id" )[0].firstChild.nodeValue;
+        var name = programs[ i ].getElementsByTagName( "name" )[0].firstChild.nodeValue;
+        var ouName = programs[ i ].getElementsByTagName( "ouName" )[0].firstChild.nodeValue;
+	
+        orgUnitName.value = ouName;
+		
+		$("#programList").append("<option value='"+ id +"'>" + name + "</option>");
+    }
+}
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
 function getPeriodsReceived( xmlObject )
 {	
     var availablePeriods = document.getElementById( "availablePeriods" );
@@ -517,6 +569,103 @@
     return stringToTrim.replace(/^\s+|\s+$/g,"");
 }
 
+//-----------------------------------------------------------------------------
+// ED Report javascript methods getting indicators filters etc
+//-----------------------------------------------------------------------------
+
+
+function getIndicators()
+{
+    var indicatorGroupList = document.getElementById( "indicatorGroupId" );
+    var indicatorGroupId = indicatorGroupList.options[ indicatorGroupList.selectedIndex ].value;
+    
+    if ( indicatorGroupId != null )
+    {
+        if ( indicatorGroupId != 0 )
+        {
+        	//alert( indicatorGroupId );
+        	document.getElementById( "availableIndicatorsFilter" ).value = "";
+        	document.getElementById( "availableIndicatorsFilter" ).disabled = true;
+        	//return false;
+        }
+        else
+        {
+        	document.getElementById( "availableIndicatorsFilter" ).value = "";
+        	document.getElementById( "availableIndicatorsFilter" ).disabled = false;
+        }
+    	//document.getElementById( "availableIndicatorsFilter" ).value = "";
+    	//document.getElementById( "availableIndicatorsFilter" ).disabled = false;
+        lockScreen();
+    	$.post("getIndicators.action",
+			{
+				id:indicatorGroupId
+			},
+			function (data)
+			{
+				getIndicatorsReceived(data);
+			},'xml');
+    }
+}
+
+function getIndicatorsReceived( xmlObject )
+{	
+    var availableIndicators = document.getElementById( "availableIndicators" );
+    var selectedIndicators = document.getElementById( "selectedIndicators" );
+	
+    clearList( availableIndicators );
+	
+    var indicators = xmlObject.getElementsByTagName( "indicator" );
+	
+    for ( var i = 0; i < indicators.length; i++ )
+    {
+        var id = indicators[ i ].getElementsByTagName( "id" )[0].firstChild.nodeValue;
+        var indicatorName = indicators[ i ].getElementsByTagName( "name" )[0].firstChild.nodeValue;
+		
+        if ( listContains( selectedIndicators, id ) == false )
+        {
+            var option = document.createElement( "option" );
+            option.value = id;
+            option.text = indicatorName;
+            availableIndicators.add( option, null );
+        }
+    }
+    unLockScreen();
+}
+//filter available indicators list
+function filterAvailableIndicators()
+{
+	var filter = document.getElementById( 'availableIndicatorsFilter' ).value;
+    var list = document.getElementById( 'availableIndicators' );
+    
+    list.options.length = 0;
+    
+    var selIndListId = document.getElementById( 'selectedIndicators' );
+    var selIndLength = selIndListId.options.length;
+    
+    for ( var id in availableIndicators )
+    {
+    	//alert( "id : " + id );
+        var value = availableIndicators[id];
+        
+        var flag = 1;
+        for( var i =0 ; i<selIndLength; i++ )
+        {
+        	//alert( selIndListId.options[i].text );
+        	//alert( selIndListId.options[i].value );
+        	if( id == selIndListId.options[i].value )
+        	{
+    			flag =2;
+    			//alert("aaaa");
+    			break;
+        	}
+        }
+        if ( value.toLowerCase().indexOf( filter.toLowerCase() ) != -1 && (flag == 1) )
+        {
+            list.add( new Option( value, id ), null );
+        }
+        //alert( flag );
+    }
+}    
 
 //-----------------------------------------------------------------------------
 //FormValidations for ED Report
@@ -528,6 +677,9 @@
 	var endPeriodObj = document.getElementById('selectedEndPeriodId');
 	var indicatorGroupObj = document.getElementById('indicatorGroupId');
 	
+	var selIndicatorsListSize  = document.reportForm.selectedIndicators.options.length;//alert(selDEListSize);
+	
+	
 	sDateTxt = startPeriodObj.options[startPeriodObj.selectedIndex].text;
 	sDate = formatDate(new Date(getDateFromFormat(sDateTxt,"MMM-y")),"yyyy-MM-dd");
 	eDateTxt = endPeriodObj.options[endPeriodObj.selectedIndex].text;
@@ -537,9 +689,25 @@
 	{
 		alert( "Starting Date is Greater" );return false;
 	}
+	/*
 	else if( indicatorGroupObj.options[indicatorGroupObj.selectedIndex].value == "ALL" )
 	{
 		alert( "Please Select Indicator Group" );return false;
 	}
+	*/
+	else if(  selIndicatorsListSize <= 0 ) 
+	{
+        alert( "Please Select Indicator(s)" );
+        return false;
+	}
+	
+	if( selIndicatorsListSize > 0 )
+	{
+		for(k=0;k<document.reportForm.selectedIndicators.options.length;k++)
+    	{
+    		document.reportForm.selectedIndicators.options[k].selected = true;
+        } 
+	}	
+	
 	return true;
 } // formValidations Function End

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/linelstingWebPortalReportAnalyserFront.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/linelstingWebPortalReportAnalyserFront.vm	2011-06-27 07:31:04 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/linelstingWebPortalReportAnalyserFront.vm	2014-04-01 08:28:29 +0000
@@ -51,10 +51,26 @@
 				OrganisationUnit : <br />
                 <input type="text" name="ouNameTB" id="ouNameTB" size="20" disabled>
           	</td>
-          	<td class="NormalB">
-				<input type="submit" name="generate" value='Generate Report'/>
+          	
+          	<td class="NormalB" style="width:200px">
+				$i18n.getString( "generated_data_type" ) :<br />
+				<select id="aggData" name="aggData" style="width:200px;">
+                    <option value="usecaptureddata">$i18n.getString( "use_captured_data" )</option>
+					<!--
+					<option value="generateaggdata">$i18n.getString( "generate_agg_data" )</option>
+                    <option value="useexistingaggdata">$i18n.getString( "use_existing_agg_data" )</option>
+					-->
+                </select>				
          	</td>
 		</tr>
+        <tr>
+			<td>&nbsp;</td>
+            <td>&nbsp;</td>
+        </tr>		
+        <tr>
+			<td>&nbsp;</td>
+            <td><input type="submit" name="generate" value='Generate Report'/></td>
+        </tr>		
 	    <tr>
 			<td>&nbsp;</td>
           	<td>

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/llBulkReportAnalysisFront.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/llBulkReportAnalysisFront.vm	2011-10-13 08:00:58 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/llBulkReportAnalysisFront.vm	2013-09-19 06:34:31 +0000
@@ -75,21 +75,23 @@
             <td>&nbsp;</td>
         </tr>
         <tr>
-            <td>&nbsp;</td>
+           
             <td class="NormalB">
                 <!--<input type="checkbox" id="aggCB" name="aggCB" checked> $i18n.getString( "aggregated_data" )-->
                 
-               <!--5. $i18n.getString( "generated_data_type" ) :<br />
+               5. $i18n.getString( "generated_data_type" ) :<br />
                 <select id="aggData" name="aggData" style="width:200px">
+                	<option value="usecaptureddata">$i18n.getString( "use_captured_data" )</option>
                     <option value="generateaggdata">$i18n.getString( "generate_agg_data" )</option>
                     <option value="useexistingaggdata">$i18n.getString( "use_existing_agg_data" )</option>
-                    <option value="usecaptureddata">$i18n.getString( "use_captured_data" )</option>
-                </select>-->
-                <input type="submit" id= "generate" name="generate" value='$i18n.getString( "generate_report" )' disabled="disabled">
+                </select>
+           </td>     
+           <td>
+           		<input type="submit" id= "generate" name="generate" value='$i18n.getString( "generate_report" )' disabled="disabled">
                 <input type="hidden" name="autogen" id="autogen" value="0" >
                 <input type="hidden" name="ouIDTB" id="ouIDTB">
                 <input type="hidden" name="reportTypeNameTB" id="reportTypeNameTB" value="$reportTypeName">
-            </td>
+           </td>
         </tr>
     </table>
 </form>
\ No newline at end of file

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/mdReportForm.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/mdReportForm.vm	2012-04-16 08:47:07 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/mdReportForm.vm	2013-09-19 06:34:31 +0000
@@ -1,3 +1,4 @@
+
 <style>
     #overlay {
     z-index:9998;
@@ -14,10 +15,28 @@
     }
     #overlayImg{ width: 50px; height: 50px; z-index: 9999; position: absolute; left:50%}
 </style>
+
+<script>
+	
+	var orgUnitLevelNames = new HashTable();
+	
+	#foreach($level in $levels )
+	    var levelId = ""+"$level.level";
+	    orgUnitLevelNames.put(levelId,"$level.name");
+	#end
+	
+	//alert( orgUnitLevelNames.get( 2 ) );
+	
+	
+	
+	leftBar.showAnimated();
+</script>
+
 <div id="overlay">
     <div id="overlayImg"><img  width="50" height="50" src="images/ajax-loader.gif" /></div>
 </div>
-<h1>$i18n.getString( "md_report_ra" )</h1>
+
+<h1>$i18n.getString( "md_report_ra" )</h1> 
 <hr /><br />
 <form id="reportForm" name="reportForm" action="generateMDReport.action" method="post" onSubmit="return formValidationsForMDReport()" target="_blank">
 	

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menu.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menu.vm	2012-08-18 05:34:21 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menu.vm	2014-07-08 11:28:35 +0000
@@ -5,7 +5,6 @@
         <li>Report Management</li>
         <ul>
             <li><a href = "reportManagement.action">Report Management</a></li>
-            <li><a href="showglobalconfig.action">Generate Global Config</a></li>
         </ul>
     </ul>
 #end
@@ -13,34 +12,87 @@
 <ul>
 	<li>Report Analysis</li>
 	<ul>
-	    <li><a href = "dailyFoodReportAnalyser.action">Daily Food Situation Reports</a></li>
+		
 		#if( $auth.hasAccess( "dhis-web-reports", "upwardReportAnalyser") )
 			<li><a href = "upwardReportAnalyser.action">GOI Reports</a></li>
 		#end
-		#if( $auth.hasAccess( "dhis-web-reports", "edReportForm") )
-			<li><a href = "edReportForm.action">Indicator Reports</a></li>
-		#end
-		#if( $auth.hasAccess( "dhis-web-reports", "routineReportAnalyser") )
-			<li><a href = "routineReportAnalyser.action">Routine Reports</a></li>
-		#end
-		#if( $auth.hasAccess( "dhis-web-reports", "feedbackReportAnalyser") )
-			<li><a href = "feedbackReportAnalyser.action">Feedback Reports</a></li>
-		#end
-		#if( $auth.hasAccess( "dhis-web-reports", "aggregationReportAnalyser") )
-			<li><a href = "aggregationReportAnalyser.action">Aggregation Reports</a></li>
-		#end
-		#if( $auth.hasAccess( "dhis-web-reports", "linelistingReportAnalyser") )
-			<li><a href = "linelistingReportAnalyser.action">Linelisting Reports</a></li>
-		#end
+		
+		#if( $auth.hasAccess( "dhis-web-reports", "goiMonthlyReportAnalyser") )
+			<li><a href = "goiMonthlyReportAnalyser.action">GOI Monthly Report(Captured Data)</a></li>
+		#end
+		
 		#if( $auth.hasAccess( "dhis-web-reports", "periodWiseprogressReportAnalyser") )
 			<li><a href = "periodWiseprogressReportAnalyser.action">Periodwise Progress Reports</a></li>
 		#end
+		
 		#if( $auth.hasAccess( "dhis-web-reports", "ouWiseProgressReportAnalyser") )
 			<li><a href = "ouWiseProgressReportAnalyser.action">Orgunitwise Progress Reports</a></li>
 		#end
+		<!--
+		#if( $auth.hasAccess( "dhis-web-reports", "programWiseOrgUnitProgressReportAnalyser") )
+			<li><a href = "programWiseOrgUnitProgressReportAnalyser.action">Programwise OrgUnitProgress Reports</a></li>
+		#end
+		
+		#if( $auth.hasAccess( "dhis-web-reports", "periodOrgUnitServiceProgressReportAnalyser") )
+			<li><a href = "periodOrgUnitServiceProgressReportAnalyser.action">Period OrgUnit Progress Reports</a></li>
+		#end	
+		-->
 		#if( $auth.hasAccess( "dhis-web-reports", "metaDataReportAnalyser") )
 			<li><a href = "metaDataReportAnalyser.action">Meta Data Reports</a></li>
 		#end
+		
+		#if( $auth.hasAccess( "dhis-web-reports", "linelistingWebPortalReportAnalyser") )
+			<li><a href = "linelistingWebPortalReportAnalyser.action">Linelisting WebPortal Reports</a></li>
+		#end
+		
+		#if( $auth.hasAccess( "dhis-web-reports", "populateMultipleUsers") )
+			<li><a href = "populateMultipleUsers.action">Populate Users From Excel</a></li>
+		#end
+		
+		#if( $auth.hasAccess( "dhis-web-reports", "lineListingBulkReportAnalyser") )
+			<li><a href = "lineListingBulkReportAnalyser.action">Linelisting Bulk Report</a></li>
+		#end
+		
+		
+		#if( $auth.hasAccess( "dhis-web-reports", "autoReportAnalyser") )
+			<li><a href = "autoReportAnalyser.action">Bulk Reports</a></li>
+		#end
+		
+		#if( $auth.hasAccess( "dhis-web-reports", "aggregationReportAnalyser") )
+			<li><a href = "aggregationReportAnalyser.action">Aggregation Reports</a></li>
+		#end
+		
+		#if( $auth.hasAccess( "dhis-web-reports", "edReportForm") )
+			<li><a href = "edReportForm.action">Indicator Reports</a></li>
+		#end
+			
+		#if( $auth.hasAccess( "dhis-web-reports", "mdReportAnalyser") )
+			<li><a href = "mdReportAnalyser.action">MD Report</a></li>
+		#end
+		
+		#if( $auth.hasAccess( "dhis-web-reports", "linelistingReportAnalyser") )
+			<li><a href = "linelistingReportAnalyser.action">Linelisting Reports</a></li>
+		#end							
+		
+		#if( $auth.hasAccess( "dhis-web-reports", "populateUsers") )
+			<li><a href = "populateUsers.action">Populate Users</a></li>
+		#end
+		
+		#if( $auth.hasAccess( "dhis-web-reports", "populateMultipleUsers") )
+			<li><a href = "populateMultipleUsers.action">Populate Users From Excel</a></li>
+		#end		
+		
+		<!--
+		#if( $auth.hasAccess( "dhis-web-reports", "idspReportAnalyser") )
+			<li><a href = "idspReportAnalyser.action">IDSP Reports</a>
+		#end
+		
+
+		#if( $auth.hasAccess( "dhis-web-reports", "feedbackReportAnalyser") )
+			<li><a href = "feedbackReportAnalyser.action">Feedback Reports</a></li>
+		#end
+
+						
 		#if( $auth.hasAccess( "dhis-web-reports", "dataSetLockReportAnalyser") )
 			<li><a href = "dataSetLockReportAnalyser.action">DataSet Lock Reports</a></li>
 		#end
@@ -53,46 +105,33 @@
 		#if( $auth.hasAccess( "dhis-web-reports", "csReviewReportForm") )
 			<li><a href = "csReviewReportForm.action">CS Review Reports</a></li>
 		#end
-		#if( $auth.hasAccess( "dhis-web-reports", "populateUsers") )
-			<li><a href = "populateUsers.action">Populate Users</a></li>
-		#end
-		#if( $auth.hasAccess( "dhis-web-reports", "autoReportAnalyser") )
-			<li><a href = "autoReportAnalyser.action">Bulk Reports</a></li>
-		#end
-		#if( $auth.hasAccess( "dhis-web-reports", "linelistingWebPortalReportAnalyser") )
-			<li><a href = "linelistingWebPortalReportAnalyser.action">Linelisting WebPortal Reports</a></li>
-		#end
-		#if( $auth.hasAccess( "dhis-web-reports", "populateMultipleUsers") )
-			<li><a href = "populateMultipleUsers.action">Populate Users From Excel</a></li>
-		#end
-		#if( $auth.hasAccess( "dhis-web-reports", "idspReportAnalyser") )
-			<li><a href = "idspReportAnalyser.action">IDSP Reports</a>
-		#end
+
 		#if( $auth.hasAccess( "dhis-web-reports", "coldChainReportAnalyser") )
 			<li><a href = "coldChainReportAnalyser.action">Cold Chain Reports</a>
 		#end
-		#if( $auth.hasAccess( "dhis-web-reports", "lineListingBulkReportAnalyser") )
-			<li><a href = "lineListingBulkReportAnalyser.action">Linelisting Bulk Report</a>
-		#end
-		#if( $auth.hasAccess( "dhis-web-reports", "mdReportAnalyser") )
-			<li><a href = "mdReportAnalyser.action">MD Report</a>
-		#end
+
         #if( $auth.hasAccess( "dhis-web-reports", "ranking2ReportForm") )
             <li><a href = "ranking2ReportForm.action">Ranking Report</a></li>  
         #end
         #if( $auth.hasAccess( "dhis-web-reports", "districtFeedbackReportAnalyser") )
             <li><a href = "districtFeedbackReportAnalyser.action">Feedback Template</a></li>
-        #end				
+        #end
+		-->
+		
 		<!--<li><a href = "advancedReportAnalyser.action">Advanced Reports</a></li>-->
 	</ul>
 </ul>
 
 
+<!--
 #if( $auth.hasAccess( "dhis-web-reports", "benificiaryInfoReportsAnalyser") )
     <ul>
         <li>Tracker Reports</li>
         <ul>
             <li><a href = "patientInfoReportsAnalyser.action">Patient Information</a></li>
+            <li><a href = "activePlanDueDatesReportAnalyserForm.action">Tracker Due Date Report</a></li>
+            
+            
             #if( $auth.hasAccess( "dhis-web-reports", "benificiaryInfoReportsAnalyser") )
                 <li><a href = "benificiaryInfoReportsAnalyser.action">Tracker Benificiary Info</a></li>
             #end
@@ -102,9 +141,11 @@
             #if( $auth.hasAccess( "dhis-web-reports", "portalReportsAnalyser") )
                 <li><a href = "portalReportsAnalyser.action">Tracker Portal Reports</a></li>
             #end
+            
             #if( $auth.hasAccess( "dhis-web-reports", "nbitsReportsAnalyser") )
                 <li><a href = "nbitsReportsAnalyser.action">Tracker Reports</a></li>
             #end
         </ul>
     </ul>
-#end
\ No newline at end of file
+#end
+-->
\ No newline at end of file

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menuWithTreeForActivePlan.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menuWithTreeForActivePlan.vm	2011-03-01 08:37:19 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menuWithTreeForActivePlan.vm	2013-09-19 06:34:31 +0000
@@ -2,10 +2,10 @@
 <a href="index.action"><h2>Report Analyser</h2></a>
 
 <ul>
-    <li>NameBased Reports</li>
+    <li>Tracker Reports</li>
     <ul>
     	<li>
-            NBITS ActivityPlan
+            Tracker Activity Plan
         </li>
     </ul>
 </ul>

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menuWithTreeForBenificiaryInfo.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menuWithTreeForBenificiaryInfo.vm	2011-03-01 08:37:19 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menuWithTreeForBenificiaryInfo.vm	2013-09-19 06:34:31 +0000
@@ -2,10 +2,10 @@
 <a href="index.action"><h2>Report Analyser</h2></a>
 
 <ul>
-    <li>NameBased Reports</li>
+    <li>Tracking Reports</li>
     <ul>
     	<li>
-            NBITS Benificiary Info
+            Benificiary Info
         </li>
     </ul>
 </ul>

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menuWithTreeForMDReport.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menuWithTreeForMDReport.vm	2012-04-16 08:47:07 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menuWithTreeForMDReport.vm	2013-09-19 06:34:31 +0000
@@ -16,7 +16,7 @@
 
 	function orgUnitHasBeenSelected( orgUnitIds )
 	{
-		document.reportForm.ouIDTB.value = orgUnitIds;
+		document.getElementById("ouIDTB").value = orgUnitIds;
 	
 		reportTypeName = document.reportForm.reportTypeNameTB.value;
 	

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menuWithTreeForPortalReport.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menuWithTreeForPortalReport.vm	2011-03-01 08:37:19 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/menuWithTreeForPortalReport.vm	2013-09-19 06:34:31 +0000
@@ -2,10 +2,10 @@
 <a href="index.action"><h2>Report Analyser</h2></a>
 
 <ul>
-    <li>NameBased Reports</li>
+    <li>Tracker Reports</li>
     <ul>
     	<li>
-            NBITS Portal Reports
+            Tracker Portal Reports
         </li>
     </ul>
 </ul>

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/nbitsReportsForm.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/nbitsReportsForm.vm	2011-03-01 08:37:19 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/nbitsReportsForm.vm	2013-09-19 06:34:31 +0000
@@ -36,7 +36,7 @@
 
 </script>
 
-<h3>NBITS Report Analyser</h3>
+<h3>Tracker Report Analyser</h3>
 <hr /><br />
 
 <form id="reportForm" name="reportForm" action="generateNBITSReport.action" method="post" onsubmit="return formValidations()" target="_blank">

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/patientInfoReportsForm.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/patientInfoReportsForm.vm	2012-04-04 11:58:27 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/patientInfoReportsForm.vm	2013-09-19 06:34:31 +0000
@@ -8,13 +8,13 @@
 			<tr>
 				<td>$i18n.getString( "search_by_name_id" )</td>
 				<td>
-					<select id="searchingAttributeId" name="searchingAttributeId" style='display:none'>
+					<!--<select id="searchingAttributeId" name="searchingAttributeId" style='display:none'>
 						<option value="">$i18n.getString( "search_by_name_identifier" )</option>
 						<option value="0">$i18n.getString( "search_by_program" )</option>
 						#foreach( $attribute in $patientAttributes )
 							<option value="$attribute.id" valueType='$attribute.valueType'>$encoder.htmlEncode( $attribute.name )</option>
 						#end
-    				</select>
+    				</select>-->
     			</td>
 			</tr>	
 			<tr>
@@ -36,4 +36,12 @@
 
 <script>
 	var i18n_specify_search_criteria = '$encoder.jsEscape( $i18n.getString( "specify_search_criteria" ) , "'")';
-</script>
\ No newline at end of file
+	//var statusSearching = -1;
+	//unSave = false;
+	isAjax = true;
+	contentDiv = '';
+</script>
+
+
+
+

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/patientRegistrationList.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/patientRegistrationList.vm	2012-06-22 05:36:42 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/patientRegistrationList.vm	2013-09-19 06:34:31 +0000
@@ -62,9 +62,6 @@
     <td>
       <table class="listTable" id="patientList" width='100%'>               
           <col width="30"/>
-			#foreach( $attribute in $patientAttributes )
-				<col/>
-			#end
           <col/>
           <col/>
           <col/>
@@ -72,25 +69,24 @@
 		  #if($mapPatientOrgunit.size()!=0)
           <col/>
 		  #end
+		  <col/>
           <col width="200"/>    
 		  
 		  <thead>
-			<tr>
+			<tr bgcolor="#285C91">
 				<th>#</th>
-				#foreach( $attribute in $patientAttributes )
-					<th id="patientAttributeName">$attribute.name</th>
-				#end
 				<th>$i18n.getString( "full_name" )</th>          
-				<th>$i18n.getString( "gender" )</th>
+				<th class="{sorter: false}">$i18n.getString( "gender" )</th>
 				<th>$i18n.getString( "date_of_birth" )</th> 
 				<th class="{sorter: false}">$i18n.getString( "age" )</th>
 				#if($mapPatientOrgunit.size()!=0)
-				<th>$i18n.getString( "hierachy_orgunit" )</th>
+					<th>$i18n.getString( "hierachy_orgunit" )</th>
 				#end
 				##if($mapPatientPrograms.size()!=0)
 				<th class="{sorter: false}">$i18n.getString( "enrolled_in_program" )</th>
 				##end
-				<th colspan="3" align="center" class="{sorter: false}">$i18n.getString( "operations" )</th>
+				<!--<th colspan="3" align="center" class="{sorter: false}">$i18n.getString( "operations" )</th>-->
+				<th style="text-align:center" class="{sorter: false}">$i18n.getString( "operations" )</th>
 				<!--<th class="{sorter: false}">&nbsp;</th>
 				<th class="{sorter: false}">$i18n.getString( "operations" )</th>-->
 			  </tr>
@@ -106,17 +102,6 @@
 					$nr
 				</td>
 				
-				#foreach( $attribute in $patientAttributes )
-					#set ( $key = $patient.id + '-' + $attribute.id )
-					<td>
-						#if( $attribute.valueType == 'YES/NO')
-							$i18n.getString( $mapPatientPatientAttr.get($key) )
-						#else
-							$mapPatientPatientAttr.get($key)
-						#end
-					</td>
-				#end
-					
 				<td>$!patient.getFullName()</td>
 				
 				<td>$i18n.getString($!patient.gender)</td>
@@ -146,25 +131,27 @@
 						#end
     				</select></td>				
 				#end				
-				
+				<td>
 				#if( $patient.getPrograms().size() !=0 )
-				  <td>
-					<input type="button" id='generateButton' value="$i18n.getString( 'discharge' )" onclick="javascript:generatePatientReport( event, '$patient.id' )" title='$i18n.getString( "discharge" )'></td>
-					<td><input type="button" id='generateButton' value="$i18n.getString( 'followup' )" onclick="javascript:generatePatientFollowUpReport( event, '$patient.id' )" title='$i18n.getString( "followup" )'>
+					<input type="button" id='generateButton' value="$i18n.getString( 'discharge' )" onclick="javascript:generatePatientReport( event, '$patient.id' )" title='$i18n.getString( "discharge" )'>
+					<input type="button" id='generateButton' value="$i18n.getString( 'followup' )" onclick="javascript:generatePatientFollowUpReport( event, '$patient.id' )" title='$i18n.getString( "followup" )'>
 				   <!-- <a  href="#" onclick="javascript:generatePatientReport( event, '$patient.id' )" title='$i18n.getString( "generate" )' target="_blank">$i18n.getString( "generate" )</a>-->
 				  <!--<a id="exportToExcel" name="exportToExcel" href="#" onclick="javascript:generatePatientReport( event, '$patient.id' )" title='$i18n.getString( "generate" )' target="_blank"><img src="images/GenerateButton.gif" alt='$i18n.getString( "generate" )'></a>-->
-				  </td>
+				  
+				
 				#else
-				  <td>	
-				  <input type="button" id='generateButton' value="$i18n.getString( 'discharge' )" onclick="javascript:generatePatientReport( event, '$patient.id' )" disabled="disabled" title='$i18n.getString( "discharge" )'></td>
-				  <td><input type="button" id='generateButton' value="$i18n.getString( 'followup' )" onclick="javascript:generatePatientFollowUpReport( event, '$patient.id' )" disabled="disabled" title='$i18n.getString( "followup" )'>
+				  
+				  <input type="button" id='generateButton' value="$i18n.getString( 'discharge' )" onclick="javascript:generatePatientReport( event, '$patient.id' )" disabled="disabled" title='$i18n.getString( "discharge" )'>
+				  <input type="button" id='generateButton' value="$i18n.getString( 'followup' )" onclick="javascript:generatePatientFollowUpReport( event, '$patient.id' )" disabled="disabled" title='$i18n.getString( "followup" )'>
 				  <!--<a  href="#" onclick="javascript:generatePatientReport( event, '$patient.id' )" title='$i18n.getString( "generate" )' disabled="disabled" target="_blank">$i18n.getString( "generate" )</a>-->
 				  <!--<a id="exportToExcel" name="exportToExcel" href="#" onclick="javascript:generatePatientReport( event, '$patient.id' )" title='$i18n.getString( "generate" )' target="_blank" style='display:none'><img src="images/GenerateButton.gif" alt='$i18n.getString( "generate" )'></a>-->	  
-				  </td>
+				  
 				#end  
 				
-				<td>
+				
 				<a href="javascript:showPatientDetails( '$patient.id' )" title='$i18n.getString( "show_details" )'><img src="../images/information.png" alt='$i18n.getString( "show_details" )'></a>
+				
+				
 				<!--
 				#if( $patient.getPrograms().size() !=0 )
 				  <input type="button" id='generateButton' value="$i18n.getString( 'generate' )" onclick="javascript:generatePatientReport( event, '$patient.id' )" title='$i18n.getString( "generate" )'>
@@ -176,9 +163,6 @@
 				<!--
 				#end  
 				  <!--<input type="button" id='generateButton' value="$i18n.getString( 'generate' )" onclick='generatePatientReport( '$patient.id' );'>-->
-				
-
-				
 				</td>
 				
 			</tr>
@@ -204,13 +188,14 @@
 #end
 </form>
 
-<div id="detailsInfo">
-</div>
+<div id="detailsInfo"></div>
+
 <script type="text/javascript">
+	
 	jQuery(document).ready(function(){	
 		tableSorter( 'patientList' );
 	});
 	var i18n_patient_details = '$encoder.jsEscape( $i18n.getString( "patient_details" ) , "'" )';
 	var i18n_no_xls_xml = '$encoder.jsEscape( $i18n.getString( "no_xls_xml" ) , "'")';
 	
-</script>
+</script>
\ No newline at end of file

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/portalReportForm.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/portalReportForm.vm	2011-10-13 09:13:08 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/portalReportForm.vm	2013-09-19 06:34:31 +0000
@@ -62,7 +62,7 @@
 
 </script>
 
-<h1>NBITS GOI Report Analyser</h1>
+<h1>Tracker Portal Report Analyser</h1>
 <hr /><br />
 
 <form id="reportForm" name="reportForm" action="generatePortalReport.action" method="post" onsubmit="return formValidations()" target="_blank">

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/ranking2ReportFront.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/ranking2ReportFront.vm	2012-07-24 12:38:31 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/ranking2ReportFront.vm	2013-09-19 06:34:31 +0000
@@ -40,7 +40,7 @@
         <input type="hidden" name="ouIDTB" id="ouIDTB" />
         <input type="hidden" name="reportTypeNameTB" id="reportTypeNameTB" value="$reportTypeName" />		
 	</div>
-    <table align="center" style=" border-collapse: collapse; margin-top: 0;" cellpadding="0" cellspacing="6" border=0>                      
+     <table align="center" style=" border-collapse: collapse; margin-top: 0;" cellpadding="0" cellspacing="0" width="730" border=0>                    
         <tr>
             <td class="NormalB">
 				1. $i18n.getString( "organisationunit" ) :<br />
@@ -103,11 +103,30 @@
             <td>&nbsp;</td>
         </tr>
         <tr>
-			<td>&nbsp;</td>
+			<td><input type="submit" id= "generate1" name="generate1" value='$i18n.getString( "generate_report_facility_wise" )' style="width:200px" disabled="disabled" onclick="callAction('STATE')"/></td>
 			<td>&nbsp;</td>
 			<td>
-				<input type="submit" id= "generate" name="generate" value='$i18n.getString( "generate_report" )' style="width:200px" />
+				<input type="submit" id= "generate" name="generate" value='$i18n.getString( "generate_report_individual" )' style="width:200px" disabled="disabled" onclick="callAction('DISTRICT')"/>
             </td>
 		</tr>
     </table>
-</form>
\ No newline at end of file
+</form>
+
+<script>	
+function callAction( actionName )
+{
+	if( formValidations() )
+	{        
+		if( actionName == "DISTRICT" )
+		{
+			document.reportForm.action = "generateRanking2Report.action";
+			document.reportForm.submit();
+		}
+		else
+		{
+			document.reportForm.action = "generateStateRanking2Report.action";
+			document.reportForm.submit();
+		}
+	}
+}	
+</script>
\ No newline at end of file

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/responseReport.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/responseReport.vm	2010-06-04 11:50:05 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/responseReport.vm	2014-07-08 10:14:35 +0000
@@ -5,8 +5,9 @@
         	<id>$report.id</id>
         	<name>$report.name</name>
         	<model>$report.model</model>
-        	<fileName>$report.fileName</fileName>
+        	<fileName>$encoder.xmlEncode( $report.getExcelTemplateName() )</fileName>
 			<ouName>$encoder.xmlEncode( $ouName )</ouName>
+			<ouLavel>$selectedOrgUnitLevel</ouLavel>
     	</report>
     #end
 </reports>

=== removed file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/showGlobalConfigForm.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/showGlobalConfigForm.vm	2012-06-30 10:19:34 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/showGlobalConfigForm.vm	1970-01-01 00:00:00 +0000
@@ -1,50 +0,0 @@
-<div id="caption" align="center" style="background-color: #99FFFF; height:50;width:400;margin-bottom: 20;padding-top: 7">
-<h3>$i18n.getString( "generate_globalXML" )</h3>
-</div>
-
-<form id="showGlobalConfigForm" name="showGlobalConfigForm" action="showglobalconfig.action" method="post">
-    <tbody>
-
-
-    <tr>
-        <td colspan="2">
-            <input type="button" id ="gen" onclick="llAggregate();"
-                   value="$i18n.getString( "generate" )" style="width:12em">
-        </td>
-        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-        </td>
-        <td colspan="2">
-            <input type="button" id="download" disabled="true"  onclick="window.location.href='downloadnewra.action'"
-                   value="$i18n.getString( "download" )" style="width:16em">
-        </td>
-
-    </tr>
-    #parse( "/dhis-web-commons/loader/loader.vm" )
-    <div id='loaderDiv' style="margin-top: 20"></div>
-    <div id="llAggregateDiv"></div>
-    </tbody>
-</form>
-
-<script type="text/javascript">
-    function llAggregate()
-    {
-
-
-            jQuery('#loaderDiv').show();
-
-            document.getElementById("gen").disabled = true;
-
-            jQuery('#llAggregateDiv').load('globalconfig.action',
-                    {
-
-                    }, function()
-                    {
-                        document.getElementById( "download" ).disabled = false;
-
-                        jQuery('#loaderDiv').hide();
-                        jQuery('#llAggregateDiv').hide();
-                    });
-
-    }
-
-</script>

=== modified file 'local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/upwardReportAnalysisFront.vm'
--- local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/upwardReportAnalysisFront.vm	2011-04-15 11:40:14 +0000
+++ local/in/dhis-web-reports-national/src/main/webapp/dhis-web-reports/upwardReportAnalysisFront.vm	2013-09-19 06:34:31 +0000
@@ -82,7 +82,7 @@
                 <select id="aggData" name="aggData" style="width:200px">
                     <option value="generateaggdata">$i18n.getString( "generate_agg_data" )</option>
                     <option value="useexistingaggdata">$i18n.getString( "use_existing_agg_data" )</option>
-                    <option value="usecaptureddata">$i18n.getString( "use_captured_data" )</option>
+                    <option selected="selected" value="usecaptureddata">$i18n.getString( "use_captured_data" )</option>
                 </select>
                 <br><br><br><br>                                
                 <input type="submit" id= "generate" name="generate" value='$i18n.getString( "generate_report" )' disabled="disabled">

=== modified file 'local/in/dhis-web-survey/pom.xml'
--- local/in/dhis-web-survey/pom.xml	2014-01-10 07:08:30 +0000
+++ local/in/dhis-web-survey/pom.xml	2014-07-04 12:47:29 +0000
@@ -6,7 +6,7 @@
 	<parent>
 		<groupId>org.hisp.dhis</groupId>
 		<artifactId>dhis-web</artifactId>
-		<version>2.15-SNAPSHOT</version>
+		<version>2.15</version>
 	</parent>
 	
 	<artifactId>dhis-web-survey</artifactId>
@@ -67,11 +67,13 @@
 			<artifactId>dhis-web-commons-resources</artifactId>
 			<type>war</type>
 		</dependency>
+		
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-service-aggregationengine-default</artifactId>
 			<version>${project.version}</version>
 		</dependency>
+		
 		<dependency>
 			<groupId>org.hisp.dhis</groupId>
 			<artifactId>dhis-support-external</artifactId>

=== modified file 'local/in/dhis-web-survey/src/main/java/org/hisp/dhis/survey/action/ValidateDataSetAction.java'
--- local/in/dhis-web-survey/src/main/java/org/hisp/dhis/survey/action/ValidateDataSetAction.java	2010-06-04 11:50:05 +0000
+++ local/in/dhis-web-survey/src/main/java/org/hisp/dhis/survey/action/ValidateDataSetAction.java	2013-09-19 06:34:31 +0000
@@ -27,6 +27,9 @@
  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */
 
+import java.util.ArrayList;
+import java.util.List;
+
 import org.hisp.dhis.dataset.DataSet;
 import org.hisp.dhis.dataset.DataSetService;
 import org.hisp.dhis.i18n.I18n;
@@ -129,8 +132,12 @@
                 return INPUT;
             }
 
-            DataSet match = dataSetService.getDataSetByName( name );
-    
+            //DataSet match = dataSetService.getDataSetByName( name );
+            List<DataSet> dataSets = new ArrayList<DataSet>( dataSetService.getDataSetByName( name ) ); 
+            //dataSet = dataSets.get( 0 );
+            
+            DataSet match = dataSets.get( 0 );
+            
             if ( match != null && ( dataSetId == null || match.getId() != dataSetId ) )
             {
                 message = i18n.getString( "duplicate_names" );
@@ -160,8 +167,10 @@
                 return INPUT;
             }
 
-            DataSet match = dataSetService.getDataSetByShortName( shortName );
-    
+            //DataSet match = dataSetService.getDataSetByShortName( shortName );
+            List<DataSet> dataSets = new ArrayList<DataSet>( dataSetService.getDataSetByShortName( name ) );
+            DataSet match = dataSets.get( 0 );
+            
             if ( match != null && ( dataSetId == null || match.getId() != dataSetId ) )
             {
                 message = i18n.getString( "duplicate_short_names" );

=== modified file 'local/in/dhis-web-survey/src/main/webapp/WEB-INF/web.xml'
--- local/in/dhis-web-survey/src/main/webapp/WEB-INF/web.xml	2012-04-04 05:46:52 +0000
+++ local/in/dhis-web-survey/src/main/webapp/WEB-INF/web.xml	2013-09-19 06:34:31 +0000
@@ -31,7 +31,7 @@
   </filter>
   <filter>
     <filter-name>Struts</filter-name>
-    <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
+    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
   </filter>
   
   <filter-mapping>

=== modified file 'local/in/pom.xml'
--- local/in/pom.xml	2014-06-02 09:44:51 +0000
+++ local/in/pom.xml	2014-11-27 06:12:19 +0000
@@ -13,26 +13,34 @@
 
 	<module>dhis-in-api</module>
     <module>dhis-in-services</module>
-	<!--	
-	<module>dhis-web-maintenance-in</module>
+	
+	<!--
 	<module>dhis-web-maintenance-pbf</module>
 	
-<module>dhis-web-maintenance-ccem</module>	
+	<module>dhis-web-maintenance-ccem</module>	
 	<module>dhis-web-coldchain</module>
     <module>dhis-web-dataentry-ccem</module> -->
 	
-    <!--<module>dhis-web-dashboard</module>
-    <module>dhis-web-dataentry-linelisting</module>
-    <module>dhis-web-excelimport</module>-->
+	<module>dhis-web-maintenance-in</module>
+    <module>dhis-web-dashboard</module>
+    <!--<module>dhis-web-dataentry-linelisting</module>-->
+    <module>dhis-web-excelimport</module>
+	
 	<!--<module>dhis-web-linelisting-in</module> -->
     
-<!--<module>dhis-web-mobile</module>
+	<!--<module>dhis-web-mobile</module>
 	<module>dhis-web-reports-in</module>-->
-<!--<module>dhis-web-reports-national</module>
+	
+	<module>dhis-web-reports-national</module>
 	<module>dhis-web-survey</module> 
-	<module>dhis-web-alert</module>-->
-<!--<module>dhis-web-validationrule-in</module>-->
-<module>dhis-web-birtreports</module> 
+	<module>dhis-web-alert</module>
+	
+	<!--<module>dhis-web-validationrule-in</module>-->
+
+	<module>dhis-web-birtreports</module> 
+	<module>dhis-web-dataentry-linelisting</module>
+	<!--<module>dhis-in-service-ihrissyncmanager</module>-->
+	
   </modules>
   
     

